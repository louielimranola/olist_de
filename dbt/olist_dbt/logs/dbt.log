[0m17:19:37.400513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c77410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036645f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036646b0>]}


============================== 17:19:37.404714 | 7fc83cba-93ed-4e2e-a4e2-b037cf9865a4 ==============================
[0m17:19:37.404714 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:19:37.405195 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:19:37.418560 [info ] [MainThread]: dbt version: 1.8.6
[0m17:19:37.418890 [info ] [MainThread]: python version: 3.12.4
[0m17:19:37.419116 [info ] [MainThread]: python path: /Users/eranola/Documents/projects/environments/venv/bin/python
[0m17:19:37.419324 [info ] [MainThread]: os info: macOS-13.3.1-arm64-arm-64bit
[0m17:19:37.581664 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:19:37.582083 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:19:37.622185 [info ] [MainThread]: Using profiles dir at /Users/eranola/.dbt
[0m17:19:37.622537 [info ] [MainThread]: Using profiles.yml file at /Users/eranola/.dbt/profiles.yml
[0m17:19:37.622781 [info ] [MainThread]: Using dbt_project.yml file at /Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/dbt_project.yml
[0m17:19:37.624086 [info ] [MainThread]: adapter type: redshift
[0m17:19:37.624376 [info ] [MainThread]: adapter version: 1.8.1
[0m17:19:37.683279 [info ] [MainThread]: Configuration:
[0m17:19:37.683706 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:19:37.683943 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:19:37.684141 [info ] [MainThread]: Required dependencies:
[0m17:19:37.684784 [debug] [MainThread]: Executing "git --help"
[0m17:19:37.701260 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:19:37.701964 [debug] [MainThread]: STDERR: "b''"
[0m17:19:37.702235 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:19:37.702473 [info ] [MainThread]: Connection:
[0m17:19:37.702736 [info ] [MainThread]:   host: redshift-cluster-1.cfbi7zij33s3.ap-southeast-1.redshift.amazonaws.com
[0m17:19:37.702934 [info ] [MainThread]:   user: awsuser
[0m17:19:37.703116 [info ] [MainThread]:   port: 5439
[0m17:19:37.703296 [info ] [MainThread]:   database: dev
[0m17:19:37.703483 [info ] [MainThread]:   method: database
[0m17:19:37.703654 [info ] [MainThread]:   cluster_id: None
[0m17:19:37.703826 [info ] [MainThread]:   iam_profile: None
[0m17:19:37.704001 [info ] [MainThread]:   schema: public
[0m17:19:37.704167 [info ] [MainThread]:   sslmode: prefer
[0m17:19:37.704333 [info ] [MainThread]:   region: None
[0m17:19:37.704501 [info ] [MainThread]:   sslmode: prefer
[0m17:19:37.704683 [info ] [MainThread]:   region: None
[0m17:19:37.704847 [info ] [MainThread]:   iam_profile: None
[0m17:19:37.705013 [info ] [MainThread]:   autocreate: False
[0m17:19:37.705192 [info ] [MainThread]:   db_groups: []
[0m17:19:37.705353 [info ] [MainThread]:   ra3_node: False
[0m17:19:37.705520 [info ] [MainThread]:   connect_timeout: None
[0m17:19:37.705680 [info ] [MainThread]:   role: None
[0m17:19:37.705842 [info ] [MainThread]:   retries: 1
[0m17:19:37.706014 [info ] [MainThread]:   autocommit: True
[0m17:19:37.706460 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m17:19:37.741011 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m17:19:37.746286 [debug] [MainThread]: Using redshift connection "debug"
[0m17:19:37.746552 [debug] [MainThread]: On debug: select 1 as id
[0m17:19:37.746762 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:19:37.750804 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:19:37.751507 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:19:38.640308 [debug] [MainThread]: SQL status: SUCCESS in 0.893 seconds
[0m17:19:38.643884 [debug] [MainThread]: On debug: Close
[0m17:19:38.645155 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:19:38.645855 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:19:38.650060 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.3024551, "process_user_time": 1.185132, "process_kernel_time": 0.318032, "process_mem_max_rss": "110985216", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:19:38.650967 [debug] [MainThread]: Command `dbt debug` succeeded at 17:19:38.650812 after 1.30 seconds
[0m17:19:38.651456 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:19:38.651964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104edfb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c77410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104227320>]}
[0m17:19:38.652542 [debug] [MainThread]: Flushing usage events
[0m00:20:23.339514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045a7560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038f4860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038f4950>]}


============================== 00:20:23.344231 | c0395035-ead6-493b-8268-3697d37ba6b9 ==============================
[0m00:20:23.344231 [info ] [MainThread]: Running with dbt=1.8.6
[0m00:20:23.344734 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:20:23.357469 [info ] [MainThread]: dbt version: 1.8.6
[0m00:20:23.357878 [info ] [MainThread]: python version: 3.12.4
[0m00:20:23.358131 [info ] [MainThread]: python path: /Users/eranola/Documents/projects/environments/venv/bin/python
[0m00:20:23.358358 [info ] [MainThread]: os info: macOS-13.3.1-arm64-arm-64bit
[0m00:20:23.517628 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m00:20:23.518039 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m00:20:23.558590 [info ] [MainThread]: Using profiles dir at /Users/eranola/.dbt
[0m00:20:23.559064 [info ] [MainThread]: Using profiles.yml file at /Users/eranola/.dbt/profiles.yml
[0m00:20:23.559337 [info ] [MainThread]: Using dbt_project.yml file at /Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/dbt_project.yml
[0m00:20:23.560772 [info ] [MainThread]: adapter type: redshift
[0m00:20:23.561092 [info ] [MainThread]: adapter version: 1.8.1
[0m00:20:23.622514 [info ] [MainThread]: Configuration:
[0m00:20:23.622971 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:20:23.623224 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:20:23.623446 [info ] [MainThread]: Required dependencies:
[0m00:20:23.624002 [debug] [MainThread]: Executing "git --help"
[0m00:20:23.635257 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:20:23.636161 [debug] [MainThread]: STDERR: "b''"
[0m00:20:23.636451 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:20:23.636718 [info ] [MainThread]: Connection:
[0m00:20:23.636983 [info ] [MainThread]:   host: redshift-cluster-1.cfbi7zij33s3.ap-southeast-1.redshift.amazonaws.com
[0m00:20:23.637194 [info ] [MainThread]:   user: awsuser
[0m00:20:23.637405 [info ] [MainThread]:   port: 5439
[0m00:20:23.637614 [info ] [MainThread]:   database: dev
[0m00:20:23.637831 [info ] [MainThread]:   method: database
[0m00:20:23.638024 [info ] [MainThread]:   cluster_id: None
[0m00:20:23.638220 [info ] [MainThread]:   iam_profile: None
[0m00:20:23.638414 [info ] [MainThread]:   schema: public
[0m00:20:23.638598 [info ] [MainThread]:   sslmode: prefer
[0m00:20:23.638793 [info ] [MainThread]:   region: None
[0m00:20:23.638979 [info ] [MainThread]:   sslmode: prefer
[0m00:20:23.639180 [info ] [MainThread]:   region: None
[0m00:20:23.639378 [info ] [MainThread]:   iam_profile: None
[0m00:20:23.639566 [info ] [MainThread]:   autocreate: False
[0m00:20:23.639753 [info ] [MainThread]:   db_groups: []
[0m00:20:23.639943 [info ] [MainThread]:   ra3_node: False
[0m00:20:23.640135 [info ] [MainThread]:   connect_timeout: None
[0m00:20:23.640317 [info ] [MainThread]:   role: None
[0m00:20:23.640497 [info ] [MainThread]:   retries: 1
[0m00:20:23.640687 [info ] [MainThread]:   autocommit: True
[0m00:20:23.641193 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m00:20:23.692587 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m00:20:23.698200 [debug] [MainThread]: Using redshift connection "debug"
[0m00:20:23.698542 [debug] [MainThread]: On debug: select 1 as id
[0m00:20:23.698790 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:20:23.702880 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:20:23.703640 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m00:20:24.511827 [debug] [MainThread]: SQL status: SUCCESS in 0.813 seconds
[0m00:20:24.516839 [debug] [MainThread]: On debug: Close
[0m00:20:24.517863 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:20:24.518410 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:20:24.522120 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.2336956, "process_user_time": 1.204251, "process_kernel_time": 0.301051, "process_mem_max_rss": "110444544", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:20:24.523057 [debug] [MainThread]: Command `dbt debug` succeeded at 00:20:24.522899 after 1.23 seconds
[0m00:20:24.523592 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:20:24.524163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054fbf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ad9be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cfac30>]}
[0m00:20:24.524802 [debug] [MainThread]: Flushing usage events
[0m01:00:53.313460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bb4fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a9ca70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a9cb60>]}


============================== 01:00:53.318248 | c47a8d82-de91-4fd3-b4a2-52df68c0e5b5 ==============================
[0m01:00:53.318248 [info ] [MainThread]: Running with dbt=1.8.6
[0m01:00:53.318794 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'profiles_dir': '/Users/eranola/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:00:53.491072 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m01:00:53.491513 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m01:00:53.629036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c47a8d82-de91-4fd3-b4a2-52df68c0e5b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10525b920>]}
[0m01:00:53.666599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c47a8d82-de91-4fd3-b4a2-52df68c0e5b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f18b00>]}
[0m01:00:53.667657 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m01:00:53.685227 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m01:00:53.686679 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:00:53.687046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c47a8d82-de91-4fd3-b4a2-52df68c0e5b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052595e0>]}
[0m01:00:54.444825 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.olist_dbt.stg_orders' (models/staging/olist/stg_orders.sql) depends on a source named 'olist.order' which was not found
[0m01:00:54.447700 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1881257, "process_user_time": 1.827604, "process_kernel_time": 0.293375, "process_mem_max_rss": "114245632", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:00:54.448211 [debug] [MainThread]: Command `dbt run` failed at 01:00:54.448134 after 1.19 seconds
[0m01:00:54.448545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1015decc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104543b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10359c260>]}
[0m01:00:54.448831 [debug] [MainThread]: Flushing usage events
[0m01:03:56.577381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10701f1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a607fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a607e30>]}


============================== 01:03:56.581795 | fcc1056a-f8cc-4889-8b37-e526b944a9f5 ==============================
[0m01:03:56.581795 [info ] [MainThread]: Running with dbt=1.8.6
[0m01:03:56.582344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/eranola/.dbt', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:03:56.755258 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m01:03:56.755687 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m01:03:56.890105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcc1056a-f8cc-4889-8b37-e526b944a9f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a607e00>]}
[0m01:03:56.927816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcc1056a-f8cc-4889-8b37-e526b944a9f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1188570b0>]}
[0m01:03:56.929581 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m01:03:56.947619 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m01:03:56.948863 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:03:56.949223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fcc1056a-f8cc-4889-8b37-e526b944a9f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b26a7e0>]}
[0m01:03:57.701860 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.olist_dbt.stg_orders' (models/staging/olist/stg_orders.sql) depends on a source named 'olist.order' which was not found
[0m01:03:57.704636 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1805898, "process_user_time": 1.829325, "process_kernel_time": 0.289704, "process_mem_max_rss": "114180096", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:03:57.705168 [debug] [MainThread]: Command `dbt run` failed at 01:03:57.705087 after 1.18 seconds
[0m01:03:57.705519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10487ecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b27a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11812c950>]}
[0m01:03:57.705809 [debug] [MainThread]: Flushing usage events
[0m01:17:18.065778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bfffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10460bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10460b830>]}


============================== 01:17:18.070556 | ea644fe2-7363-4889-9b03-aa4d0cba378f ==============================
[0m01:17:18.070556 [info ] [MainThread]: Running with dbt=1.8.6
[0m01:17:18.071071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:17:18.247239 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m01:17:18.247664 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m01:17:18.384667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea644fe2-7363-4889-9b03-aa4d0cba378f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104632420>]}
[0m01:17:18.421249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea644fe2-7363-4889-9b03-aa4d0cba378f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045d4500>]}
[0m01:17:18.423008 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m01:17:18.440398 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m01:17:18.441861 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:17:18.442235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ea644fe2-7363-4889-9b03-aa4d0cba378f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105114230>]}
[0m01:17:19.198536 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.olist_dbt.stg_orders' (models/staging/olist/stg_orders.sql) depends on a source named 'olist.order' which was not found
[0m01:17:19.201573 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1916535, "process_user_time": 1.822543, "process_kernel_time": 0.302624, "process_mem_max_rss": "113721344", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:17:19.202092 [debug] [MainThread]: Command `dbt run` failed at 01:17:19.202009 after 1.19 seconds
[0m01:17:19.202441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10460bf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055e49e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057bc080>]}
[0m01:17:19.202725 [debug] [MainThread]: Flushing usage events
[0m01:18:37.609994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee8dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103289b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103288f0>]}


============================== 01:18:37.614805 | e8c8a464-5ca8-4c8e-8ad9-aa4d67276201 ==============================
[0m01:18:37.614805 [info ] [MainThread]: Running with dbt=1.8.6
[0m01:18:37.615311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/eranola/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:18:37.788062 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m01:18:37.788491 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m01:18:37.924267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8c8a464-5ca8-4c8e-8ad9-aa4d67276201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11399ddf0>]}
[0m01:18:37.961737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8c8a464-5ca8-4c8e-8ad9-aa4d67276201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139063f0>]}
[0m01:18:37.963496 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m01:18:37.981031 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m01:18:37.982565 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:18:37.982946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e8c8a464-5ca8-4c8e-8ad9-aa4d67276201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148f73e0>]}
[0m01:18:38.774509 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.olist_dbt.marts
- models.olist_dbt.intermediate
[0m01:18:38.778404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8c8a464-5ca8-4c8e-8ad9-aa4d67276201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1154511f0>]}
[0m01:18:38.832487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8c8a464-5ca8-4c8e-8ad9-aa4d67276201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1154e20c0>]}
[0m01:18:38.832899 [info ] [MainThread]: Found 1 model, 488 macros
[0m01:18:38.833256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8c8a464-5ca8-4c8e-8ad9-aa4d67276201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11538c830>]}
[0m01:18:38.834584 [info ] [MainThread]: 
[0m01:18:38.835059 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m01:18:38.835707 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m01:18:38.848737 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m01:18:38.849134 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m01:18:38.849373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:38.852679 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:18:38.853401 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:18:39.746421 [debug] [ThreadPool]: SQL status: SUCCESS in 0.897 seconds
[0m01:18:39.751081 [debug] [ThreadPool]: On list_dev: Close
[0m01:18:39.752905 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_public_staging)
[0m01:18:39.753762 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "public_staging"
"
[0m01:18:39.764458 [debug] [ThreadPool]: Using redshift connection "create_dev_public_staging"
[0m01:18:39.765171 [debug] [ThreadPool]: On create_dev_public_staging: BEGIN
[0m01:18:39.765627 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:39.766233 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:18:39.766599 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:18:40.337441 [debug] [ThreadPool]: SQL status: SUCCESS in 0.571 seconds
[0m01:18:40.338849 [debug] [ThreadPool]: Using redshift connection "create_dev_public_staging"
[0m01:18:40.339580 [debug] [ThreadPool]: On create_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "create_dev_public_staging"} */
create schema if not exists "public_staging"
[0m01:18:40.636507 [debug] [ThreadPool]: SQL status: SUCCESS in 0.296 seconds
[0m01:18:40.641258 [debug] [ThreadPool]: On create_dev_public_staging: COMMIT
[0m01:18:40.642643 [debug] [ThreadPool]: Using redshift connection "create_dev_public_staging"
[0m01:18:40.643597 [debug] [ThreadPool]: On create_dev_public_staging: COMMIT
[0m01:18:40.806605 [debug] [ThreadPool]: SQL status: SUCCESS in 0.162 seconds
[0m01:18:40.808688 [debug] [ThreadPool]: On create_dev_public_staging: Close
[0m01:18:40.812435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_public_staging, now list_dev_public_staging)
[0m01:18:40.827900 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m01:18:40.828555 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m01:18:40.828923 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:40.829459 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:18:40.829812 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:18:41.396040 [debug] [ThreadPool]: SQL status: SUCCESS in 0.567 seconds
[0m01:18:41.397982 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m01:18:41.399074 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m01:18:41.516404 [debug] [ThreadPool]: SQL status: SUCCESS in 0.116 seconds
[0m01:18:41.521606 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m01:18:41.626395 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m01:18:41.648794 [debug] [MainThread]: Using redshift connection "master"
[0m01:18:41.649390 [debug] [MainThread]: On master: BEGIN
[0m01:18:41.649749 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:18:41.650255 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:18:41.650627 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:18:42.246101 [debug] [MainThread]: SQL status: SUCCESS in 0.596 seconds
[0m01:18:42.248028 [debug] [MainThread]: Using redshift connection "master"
[0m01:18:42.249313 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m01:18:42.445946 [debug] [MainThread]: SQL status: SUCCESS in 0.195 seconds
[0m01:18:42.451274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8c8a464-5ca8-4c8e-8ad9-aa4d67276201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115453620>]}
[0m01:18:42.452573 [debug] [MainThread]: On master: ROLLBACK
[0m01:18:42.566463 [debug] [MainThread]: Using redshift connection "master"
[0m01:18:42.567889 [debug] [MainThread]: On master: BEGIN
[0m01:18:42.625687 [debug] [MainThread]: SQL status: SUCCESS in 0.057 seconds
[0m01:18:42.626850 [debug] [MainThread]: On master: COMMIT
[0m01:18:42.628012 [debug] [MainThread]: Using redshift connection "master"
[0m01:18:42.628898 [debug] [MainThread]: On master: COMMIT
[0m01:18:42.746080 [debug] [MainThread]: SQL status: SUCCESS in 0.116 seconds
[0m01:18:42.747724 [debug] [MainThread]: On master: Close
[0m01:18:42.749760 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:18:42.750776 [info ] [MainThread]: 
[0m01:18:42.756743 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_orders
[0m01:18:42.758038 [info ] [Thread-1 (]: 1 of 1 START sql view model public_staging.stg_orders .......................... [RUN]
[0m01:18:42.758820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now model.olist_dbt.stg_orders)
[0m01:18:42.759346 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_orders
[0m01:18:42.762261 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_orders"
[0m01:18:42.765522 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_orders
[0m01:18:42.805892 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_orders"
[0m01:18:42.808991 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:18:42.809322 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m01:18:42.809597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:42.809974 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:18:42.810247 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:18:43.476313 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.666 seconds
[0m01:18:43.478358 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:18:43.479784 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */


  create view "dev"."public_staging"."stg_orders__dbt_tmp" as (
    SELECT
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
FROM order
  ) ;
[0m01:18:43.546236 [debug] [Thread-1 (]: Redshift adapter: Redshift error: syntax error at or near "order" in context ",
    order_estimated_delivery_date
FROM order", at line 14, column 6
[0m01:18:43.548352 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: ROLLBACK
[0m01:18:43.676143 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: Close
[0m01:18:43.689302 [debug] [Thread-1 (]: Database Error in model stg_orders (models/staging/olist/stg_orders.sql)
  syntax error at or near "order" in context ",
      order_estimated_delivery_date
  FROM order", at line 14, column 6
  compiled Code at target/run/olist_dbt/models/staging/olist/stg_orders.sql
[0m01:18:43.691564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8c8a464-5ca8-4c8e-8ad9-aa4d67276201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138d55b0>]}
[0m01:18:43.692566 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public_staging.stg_orders ................. [[31mERROR[0m in 0.93s]
[0m01:18:43.693465 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_orders
[0m01:18:43.695940 [debug] [MainThread]: Using redshift connection "master"
[0m01:18:43.696540 [debug] [MainThread]: On master: BEGIN
[0m01:18:43.696991 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:18:43.697644 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:18:43.698094 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:18:44.245693 [debug] [MainThread]: SQL status: SUCCESS in 0.548 seconds
[0m01:18:44.247529 [debug] [MainThread]: On master: COMMIT
[0m01:18:44.248863 [debug] [MainThread]: Using redshift connection "master"
[0m01:18:44.249820 [debug] [MainThread]: On master: COMMIT
[0m01:18:44.355617 [debug] [MainThread]: SQL status: SUCCESS in 0.105 seconds
[0m01:18:44.357354 [debug] [MainThread]: On master: Close
[0m01:18:44.359170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:18:44.359800 [debug] [MainThread]: Connection 'model.olist_dbt.stg_orders' was properly closed.
[0m01:18:44.360452 [info ] [MainThread]: 
[0m01:18:44.361118 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.53 seconds (5.53s).
[0m01:18:44.362275 [debug] [MainThread]: Command end result
[0m01:18:44.402742 [info ] [MainThread]: 
[0m01:18:44.403249 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:18:44.403534 [info ] [MainThread]: 
[0m01:18:44.403869 [error] [MainThread]:   Database Error in model stg_orders (models/staging/olist/stg_orders.sql)
  syntax error at or near "order" in context ",
      order_estimated_delivery_date
  FROM order", at line 14, column 6
  compiled Code at target/run/olist_dbt/models/staging/olist/stg_orders.sql
[0m01:18:44.404132 [info ] [MainThread]: 
[0m01:18:44.404391 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:18:44.407000 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.84897, "process_user_time": 2.567461, "process_kernel_time": 0.401436, "process_mem_max_rss": "121389056", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:18:44.407545 [debug] [MainThread]: Command `dbt run` failed at 01:18:44.407456 after 6.85 seconds
[0m01:18:44.407936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134c1f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131a6330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056fecc0>]}
[0m01:18:44.408282 [debug] [MainThread]: Flushing usage events
[0m01:23:03.240362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e8680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ac950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076aca40>]}


============================== 01:23:03.245018 | 3da3b6ac-5cd3-4eb8-8bef-1c0acca826ec ==============================
[0m01:23:03.245018 [info ] [MainThread]: Running with dbt=1.8.6
[0m01:23:03.245511 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:23:03.364188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3da3b6ac-5cd3-4eb8-8bef-1c0acca826ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087eb0b0>]}
[0m01:23:03.385208 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.196647, "process_user_time": 0.996081, "process_kernel_time": 0.214284, "process_mem_max_rss": "96010240", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:23:03.385726 [debug] [MainThread]: Command `dbt clean` succeeded at 01:23:03.385649 after 0.20 seconds
[0m01:23:03.386043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108793f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085fd670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10727e780>]}
[0m01:23:03.386332 [debug] [MainThread]: Flushing usage events
[0m01:26:54.306370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e31250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c4c9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c4c950>]}


============================== 01:26:54.311168 | e15204ba-85d1-4a7b-9a60-7e67e1c2f5e6 ==============================
[0m01:26:54.311168 [info ] [MainThread]: Running with dbt=1.8.6
[0m01:26:54.311666 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/eranola/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:26:54.487675 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m01:26:54.488095 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m01:26:54.623606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e15204ba-85d1-4a7b-9a60-7e67e1c2f5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087236b0>]}
[0m01:26:54.660950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e15204ba-85d1-4a7b-9a60-7e67e1c2f5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a1ed20>]}
[0m01:26:54.662660 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m01:26:54.680699 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m01:26:54.681930 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:26:54.682262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e15204ba-85d1-4a7b-9a60-7e67e1c2f5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10943a120>]}
[0m01:26:55.479638 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.olist_dbt.marts
- models.olist_dbt.intermediate
[0m01:26:55.483484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e15204ba-85d1-4a7b-9a60-7e67e1c2f5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f86870>]}
[0m01:26:55.536482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e15204ba-85d1-4a7b-9a60-7e67e1c2f5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f1d730>]}
[0m01:26:55.536893 [info ] [MainThread]: Found 1 model, 488 macros
[0m01:26:55.537178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e15204ba-85d1-4a7b-9a60-7e67e1c2f5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d5b2f0>]}
[0m01:26:55.538390 [info ] [MainThread]: 
[0m01:26:55.538817 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m01:26:55.539488 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m01:26:55.552230 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m01:26:55.552680 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m01:26:55.552976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:26:55.556228 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:26:55.557002 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:26:56.223773 [debug] [ThreadPool]: SQL status: SUCCESS in 0.671 seconds
[0m01:26:56.226314 [debug] [ThreadPool]: On list_dev: Close
[0m01:26:56.228113 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public_staging)
[0m01:26:56.238376 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m01:26:56.238884 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m01:26:56.239247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:26:56.239768 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:26:56.240125 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:26:56.874224 [debug] [ThreadPool]: SQL status: SUCCESS in 0.634 seconds
[0m01:26:56.876254 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m01:26:56.877319 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m01:26:57.014150 [debug] [ThreadPool]: SQL status: SUCCESS in 0.135 seconds
[0m01:26:57.020447 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m01:26:57.143865 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m01:26:57.160942 [debug] [MainThread]: Using redshift connection "master"
[0m01:26:57.161659 [debug] [MainThread]: On master: BEGIN
[0m01:26:57.162106 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:26:57.162704 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:26:57.163057 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:26:57.823873 [debug] [MainThread]: SQL status: SUCCESS in 0.661 seconds
[0m01:26:57.825518 [debug] [MainThread]: Using redshift connection "master"
[0m01:26:57.826344 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m01:26:58.013836 [debug] [MainThread]: SQL status: SUCCESS in 0.186 seconds
[0m01:26:58.018569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e15204ba-85d1-4a7b-9a60-7e67e1c2f5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10930a3c0>]}
[0m01:26:58.019623 [debug] [MainThread]: On master: ROLLBACK
[0m01:26:58.144252 [debug] [MainThread]: Using redshift connection "master"
[0m01:26:58.145989 [debug] [MainThread]: On master: BEGIN
[0m01:26:58.213481 [debug] [MainThread]: SQL status: SUCCESS in 0.066 seconds
[0m01:26:58.214651 [debug] [MainThread]: On master: COMMIT
[0m01:26:58.215732 [debug] [MainThread]: Using redshift connection "master"
[0m01:26:58.216601 [debug] [MainThread]: On master: COMMIT
[0m01:26:58.343581 [debug] [MainThread]: SQL status: SUCCESS in 0.126 seconds
[0m01:26:58.345395 [debug] [MainThread]: On master: Close
[0m01:26:58.347233 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:26:58.347923 [info ] [MainThread]: 
[0m01:26:58.353855 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_orders
[0m01:26:58.354908 [info ] [Thread-1 (]: 1 of 1 START sql view model public_staging.stg_orders .......................... [RUN]
[0m01:26:58.355943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now model.olist_dbt.stg_orders)
[0m01:26:58.356570 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_orders
[0m01:26:58.407540 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_orders"
[0m01:26:58.410313 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_orders
[0m01:26:58.440055 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_orders"
[0m01:26:58.443186 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:26:58.443501 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m01:26:58.443764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:26:58.444123 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:26:58.444397 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:26:58.983838 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.539 seconds
[0m01:26:58.985973 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:26:58.987132 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */


  create view "dev"."public_staging"."stg_orders__dbt_tmp" as (
    


SELECT
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
FROM "order"
  ) ;
[0m01:26:59.243895 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.255 seconds
[0m01:26:59.259588 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:26:59.260402 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m01:26:59.433565 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.172 seconds
[0m01:26:59.463001 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m01:26:59.463674 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:26:59.464096 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m01:26:59.593359 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.128 seconds
[0m01:26:59.595402 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:26:59.596496 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m01:26:59.703463 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.106 seconds
[0m01:26:59.716839 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_orders__dbt_backup"
[0m01:26:59.721933 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:26:59.722312 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
drop view if exists "dev"."public_staging"."stg_orders__dbt_backup" cascade
[0m01:26:59.823275 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.100 seconds
[0m01:26:59.825803 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m01:26:59.826808 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:26:59.827496 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m01:26:59.903161 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.075 seconds
[0m01:26:59.904803 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:26:59.905834 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m01:26:59.983629 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.076 seconds
[0m01:26:59.989993 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: ROLLBACK
[0m01:27:00.093346 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: Close
[0m01:27:00.096432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e15204ba-85d1-4a7b-9a60-7e67e1c2f5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10765c9e0>]}
[0m01:27:00.097484 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public_staging.stg_orders ..................... [[32mSUCCESS[0m in 1.74s]
[0m01:27:00.098389 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_orders
[0m01:27:00.100020 [debug] [MainThread]: Using redshift connection "master"
[0m01:27:00.100533 [debug] [MainThread]: On master: BEGIN
[0m01:27:00.100955 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:27:00.101703 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:27:00.102121 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:27:00.633234 [debug] [MainThread]: SQL status: SUCCESS in 0.532 seconds
[0m01:27:00.634847 [debug] [MainThread]: On master: COMMIT
[0m01:27:00.636324 [debug] [MainThread]: Using redshift connection "master"
[0m01:27:00.637177 [debug] [MainThread]: On master: COMMIT
[0m01:27:00.743424 [debug] [MainThread]: SQL status: SUCCESS in 0.105 seconds
[0m01:27:00.745204 [debug] [MainThread]: On master: Close
[0m01:27:00.747021 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:27:00.747764 [debug] [MainThread]: Connection 'model.olist_dbt.stg_orders' was properly closed.
[0m01:27:00.748388 [info ] [MainThread]: 
[0m01:27:00.749063 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.21 seconds (5.21s).
[0m01:27:00.750181 [debug] [MainThread]: Command end result
[0m01:27:00.790256 [info ] [MainThread]: 
[0m01:27:00.790739 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:27:00.791029 [info ] [MainThread]: 
[0m01:27:00.791310 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:27:00.794064 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.539943, "process_user_time": 2.519117, "process_kernel_time": 0.393413, "process_mem_max_rss": "121716736", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:27:00.794618 [debug] [MainThread]: Command `dbt run` succeeded at 01:27:00.794531 after 6.54 seconds
[0m01:27:00.794977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105792cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aaf1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f8f410>]}
[0m01:27:00.795300 [debug] [MainThread]: Flushing usage events
[0m01:37:22.905870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10874e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b9c9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b9c9b0>]}


============================== 01:37:22.910341 | c0d1c329-7608-46ef-949d-ca2356e26030 ==============================
[0m01:37:22.910341 [info ] [MainThread]: Running with dbt=1.8.6
[0m01:37:22.910878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:37:23.087780 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m01:37:23.088194 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m01:37:23.229178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0d1c329-7608-46ef-949d-ca2356e26030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075ad8b0>]}
[0m01:37:23.266870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0d1c329-7608-46ef-949d-ca2356e26030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ce180>]}
[0m01:37:23.267967 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m01:37:23.284360 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m01:37:23.332380 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:37:23.332823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c0d1c329-7608-46ef-949d-ca2356e26030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108272450>]}
[0m01:37:24.157929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0d1c329-7608-46ef-949d-ca2356e26030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eb7e30>]}
[0m01:37:24.210053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0d1c329-7608-46ef-949d-ca2356e26030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098324e0>]}
[0m01:37:24.210467 [info ] [MainThread]: Found 1 model, 488 macros
[0m01:37:24.210741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0d1c329-7608-46ef-949d-ca2356e26030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10938d010>]}
[0m01:37:24.211986 [info ] [MainThread]: 
[0m01:37:24.212436 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m01:37:24.213068 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m01:37:24.260869 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m01:37:24.261300 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m01:37:24.261546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:37:24.264660 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:37:24.265383 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:37:25.030096 [debug] [ThreadPool]: SQL status: SUCCESS in 0.768 seconds
[0m01:37:25.035351 [debug] [ThreadPool]: On list_dev: Close
[0m01:37:25.038400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public)
[0m01:37:25.050182 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m01:37:25.050773 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m01:37:25.051206 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:37:25.051784 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:37:25.052177 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:37:25.782191 [debug] [ThreadPool]: SQL status: SUCCESS in 0.731 seconds
[0m01:37:25.783986 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m01:37:25.785041 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m01:37:25.942914 [debug] [ThreadPool]: SQL status: SUCCESS in 0.157 seconds
[0m01:37:25.947830 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m01:37:26.089935 [debug] [ThreadPool]: On list_dev_public: Close
[0m01:37:26.107923 [debug] [MainThread]: Using redshift connection "master"
[0m01:37:26.108586 [debug] [MainThread]: On master: BEGIN
[0m01:37:26.109019 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:37:26.109605 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:37:26.110044 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:37:26.880095 [debug] [MainThread]: SQL status: SUCCESS in 0.771 seconds
[0m01:37:26.882031 [debug] [MainThread]: Using redshift connection "master"
[0m01:37:26.883256 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m01:37:27.079554 [debug] [MainThread]: SQL status: SUCCESS in 0.195 seconds
[0m01:37:27.086760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0d1c329-7608-46ef-949d-ca2356e26030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10926ec90>]}
[0m01:37:27.088166 [debug] [MainThread]: On master: ROLLBACK
[0m01:37:27.210211 [debug] [MainThread]: Using redshift connection "master"
[0m01:37:27.211620 [debug] [MainThread]: On master: BEGIN
[0m01:37:27.279854 [debug] [MainThread]: SQL status: SUCCESS in 0.067 seconds
[0m01:37:27.281391 [debug] [MainThread]: On master: COMMIT
[0m01:37:27.282697 [debug] [MainThread]: Using redshift connection "master"
[0m01:37:27.283608 [debug] [MainThread]: On master: COMMIT
[0m01:37:27.409738 [debug] [MainThread]: SQL status: SUCCESS in 0.125 seconds
[0m01:37:27.411520 [debug] [MainThread]: On master: Close
[0m01:37:27.413526 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:37:27.414622 [info ] [MainThread]: 
[0m01:37:27.422177 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_orders
[0m01:37:27.423422 [info ] [Thread-1 (]: 1 of 1 START sql table model public.stg_orders ................................. [RUN]
[0m01:37:27.424186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.olist_dbt.stg_orders)
[0m01:37:27.424715 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_orders
[0m01:37:27.429176 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_orders"
[0m01:37:27.430964 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_orders
[0m01:37:27.478242 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_orders"
[0m01:37:27.480145 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:37:27.480449 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m01:37:27.480700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:27.481057 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:37:27.481324 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:37:28.249959 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.769 seconds
[0m01:37:28.252191 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:37:28.253425 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */

  
    

  create  table
    "dev"."public"."stg_orders__dbt_tmp"
    
    
    
  as (
    


SELECT
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
FROM "order"
  );
[0m01:37:37.480422 [debug] [Thread-1 (]: SQL status: SUCCESS in 9.226 seconds
[0m01:37:37.501049 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:37:37.501755 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m01:37:37.957776 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.455 seconds
[0m01:37:37.989452 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m01:37:37.990113 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:37:37.990547 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m01:37:38.167805 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.176 seconds
[0m01:37:38.169788 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:37:38.170851 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m01:37:38.317793 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.146 seconds
[0m01:37:38.330908 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."stg_orders__dbt_backup"
[0m01:37:38.338467 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:37:38.338948 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
drop table if exists "dev"."public"."stg_orders__dbt_backup" cascade
[0m01:37:38.487641 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.148 seconds
[0m01:37:38.491702 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m01:37:38.493098 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:37:38.494146 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m01:37:38.567767 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.072 seconds
[0m01:37:38.569484 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:37:38.570556 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m01:37:38.647652 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.076 seconds
[0m01:37:38.653411 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: ROLLBACK
[0m01:37:38.797783 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: Close
[0m01:37:38.802910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0d1c329-7608-46ef-949d-ca2356e26030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dd4320>]}
[0m01:37:38.804228 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.stg_orders ............................ [[32mSUCCESS[0m in 11.38s]
[0m01:37:38.805218 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_orders
[0m01:37:38.807330 [debug] [MainThread]: Using redshift connection "master"
[0m01:37:38.807934 [debug] [MainThread]: On master: BEGIN
[0m01:37:38.808335 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:37:38.809001 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:37:38.809469 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:37:39.537587 [debug] [MainThread]: SQL status: SUCCESS in 0.729 seconds
[0m01:37:39.539513 [debug] [MainThread]: On master: COMMIT
[0m01:37:39.540942 [debug] [MainThread]: Using redshift connection "master"
[0m01:37:39.541783 [debug] [MainThread]: On master: COMMIT
[0m01:37:39.687581 [debug] [MainThread]: SQL status: SUCCESS in 0.145 seconds
[0m01:37:39.689548 [debug] [MainThread]: On master: Close
[0m01:37:39.691337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:37:39.692019 [debug] [MainThread]: Connection 'model.olist_dbt.stg_orders' was properly closed.
[0m01:37:39.692766 [info ] [MainThread]: 
[0m01:37:39.693438 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.48 seconds (15.48s).
[0m01:37:39.694750 [debug] [MainThread]: Command end result
[0m01:37:39.732541 [info ] [MainThread]: 
[0m01:37:39.733072 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:37:39.733395 [info ] [MainThread]: 
[0m01:37:39.733716 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:37:39.736559 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.883913, "process_user_time": 2.611747, "process_kernel_time": 0.421751, "process_mem_max_rss": "124354560", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:37:39.737045 [debug] [MainThread]: Command `dbt run` succeeded at 01:37:39.736968 after 16.88 seconds
[0m01:37:39.737374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076abfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d1dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d1d970>]}
[0m01:37:39.737705 [debug] [MainThread]: Flushing usage events
[0m01:39:11.780404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10436ddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10465bbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046039b0>]}


============================== 01:39:11.784965 | ab580ae5-c830-47f3-a2ae-63ed61e0516a ==============================
[0m01:39:11.784965 [info ] [MainThread]: Running with dbt=1.8.6
[0m01:39:11.785452 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/eranola/.dbt', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'debug': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:39:11.961390 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m01:39:11.961844 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m01:39:12.098568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab580ae5-c830-47f3-a2ae-63ed61e0516a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ccf200>]}
[0m01:39:12.136873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab580ae5-c830-47f3-a2ae-63ed61e0516a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a6330>]}
[0m01:39:12.138125 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m01:39:12.155077 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m01:39:12.264793 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:39:12.265203 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:39:12.283832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab580ae5-c830-47f3-a2ae-63ed61e0516a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d47ad0>]}
[0m01:39:12.338250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab580ae5-c830-47f3-a2ae-63ed61e0516a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106092cf0>]}
[0m01:39:12.339764 [info ] [MainThread]: Found 1 model, 488 macros
[0m01:39:12.340297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab580ae5-c830-47f3-a2ae-63ed61e0516a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062767e0>]}
[0m01:39:12.341574 [info ] [MainThread]: 
[0m01:39:12.342001 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m01:39:12.342635 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m01:39:12.356295 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m01:39:12.356711 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m01:39:12.356982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:39:12.360182 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:39:12.360927 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:39:13.120508 [debug] [ThreadPool]: SQL status: SUCCESS in 0.763 seconds
[0m01:39:13.126359 [debug] [ThreadPool]: On list_dev: Close
[0m01:39:13.129830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public)
[0m01:39:13.140689 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m01:39:13.141337 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m01:39:13.141731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:39:13.142282 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:39:13.142742 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:39:13.690379 [debug] [ThreadPool]: SQL status: SUCCESS in 0.548 seconds
[0m01:39:13.692472 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m01:39:13.693669 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m01:39:13.810231 [debug] [ThreadPool]: SQL status: SUCCESS in 0.116 seconds
[0m01:39:13.814907 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m01:39:13.920205 [debug] [ThreadPool]: On list_dev_public: Close
[0m01:39:13.939625 [debug] [MainThread]: Using redshift connection "master"
[0m01:39:13.940375 [debug] [MainThread]: On master: BEGIN
[0m01:39:13.940848 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:39:13.941470 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:39:13.941934 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:39:14.532292 [debug] [MainThread]: SQL status: SUCCESS in 0.591 seconds
[0m01:39:14.534377 [debug] [MainThread]: Using redshift connection "master"
[0m01:39:14.535663 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m01:39:14.699917 [debug] [MainThread]: SQL status: SUCCESS in 0.163 seconds
[0m01:39:14.703881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab580ae5-c830-47f3-a2ae-63ed61e0516a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c8be90>]}
[0m01:39:14.704842 [debug] [MainThread]: On master: ROLLBACK
[0m01:39:14.820409 [debug] [MainThread]: Using redshift connection "master"
[0m01:39:14.821670 [debug] [MainThread]: On master: BEGIN
[0m01:39:14.880329 [debug] [MainThread]: SQL status: SUCCESS in 0.058 seconds
[0m01:39:14.882090 [debug] [MainThread]: On master: COMMIT
[0m01:39:14.883360 [debug] [MainThread]: Using redshift connection "master"
[0m01:39:14.884098 [debug] [MainThread]: On master: COMMIT
[0m01:39:15.000702 [debug] [MainThread]: SQL status: SUCCESS in 0.116 seconds
[0m01:39:15.002588 [debug] [MainThread]: On master: Close
[0m01:39:15.004636 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:39:15.005317 [info ] [MainThread]: 
[0m01:39:15.010843 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_orders
[0m01:39:15.012650 [info ] [Thread-1 (]: 1 of 1 START sql table model public.stg_orders ................................. [RUN]
[0m01:39:15.013532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.olist_dbt.stg_orders)
[0m01:39:15.014371 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_orders
[0m01:39:15.019005 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_orders"
[0m01:39:15.020588 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_orders
[0m01:39:15.068907 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_orders"
[0m01:39:15.071196 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:39:15.071560 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m01:39:15.071852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:39:15.072243 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:39:15.072538 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:39:15.680389 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.608 seconds
[0m01:39:15.682572 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:39:15.683515 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */

  
    

  create  table
    "dev"."public"."stg_orders__dbt_tmp"
    
    
    
  as (
    


SELECT
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
FROM "order"
  );
[0m01:39:16.274533 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.590 seconds
[0m01:39:16.290558 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:39:16.291462 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m01:39:16.660102 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.367 seconds
[0m01:39:16.670987 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:39:16.671857 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m01:39:16.880400 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.207 seconds
[0m01:39:16.918957 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m01:39:16.919757 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:39:16.920171 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m01:39:17.079957 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.159 seconds
[0m01:39:17.082623 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:39:17.083358 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m01:39:17.210306 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.126 seconds
[0m01:39:17.228030 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."stg_orders__dbt_backup"
[0m01:39:17.236808 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:39:17.237425 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
drop table if exists "dev"."public"."stg_orders__dbt_backup" cascade
[0m01:39:17.359950 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.121 seconds
[0m01:39:17.364402 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m01:39:17.365482 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:39:17.366245 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m01:39:17.490015 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.122 seconds
[0m01:39:17.492638 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:39:17.493704 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m01:39:17.565269 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.070 seconds
[0m01:39:17.571443 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: ROLLBACK
[0m01:39:17.700059 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: Close
[0m01:39:17.705901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab580ae5-c830-47f3-a2ae-63ed61e0516a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f1c920>]}
[0m01:39:17.707581 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.stg_orders ............................ [[32mSUCCESS[0m in 2.69s]
[0m01:39:17.709162 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_orders
[0m01:39:17.711072 [debug] [MainThread]: Using redshift connection "master"
[0m01:39:17.711686 [debug] [MainThread]: On master: BEGIN
[0m01:39:17.712155 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:39:17.713017 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:39:17.713705 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:39:18.349271 [debug] [MainThread]: SQL status: SUCCESS in 0.637 seconds
[0m01:39:18.351233 [debug] [MainThread]: On master: COMMIT
[0m01:39:18.352330 [debug] [MainThread]: Using redshift connection "master"
[0m01:39:18.353034 [debug] [MainThread]: On master: COMMIT
[0m01:39:18.480541 [debug] [MainThread]: SQL status: SUCCESS in 0.126 seconds
[0m01:39:18.482404 [debug] [MainThread]: On master: Close
[0m01:39:18.483992 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:39:18.484605 [debug] [MainThread]: Connection 'model.olist_dbt.stg_orders' was properly closed.
[0m01:39:18.485300 [info ] [MainThread]: 
[0m01:39:18.486507 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.14 seconds (6.14s).
[0m01:39:18.488219 [debug] [MainThread]: Command end result
[0m01:39:18.526645 [info ] [MainThread]: 
[0m01:39:18.527136 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:39:18.527436 [info ] [MainThread]: 
[0m01:39:18.527727 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:39:18.530222 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.803372, "process_user_time": 1.875938, "process_kernel_time": 0.410579, "process_mem_max_rss": "121749504", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:39:18.530741 [debug] [MainThread]: Command `dbt run` succeeded at 01:39:18.530665 after 6.80 seconds
[0m01:39:18.531089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104603a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fc42f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101052d20>]}
[0m01:39:18.531382 [debug] [MainThread]: Flushing usage events
[0m01:49:52.332467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054eac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f57fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f57e60>]}


============================== 01:49:52.337217 | 58189550-a76f-4e49-ab90-f2c8068dfe8e ==============================
[0m01:49:52.337217 [info ] [MainThread]: Running with dbt=1.8.6
[0m01:49:52.337737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_orders.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:49:52.516720 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m01:49:52.517136 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m01:49:52.656787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58189550-a76f-4e49-ab90-f2c8068dfe8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f7c290>]}
[0m01:49:52.694224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58189550-a76f-4e49-ab90-f2c8068dfe8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f55fa0>]}
[0m01:49:52.695341 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m01:49:52.711829 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m01:49:52.824025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:49:52.824402 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:49:52.842273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58189550-a76f-4e49-ab90-f2c8068dfe8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a71940>]}
[0m01:49:52.897213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58189550-a76f-4e49-ab90-f2c8068dfe8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f9f050>]}
[0m01:49:52.897622 [info ] [MainThread]: Found 1 model, 488 macros
[0m01:49:52.898105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58189550-a76f-4e49-ab90-f2c8068dfe8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061888c0>]}
[0m01:49:52.899340 [info ] [MainThread]: 
[0m01:49:52.899781 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m01:49:52.900422 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m01:49:52.914232 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m01:49:52.914651 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m01:49:52.914907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:49:52.918301 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:49:52.919218 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:49:53.672800 [debug] [ThreadPool]: SQL status: SUCCESS in 0.757 seconds
[0m01:49:53.678912 [debug] [ThreadPool]: On list_dev: Close
[0m01:49:53.681606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public)
[0m01:49:53.691488 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m01:49:53.692027 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m01:49:53.692393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:49:53.692928 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:49:53.693314 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:49:54.373134 [debug] [ThreadPool]: SQL status: SUCCESS in 0.680 seconds
[0m01:49:54.374923 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m01:49:54.375986 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m01:49:54.502586 [debug] [ThreadPool]: SQL status: SUCCESS in 0.125 seconds
[0m01:49:54.508490 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m01:49:54.633536 [debug] [ThreadPool]: On list_dev_public: Close
[0m01:49:54.652197 [debug] [MainThread]: Using redshift connection "master"
[0m01:49:54.652845 [debug] [MainThread]: On master: BEGIN
[0m01:49:54.653283 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:49:54.653911 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:49:54.654337 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:49:55.202862 [debug] [MainThread]: SQL status: SUCCESS in 0.549 seconds
[0m01:49:55.204724 [debug] [MainThread]: Using redshift connection "master"
[0m01:49:55.205980 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m01:49:55.372507 [debug] [MainThread]: SQL status: SUCCESS in 0.165 seconds
[0m01:49:55.375462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58189550-a76f-4e49-ab90-f2c8068dfe8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c3500>]}
[0m01:49:55.376209 [debug] [MainThread]: On master: ROLLBACK
[0m01:49:55.502669 [debug] [MainThread]: Using redshift connection "master"
[0m01:49:55.503941 [debug] [MainThread]: On master: BEGIN
[0m01:49:55.562772 [debug] [MainThread]: SQL status: SUCCESS in 0.058 seconds
[0m01:49:55.563974 [debug] [MainThread]: On master: COMMIT
[0m01:49:55.564879 [debug] [MainThread]: Using redshift connection "master"
[0m01:49:55.565513 [debug] [MainThread]: On master: COMMIT
[0m01:49:55.682419 [debug] [MainThread]: SQL status: SUCCESS in 0.116 seconds
[0m01:49:55.683774 [debug] [MainThread]: On master: Close
[0m01:49:55.685262 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:49:55.686001 [info ] [MainThread]: 
[0m01:49:55.689674 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_orders
[0m01:49:55.690538 [info ] [Thread-1 (]: 1 of 1 START sql table model public.stg_orders ................................. [RUN]
[0m01:49:55.691168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.olist_dbt.stg_orders)
[0m01:49:55.691622 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_orders
[0m01:49:55.694130 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_orders"
[0m01:49:55.695300 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_orders
[0m01:49:55.740299 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_orders"
[0m01:49:55.742534 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:49:55.742871 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m01:49:55.743132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:49:55.743632 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:49:55.743954 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:49:56.412575 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.669 seconds
[0m01:49:56.413862 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:49:56.414382 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */

  
    

  create  table
    "dev"."public"."stg_orders__dbt_tmp"
    
    
    
  as (
    


SELECT
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
FROM "order"
  );
[0m01:49:56.796107 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.381 seconds
[0m01:49:56.812927 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:49:56.813747 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m01:49:57.192527 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.378 seconds
[0m01:49:57.201652 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:49:57.202218 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m01:49:57.382196 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.179 seconds
[0m01:49:57.409829 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m01:49:57.410370 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:49:57.410701 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m01:49:57.591981 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.181 seconds
[0m01:49:57.593083 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:49:57.593592 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m01:49:57.714723 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.120 seconds
[0m01:49:57.724250 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."stg_orders__dbt_backup"
[0m01:49:57.728482 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:49:57.728820 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
drop table if exists "dev"."public"."stg_orders__dbt_backup" cascade
[0m01:49:57.853416 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.123 seconds
[0m01:49:57.862142 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m01:49:57.865549 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:49:57.866001 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m01:49:57.962146 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.095 seconds
[0m01:49:57.964010 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m01:49:57.965129 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m01:49:58.032459 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.066 seconds
[0m01:49:58.038460 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: ROLLBACK
[0m01:49:58.192014 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: Close
[0m01:49:58.194067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58189550-a76f-4e49-ab90-f2c8068dfe8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ae570>]}
[0m01:49:58.194765 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.stg_orders ............................ [[32mSUCCESS[0m in 2.50s]
[0m01:49:58.195403 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_orders
[0m01:49:58.196699 [debug] [MainThread]: Using redshift connection "master"
[0m01:49:58.197101 [debug] [MainThread]: On master: BEGIN
[0m01:49:58.197441 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:49:58.197924 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:49:58.198252 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:49:58.862277 [debug] [MainThread]: SQL status: SUCCESS in 0.664 seconds
[0m01:49:58.864180 [debug] [MainThread]: On master: COMMIT
[0m01:49:58.865573 [debug] [MainThread]: Using redshift connection "master"
[0m01:49:58.866577 [debug] [MainThread]: On master: COMMIT
[0m01:49:58.992294 [debug] [MainThread]: SQL status: SUCCESS in 0.124 seconds
[0m01:49:58.994124 [debug] [MainThread]: On master: Close
[0m01:49:58.996080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:49:58.997027 [debug] [MainThread]: Connection 'model.olist_dbt.stg_orders' was properly closed.
[0m01:49:58.998078 [info ] [MainThread]: 
[0m01:49:58.999100 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.10 seconds (6.10s).
[0m01:49:59.000746 [debug] [MainThread]: Command end result
[0m01:49:59.042049 [info ] [MainThread]: 
[0m01:49:59.042607 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:49:59.042911 [info ] [MainThread]: 
[0m01:49:59.043205 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:49:59.046385 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.7694435, "process_user_time": 1.817766, "process_kernel_time": 0.419104, "process_mem_max_rss": "121290752", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:49:59.047019 [debug] [MainThread]: Command `dbt run` succeeded at 01:49:59.046931 after 6.77 seconds
[0m01:49:59.047401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10591cf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055262a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b75760>]}
[0m01:49:59.047747 [debug] [MainThread]: Flushing usage events
[0m15:09:33.146951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105418830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d38a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d38980>]}


============================== 15:09:33.155631 | b5cf3539-7c43-4b7f-949c-217aafc8481e ==============================
[0m15:09:33.155631 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:09:33.156586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_orders.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:09:33.358793 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:09:33.359227 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:09:33.771083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5cf3539-7c43-4b7f-949c-217aafc8481e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eaf350>]}
[0m15:09:33.808740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5cf3539-7c43-4b7f-949c-217aafc8481e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047b14f0>]}
[0m15:09:33.810318 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m15:09:33.866193 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:09:33.912704 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:09:33.913165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b5cf3539-7c43-4b7f-949c-217aafc8481e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10541a270>]}
[0m15:09:34.702589 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.olist_dbt.marts.staging
[0m15:09:34.706605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5cf3539-7c43-4b7f-949c-217aafc8481e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee8980>]}
[0m15:09:34.793782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5cf3539-7c43-4b7f-949c-217aafc8481e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10599ede0>]}
[0m15:09:34.794234 [info ] [MainThread]: Found 1 model, 488 macros
[0m15:09:34.794534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5cf3539-7c43-4b7f-949c-217aafc8481e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a58470>]}
[0m15:09:34.795704 [info ] [MainThread]: 
[0m15:09:34.796130 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:09:34.796806 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m15:09:34.809902 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m15:09:34.810337 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m15:09:34.810591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:34.813623 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:09:34.814349 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:09:35.565271 [debug] [ThreadPool]: SQL status: SUCCESS in 0.754 seconds
[0m15:09:35.568437 [debug] [ThreadPool]: On list_dev: Close
[0m15:09:35.570398 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public)
[0m15:09:35.580686 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:09:35.581163 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m15:09:35.581523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:35.582107 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:09:35.582476 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:09:36.041657 [debug] [ThreadPool]: SQL status: SUCCESS in 0.460 seconds
[0m15:09:36.043757 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:09:36.044899 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m15:09:36.146935 [debug] [ThreadPool]: SQL status: SUCCESS in 0.101 seconds
[0m15:09:36.151491 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m15:09:36.234121 [debug] [ThreadPool]: On list_dev_public: Close
[0m15:09:36.251727 [debug] [MainThread]: Using redshift connection "master"
[0m15:09:36.252492 [debug] [MainThread]: On master: BEGIN
[0m15:09:36.252913 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:09:36.253573 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:09:36.254020 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:09:36.808330 [debug] [MainThread]: SQL status: SUCCESS in 0.555 seconds
[0m15:09:36.810093 [debug] [MainThread]: Using redshift connection "master"
[0m15:09:36.811236 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:09:36.973258 [debug] [MainThread]: SQL status: SUCCESS in 0.160 seconds
[0m15:09:36.979913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5cf3539-7c43-4b7f-949c-217aafc8481e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10599ede0>]}
[0m15:09:36.981354 [debug] [MainThread]: On master: ROLLBACK
[0m15:09:37.079337 [debug] [MainThread]: Using redshift connection "master"
[0m15:09:37.080600 [debug] [MainThread]: On master: BEGIN
[0m15:09:37.129208 [debug] [MainThread]: SQL status: SUCCESS in 0.048 seconds
[0m15:09:37.130219 [debug] [MainThread]: On master: COMMIT
[0m15:09:37.131279 [debug] [MainThread]: Using redshift connection "master"
[0m15:09:37.132132 [debug] [MainThread]: On master: COMMIT
[0m15:09:37.229240 [debug] [MainThread]: SQL status: SUCCESS in 0.096 seconds
[0m15:09:37.230823 [debug] [MainThread]: On master: Close
[0m15:09:37.232685 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:09:37.233549 [info ] [MainThread]: 
[0m15:09:37.239872 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_orders
[0m15:09:37.240647 [info ] [Thread-1 (]: 1 of 1 START sql table model public.stg_orders ................................. [RUN]
[0m15:09:37.241509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.olist_dbt.stg_orders)
[0m15:09:37.242094 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_orders
[0m15:09:37.246575 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_orders"
[0m15:09:37.248466 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_orders
[0m15:09:37.299614 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_orders"
[0m15:09:37.301642 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:09:37.301944 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:09:37.302199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:37.302567 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:09:37.302832 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:09:37.924905 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.622 seconds
[0m15:09:37.927130 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:09:37.928325 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */

  
    

  create  table
    "dev"."public"."stg_orders__dbt_tmp"
    
    
    
  as (
    


SELECT
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
FROM "order"
  );
[0m15:09:38.366647 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.437 seconds
[0m15:09:38.385433 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:09:38.386189 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m15:09:38.725673 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.339 seconds
[0m15:09:38.737510 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:09:38.738236 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m15:09:38.910966 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.172 seconds
[0m15:09:38.944800 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:09:38.945390 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:09:38.945750 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:09:39.141890 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.195 seconds
[0m15:09:39.143865 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:09:39.144878 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:09:39.261271 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.115 seconds
[0m15:09:39.274103 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."stg_orders__dbt_backup"
[0m15:09:39.281206 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:09:39.281673 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
drop table if exists "dev"."public"."stg_orders__dbt_backup" cascade
[0m15:09:39.397757 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.115 seconds
[0m15:09:39.401672 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:09:39.402989 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:09:39.404020 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:09:39.496729 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.092 seconds
[0m15:09:39.498052 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:09:39.499043 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:09:39.557385 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.057 seconds
[0m15:09:39.563622 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: ROLLBACK
[0m15:09:39.682317 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: Close
[0m15:09:39.688324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5cf3539-7c43-4b7f-949c-217aafc8481e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104744b60>]}
[0m15:09:39.689995 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.stg_orders ............................ [[32mSUCCESS[0m in 2.44s]
[0m15:09:39.691642 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_orders
[0m15:09:39.693935 [debug] [MainThread]: Using redshift connection "master"
[0m15:09:39.694536 [debug] [MainThread]: On master: BEGIN
[0m15:09:39.694973 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:09:39.695620 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:09:39.696090 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:09:40.332787 [debug] [MainThread]: SQL status: SUCCESS in 0.637 seconds
[0m15:09:40.334724 [debug] [MainThread]: On master: COMMIT
[0m15:09:40.336194 [debug] [MainThread]: Using redshift connection "master"
[0m15:09:40.337125 [debug] [MainThread]: On master: COMMIT
[0m15:09:40.451562 [debug] [MainThread]: SQL status: SUCCESS in 0.114 seconds
[0m15:09:40.452061 [debug] [MainThread]: On master: Close
[0m15:09:40.452650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:40.452923 [debug] [MainThread]: Connection 'model.olist_dbt.stg_orders' was properly closed.
[0m15:09:40.453206 [info ] [MainThread]: 
[0m15:09:40.453484 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.66 seconds (5.66s).
[0m15:09:40.454032 [debug] [MainThread]: Command end result
[0m15:09:40.481975 [info ] [MainThread]: 
[0m15:09:40.482388 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:09:40.482645 [info ] [MainThread]: 
[0m15:09:40.482893 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:09:40.527150 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.8341866, "process_user_time": 2.64309, "process_kernel_time": 0.487518, "process_mem_max_rss": "122830848", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:09:40.527727 [debug] [MainThread]: Command `dbt run` succeeded at 15:09:40.527650 after 7.83 seconds
[0m15:09:40.528034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058ca0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f5a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10287ecf0>]}
[0m15:09:40.528316 [debug] [MainThread]: Flushing usage events
[0m15:12:08.801843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037cecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106528950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106528860>]}


============================== 15:12:08.806234 | bc712a12-4d9a-439e-8f6c-f0546fb7d306 ==============================
[0m15:12:08.806234 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:12:08.806720 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:12:08.988294 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:12:08.988740 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:12:09.120554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc712a12-4d9a-439e-8f6c-f0546fb7d306', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11823fbc0>]}
[0m15:12:09.158305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc712a12-4d9a-439e-8f6c-f0546fb7d306', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1183a48c0>]}
[0m15:12:09.160119 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m15:12:09.178509 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:12:09.281194 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:12:09.281587 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:12:09.285524 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.olist_dbt.marts.staging
[0m15:12:09.300428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc712a12-4d9a-439e-8f6c-f0546fb7d306', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11824acf0>]}
[0m15:12:09.354271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc712a12-4d9a-439e-8f6c-f0546fb7d306', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118e670b0>]}
[0m15:12:09.354895 [info ] [MainThread]: Found 1 model, 488 macros
[0m15:12:09.355181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc712a12-4d9a-439e-8f6c-f0546fb7d306', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118356660>]}
[0m15:12:09.356425 [info ] [MainThread]: 
[0m15:12:09.356895 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:12:09.357572 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m15:12:09.371820 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m15:12:09.372233 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m15:12:09.372490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:09.375893 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:12:09.376713 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:12:10.038378 [debug] [ThreadPool]: SQL status: SUCCESS in 0.665 seconds
[0m15:12:10.043773 [debug] [ThreadPool]: On list_dev: Close
[0m15:12:10.047848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public)
[0m15:12:10.059079 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:12:10.059640 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m15:12:10.060006 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:10.060576 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:12:10.060952 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:12:10.615835 [debug] [ThreadPool]: SQL status: SUCCESS in 0.555 seconds
[0m15:12:10.617689 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:12:10.618880 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m15:12:10.740815 [debug] [ThreadPool]: SQL status: SUCCESS in 0.121 seconds
[0m15:12:10.746566 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m15:12:10.844709 [debug] [ThreadPool]: On list_dev_public: Close
[0m15:12:10.867701 [debug] [MainThread]: Using redshift connection "master"
[0m15:12:10.868341 [debug] [MainThread]: On master: BEGIN
[0m15:12:10.868714 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:12:10.869244 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:12:10.869622 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:12:11.443290 [debug] [MainThread]: SQL status: SUCCESS in 0.574 seconds
[0m15:12:11.445374 [debug] [MainThread]: Using redshift connection "master"
[0m15:12:11.446637 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:12:11.620220 [debug] [MainThread]: SQL status: SUCCESS in 0.172 seconds
[0m15:12:11.625931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc712a12-4d9a-439e-8f6c-f0546fb7d306', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f9a5d0>]}
[0m15:12:11.627007 [debug] [MainThread]: On master: ROLLBACK
[0m15:12:11.729227 [debug] [MainThread]: Using redshift connection "master"
[0m15:12:11.730779 [debug] [MainThread]: On master: BEGIN
[0m15:12:11.785118 [debug] [MainThread]: SQL status: SUCCESS in 0.053 seconds
[0m15:12:11.786570 [debug] [MainThread]: On master: COMMIT
[0m15:12:11.787835 [debug] [MainThread]: Using redshift connection "master"
[0m15:12:11.788789 [debug] [MainThread]: On master: COMMIT
[0m15:12:11.889082 [debug] [MainThread]: SQL status: SUCCESS in 0.099 seconds
[0m15:12:11.890897 [debug] [MainThread]: On master: Close
[0m15:12:11.892570 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:12:11.893321 [info ] [MainThread]: 
[0m15:12:11.898628 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_orders
[0m15:12:11.899650 [info ] [Thread-1 (]: 1 of 1 START sql table model public.stg_orders ................................. [RUN]
[0m15:12:11.900444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.olist_dbt.stg_orders)
[0m15:12:11.901115 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_orders
[0m15:12:11.905919 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_orders"
[0m15:12:11.908463 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_orders
[0m15:12:11.954677 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_orders"
[0m15:12:11.956683 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:12:11.957023 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:12:11.957286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:11.957727 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:12:11.958024 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:12:12.528508 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.571 seconds
[0m15:12:12.529190 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:12:12.529628 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */

  
    

  create  table
    "dev"."public"."stg_orders__dbt_tmp"
    
    
    
  as (
    


SELECT
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
FROM "order"
  );
[0m15:12:12.879196 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.348 seconds
[0m15:12:12.893803 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:12:12.894625 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m15:12:13.201540 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.306 seconds
[0m15:12:13.206677 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:12:13.207263 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m15:12:13.354220 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.146 seconds
[0m15:12:13.387900 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:12:13.388599 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:12:13.388992 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:12:13.526591 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.137 seconds
[0m15:12:13.528305 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:12:13.528940 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:12:13.626728 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.097 seconds
[0m15:12:13.639205 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."stg_orders__dbt_backup"
[0m15:12:13.646914 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:12:13.647444 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
drop table if exists "dev"."public"."stg_orders__dbt_backup" cascade
[0m15:12:13.746090 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.098 seconds
[0m15:12:13.748270 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:12:13.749364 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:12:13.749832 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:12:13.833791 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.083 seconds
[0m15:12:13.834688 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:12:13.835232 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:12:13.887796 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.052 seconds
[0m15:12:13.893404 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: ROLLBACK
[0m15:12:13.993402 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: Close
[0m15:12:13.995499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc712a12-4d9a-439e-8f6c-f0546fb7d306', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118d1ba70>]}
[0m15:12:13.996195 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.stg_orders ............................ [[32mSUCCESS[0m in 2.09s]
[0m15:12:13.996819 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_orders
[0m15:12:13.998031 [debug] [MainThread]: Using redshift connection "master"
[0m15:12:13.998440 [debug] [MainThread]: On master: BEGIN
[0m15:12:13.998753 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:12:13.999215 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:12:13.999542 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:12:14.453458 [debug] [MainThread]: SQL status: SUCCESS in 0.454 seconds
[0m15:12:14.455428 [debug] [MainThread]: On master: COMMIT
[0m15:12:14.456822 [debug] [MainThread]: Using redshift connection "master"
[0m15:12:14.457504 [debug] [MainThread]: On master: COMMIT
[0m15:12:14.537196 [debug] [MainThread]: SQL status: SUCCESS in 0.079 seconds
[0m15:12:14.538122 [debug] [MainThread]: On master: Close
[0m15:12:14.539076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:12:14.539547 [debug] [MainThread]: Connection 'model.olist_dbt.stg_orders' was properly closed.
[0m15:12:14.540053 [info ] [MainThread]: 
[0m15:12:14.540641 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.18 seconds (5.18s).
[0m15:12:14.542714 [debug] [MainThread]: Command end result
[0m15:12:14.581345 [info ] [MainThread]: 
[0m15:12:14.581850 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:12:14.582150 [info ] [MainThread]: 
[0m15:12:14.582433 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:12:14.585126 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.836436, "process_user_time": 1.842652, "process_kernel_time": 0.400803, "process_mem_max_rss": "120930304", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:12:14.585706 [debug] [MainThread]: Command `dbt run` succeeded at 15:12:14.585619 after 5.84 seconds
[0m15:12:14.586067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a6180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119aa0b60>]}
[0m15:12:14.586399 [debug] [MainThread]: Flushing usage events
[0m15:38:39.441104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105312180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b1ca70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cfcbc0>]}


============================== 15:38:39.445836 | bc5aabce-e3c9-4139-8db2-de84cccaee36 ==============================
[0m15:38:39.445836 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:38:39.446344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'profiles_dir': '/Users/eranola/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:38:39.621389 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:38:39.621802 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:38:39.758344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc5aabce-e3c9-4139-8db2-de84cccaee36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104709a60>]}
[0m15:38:39.795739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc5aabce-e3c9-4139-8db2-de84cccaee36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e72510>]}
[0m15:38:39.797552 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m15:38:39.815259 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:38:39.861559 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:38:39.862009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bc5aabce-e3c9-4139-8db2-de84cccaee36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106504290>]}
[0m15:38:40.647503 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.olist_dbt.marts.staging
[0m15:38:40.651456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc5aabce-e3c9-4139-8db2-de84cccaee36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f166c0>]}
[0m15:38:40.739012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc5aabce-e3c9-4139-8db2-de84cccaee36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f83110>]}
[0m15:38:40.739464 [info ] [MainThread]: Found 1 model, 488 macros
[0m15:38:40.739760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc5aabce-e3c9-4139-8db2-de84cccaee36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10638c6b0>]}
[0m15:38:40.741021 [info ] [MainThread]: 
[0m15:38:40.741448 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:38:40.742103 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m15:38:40.755026 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m15:38:40.755443 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m15:38:40.755693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:40.758823 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:38:40.759555 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:38:41.554739 [debug] [ThreadPool]: SQL status: SUCCESS in 0.798 seconds
[0m15:38:41.557919 [debug] [ThreadPool]: On list_dev: Close
[0m15:38:41.559937 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public)
[0m15:38:41.571293 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:38:41.571910 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m15:38:41.572338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:41.572935 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:38:41.573304 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:38:42.100755 [debug] [ThreadPool]: SQL status: SUCCESS in 0.528 seconds
[0m15:38:42.102409 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:38:42.103231 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m15:38:42.252553 [debug] [ThreadPool]: SQL status: SUCCESS in 0.148 seconds
[0m15:38:42.257535 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m15:38:42.354231 [debug] [ThreadPool]: On list_dev_public: Close
[0m15:38:42.372402 [debug] [MainThread]: Using redshift connection "master"
[0m15:38:42.373096 [debug] [MainThread]: On master: BEGIN
[0m15:38:42.373552 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:38:42.374160 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:38:42.374528 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:38:42.922679 [debug] [MainThread]: SQL status: SUCCESS in 0.548 seconds
[0m15:38:42.924447 [debug] [MainThread]: Using redshift connection "master"
[0m15:38:42.925670 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:38:43.087468 [debug] [MainThread]: SQL status: SUCCESS in 0.160 seconds
[0m15:38:43.092164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc5aabce-e3c9-4139-8db2-de84cccaee36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d45520>]}
[0m15:38:43.093475 [debug] [MainThread]: On master: ROLLBACK
[0m15:38:43.179573 [debug] [MainThread]: Using redshift connection "master"
[0m15:38:43.181255 [debug] [MainThread]: On master: BEGIN
[0m15:38:43.234757 [debug] [MainThread]: SQL status: SUCCESS in 0.052 seconds
[0m15:38:43.235807 [debug] [MainThread]: On master: COMMIT
[0m15:38:43.236575 [debug] [MainThread]: Using redshift connection "master"
[0m15:38:43.237057 [debug] [MainThread]: On master: COMMIT
[0m15:38:43.320259 [debug] [MainThread]: SQL status: SUCCESS in 0.082 seconds
[0m15:38:43.322215 [debug] [MainThread]: On master: Close
[0m15:38:43.324219 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:38:43.325325 [info ] [MainThread]: 
[0m15:38:43.332402 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_orders
[0m15:38:43.333584 [info ] [Thread-1 (]: 1 of 1 START sql table model public.stg_orders ................................. [RUN]
[0m15:38:43.334877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.olist_dbt.stg_orders)
[0m15:38:43.335901 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_orders
[0m15:38:43.340227 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_orders"
[0m15:38:43.341801 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_orders
[0m15:38:43.395016 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_orders"
[0m15:38:43.396959 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:38:43.397296 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:38:43.397561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:43.397935 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:38:43.398205 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:38:43.908463 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.510 seconds
[0m15:38:43.910374 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:38:43.911569 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */

  
    

  create  table
    "dev"."public"."stg_orders__dbt_tmp"
    
    
    
  as (
    


SELECT
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
FROM "order"
  );
[0m15:38:44.332589 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.420 seconds
[0m15:38:44.340838 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:38:44.341321 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m15:38:44.594380 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.252 seconds
[0m15:38:44.597646 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:38:44.598010 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m15:38:44.721220 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.122 seconds
[0m15:38:44.752169 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:38:44.752810 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:38:44.753179 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:38:44.880536 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.127 seconds
[0m15:38:44.882624 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:38:44.883426 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:38:44.966782 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.082 seconds
[0m15:38:44.980616 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."stg_orders__dbt_backup"
[0m15:38:44.988389 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:38:44.988892 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
drop table if exists "dev"."public"."stg_orders__dbt_backup" cascade
[0m15:38:45.071993 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.082 seconds
[0m15:38:45.075913 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:38:45.077298 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:38:45.078372 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:38:45.158009 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.078 seconds
[0m15:38:45.160028 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:38:45.161133 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:38:45.203739 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.041 seconds
[0m15:38:45.209929 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: ROLLBACK
[0m15:38:45.293853 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: Close
[0m15:38:45.298670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc5aabce-e3c9-4139-8db2-de84cccaee36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104708c50>]}
[0m15:38:45.300017 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.stg_orders ............................ [[32mSUCCESS[0m in 1.96s]
[0m15:38:45.301424 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_orders
[0m15:38:45.303335 [debug] [MainThread]: Using redshift connection "master"
[0m15:38:45.303842 [debug] [MainThread]: On master: BEGIN
[0m15:38:45.304257 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:38:45.304887 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:38:45.305352 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:38:45.943146 [debug] [MainThread]: SQL status: SUCCESS in 0.638 seconds
[0m15:38:45.944592 [debug] [MainThread]: On master: COMMIT
[0m15:38:45.945667 [debug] [MainThread]: Using redshift connection "master"
[0m15:38:45.946354 [debug] [MainThread]: On master: COMMIT
[0m15:38:46.064660 [debug] [MainThread]: SQL status: SUCCESS in 0.117 seconds
[0m15:38:46.066679 [debug] [MainThread]: On master: Close
[0m15:38:46.068498 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:38:46.069497 [debug] [MainThread]: Connection 'model.olist_dbt.stg_orders' was properly closed.
[0m15:38:46.070496 [info ] [MainThread]: 
[0m15:38:46.071532 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.33 seconds (5.33s).
[0m15:38:46.072944 [debug] [MainThread]: Command end result
[0m15:38:46.112973 [info ] [MainThread]: 
[0m15:38:46.113529 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:38:46.113824 [info ] [MainThread]: 
[0m15:38:46.114122 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:38:46.116913 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.723036, "process_user_time": 2.631687, "process_kernel_time": 0.378179, "process_mem_max_rss": "122814464", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:38:46.117518 [debug] [MainThread]: Command `dbt run` succeeded at 15:38:46.117429 after 6.72 seconds
[0m15:38:46.117912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069673e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105987560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071a70e0>]}
[0m15:38:46.118252 [debug] [MainThread]: Flushing usage events
[0m15:39:54.264972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cfc530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108763b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108763f50>]}


============================== 15:39:54.269303 | a2704cef-6d51-4081-ae18-dcfeab00ad88 ==============================
[0m15:39:54.269303 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:39:54.269854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:39:54.446056 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:39:54.446482 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:39:54.583533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2704cef-6d51-4081-ae18-dcfeab00ad88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107021a90>]}
[0m15:39:54.620805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2704cef-6d51-4081-ae18-dcfeab00ad88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073689e0>]}
[0m15:39:54.621873 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m15:39:54.638723 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:39:54.744934 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:39:54.745314 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:39:54.749253 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.olist_dbt.marts.staging
[0m15:39:54.764363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2704cef-6d51-4081-ae18-dcfeab00ad88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dcd790>]}
[0m15:39:54.818643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2704cef-6d51-4081-ae18-dcfeab00ad88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10987f5f0>]}
[0m15:39:54.819288 [info ] [MainThread]: Found 1 model, 488 macros
[0m15:39:54.819583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2704cef-6d51-4081-ae18-dcfeab00ad88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098827b0>]}
[0m15:39:54.820822 [info ] [MainThread]: 
[0m15:39:54.821260 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:39:54.821918 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m15:39:54.835974 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m15:39:54.836370 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m15:39:54.836619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:54.839843 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:39:54.840578 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:39:55.502974 [debug] [ThreadPool]: SQL status: SUCCESS in 0.666 seconds
[0m15:39:55.508507 [debug] [ThreadPool]: On list_dev: Close
[0m15:39:55.511397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public)
[0m15:39:55.522918 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:39:55.523534 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m15:39:55.523905 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:39:55.524472 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:39:55.524830 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:39:56.166497 [debug] [ThreadPool]: SQL status: SUCCESS in 0.642 seconds
[0m15:39:56.168103 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:39:56.168867 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m15:39:56.307778 [debug] [ThreadPool]: SQL status: SUCCESS in 0.138 seconds
[0m15:39:56.312631 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m15:39:56.426466 [debug] [ThreadPool]: On list_dev_public: Close
[0m15:39:56.449979 [debug] [MainThread]: Using redshift connection "master"
[0m15:39:56.450646 [debug] [MainThread]: On master: BEGIN
[0m15:39:56.451010 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:39:56.451551 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:39:56.451937 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:39:57.002574 [debug] [MainThread]: SQL status: SUCCESS in 0.551 seconds
[0m15:39:57.003915 [debug] [MainThread]: Using redshift connection "master"
[0m15:39:57.004588 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:39:57.166112 [debug] [MainThread]: SQL status: SUCCESS in 0.160 seconds
[0m15:39:57.171442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2704cef-6d51-4081-ae18-dcfeab00ad88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10879a840>]}
[0m15:39:57.172979 [debug] [MainThread]: On master: ROLLBACK
[0m15:39:57.272019 [debug] [MainThread]: Using redshift connection "master"
[0m15:39:57.273963 [debug] [MainThread]: On master: BEGIN
[0m15:39:57.323106 [debug] [MainThread]: SQL status: SUCCESS in 0.048 seconds
[0m15:39:57.325030 [debug] [MainThread]: On master: COMMIT
[0m15:39:57.326403 [debug] [MainThread]: Using redshift connection "master"
[0m15:39:57.327405 [debug] [MainThread]: On master: COMMIT
[0m15:39:57.424999 [debug] [MainThread]: SQL status: SUCCESS in 0.096 seconds
[0m15:39:57.426803 [debug] [MainThread]: On master: Close
[0m15:39:57.428926 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:39:57.429763 [info ] [MainThread]: 
[0m15:39:57.435612 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_orders
[0m15:39:57.436898 [info ] [Thread-1 (]: 1 of 1 START sql table model public.stg_orders ................................. [RUN]
[0m15:39:57.437911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.olist_dbt.stg_orders)
[0m15:39:57.438482 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_orders
[0m15:39:57.443402 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_orders"
[0m15:39:57.445238 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_orders
[0m15:39:57.493287 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_orders"
[0m15:39:57.495207 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:39:57.495524 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:39:57.495784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:57.496156 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:39:57.496428 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:39:58.039521 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.543 seconds
[0m15:39:58.040981 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:39:58.041657 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */

  
    

  create  table
    "dev"."public"."stg_orders__dbt_tmp"
    
    
    
  as (
    


SELECT
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
FROM "order"
  );
[0m15:39:58.484279 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.441 seconds
[0m15:39:58.498651 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:39:58.499415 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m15:39:58.816190 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.316 seconds
[0m15:39:58.844616 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:39:58.845189 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:39:58.845529 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:39:58.999636 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.153 seconds
[0m15:39:59.001626 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:39:59.002444 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:39:59.107079 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.104 seconds
[0m15:39:59.119170 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."stg_orders__dbt_backup"
[0m15:39:59.126431 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:39:59.126920 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
drop table if exists "dev"."public"."stg_orders__dbt_backup" cascade
[0m15:39:59.230102 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.102 seconds
[0m15:39:59.233929 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:39:59.235268 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:39:59.236321 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:39:59.296553 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.059 seconds
[0m15:39:59.298258 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:39:59.299351 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:39:59.350321 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.050 seconds
[0m15:39:59.356363 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: ROLLBACK
[0m15:39:59.464112 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: Close
[0m15:39:59.469424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2704cef-6d51-4081-ae18-dcfeab00ad88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10926e660>]}
[0m15:39:59.470830 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.stg_orders ............................ [[32mSUCCESS[0m in 2.03s]
[0m15:39:59.472281 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_orders
[0m15:39:59.474354 [debug] [MainThread]: Using redshift connection "master"
[0m15:39:59.474834 [debug] [MainThread]: On master: BEGIN
[0m15:39:59.475256 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:39:59.475906 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:39:59.476372 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:39:59.941404 [debug] [MainThread]: SQL status: SUCCESS in 0.466 seconds
[0m15:39:59.943442 [debug] [MainThread]: On master: COMMIT
[0m15:39:59.944829 [debug] [MainThread]: Using redshift connection "master"
[0m15:39:59.945872 [debug] [MainThread]: On master: COMMIT
[0m15:40:00.027374 [debug] [MainThread]: SQL status: SUCCESS in 0.080 seconds
[0m15:40:00.030042 [debug] [MainThread]: On master: Close
[0m15:40:00.031367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:40:00.032090 [debug] [MainThread]: Connection 'model.olist_dbt.stg_orders' was properly closed.
[0m15:40:00.032683 [info ] [MainThread]: 
[0m15:40:00.033300 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.21 seconds (5.21s).
[0m15:40:00.034423 [debug] [MainThread]: Command end result
[0m15:40:00.073376 [info ] [MainThread]: 
[0m15:40:00.073801 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:40:00.074064 [info ] [MainThread]: 
[0m15:40:00.074322 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:40:00.076779 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.8641615, "process_user_time": 1.846997, "process_kernel_time": 0.394463, "process_mem_max_rss": "121339904", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:40:00.077334 [debug] [MainThread]: Command `dbt run` succeeded at 15:40:00.077250 after 5.86 seconds
[0m15:40:00.077733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108279af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108833170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083dd940>]}
[0m15:40:00.078045 [debug] [MainThread]: Flushing usage events
[0m15:42:39.864496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d262d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107207f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107207f80>]}


============================== 15:42:39.868698 | c10ef118-0821-4ac1-a22e-2805a6cf9d45 ==============================
[0m15:42:39.868698 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:42:39.869181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:42:40.040282 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:42:40.040710 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:42:40.166276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c10ef118-0821-4ac1-a22e-2805a6cf9d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106276ff0>]}
[0m15:42:40.203727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c10ef118-0821-4ac1-a22e-2805a6cf9d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106537f20>]}
[0m15:42:40.205001 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m15:42:40.221770 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:42:40.268509 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:42:40.268992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c10ef118-0821-4ac1-a22e-2805a6cf9d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064c63c0>]}
[0m15:42:41.057976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c10ef118-0821-4ac1-a22e-2805a6cf9d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12287f500>]}
[0m15:42:41.142354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c10ef118-0821-4ac1-a22e-2805a6cf9d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120f9d640>]}
[0m15:42:41.142793 [info ] [MainThread]: Found 1 model, 488 macros
[0m15:42:41.143089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c10ef118-0821-4ac1-a22e-2805a6cf9d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bacbf0>]}
[0m15:42:41.144329 [info ] [MainThread]: 
[0m15:42:41.144756 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:42:41.145429 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m15:42:41.158319 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m15:42:41.158727 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m15:42:41.158980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:41.162084 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:42:41.162791 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:42:41.824194 [debug] [ThreadPool]: SQL status: SUCCESS in 0.665 seconds
[0m15:42:41.830378 [debug] [ThreadPool]: On list_dev: Close
[0m15:42:41.832384 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_public_public_staging)
[0m15:42:41.833244 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "public_public_staging"
"
[0m15:42:41.841528 [debug] [ThreadPool]: Using redshift connection "create_dev_public_public_staging"
[0m15:42:41.841909 [debug] [ThreadPool]: On create_dev_public_public_staging: BEGIN
[0m15:42:41.842210 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:41.842703 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:42:41.843034 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:42:42.394866 [debug] [ThreadPool]: SQL status: SUCCESS in 0.552 seconds
[0m15:42:42.396691 [debug] [ThreadPool]: Using redshift connection "create_dev_public_public_staging"
[0m15:42:42.397763 [debug] [ThreadPool]: On create_dev_public_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "create_dev_public_public_staging"} */
create schema if not exists "public_public_staging"
[0m15:42:42.650349 [debug] [ThreadPool]: SQL status: SUCCESS in 0.251 seconds
[0m15:42:42.654810 [debug] [ThreadPool]: On create_dev_public_public_staging: COMMIT
[0m15:42:42.655942 [debug] [ThreadPool]: Using redshift connection "create_dev_public_public_staging"
[0m15:42:42.656541 [debug] [ThreadPool]: On create_dev_public_public_staging: COMMIT
[0m15:42:42.780896 [debug] [ThreadPool]: SQL status: SUCCESS in 0.123 seconds
[0m15:42:42.782989 [debug] [ThreadPool]: On create_dev_public_public_staging: Close
[0m15:42:42.786350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_public_public_staging, now list_dev_public_public_staging)
[0m15:42:42.799653 [debug] [ThreadPool]: Using redshift connection "list_dev_public_public_staging"
[0m15:42:42.800162 [debug] [ThreadPool]: On list_dev_public_public_staging: BEGIN
[0m15:42:42.800534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:42.801083 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:42:42.801455 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:42:43.438602 [debug] [ThreadPool]: SQL status: SUCCESS in 0.638 seconds
[0m15:42:43.440651 [debug] [ThreadPool]: Using redshift connection "list_dev_public_public_staging"
[0m15:42:43.441836 [debug] [ThreadPool]: On list_dev_public_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_public_staging'
[0m15:42:43.592976 [debug] [ThreadPool]: SQL status: SUCCESS in 0.150 seconds
[0m15:42:43.598418 [debug] [ThreadPool]: On list_dev_public_public_staging: ROLLBACK
[0m15:42:43.712310 [debug] [ThreadPool]: On list_dev_public_public_staging: Close
[0m15:42:43.727535 [debug] [MainThread]: Using redshift connection "master"
[0m15:42:43.728233 [debug] [MainThread]: On master: BEGIN
[0m15:42:43.728629 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:42:43.729150 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:42:43.729527 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:42:44.279485 [debug] [MainThread]: SQL status: SUCCESS in 0.550 seconds
[0m15:42:44.281297 [debug] [MainThread]: Using redshift connection "master"
[0m15:42:44.282547 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:42:44.442727 [debug] [MainThread]: SQL status: SUCCESS in 0.159 seconds
[0m15:42:44.448048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c10ef118-0821-4ac1-a22e-2805a6cf9d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069a2000>]}
[0m15:42:44.449569 [debug] [MainThread]: On master: ROLLBACK
[0m15:42:44.547996 [debug] [MainThread]: Using redshift connection "master"
[0m15:42:44.548530 [debug] [MainThread]: On master: BEGIN
[0m15:42:44.596962 [debug] [MainThread]: SQL status: SUCCESS in 0.048 seconds
[0m15:42:44.597522 [debug] [MainThread]: On master: COMMIT
[0m15:42:44.597920 [debug] [MainThread]: Using redshift connection "master"
[0m15:42:44.598202 [debug] [MainThread]: On master: COMMIT
[0m15:42:44.693819 [debug] [MainThread]: SQL status: SUCCESS in 0.095 seconds
[0m15:42:44.694657 [debug] [MainThread]: On master: Close
[0m15:42:44.695935 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:42:44.696664 [info ] [MainThread]: 
[0m15:42:44.701478 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_orders
[0m15:42:44.702362 [info ] [Thread-1 (]: 1 of 1 START sql table model public_public_staging.stg_orders .................. [RUN]
[0m15:42:44.703349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_public_staging, now model.olist_dbt.stg_orders)
[0m15:42:44.703904 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_orders
[0m15:42:44.708075 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_orders"
[0m15:42:44.710078 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_orders
[0m15:42:44.760815 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_orders"
[0m15:42:44.762855 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:42:44.763170 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:42:44.763428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:44.763797 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:42:44.764068 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:42:45.297551 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.533 seconds
[0m15:42:45.299637 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:42:45.300899 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */

  
    

  create  table
    "dev"."public_public_staging"."stg_orders__dbt_tmp"
    
    
    
  as (
    


SELECT
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
FROM "order"
  );
[0m15:42:45.704590 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.402 seconds
[0m15:42:45.722321 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:42:45.723034 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public_public_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m15:42:46.020739 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.297 seconds
[0m15:42:46.050692 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:42:46.051236 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:42:46.051624 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:42:46.190132 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.138 seconds
[0m15:42:46.192107 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:42:46.193176 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:42:46.291413 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.097 seconds
[0m15:42:46.306366 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_public_staging"."stg_orders__dbt_backup"
[0m15:42:46.313180 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:42:46.313681 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
drop table if exists "dev"."public_public_staging"."stg_orders__dbt_backup" cascade
[0m15:42:46.410897 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.096 seconds
[0m15:42:46.414566 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:42:46.415623 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:42:46.416253 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:42:46.472914 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.056 seconds
[0m15:42:46.474895 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:42:46.475976 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:42:46.524959 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.048 seconds
[0m15:42:46.530057 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: ROLLBACK
[0m15:42:46.628534 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: Close
[0m15:42:46.633965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c10ef118-0821-4ac1-a22e-2805a6cf9d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120e18e30>]}
[0m15:42:46.635889 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public_public_staging.stg_orders ............. [[32mSUCCESS[0m in 1.93s]
[0m15:42:46.637477 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_orders
[0m15:42:46.639817 [debug] [MainThread]: Using redshift connection "master"
[0m15:42:46.640456 [debug] [MainThread]: On master: BEGIN
[0m15:42:46.640886 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:42:46.641533 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:42:46.641986 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:42:47.099393 [debug] [MainThread]: SQL status: SUCCESS in 0.458 seconds
[0m15:42:47.101330 [debug] [MainThread]: On master: COMMIT
[0m15:42:47.102767 [debug] [MainThread]: Using redshift connection "master"
[0m15:42:47.103758 [debug] [MainThread]: On master: COMMIT
[0m15:42:47.181505 [debug] [MainThread]: SQL status: SUCCESS in 0.077 seconds
[0m15:42:47.183461 [debug] [MainThread]: On master: Close
[0m15:42:47.185386 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:47.186326 [debug] [MainThread]: Connection 'model.olist_dbt.stg_orders' was properly closed.
[0m15:42:47.187394 [info ] [MainThread]: 
[0m15:42:47.188455 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.04 seconds (6.04s).
[0m15:42:47.190109 [debug] [MainThread]: Command end result
[0m15:42:47.232275 [info ] [MainThread]: 
[0m15:42:47.232882 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:42:47.233220 [info ] [MainThread]: 
[0m15:42:47.233545 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:42:47.236396 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.426837, "process_user_time": 2.659879, "process_kernel_time": 0.384638, "process_mem_max_rss": "122306560", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:42:47.236951 [debug] [MainThread]: Command `dbt run` succeeded at 15:42:47.236865 after 7.43 seconds
[0m15:42:47.237317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106468890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069a2300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107affa70>]}
[0m15:42:47.237641 [debug] [MainThread]: Flushing usage events
[0m15:43:15.644521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e09730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e32480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e309e0>]}


============================== 15:43:15.648561 | c079016d-a3c3-41c9-b95c-8df6fb0ad9ff ==============================
[0m15:43:15.648561 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:43:15.649067 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:43:15.815920 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:43:15.816347 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:43:15.942314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c079016d-a3c3-41c9-b95c-8df6fb0ad9ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106839d60>]}
[0m15:43:15.979074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c079016d-a3c3-41c9-b95c-8df6fb0ad9ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf6c30>]}
[0m15:43:15.979928 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m15:43:15.995656 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:43:16.041866 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:43:16.042344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c079016d-a3c3-41c9-b95c-8df6fb0ad9ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109001a60>]}
[0m15:43:16.829209 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging.olist
[0m15:43:16.833079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c079016d-a3c3-41c9-b95c-8df6fb0ad9ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108abd580>]}
[0m15:43:16.919825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c079016d-a3c3-41c9-b95c-8df6fb0ad9ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090b33b0>]}
[0m15:43:16.920277 [info ] [MainThread]: Found 1 model, 488 macros
[0m15:43:16.920573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c079016d-a3c3-41c9-b95c-8df6fb0ad9ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090fc140>]}
[0m15:43:16.921837 [info ] [MainThread]: 
[0m15:43:16.922286 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:43:16.922971 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m15:43:16.936147 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m15:43:16.936563 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m15:43:16.936817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:43:16.939924 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:43:16.940649 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:43:17.688849 [debug] [ThreadPool]: SQL status: SUCCESS in 0.752 seconds
[0m15:43:17.694558 [debug] [ThreadPool]: On list_dev: Close
[0m15:43:17.697439 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public)
[0m15:43:17.708387 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:43:17.708978 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m15:43:17.709379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:43:17.709936 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:43:17.710321 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:43:18.263936 [debug] [ThreadPool]: SQL status: SUCCESS in 0.554 seconds
[0m15:43:18.265332 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:43:18.266033 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m15:43:18.385316 [debug] [ThreadPool]: SQL status: SUCCESS in 0.118 seconds
[0m15:43:18.390894 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m15:43:18.487442 [debug] [ThreadPool]: On list_dev_public: Close
[0m15:43:18.506004 [debug] [MainThread]: Using redshift connection "master"
[0m15:43:18.506629 [debug] [MainThread]: On master: BEGIN
[0m15:43:18.507064 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:43:18.507696 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:43:18.508135 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:43:18.967567 [debug] [MainThread]: SQL status: SUCCESS in 0.460 seconds
[0m15:43:18.968197 [debug] [MainThread]: Using redshift connection "master"
[0m15:43:18.968609 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:43:19.111113 [debug] [MainThread]: SQL status: SUCCESS in 0.142 seconds
[0m15:43:19.116135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c079016d-a3c3-41c9-b95c-8df6fb0ad9ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108509550>]}
[0m15:43:19.117691 [debug] [MainThread]: On master: ROLLBACK
[0m15:43:19.198046 [debug] [MainThread]: Using redshift connection "master"
[0m15:43:19.199675 [debug] [MainThread]: On master: BEGIN
[0m15:43:19.240074 [debug] [MainThread]: SQL status: SUCCESS in 0.039 seconds
[0m15:43:19.241155 [debug] [MainThread]: On master: COMMIT
[0m15:43:19.242227 [debug] [MainThread]: Using redshift connection "master"
[0m15:43:19.243011 [debug] [MainThread]: On master: COMMIT
[0m15:43:19.322973 [debug] [MainThread]: SQL status: SUCCESS in 0.079 seconds
[0m15:43:19.324667 [debug] [MainThread]: On master: Close
[0m15:43:19.326736 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:43:19.327837 [info ] [MainThread]: 
[0m15:43:19.335199 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_orders
[0m15:43:19.336299 [info ] [Thread-1 (]: 1 of 1 START sql table model public.stg_orders ................................. [RUN]
[0m15:43:19.337589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.olist_dbt.stg_orders)
[0m15:43:19.338585 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_orders
[0m15:43:19.343797 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_orders"
[0m15:43:19.345487 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_orders
[0m15:43:19.398347 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_orders"
[0m15:43:19.400383 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:43:19.400715 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:43:19.400980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:19.401345 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:43:19.401616 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:43:19.840029 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.438 seconds
[0m15:43:19.842061 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:43:19.843297 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */

  
    

  create  table
    "dev"."public"."stg_orders__dbt_tmp"
    
    
    
  as (
    


SELECT
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
FROM "order"
  );
[0m15:43:20.165006 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.320 seconds
[0m15:43:20.179522 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:43:20.180314 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m15:43:20.415491 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.234 seconds
[0m15:43:20.444586 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:43:20.445275 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:43:20.445644 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:43:20.566262 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.120 seconds
[0m15:43:20.568278 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:43:20.569256 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:43:20.649389 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.079 seconds
[0m15:43:20.660653 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."stg_orders__dbt_backup"
[0m15:43:20.667983 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:43:20.668581 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
drop table if exists "dev"."public"."stg_orders__dbt_backup" cascade
[0m15:43:20.750159 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.081 seconds
[0m15:43:20.753750 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:43:20.754826 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:43:20.755471 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:43:20.802976 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.046 seconds
[0m15:43:20.805105 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:43:20.806097 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:43:20.846603 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.039 seconds
[0m15:43:20.851294 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: ROLLBACK
[0m15:43:20.930293 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: Close
[0m15:43:20.935387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c079016d-a3c3-41c9-b95c-8df6fb0ad9ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106838dd0>]}
[0m15:43:20.937241 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.stg_orders ............................ [[32mSUCCESS[0m in 1.60s]
[0m15:43:20.938701 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_orders
[0m15:43:20.940464 [debug] [MainThread]: Using redshift connection "master"
[0m15:43:20.940955 [debug] [MainThread]: On master: BEGIN
[0m15:43:20.941360 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:43:20.941991 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:43:20.942437 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:43:21.484251 [debug] [MainThread]: SQL status: SUCCESS in 0.543 seconds
[0m15:43:21.485607 [debug] [MainThread]: On master: COMMIT
[0m15:43:21.486709 [debug] [MainThread]: Using redshift connection "master"
[0m15:43:21.487654 [debug] [MainThread]: On master: COMMIT
[0m15:43:21.583963 [debug] [MainThread]: SQL status: SUCCESS in 0.096 seconds
[0m15:43:21.585166 [debug] [MainThread]: On master: Close
[0m15:43:21.586703 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:43:21.587236 [debug] [MainThread]: Connection 'model.olist_dbt.stg_orders' was properly closed.
[0m15:43:21.587866 [info ] [MainThread]: 
[0m15:43:21.588421 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.67 seconds (4.67s).
[0m15:43:21.589598 [debug] [MainThread]: Command end result
[0m15:43:21.629038 [info ] [MainThread]: 
[0m15:43:21.629566 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:43:21.629863 [info ] [MainThread]: 
[0m15:43:21.630159 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:43:21.632387 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.039573, "process_user_time": 2.587548, "process_kernel_time": 0.370612, "process_mem_max_rss": "123437056", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:43:21.633132 [debug] [MainThread]: Command `dbt run` succeeded at 15:43:21.633015 after 6.04 seconds
[0m15:43:21.633520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cfdfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107209460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10759d070>]}
[0m15:43:21.633872 [debug] [MainThread]: Flushing usage events
[0m15:44:24.217787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c0cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103200b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103200b00>]}


============================== 15:44:24.222285 | 8b46f63e-82d3-4a2d-b678-8c056cc53c5f ==============================
[0m15:44:24.222285 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:44:24.222781 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:44:24.392906 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:44:24.393338 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:44:24.526730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b46f63e-82d3-4a2d-b678-8c056cc53c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104581190>]}
[0m15:44:24.563956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b46f63e-82d3-4a2d-b678-8c056cc53c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103714f80>]}
[0m15:44:24.565670 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m15:44:24.583638 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:44:24.629545 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:44:24.630009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8b46f63e-82d3-4a2d-b678-8c056cc53c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038d24b0>]}
[0m15:44:25.413595 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging.olist
[0m15:44:25.417425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b46f63e-82d3-4a2d-b678-8c056cc53c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e98860>]}
[0m15:44:25.505273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b46f63e-82d3-4a2d-b678-8c056cc53c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031de7e0>]}
[0m15:44:25.505731 [info ] [MainThread]: Found 1 model, 488 macros
[0m15:44:25.506057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b46f63e-82d3-4a2d-b678-8c056cc53c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e67e0>]}
[0m15:44:25.507276 [info ] [MainThread]: 
[0m15:44:25.507708 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:44:25.508368 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m15:44:25.521560 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m15:44:25.521974 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m15:44:25.522227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:25.525378 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:44:25.526101 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:44:26.187932 [debug] [ThreadPool]: SQL status: SUCCESS in 0.665 seconds
[0m15:44:26.193890 [debug] [ThreadPool]: On list_dev: Close
[0m15:44:26.197254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public)
[0m15:44:26.209616 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:44:26.210234 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m15:44:26.210707 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:44:26.211374 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:44:26.211830 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:44:26.761632 [debug] [ThreadPool]: SQL status: SUCCESS in 0.551 seconds
[0m15:44:26.763269 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:44:26.764370 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m15:44:26.884492 [debug] [ThreadPool]: SQL status: SUCCESS in 0.119 seconds
[0m15:44:26.889890 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m15:44:26.986662 [debug] [ThreadPool]: On list_dev_public: Close
[0m15:44:27.005035 [debug] [MainThread]: Using redshift connection "master"
[0m15:44:27.005680 [debug] [MainThread]: On master: BEGIN
[0m15:44:27.006111 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:44:27.006707 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:44:27.007176 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:44:27.559007 [debug] [MainThread]: SQL status: SUCCESS in 0.552 seconds
[0m15:44:27.560860 [debug] [MainThread]: Using redshift connection "master"
[0m15:44:27.562071 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:44:27.727603 [debug] [MainThread]: SQL status: SUCCESS in 0.164 seconds
[0m15:44:27.732599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b46f63e-82d3-4a2d-b678-8c056cc53c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048dd010>]}
[0m15:44:27.734137 [debug] [MainThread]: On master: ROLLBACK
[0m15:44:27.833809 [debug] [MainThread]: Using redshift connection "master"
[0m15:44:27.834951 [debug] [MainThread]: On master: BEGIN
[0m15:44:27.882998 [debug] [MainThread]: SQL status: SUCCESS in 0.047 seconds
[0m15:44:27.884007 [debug] [MainThread]: On master: COMMIT
[0m15:44:27.885065 [debug] [MainThread]: Using redshift connection "master"
[0m15:44:27.885913 [debug] [MainThread]: On master: COMMIT
[0m15:44:27.983063 [debug] [MainThread]: SQL status: SUCCESS in 0.096 seconds
[0m15:44:27.984303 [debug] [MainThread]: On master: Close
[0m15:44:27.986143 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:44:27.987037 [info ] [MainThread]: 
[0m15:44:27.992819 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_orders
[0m15:44:27.993762 [info ] [Thread-1 (]: 1 of 1 START sql table model public.stg_orders ................................. [RUN]
[0m15:44:27.994606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.olist_dbt.stg_orders)
[0m15:44:27.995280 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_orders
[0m15:44:27.999295 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_orders"
[0m15:44:28.001242 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_orders
[0m15:44:28.053656 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_orders"
[0m15:44:28.055663 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:44:28.055985 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:44:28.056243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:44:28.056601 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:44:28.056869 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:44:28.677866 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.621 seconds
[0m15:44:28.680002 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:44:28.681253 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */

  
    

  create  table
    "dev"."public"."stg_orders__dbt_tmp"
    
    
    
  as (
    


SELECT
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
FROM "order"
  );
[0m15:44:29.059485 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.377 seconds
[0m15:44:29.074559 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:44:29.075347 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m15:44:29.414274 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.338 seconds
[0m15:44:29.448926 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:44:29.449604 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:44:29.450044 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:44:29.608281 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.157 seconds
[0m15:44:29.610256 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:44:29.611299 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:44:29.726513 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.114 seconds
[0m15:44:29.741558 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."stg_orders__dbt_backup"
[0m15:44:29.747886 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:44:29.748364 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
drop table if exists "dev"."public"."stg_orders__dbt_backup" cascade
[0m15:44:29.865286 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.116 seconds
[0m15:44:29.868937 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:44:29.870252 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:44:29.871295 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:44:29.935527 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.063 seconds
[0m15:44:29.936966 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:44:29.938003 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:44:29.995173 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.056 seconds
[0m15:44:30.000853 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: ROLLBACK
[0m15:44:30.115317 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: Close
[0m15:44:30.121430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b46f63e-82d3-4a2d-b678-8c056cc53c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c0cf20>]}
[0m15:44:30.122880 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.stg_orders ............................ [[32mSUCCESS[0m in 2.12s]
[0m15:44:30.123950 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_orders
[0m15:44:30.126470 [debug] [MainThread]: Using redshift connection "master"
[0m15:44:30.127328 [debug] [MainThread]: On master: BEGIN
[0m15:44:30.127803 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:44:30.128480 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:44:30.128955 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:44:30.673865 [debug] [MainThread]: SQL status: SUCCESS in 0.546 seconds
[0m15:44:30.675838 [debug] [MainThread]: On master: COMMIT
[0m15:44:30.677118 [debug] [MainThread]: Using redshift connection "master"
[0m15:44:30.677671 [debug] [MainThread]: On master: COMMIT
[0m15:44:30.774860 [debug] [MainThread]: SQL status: SUCCESS in 0.096 seconds
[0m15:44:30.776750 [debug] [MainThread]: On master: Close
[0m15:44:30.778588 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:44:30.779502 [debug] [MainThread]: Connection 'model.olist_dbt.stg_orders' was properly closed.
[0m15:44:30.780602 [info ] [MainThread]: 
[0m15:44:30.781562 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.27 seconds (5.27s).
[0m15:44:30.783161 [debug] [MainThread]: Command end result
[0m15:44:30.824788 [info ] [MainThread]: 
[0m15:44:30.825330 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:44:30.825631 [info ] [MainThread]: 
[0m15:44:30.825916 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:44:30.828818 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.6672935, "process_user_time": 2.591175, "process_kernel_time": 0.373311, "process_mem_max_rss": "122077184", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:44:30.829398 [debug] [MainThread]: Command `dbt run` succeeded at 15:44:30.829309 after 6.67 seconds
[0m15:44:30.829785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103305af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e589e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d46cf0>]}
[0m15:44:30.830136 [debug] [MainThread]: Flushing usage events
[0m15:46:01.500535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085b7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083f3b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10880ff50>]}


============================== 15:46:01.504863 | b17a824e-b93b-4473-a016-2d4586b2d57f ==============================
[0m15:46:01.504863 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:46:01.505381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/eranola/.dbt', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:46:01.674117 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:46:01.674529 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:46:01.798935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b17a824e-b93b-4473-a016-2d4586b2d57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d50440>]}
[0m15:46:01.836914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b17a824e-b93b-4473-a016-2d4586b2d57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088364e0>]}
[0m15:46:01.838400 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m15:46:01.855829 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:46:01.961006 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:46:01.961413 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:46:01.965366 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging.olist
[0m15:46:01.979967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b17a824e-b93b-4473-a016-2d4586b2d57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109303bf0>]}
[0m15:46:02.045944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b17a824e-b93b-4473-a016-2d4586b2d57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109927560>]}
[0m15:46:02.046705 [info ] [MainThread]: Found 1 model, 488 macros
[0m15:46:02.047057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b17a824e-b93b-4473-a016-2d4586b2d57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eaea50>]}
[0m15:46:02.049556 [info ] [MainThread]: 
[0m15:46:02.050425 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:46:02.052481 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m15:46:02.067489 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m15:46:02.068083 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m15:46:02.068364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:02.071762 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:46:02.072517 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:46:02.735545 [debug] [ThreadPool]: SQL status: SUCCESS in 0.667 seconds
[0m15:46:02.737512 [debug] [ThreadPool]: On list_dev: Close
[0m15:46:02.738731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public)
[0m15:46:02.745289 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:46:02.745671 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m15:46:02.745937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:46:02.746315 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:46:02.746587 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:46:03.395772 [debug] [ThreadPool]: SQL status: SUCCESS in 0.649 seconds
[0m15:46:03.397362 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:46:03.398217 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m15:46:03.543200 [debug] [ThreadPool]: SQL status: SUCCESS in 0.144 seconds
[0m15:46:03.549177 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m15:46:03.671392 [debug] [ThreadPool]: On list_dev_public: Close
[0m15:46:03.692275 [debug] [MainThread]: Using redshift connection "master"
[0m15:46:03.692858 [debug] [MainThread]: On master: BEGIN
[0m15:46:03.693226 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:46:03.693766 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:46:03.694144 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:46:04.254407 [debug] [MainThread]: SQL status: SUCCESS in 0.561 seconds
[0m15:46:04.256253 [debug] [MainThread]: Using redshift connection "master"
[0m15:46:04.257502 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:46:04.420972 [debug] [MainThread]: SQL status: SUCCESS in 0.162 seconds
[0m15:46:04.426505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b17a824e-b93b-4473-a016-2d4586b2d57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a5de80>]}
[0m15:46:04.428048 [debug] [MainThread]: On master: ROLLBACK
[0m15:46:04.527889 [debug] [MainThread]: Using redshift connection "master"
[0m15:46:04.529390 [debug] [MainThread]: On master: BEGIN
[0m15:46:04.577983 [debug] [MainThread]: SQL status: SUCCESS in 0.048 seconds
[0m15:46:04.579473 [debug] [MainThread]: On master: COMMIT
[0m15:46:04.580846 [debug] [MainThread]: Using redshift connection "master"
[0m15:46:04.581768 [debug] [MainThread]: On master: COMMIT
[0m15:46:04.680053 [debug] [MainThread]: SQL status: SUCCESS in 0.097 seconds
[0m15:46:04.681847 [debug] [MainThread]: On master: Close
[0m15:46:04.683752 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:46:04.684598 [info ] [MainThread]: 
[0m15:46:04.690747 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_orders
[0m15:46:04.691887 [info ] [Thread-1 (]: 1 of 1 START sql table model public.stg_orders ................................. [RUN]
[0m15:46:04.692803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.olist_dbt.stg_orders)
[0m15:46:04.693343 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_orders
[0m15:46:04.698167 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_orders"
[0m15:46:04.700099 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_orders
[0m15:46:04.761406 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_orders"
[0m15:46:04.763296 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:46:04.763647 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:46:04.763916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:46:04.764283 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:46:04.764551 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:46:05.306421 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.542 seconds
[0m15:46:05.308221 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:46:05.309496 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */

  
    

  create  table
    "dev"."public"."stg_orders__dbt_tmp"
    
    
    
  as (
    


SELECT
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
FROM "order"
  );
[0m15:46:05.697813 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.387 seconds
[0m15:46:05.712687 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:46:05.713444 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m15:46:06.008789 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.294 seconds
[0m15:46:06.017555 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:46:06.018312 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m15:46:06.167393 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.148 seconds
[0m15:46:06.198927 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:46:06.199601 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:46:06.199965 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:46:06.348852 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.148 seconds
[0m15:46:06.349652 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:46:06.350058 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:46:06.459429 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.108 seconds
[0m15:46:06.472975 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."stg_orders__dbt_backup"
[0m15:46:06.481885 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:46:06.482522 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
drop table if exists "dev"."public"."stg_orders__dbt_backup" cascade
[0m15:46:06.591631 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.108 seconds
[0m15:46:06.594555 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:46:06.595483 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:46:06.596217 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:46:06.683310 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.086 seconds
[0m15:46:06.685186 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:46:06.686156 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:46:06.737485 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.050 seconds
[0m15:46:06.742568 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: ROLLBACK
[0m15:46:06.839498 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: Close
[0m15:46:06.845101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b17a824e-b93b-4473-a016-2d4586b2d57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070ccd40>]}
[0m15:46:06.846874 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.stg_orders ............................ [[32mSUCCESS[0m in 2.15s]
[0m15:46:06.847869 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_orders
[0m15:46:06.850482 [debug] [MainThread]: Using redshift connection "master"
[0m15:46:06.851303 [debug] [MainThread]: On master: BEGIN
[0m15:46:06.851757 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:46:06.852436 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:46:06.852887 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:46:07.490618 [debug] [MainThread]: SQL status: SUCCESS in 0.638 seconds
[0m15:46:07.492544 [debug] [MainThread]: On master: COMMIT
[0m15:46:07.493917 [debug] [MainThread]: Using redshift connection "master"
[0m15:46:07.494666 [debug] [MainThread]: On master: COMMIT
[0m15:46:07.609914 [debug] [MainThread]: SQL status: SUCCESS in 0.114 seconds
[0m15:46:07.611835 [debug] [MainThread]: On master: Close
[0m15:46:07.613481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:07.614132 [debug] [MainThread]: Connection 'model.olist_dbt.stg_orders' was properly closed.
[0m15:46:07.614794 [info ] [MainThread]: 
[0m15:46:07.615653 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.56 seconds (5.56s).
[0m15:46:07.616874 [debug] [MainThread]: Command end result
[0m15:46:07.657746 [info ] [MainThread]: 
[0m15:46:07.658226 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:46:07.658526 [info ] [MainThread]: 
[0m15:46:07.658816 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:46:07.661649 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.2125645, "process_user_time": 1.849852, "process_kernel_time": 0.37562, "process_mem_max_rss": "120881152", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:46:07.662143 [debug] [MainThread]: Command `dbt run` succeeded at 15:46:07.662064 after 6.21 seconds
[0m15:46:07.662475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10824d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105206cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087b7650>]}
[0m15:46:07.662789 [debug] [MainThread]: Flushing usage events
[0m15:47:28.872930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10537aa80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10594c4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053f4b60>]}


============================== 15:47:28.877213 | fd6f2465-2af0-4ae8-8f3a-4824e73348d0 ==============================
[0m15:47:28.877213 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:47:28.877722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'profiles_dir': '/Users/eranola/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:47:29.047604 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:47:29.048042 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:47:29.177663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd6f2465-2af0-4ae8-8f3a-4824e73348d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c38230>]}
[0m15:47:29.216506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd6f2465-2af0-4ae8-8f3a-4824e73348d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac7170>]}
[0m15:47:29.218455 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m15:47:29.236762 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:47:29.284822 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:47:29.285285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fd6f2465-2af0-4ae8-8f3a-4824e73348d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac6540>]}
[0m15:47:30.069881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd6f2465-2af0-4ae8-8f3a-4824e73348d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10758c350>]}
[0m15:47:30.154203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd6f2465-2af0-4ae8-8f3a-4824e73348d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107618350>]}
[0m15:47:30.154645 [info ] [MainThread]: Found 1 model, 488 macros
[0m15:47:30.154944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd6f2465-2af0-4ae8-8f3a-4824e73348d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10657a810>]}
[0m15:47:30.156160 [info ] [MainThread]: 
[0m15:47:30.156590 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:47:30.157241 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m15:47:30.170337 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m15:47:30.170767 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m15:47:30.171029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:30.174169 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:47:30.174870 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:47:30.837736 [debug] [ThreadPool]: SQL status: SUCCESS in 0.666 seconds
[0m15:47:30.843658 [debug] [ThreadPool]: On list_dev: Close
[0m15:47:30.846302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public_staging)
[0m15:47:30.854960 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m15:47:30.855382 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m15:47:30.855706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:30.856227 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:47:30.856563 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:47:31.500342 [debug] [ThreadPool]: SQL status: SUCCESS in 0.644 seconds
[0m15:47:31.502256 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m15:47:31.503382 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m15:47:31.637875 [debug] [ThreadPool]: SQL status: SUCCESS in 0.133 seconds
[0m15:47:31.642373 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m15:47:31.756535 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m15:47:31.774783 [debug] [MainThread]: Using redshift connection "master"
[0m15:47:31.775425 [debug] [MainThread]: On master: BEGIN
[0m15:47:31.775788 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:47:31.776337 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:47:31.776702 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:47:32.325880 [debug] [MainThread]: SQL status: SUCCESS in 0.550 seconds
[0m15:47:32.327824 [debug] [MainThread]: Using redshift connection "master"
[0m15:47:32.329043 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:47:32.491055 [debug] [MainThread]: SQL status: SUCCESS in 0.160 seconds
[0m15:47:32.496552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd6f2465-2af0-4ae8-8f3a-4824e73348d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107702660>]}
[0m15:47:32.498045 [debug] [MainThread]: On master: ROLLBACK
[0m15:47:32.596052 [debug] [MainThread]: Using redshift connection "master"
[0m15:47:32.597389 [debug] [MainThread]: On master: BEGIN
[0m15:47:32.646332 [debug] [MainThread]: SQL status: SUCCESS in 0.048 seconds
[0m15:47:32.647502 [debug] [MainThread]: On master: COMMIT
[0m15:47:32.648625 [debug] [MainThread]: Using redshift connection "master"
[0m15:47:32.649533 [debug] [MainThread]: On master: COMMIT
[0m15:47:32.745496 [debug] [MainThread]: SQL status: SUCCESS in 0.095 seconds
[0m15:47:32.747078 [debug] [MainThread]: On master: Close
[0m15:47:32.748632 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:47:32.749457 [info ] [MainThread]: 
[0m15:47:32.756400 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_orders
[0m15:47:32.757505 [info ] [Thread-1 (]: 1 of 1 START sql table model public_staging.stg_orders ......................... [RUN]
[0m15:47:32.758268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now model.olist_dbt.stg_orders)
[0m15:47:32.758791 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_orders
[0m15:47:32.763709 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_orders"
[0m15:47:32.766345 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_orders
[0m15:47:32.817294 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_orders"
[0m15:47:32.819255 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:47:32.819573 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:47:32.819829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:32.820198 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:47:32.820464 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:47:33.439044 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.619 seconds
[0m15:47:33.439787 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:47:33.440268 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */

  
    

  create  table
    "dev"."public_staging"."stg_orders__dbt_tmp"
    
    
    
  as (
    


SELECT
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
FROM "order"
  );
[0m15:47:33.864536 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.423 seconds
[0m15:47:33.879988 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:47:33.881229 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m15:47:34.225225 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.343 seconds
[0m15:47:34.240498 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:47:34.240989 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:47:34.241272 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:47:34.394457 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.153 seconds
[0m15:47:34.395508 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:47:34.396077 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:47:34.512012 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.115 seconds
[0m15:47:34.522790 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_orders__dbt_backup"
[0m15:47:34.529981 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:47:34.530527 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
drop table if exists "dev"."public_staging"."stg_orders__dbt_backup" cascade
[0m15:47:34.645663 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.115 seconds
[0m15:47:34.646956 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:47:34.647553 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:47:34.647912 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:47:34.713480 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.065 seconds
[0m15:47:34.714367 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:47:34.714894 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:47:34.772371 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.057 seconds
[0m15:47:34.776098 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: ROLLBACK
[0m15:47:34.889437 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: Close
[0m15:47:34.892366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd6f2465-2af0-4ae8-8f3a-4824e73348d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac7830>]}
[0m15:47:34.893548 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public_staging.stg_orders .................... [[32mSUCCESS[0m in 2.13s]
[0m15:47:34.894862 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_orders
[0m15:47:34.896926 [debug] [MainThread]: Using redshift connection "master"
[0m15:47:34.897508 [debug] [MainThread]: On master: BEGIN
[0m15:47:34.897935 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:47:34.899354 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:47:34.900383 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:47:35.360490 [debug] [MainThread]: SQL status: SUCCESS in 0.462 seconds
[0m15:47:35.362350 [debug] [MainThread]: On master: COMMIT
[0m15:47:35.363806 [debug] [MainThread]: Using redshift connection "master"
[0m15:47:35.364769 [debug] [MainThread]: On master: COMMIT
[0m15:47:35.444513 [debug] [MainThread]: SQL status: SUCCESS in 0.079 seconds
[0m15:47:35.445979 [debug] [MainThread]: On master: Close
[0m15:47:35.447293 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:35.447844 [debug] [MainThread]: Connection 'model.olist_dbt.stg_orders' was properly closed.
[0m15:47:35.448656 [info ] [MainThread]: 
[0m15:47:35.449739 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.29 seconds (5.29s).
[0m15:47:35.451021 [debug] [MainThread]: Command end result
[0m15:47:35.489464 [info ] [MainThread]: 
[0m15:47:35.489950 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:47:35.490250 [info ] [MainThread]: 
[0m15:47:35.490552 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:47:35.493156 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.6726313, "process_user_time": 2.526935, "process_kernel_time": 0.396191, "process_mem_max_rss": "120160256", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:47:35.493703 [debug] [MainThread]: Command `dbt run` succeeded at 15:47:35.493616 after 6.67 seconds
[0m15:47:35.494066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10537aa80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060cc740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a1b8f0>]}
[0m15:47:35.494401 [debug] [MainThread]: Flushing usage events
[0m15:48:25.852172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d89d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b28ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b28cb0>]}


============================== 15:48:25.856074 | bd122a66-7191-4006-b2a3-b98793be76da ==============================
[0m15:48:25.856074 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:48:25.856591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'profiles_dir': '/Users/eranola/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:48:26.023046 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:48:26.023467 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:48:26.147631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd122a66-7191-4006-b2a3-b98793be76da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108050860>]}
[0m15:48:26.184697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd122a66-7191-4006-b2a3-b98793be76da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080527b0>]}
[0m15:48:26.185544 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m15:48:26.201980 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:48:26.308009 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:48:26.308395 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:48:26.326202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd122a66-7191-4006-b2a3-b98793be76da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a60c0>]}
[0m15:48:26.376821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd122a66-7191-4006-b2a3-b98793be76da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b271d0>]}
[0m15:48:26.377437 [info ] [MainThread]: Found 1 model, 488 macros
[0m15:48:26.377723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd122a66-7191-4006-b2a3-b98793be76da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c94f20>]}
[0m15:48:26.378975 [info ] [MainThread]: 
[0m15:48:26.379398 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:48:26.380053 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m15:48:26.394609 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m15:48:26.395041 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m15:48:26.395303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:26.398545 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:48:26.399299 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:48:26.964147 [debug] [ThreadPool]: SQL status: SUCCESS in 0.568 seconds
[0m15:48:26.968112 [debug] [ThreadPool]: On list_dev: Close
[0m15:48:26.970926 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public_staging)
[0m15:48:26.982049 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m15:48:26.982652 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m15:48:26.983101 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:26.983667 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:48:26.984034 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:48:27.637826 [debug] [ThreadPool]: SQL status: SUCCESS in 0.654 seconds
[0m15:48:27.639652 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m15:48:27.640781 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m15:48:27.774660 [debug] [ThreadPool]: SQL status: SUCCESS in 0.133 seconds
[0m15:48:27.780018 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m15:48:27.895368 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m15:48:27.916561 [debug] [MainThread]: Using redshift connection "master"
[0m15:48:27.917201 [debug] [MainThread]: On master: BEGIN
[0m15:48:27.917566 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:48:27.918088 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:48:27.918455 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:48:28.582333 [debug] [MainThread]: SQL status: SUCCESS in 0.664 seconds
[0m15:48:28.583994 [debug] [MainThread]: Using redshift connection "master"
[0m15:48:28.585185 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:48:28.763295 [debug] [MainThread]: SQL status: SUCCESS in 0.177 seconds
[0m15:48:28.766439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd122a66-7191-4006-b2a3-b98793be76da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d99880>]}
[0m15:48:28.767260 [debug] [MainThread]: On master: ROLLBACK
[0m15:48:28.882581 [debug] [MainThread]: Using redshift connection "master"
[0m15:48:28.884375 [debug] [MainThread]: On master: BEGIN
[0m15:48:28.942248 [debug] [MainThread]: SQL status: SUCCESS in 0.057 seconds
[0m15:48:28.943687 [debug] [MainThread]: On master: COMMIT
[0m15:48:28.944960 [debug] [MainThread]: Using redshift connection "master"
[0m15:48:28.945924 [debug] [MainThread]: On master: COMMIT
[0m15:48:29.061161 [debug] [MainThread]: SQL status: SUCCESS in 0.114 seconds
[0m15:48:29.062573 [debug] [MainThread]: On master: Close
[0m15:48:29.064546 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:48:29.065777 [info ] [MainThread]: 
[0m15:48:29.069977 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_orders
[0m15:48:29.071102 [info ] [Thread-1 (]: 1 of 1 START sql table model public_staging.stg_orders ......................... [RUN]
[0m15:48:29.071883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now model.olist_dbt.stg_orders)
[0m15:48:29.072540 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_orders
[0m15:48:29.077039 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_orders"
[0m15:48:29.079336 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_orders
[0m15:48:29.126663 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_orders"
[0m15:48:29.128555 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:48:29.128875 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:48:29.129130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:29.129497 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:48:29.129766 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:48:29.655216 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.526 seconds
[0m15:48:29.656460 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:48:29.657029 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */

  
    

  create  table
    "dev"."public_staging"."stg_orders__dbt_tmp"
    
    
    
  as (
    


SELECT
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
FROM "order"
  );
[0m15:48:30.083575 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.426 seconds
[0m15:48:30.096555 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:48:30.097372 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m15:48:30.385691 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.287 seconds
[0m15:48:30.412383 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:48:30.412903 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:48:30.413219 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:48:30.551860 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.138 seconds
[0m15:48:30.553804 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:48:30.554861 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:48:30.651915 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.096 seconds
[0m15:48:30.664960 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_orders__dbt_backup"
[0m15:48:30.672529 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:48:30.673054 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
drop table if exists "dev"."public_staging"."stg_orders__dbt_backup" cascade
[0m15:48:30.771543 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.098 seconds
[0m15:48:30.774805 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:48:30.775745 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:48:30.776364 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m15:48:30.832197 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.055 seconds
[0m15:48:30.833689 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m15:48:30.834476 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m15:48:30.890414 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.055 seconds
[0m15:48:30.896480 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: ROLLBACK
[0m15:48:30.993298 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: Close
[0m15:48:30.998629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd122a66-7191-4006-b2a3-b98793be76da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105238a40>]}
[0m15:48:30.999962 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public_staging.stg_orders .................... [[32mSUCCESS[0m in 1.92s]
[0m15:48:31.001271 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_orders
[0m15:48:31.003513 [debug] [MainThread]: Using redshift connection "master"
[0m15:48:31.004004 [debug] [MainThread]: On master: BEGIN
[0m15:48:31.004435 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:48:31.005093 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:48:31.005554 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:48:31.463226 [debug] [MainThread]: SQL status: SUCCESS in 0.458 seconds
[0m15:48:31.465133 [debug] [MainThread]: On master: COMMIT
[0m15:48:31.466505 [debug] [MainThread]: Using redshift connection "master"
[0m15:48:31.467470 [debug] [MainThread]: On master: COMMIT
[0m15:48:31.586985 [debug] [MainThread]: SQL status: SUCCESS in 0.118 seconds
[0m15:48:31.588755 [debug] [MainThread]: On master: Close
[0m15:48:31.590559 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:31.591467 [debug] [MainThread]: Connection 'model.olist_dbt.stg_orders' was properly closed.
[0m15:48:31.592507 [info ] [MainThread]: 
[0m15:48:31.593562 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.21 seconds (5.21s).
[0m15:48:31.595198 [debug] [MainThread]: Command end result
[0m15:48:31.638940 [info ] [MainThread]: 
[0m15:48:31.639478 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:48:31.639767 [info ] [MainThread]: 
[0m15:48:31.640055 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:48:31.642038 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.840791, "process_user_time": 1.836352, "process_kernel_time": 0.360724, "process_mem_max_rss": "119422976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:48:31.642544 [debug] [MainThread]: Command `dbt run` succeeded at 15:48:31.642468 after 5.84 seconds
[0m15:48:31.642887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d89d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a27d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106922b70>]}
[0m15:48:31.643201 [debug] [MainThread]: Flushing usage events
[0m16:07:18.783079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ea5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105728b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105728b30>]}


============================== 16:07:18.787796 | 3ed95723-eabd-4e4a-969f-3b3274ffcf60 ==============================
[0m16:07:18.787796 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:07:18.788308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:07:18.965267 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:07:18.965732 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:07:19.106651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ed95723-eabd-4e4a-969f-3b3274ffcf60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc0c50>]}
[0m16:07:19.145030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ed95723-eabd-4e4a-969f-3b3274ffcf60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10768e3c0>]}
[0m16:07:19.146374 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:07:19.162892 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:07:19.271801 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:07:19.272376 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/stg_orders.sql
[0m16:07:19.389201 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_orders (models/staging/olist/stg_orders.sql)
  source() takes exactly two arguments (1 given)
[0m16:07:19.391936 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6641687, "process_user_time": 1.314115, "process_kernel_time": 0.297622, "process_mem_max_rss": "114966528", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:07:19.392457 [debug] [MainThread]: Command `dbt run` failed at 16:07:19.392374 after 0.66 seconds
[0m16:07:19.392812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c06cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107da5220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086712b0>]}
[0m16:07:19.393106 [debug] [MainThread]: Flushing usage events
[0m16:08:09.820483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b2e420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087e5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107948b00>]}


============================== 16:08:09.824872 | e3188caa-16f6-421d-a5c9-18e07b1a5b44 ==============================
[0m16:08:09.824872 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:08:09.825438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:08:09.997510 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:08:09.997937 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:08:10.133254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3188caa-16f6-421d-a5c9-18e07b1a5b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ed8f50>]}
[0m16:08:10.170767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3188caa-16f6-421d-a5c9-18e07b1a5b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c565a0>]}
[0m16:08:10.173409 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:08:10.190497 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:08:10.295325 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:08:10.295871 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/stg_orders.sql
[0m16:08:10.409888 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_orders (models/staging/olist/stg_orders.sql)
  source() takes exactly two arguments (1 given)
[0m16:08:10.412296 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.64456636, "process_user_time": 1.289068, "process_kernel_time": 0.283345, "process_mem_max_rss": "113246208", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:08:10.412806 [debug] [MainThread]: Command `dbt run` failed at 16:08:10.412725 after 0.65 seconds
[0m16:08:10.413150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079254c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10801ca70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109134710>]}
[0m16:08:10.413446 [debug] [MainThread]: Flushing usage events
[0m16:08:48.131433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10148d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e2caa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e2ca70>]}


============================== 16:08:48.135672 | 0f2ba398-2900-41bc-8750-b43ec21aff43 ==============================
[0m16:08:48.135672 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:08:48.136190 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/eranola/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:08:48.309389 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:08:48.309821 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:08:48.437042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f2ba398-2900-41bc-8750-b43ec21aff43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102839a60>]}
[0m16:08:48.474277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f2ba398-2900-41bc-8750-b43ec21aff43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104527620>]}
[0m16:08:48.475234 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:08:48.491659 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:08:48.596771 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:08:48.597296 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/stg_orders.sql
[0m16:08:48.712712 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.olist_dbt.stg_orders' (models/staging/olist/stg_orders.sql) depends on a source named 'olist.orders' which was not found
[0m16:08:48.715908 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6388454, "process_user_time": 1.309654, "process_kernel_time": 0.269468, "process_mem_max_rss": "114819072", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:08:48.716437 [debug] [MainThread]: Command `dbt run` failed at 16:08:48.716356 after 0.64 seconds
[0m16:08:48.716777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10447f560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042ca030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035ae3f0>]}
[0m16:08:48.717077 [debug] [MainThread]: Flushing usage events
[0m16:12:20.164165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb0d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f8b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe3fe0>]}


============================== 16:12:20.168497 | 59c6321a-4b47-4401-a75d-389a85bab987 ==============================
[0m16:12:20.168497 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:12:20.169017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:12:20.345754 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:12:20.346199 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:12:20.485940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59c6321a-4b47-4401-a75d-389a85bab987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf4f80>]}
[0m16:12:20.523491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59c6321a-4b47-4401-a75d-389a85bab987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe2510>]}
[0m16:12:20.524595 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:12:20.541406 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:12:20.648526 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:12:20.649064 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/stg_orders.sql
[0m16:12:20.767164 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.olist_dbt.stg_orders' (models/staging/olist/stg_orders.sql) depends on a source named 'public.orders' which was not found
[0m16:12:20.770437 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.66008174, "process_user_time": 1.297897, "process_kernel_time": 0.298816, "process_mem_max_rss": "114638848", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:12:20.770951 [debug] [MainThread]: Command `dbt run` failed at 16:12:20.770872 after 0.66 seconds
[0m16:12:20.771292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a8f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad7dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad7f80>]}
[0m16:12:20.771592 [debug] [MainThread]: Flushing usage events
[0m16:47:14.751192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105859970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107630a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107774a70>]}


============================== 16:47:14.755526 | f35a7cf6-5847-496d-aa5f-74d0d48284d2 ==============================
[0m16:47:14.755526 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:47:14.756016 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:47:14.934010 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:47:14.934423 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:47:15.076201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f35a7cf6-5847-496d-aa5f-74d0d48284d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f83860>]}
[0m16:47:15.113660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f35a7cf6-5847-496d-aa5f-74d0d48284d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108247680>]}
[0m16:47:15.114863 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:47:15.131572 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:47:15.241799 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:47:15.242360 [debug] [MainThread]: Partial parsing: added file: olist_dbt://models/staging/olist/_olist__sources.yml
[0m16:47:15.242708 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/stg_orders.sql
[0m16:47:15.420667 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "olist_order".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("olist", "order").
  
  To fix this, change the name of one of these resources:
  - source.olist_dbt.olist.order (models/staging/olist/_olist__sources.yml)
  - source.olist_dbt.olist.order (models/staging/olist/_olist__sources.yml)
[0m16:47:15.424673 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.72963697, "process_user_time": 1.358761, "process_kernel_time": 0.313411, "process_mem_max_rss": "118194176", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:47:15.425208 [debug] [MainThread]: Command `dbt run` failed at 16:47:15.425124 after 0.73 seconds
[0m16:47:15.425558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105859970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a7c290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107274e60>]}
[0m16:47:15.425864 [debug] [MainThread]: Flushing usage events
[0m16:47:44.047862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b15b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109007fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109007e00>]}


============================== 16:47:44.051798 | 7c645971-02c8-498e-9dde-08a14e2f5d79 ==============================
[0m16:47:44.051798 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:47:44.052317 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'profiles_dir': '/Users/eranola/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:47:44.217591 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:47:44.218007 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:47:44.342765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c645971-02c8-498e-9dde-08a14e2f5d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097f9a30>]}
[0m16:47:44.379911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c645971-02c8-498e-9dde-08a14e2f5d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10902e510>]}
[0m16:47:44.380758 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:47:44.396720 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:47:44.503243 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:47:44.503783 [debug] [MainThread]: Partial parsing: added file: olist_dbt://models/staging/olist/_olist__sources.yml
[0m16:47:44.504133 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/stg_orders.sql
[0m16:47:44.727445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c645971-02c8-498e-9dde-08a14e2f5d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a520650>]}
[0m16:47:44.789108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c645971-02c8-498e-9dde-08a14e2f5d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a54b500>]}
[0m16:47:44.789523 [info ] [MainThread]: Found 1 model, 10 sources, 488 macros
[0m16:47:44.789820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c645971-02c8-498e-9dde-08a14e2f5d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a48d040>]}
[0m16:47:44.791191 [info ] [MainThread]: 
[0m16:47:44.791625 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m16:47:44.792250 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m16:47:44.805391 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m16:47:44.805837 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m16:47:44.806100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:44.809386 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:47:44.810109 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:47:45.472996 [debug] [ThreadPool]: SQL status: SUCCESS in 0.666 seconds
[0m16:47:45.477714 [debug] [ThreadPool]: On list_dev: Close
[0m16:47:45.480407 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public_staging)
[0m16:47:45.492199 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m16:47:45.492835 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m16:47:45.493195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:47:45.493740 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:47:45.494112 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:47:46.141938 [debug] [ThreadPool]: SQL status: SUCCESS in 0.648 seconds
[0m16:47:46.143094 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m16:47:46.143618 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m16:47:46.278983 [debug] [ThreadPool]: SQL status: SUCCESS in 0.134 seconds
[0m16:47:46.283248 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m16:47:46.398701 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m16:47:46.415496 [debug] [MainThread]: Using redshift connection "master"
[0m16:47:46.416039 [debug] [MainThread]: On master: BEGIN
[0m16:47:46.416405 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:47:46.416902 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:47:46.417284 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:47:47.059218 [debug] [MainThread]: SQL status: SUCCESS in 0.642 seconds
[0m16:47:47.061184 [debug] [MainThread]: Using redshift connection "master"
[0m16:47:47.062444 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m16:47:47.242547 [debug] [MainThread]: SQL status: SUCCESS in 0.179 seconds
[0m16:47:47.247693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c645971-02c8-498e-9dde-08a14e2f5d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109661670>]}
[0m16:47:47.248783 [debug] [MainThread]: On master: ROLLBACK
[0m16:47:47.364717 [debug] [MainThread]: Using redshift connection "master"
[0m16:47:47.366511 [debug] [MainThread]: On master: BEGIN
[0m16:47:47.424796 [debug] [MainThread]: SQL status: SUCCESS in 0.057 seconds
[0m16:47:47.426706 [debug] [MainThread]: On master: COMMIT
[0m16:47:47.427918 [debug] [MainThread]: Using redshift connection "master"
[0m16:47:47.428643 [debug] [MainThread]: On master: COMMIT
[0m16:47:47.543508 [debug] [MainThread]: SQL status: SUCCESS in 0.114 seconds
[0m16:47:47.545423 [debug] [MainThread]: On master: Close
[0m16:47:47.547481 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:47:47.548606 [info ] [MainThread]: 
[0m16:47:47.554952 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_orders
[0m16:47:47.556192 [info ] [Thread-1 (]: 1 of 1 START sql table model public_staging.stg_orders ......................... [RUN]
[0m16:47:47.556974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now model.olist_dbt.stg_orders)
[0m16:47:47.557513 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_orders
[0m16:47:47.562327 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_orders"
[0m16:47:47.564075 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_orders
[0m16:47:47.614819 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_orders"
[0m16:47:47.617259 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m16:47:47.617587 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m16:47:47.617844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:47.618208 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:47:47.618473 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:47:48.186447 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.568 seconds
[0m16:47:48.187078 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m16:47:48.187493 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */

  
    

  create  table
    "dev"."public_staging"."stg_orders__dbt_tmp"
    
    
    
  as (
    


-- models/staging/olist/stg_orders.sql
with source as (
    select *
    from "dev"."public"."orders"
)
select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp::timestamp as order_purchase_timestamp,
    order_approved_at::timestamp as order_approved_at,
    order_delivered_carrier_date::timestamp as order_delivered_carrier_date,
    order_delivered_customer_date::timestamp as order_delivered_customer_date,
    order_estimated_delivery_date::timestamp as order_estimated_delivery_date
from source
  );
[0m16:47:58.017100 [debug] [Thread-1 (]: SQL status: SUCCESS in 9.829 seconds
[0m16:47:58.039731 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m16:47:58.043005 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m16:47:58.332848 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.288 seconds
[0m16:47:58.360871 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m16:47:58.361626 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m16:47:58.361968 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m16:47:58.510342 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.148 seconds
[0m16:47:58.512354 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m16:47:58.513399 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m16:47:58.615885 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.101 seconds
[0m16:47:58.630486 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_orders__dbt_backup"
[0m16:47:58.637551 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m16:47:58.638102 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
drop table if exists "dev"."public_staging"."stg_orders__dbt_backup" cascade
[0m16:47:58.736621 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.098 seconds
[0m16:47:58.740530 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m16:47:58.741892 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m16:47:58.742944 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m16:47:58.798259 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.054 seconds
[0m16:47:58.799987 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m16:47:58.801060 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m16:47:58.849594 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.047 seconds
[0m16:47:58.855699 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: ROLLBACK
[0m16:47:58.953798 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: Close
[0m16:47:58.959307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c645971-02c8-498e-9dde-08a14e2f5d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6be690>]}
[0m16:47:58.960824 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public_staging.stg_orders .................... [[32mSUCCESS[0m in 11.40s]
[0m16:47:58.961982 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_orders
[0m16:47:58.964142 [debug] [MainThread]: Using redshift connection "master"
[0m16:47:58.964654 [debug] [MainThread]: On master: BEGIN
[0m16:47:58.965048 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:47:58.965685 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:47:58.966121 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:47:59.436336 [debug] [MainThread]: SQL status: SUCCESS in 0.471 seconds
[0m16:47:59.437809 [debug] [MainThread]: On master: COMMIT
[0m16:47:59.439016 [debug] [MainThread]: Using redshift connection "master"
[0m16:47:59.439865 [debug] [MainThread]: On master: COMMIT
[0m16:47:59.521774 [debug] [MainThread]: SQL status: SUCCESS in 0.081 seconds
[0m16:47:59.523125 [debug] [MainThread]: On master: Close
[0m16:47:59.524400 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:59.525041 [debug] [MainThread]: Connection 'model.olist_dbt.stg_orders' was properly closed.
[0m16:47:59.525677 [info ] [MainThread]: 
[0m16:47:59.526281 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 14.73 seconds (14.73s).
[0m16:47:59.527464 [debug] [MainThread]: Command end result
[0m16:47:59.567757 [info ] [MainThread]: 
[0m16:47:59.568240 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:47:59.568656 [info ] [MainThread]: 
[0m16:47:59.569007 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:47:59.571592 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.574789, "process_user_time": 2.071187, "process_kernel_time": 0.377693, "process_mem_max_rss": "124846080", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:47:59.572139 [debug] [MainThread]: Command `dbt run` succeeded at 16:47:59.572053 after 15.58 seconds
[0m16:47:59.572503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a6f2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109548b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087afa70>]}
[0m16:47:59.572834 [debug] [MainThread]: Flushing usage events
[0m16:59:53.337831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ac9c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053549e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10432c9e0>]}


============================== 16:59:53.342259 | 45d7d40d-4b63-47b3-bad2-e31aeacb35e8 ==============================
[0m16:59:53.342259 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:59:53.342787 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:59:53.517753 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:59:53.518180 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:59:53.653881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45d7d40d-4b63-47b3-bad2-e31aeacb35e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104acbfb0>]}
[0m16:59:53.691267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45d7d40d-4b63-47b3-bad2-e31aeacb35e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057d6060>]}
[0m16:59:53.694116 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:59:53.711528 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:59:53.836284 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 8 files added, 0 files changed.
[0m16:59:53.844914 [debug] [MainThread]: Partial parsing: added file: olist_dbt://models/staging/olist/stg_customers.sql
[0m16:59:53.845210 [debug] [MainThread]: Partial parsing: added file: olist_dbt://models/staging/olist/stg_product_category.sql
[0m16:59:53.845468 [debug] [MainThread]: Partial parsing: added file: olist_dbt://models/staging/olist/stg_order_payments.sql
[0m16:59:53.845699 [debug] [MainThread]: Partial parsing: added file: olist_dbt://models/staging/olist/stg_sellers.sql
[0m16:59:53.845932 [debug] [MainThread]: Partial parsing: added file: olist_dbt://models/staging/olist/stg_products.sql
[0m16:59:53.846163 [debug] [MainThread]: Partial parsing: added file: olist_dbt://models/staging/olist/stg_geolocation.sql
[0m16:59:53.846398 [debug] [MainThread]: Partial parsing: added file: olist_dbt://models/staging/olist/stg_order_items.sql
[0m16:59:53.846622 [debug] [MainThread]: Partial parsing: added file: olist_dbt://models/staging/olist/stg_order_reviews.sql
[0m16:59:54.023281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45d7d40d-4b63-47b3-bad2-e31aeacb35e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107147410>]}
[0m16:59:54.086887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45d7d40d-4b63-47b3-bad2-e31aeacb35e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074a7230>]}
[0m16:59:54.087317 [info ] [MainThread]: Found 9 models, 10 sources, 488 macros
[0m16:59:54.087613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45d7d40d-4b63-47b3-bad2-e31aeacb35e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10748b980>]}
[0m16:59:54.089227 [info ] [MainThread]: 
[0m16:59:54.089689 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m16:59:54.092712 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m16:59:54.106255 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m16:59:54.106960 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m16:59:54.107420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:54.110794 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:59:54.111545 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:59:54.776364 [debug] [ThreadPool]: SQL status: SUCCESS in 0.669 seconds
[0m16:59:54.783566 [debug] [ThreadPool]: On list_dev: Close
[0m16:59:54.789054 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public_staging)
[0m16:59:54.801056 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m16:59:54.801758 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m16:59:54.802193 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:59:54.802836 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:59:54.803316 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:59:55.440915 [debug] [ThreadPool]: SQL status: SUCCESS in 0.638 seconds
[0m16:59:55.442619 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m16:59:55.443752 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m16:59:55.579515 [debug] [ThreadPool]: SQL status: SUCCESS in 0.134 seconds
[0m16:59:55.584255 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m16:59:55.699009 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m16:59:55.720740 [debug] [MainThread]: Using redshift connection "master"
[0m16:59:55.721348 [debug] [MainThread]: On master: BEGIN
[0m16:59:55.721708 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:59:55.722209 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:59:55.722576 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:59:56.278028 [debug] [MainThread]: SQL status: SUCCESS in 0.556 seconds
[0m16:59:56.279945 [debug] [MainThread]: Using redshift connection "master"
[0m16:59:56.281154 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m16:59:56.463968 [debug] [MainThread]: SQL status: SUCCESS in 0.181 seconds
[0m16:59:56.469489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45d7d40d-4b63-47b3-bad2-e31aeacb35e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039fd940>]}
[0m16:59:56.471077 [debug] [MainThread]: On master: ROLLBACK
[0m16:59:56.572531 [debug] [MainThread]: Using redshift connection "master"
[0m16:59:56.574457 [debug] [MainThread]: On master: BEGIN
[0m16:59:56.623656 [debug] [MainThread]: SQL status: SUCCESS in 0.048 seconds
[0m16:59:56.624754 [debug] [MainThread]: On master: COMMIT
[0m16:59:56.625839 [debug] [MainThread]: Using redshift connection "master"
[0m16:59:56.626750 [debug] [MainThread]: On master: COMMIT
[0m16:59:56.723064 [debug] [MainThread]: SQL status: SUCCESS in 0.095 seconds
[0m16:59:56.724873 [debug] [MainThread]: On master: Close
[0m16:59:56.726507 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:59:56.727174 [info ] [MainThread]: 
[0m16:59:56.733616 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_customers
[0m16:59:56.734628 [info ] [Thread-1 (]: 1 of 9 START sql view model public_staging.stg_customers ....................... [RUN]
[0m16:59:56.735389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now model.olist_dbt.stg_customers)
[0m16:59:56.735915 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_customers
[0m16:59:56.740098 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_customers"
[0m16:59:56.741790 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_customers
[0m16:59:56.778356 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_customers"
[0m16:59:56.780301 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m16:59:56.780630 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: BEGIN
[0m16:59:56.780894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:56.781260 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:59:56.781528 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:59:57.316038 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.534 seconds
[0m16:59:57.318193 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m16:59:57.319448 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_customers"} */


  create view "dev"."public_staging"."stg_customers__dbt_tmp" as (
    with source as (
    select *
    from "dev"."public"."customer"
)
select
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state
from source
  ) ;
[0m16:59:57.566452 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.245 seconds
[0m16:59:57.585559 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m16:59:57.586367 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_customers"} */
alter table "dev"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m16:59:57.731672 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.144 seconds
[0m16:59:57.758780 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: COMMIT
[0m16:59:57.759517 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m16:59:57.759965 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: COMMIT
[0m16:59:57.890132 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.129 seconds
[0m16:59:57.892178 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m16:59:57.893270 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: BEGIN
[0m16:59:57.993811 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.099 seconds
[0m16:59:58.008134 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_customers__dbt_backup"
[0m16:59:58.015557 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m16:59:58.016121 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_customers"} */
drop view if exists "dev"."public_staging"."stg_customers__dbt_backup" cascade
[0m16:59:58.113905 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.097 seconds
[0m16:59:58.117568 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: COMMIT
[0m16:59:58.118313 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m16:59:58.118836 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: COMMIT
[0m16:59:58.194456 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.075 seconds
[0m16:59:58.196484 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m16:59:58.197596 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: BEGIN
[0m16:59:58.246664 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.048 seconds
[0m16:59:58.253133 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: ROLLBACK
[0m16:59:58.349299 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: Close
[0m16:59:58.355397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45d7d40d-4b63-47b3-bad2-e31aeacb35e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103990c80>]}
[0m16:59:58.357105 [info ] [Thread-1 (]: 1 of 9 OK created sql view model public_staging.stg_customers .................. [[32mSUCCESS[0m in 1.62s]
[0m16:59:58.358357 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_customers
[0m16:59:58.359248 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_geolocation
[0m16:59:58.360595 [info ] [Thread-1 (]: 2 of 9 START sql view model public_staging.stg_geolocation ..................... [RUN]
[0m16:59:58.361709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_customers, now model.olist_dbt.stg_geolocation)
[0m16:59:58.362462 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_geolocation
[0m16:59:58.366765 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_geolocation"
[0m16:59:58.368390 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_geolocation
[0m16:59:58.374379 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_geolocation"
[0m16:59:58.376868 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m16:59:58.377344 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: BEGIN
[0m16:59:58.377765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:58.378354 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:59:58.378776 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:59:58.835019 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.457 seconds
[0m16:59:58.837150 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m16:59:58.838508 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_geolocation"} */


  create view "dev"."public_staging"."stg_geolocation__dbt_tmp" as (
    with source as (
    select *
    from "dev"."public"."geolocation"
)
select
    geolocation_zip_code_prefix,
    geolocation_lat,
    geolocation_lng,
    geolocation_city,
    geolocation_state
from source
  ) ;
[0m16:59:59.041032 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.201 seconds
[0m16:59:59.054599 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m16:59:59.055113 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_geolocation"} */
alter table "dev"."public_staging"."stg_geolocation__dbt_tmp" rename to "stg_geolocation"
[0m16:59:59.176424 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.121 seconds
[0m16:59:59.182345 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: COMMIT
[0m16:59:59.183829 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m16:59:59.184918 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: COMMIT
[0m16:59:59.293552 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.107 seconds
[0m16:59:59.296192 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m16:59:59.297320 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: BEGIN
[0m16:59:59.376987 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.079 seconds
[0m16:59:59.384150 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_geolocation__dbt_backup"
[0m16:59:59.385854 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m16:59:59.386432 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_geolocation"} */
drop view if exists "dev"."public_staging"."stg_geolocation__dbt_backup" cascade
[0m16:59:59.466403 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.079 seconds
[0m16:59:59.470395 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: COMMIT
[0m16:59:59.471761 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m16:59:59.472855 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: COMMIT
[0m16:59:59.539585 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.066 seconds
[0m16:59:59.540882 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m16:59:59.541687 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: BEGIN
[0m16:59:59.581824 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.039 seconds
[0m16:59:59.584386 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: ROLLBACK
[0m16:59:59.665051 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: Close
[0m16:59:59.668156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45d7d40d-4b63-47b3-bad2-e31aeacb35e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c83410>]}
[0m16:59:59.669877 [info ] [Thread-1 (]: 2 of 9 OK created sql view model public_staging.stg_geolocation ................ [[32mSUCCESS[0m in 1.31s]
[0m16:59:59.671046 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_geolocation
[0m16:59:59.671681 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_order_items
[0m16:59:59.672463 [info ] [Thread-1 (]: 3 of 9 START sql view model public_staging.stg_order_items ..................... [RUN]
[0m16:59:59.673162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_geolocation, now model.olist_dbt.stg_order_items)
[0m16:59:59.673693 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_order_items
[0m16:59:59.677845 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_order_items"
[0m16:59:59.679431 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_order_items
[0m16:59:59.684592 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_order_items"
[0m16:59:59.687112 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m16:59:59.687603 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: BEGIN
[0m16:59:59.688007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:59.688558 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:59:59.688954 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:00:00.326594 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.638 seconds
[0m17:00:00.328546 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:00:00.329525 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_items"} */


  create view "dev"."public_staging"."stg_order_items__dbt_tmp" as (
    with source as (
    select *
    from "dev"."public"."order_items"
)
select
    order_id,
    order_item_id,
    product_id,
    seller_id,
    shipping_limit_date,
    price,
    freight_value,
    product_category_name_english
from source
  ) ;
[0m17:00:00.390669 [debug] [Thread-1 (]: Redshift adapter: Redshift error: column "product_category_name_english" does not exist in source
[0m17:00:00.392414 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: ROLLBACK
[0m17:00:00.508953 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: Close
[0m17:00:00.522474 [debug] [Thread-1 (]: Database Error in model stg_order_items (models/staging/olist/stg_order_items.sql)
  column "product_category_name_english" does not exist in source
  compiled Code at target/run/olist_dbt/models/staging/olist/stg_order_items.sql
[0m17:00:00.523532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45d7d40d-4b63-47b3-bad2-e31aeacb35e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107137ef0>]}
[0m17:00:00.524502 [error] [Thread-1 (]: 3 of 9 ERROR creating sql view model public_staging.stg_order_items ............ [[31mERROR[0m in 0.85s]
[0m17:00:00.525318 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_order_items
[0m17:00:00.525936 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_order_payments
[0m17:00:00.527557 [info ] [Thread-1 (]: 4 of 9 START sql view model public_staging.stg_order_payments .................. [RUN]
[0m17:00:00.528307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_order_items, now model.olist_dbt.stg_order_payments)
[0m17:00:00.528847 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_order_payments
[0m17:00:00.533077 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_order_payments"
[0m17:00:00.534691 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_order_payments
[0m17:00:00.538904 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_order_payments"
[0m17:00:00.541459 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:00:00.542011 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: BEGIN
[0m17:00:00.542415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:00.542988 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:00:00.543417 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:00:00.996048 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.453 seconds
[0m17:00:00.997014 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:00:00.997657 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_payments"} */


  create view "dev"."public_staging"."stg_order_payments__dbt_tmp" as (
    with source as (
    select *
    from "dev"."public"."order_payments"
)
select
    order_id,
    payment_sequential,
    payment_type,
    payment_installments,
    payment_value
from source
  ) ;
[0m17:00:01.196841 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.198 seconds
[0m17:00:01.206459 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:00:01.207664 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_payments"} */
alter table "dev"."public_staging"."stg_order_payments__dbt_tmp" rename to "stg_order_payments"
[0m17:00:01.326193 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.118 seconds
[0m17:00:01.329583 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: COMMIT
[0m17:00:01.330418 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:00:01.330931 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: COMMIT
[0m17:00:01.452013 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.120 seconds
[0m17:00:01.454254 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:00:01.455336 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: BEGIN
[0m17:00:01.535524 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.079 seconds
[0m17:00:01.542306 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_order_payments__dbt_backup"
[0m17:00:01.544799 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:00:01.545545 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_payments"} */
drop view if exists "dev"."public_staging"."stg_order_payments__dbt_backup" cascade
[0m17:00:01.626976 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.081 seconds
[0m17:00:01.630646 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: COMMIT
[0m17:00:01.632077 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:00:01.633172 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: COMMIT
[0m17:00:01.700580 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.066 seconds
[0m17:00:01.702616 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:00:01.703966 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: BEGIN
[0m17:00:01.744269 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.039 seconds
[0m17:00:01.747378 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: ROLLBACK
[0m17:00:01.826808 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: Close
[0m17:00:01.829910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45d7d40d-4b63-47b3-bad2-e31aeacb35e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a9520>]}
[0m17:00:01.831916 [info ] [Thread-1 (]: 4 of 9 OK created sql view model public_staging.stg_order_payments ............. [[32mSUCCESS[0m in 1.30s]
[0m17:00:01.833384 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_order_payments
[0m17:00:01.834299 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_order_reviews
[0m17:00:01.835468 [info ] [Thread-1 (]: 5 of 9 START sql view model public_staging.stg_order_reviews ................... [RUN]
[0m17:00:01.836444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_order_payments, now model.olist_dbt.stg_order_reviews)
[0m17:00:01.837032 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_order_reviews
[0m17:00:01.841296 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_order_reviews"
[0m17:00:01.842906 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_order_reviews
[0m17:00:01.848523 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_order_reviews"
[0m17:00:01.851021 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:00:01.851479 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: BEGIN
[0m17:00:01.851857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:01.852386 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:00:01.852786 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:00:02.307952 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.455 seconds
[0m17:00:02.310155 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:00:02.311464 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_reviews"} */


  create view "dev"."public_staging"."stg_order_reviews__dbt_tmp" as (
    with source as (
    select *
    from "dev"."public"."order_reviews"
)
select
    review_id,
    order_id,
    review_score,
    review_comment_title,
    review_comment_message,
    review_creation_date,
    review_answer_timestamp
from source
  ) ;
[0m17:00:02.513183 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.200 seconds
[0m17:00:02.532433 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:00:02.533190 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_reviews"} */
alter table "dev"."public_staging"."stg_order_reviews__dbt_tmp" rename to "stg_order_reviews"
[0m17:00:02.651928 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.118 seconds
[0m17:00:02.657937 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: COMMIT
[0m17:00:02.659300 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:00:02.660375 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: COMMIT
[0m17:00:02.770128 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.108 seconds
[0m17:00:02.773003 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:00:02.774136 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: BEGIN
[0m17:00:02.852649 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.077 seconds
[0m17:00:02.859027 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_order_reviews__dbt_backup"
[0m17:00:02.861227 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:00:02.861905 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_reviews"} */
drop view if exists "dev"."public_staging"."stg_order_reviews__dbt_backup" cascade
[0m17:00:02.942876 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.080 seconds
[0m17:00:02.946730 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: COMMIT
[0m17:00:02.948200 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:00:02.948850 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: COMMIT
[0m17:00:03.017373 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.068 seconds
[0m17:00:03.019311 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:00:03.020240 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: BEGIN
[0m17:00:03.060429 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.039 seconds
[0m17:00:03.063015 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: ROLLBACK
[0m17:00:03.141348 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: Close
[0m17:00:03.142208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45d7d40d-4b63-47b3-bad2-e31aeacb35e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10772e810>]}
[0m17:00:03.142766 [info ] [Thread-1 (]: 5 of 9 OK created sql view model public_staging.stg_order_reviews .............. [[32mSUCCESS[0m in 1.31s]
[0m17:00:03.143435 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_order_reviews
[0m17:00:03.143839 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_orders
[0m17:00:03.144268 [info ] [Thread-1 (]: 6 of 9 START sql table model public_staging.stg_orders ......................... [RUN]
[0m17:00:03.144651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_order_reviews, now model.olist_dbt.stg_orders)
[0m17:00:03.144964 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_orders
[0m17:00:03.147546 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_orders"
[0m17:00:03.148615 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_orders
[0m17:00:03.173063 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_orders"
[0m17:00:03.175453 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:00:03.175761 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m17:00:03.176016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:03.176375 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:00:03.176653 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:00:03.794245 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.618 seconds
[0m17:00:03.796466 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:00:03.797246 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */

  
    

  create  table
    "dev"."public_staging"."stg_orders__dbt_tmp"
    
    
    
  as (
    


-- models/staging/olist/stg_orders.sql
with source as (
    select *
    from "dev"."public"."orders"
)
select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp::timestamp as order_purchase_timestamp,
    order_approved_at::timestamp as order_approved_at,
    order_delivered_carrier_date::timestamp as order_delivered_carrier_date,
    order_delivered_customer_date::timestamp as order_delivered_customer_date,
    order_estimated_delivery_date::timestamp as order_estimated_delivery_date
from source
  );
[0m17:00:04.480553 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.682 seconds
[0m17:00:04.492686 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:00:04.493886 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m17:00:04.842420 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.347 seconds
[0m17:00:04.851647 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:00:04.852455 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m17:00:05.023705 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.170 seconds
[0m17:00:05.037654 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m17:00:05.038295 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:00:05.038742 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m17:00:05.185621 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.146 seconds
[0m17:00:05.187753 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:00:05.189001 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m17:00:05.304924 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.114 seconds
[0m17:00:05.313147 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_orders__dbt_backup"
[0m17:00:05.317861 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:00:05.318329 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
drop table if exists "dev"."public_staging"."stg_orders__dbt_backup" cascade
[0m17:00:05.434574 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.115 seconds
[0m17:00:05.437958 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m17:00:05.438977 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:00:05.439630 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m17:00:05.529194 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.089 seconds
[0m17:00:05.530629 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:00:05.531669 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m17:00:05.589491 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.057 seconds
[0m17:00:05.591980 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: ROLLBACK
[0m17:00:05.708442 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: Close
[0m17:00:05.710880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45d7d40d-4b63-47b3-bad2-e31aeacb35e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a8fe0>]}
[0m17:00:05.712147 [info ] [Thread-1 (]: 6 of 9 OK created sql table model public_staging.stg_orders .................... [[32mSUCCESS[0m in 2.57s]
[0m17:00:05.713374 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_orders
[0m17:00:05.714409 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_product_category
[0m17:00:05.715341 [info ] [Thread-1 (]: 7 of 9 START sql view model public_staging.stg_product_category ................ [RUN]
[0m17:00:05.716077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_orders, now model.olist_dbt.stg_product_category)
[0m17:00:05.716579 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_product_category
[0m17:00:05.720412 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_product_category"
[0m17:00:05.722194 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_product_category
[0m17:00:05.727094 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_product_category"
[0m17:00:05.729549 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:00:05.730062 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: BEGIN
[0m17:00:05.730452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:05.731078 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:00:05.731512 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:00:06.279718 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.549 seconds
[0m17:00:06.281610 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:00:06.282862 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_product_category"} */


  create view "dev"."public_staging"."stg_product_category__dbt_tmp" as (
    with source as (
    select *
    from "dev"."public"."product_category"
)
select
    product_category_name_english as product_category
from source
  ) ;
[0m17:00:06.529570 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.246 seconds
[0m17:00:06.533894 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:00:06.534406 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_product_category"} */
alter table "dev"."public_staging"."stg_product_category__dbt_tmp" rename to "stg_product_category"
[0m17:00:06.681659 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.146 seconds
[0m17:00:06.685867 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: COMMIT
[0m17:00:06.686993 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:00:06.687570 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: COMMIT
[0m17:00:06.813884 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.125 seconds
[0m17:00:06.815593 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:00:06.816505 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: BEGIN
[0m17:00:06.915236 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.098 seconds
[0m17:00:06.921320 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_product_category__dbt_backup"
[0m17:00:06.923054 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:00:06.923638 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_product_category"} */
drop view if exists "dev"."public_staging"."stg_product_category__dbt_backup" cascade
[0m17:00:07.022388 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.098 seconds
[0m17:00:07.025320 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: COMMIT
[0m17:00:07.026480 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:00:07.027253 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: COMMIT
[0m17:00:07.104328 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.076 seconds
[0m17:00:07.105834 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:00:07.106525 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: BEGIN
[0m17:00:07.156019 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.049 seconds
[0m17:00:07.159265 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: ROLLBACK
[0m17:00:07.254786 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: Close
[0m17:00:07.256245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45d7d40d-4b63-47b3-bad2-e31aeacb35e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112855d90>]}
[0m17:00:07.257382 [info ] [Thread-1 (]: 7 of 9 OK created sql view model public_staging.stg_product_category ........... [[32mSUCCESS[0m in 1.54s]
[0m17:00:07.258414 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_product_category
[0m17:00:07.259084 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_products
[0m17:00:07.259872 [info ] [Thread-1 (]: 8 of 9 START sql view model public_staging.stg_products ........................ [RUN]
[0m17:00:07.260627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_product_category, now model.olist_dbt.stg_products)
[0m17:00:07.261185 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_products
[0m17:00:07.265378 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_products"
[0m17:00:07.266972 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_products
[0m17:00:07.271759 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_products"
[0m17:00:07.274366 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:00:07.274884 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: BEGIN
[0m17:00:07.275286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:07.275838 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:00:07.276244 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:00:07.728985 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.454 seconds
[0m17:00:07.729965 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:00:07.730970 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_products"} */


  create view "dev"."public_staging"."stg_products__dbt_tmp" as (
    with source as (
    select *
    from "dev"."public"."products"
)
select
    product_id,
    product_category_name_english,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
from source
  ) ;
[0m17:00:07.773037 [debug] [Thread-1 (]: Redshift adapter: Redshift error: column "product_category_name_english" does not exist in source
[0m17:00:07.773501 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: ROLLBACK
[0m17:00:07.852475 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: Close
[0m17:00:07.856026 [debug] [Thread-1 (]: Database Error in model stg_products (models/staging/olist/stg_products.sql)
  column "product_category_name_english" does not exist in source
  compiled Code at target/run/olist_dbt/models/staging/olist/stg_products.sql
[0m17:00:07.856522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45d7d40d-4b63-47b3-bad2-e31aeacb35e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c36b0>]}
[0m17:00:07.857148 [error] [Thread-1 (]: 8 of 9 ERROR creating sql view model public_staging.stg_products ............... [[31mERROR[0m in 0.60s]
[0m17:00:07.857698 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_products
[0m17:00:07.858098 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_sellers
[0m17:00:07.858680 [info ] [Thread-1 (]: 9 of 9 START sql view model public_staging.stg_sellers ......................... [RUN]
[0m17:00:07.859223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_products, now model.olist_dbt.stg_sellers)
[0m17:00:07.859613 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_sellers
[0m17:00:07.862407 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_sellers"
[0m17:00:07.863585 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_sellers
[0m17:00:07.866575 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_sellers"
[0m17:00:07.868261 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:00:07.868578 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: BEGIN
[0m17:00:07.868856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:07.869252 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:00:07.869552 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:00:08.402308 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.533 seconds
[0m17:00:08.403443 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:00:08.404131 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_sellers"} */


  create view "dev"."public_staging"."stg_sellers__dbt_tmp" as (
    with source as (
    select *
    from "dev"."public"."sellers"
)
select
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state
from source
  ) ;
[0m17:00:08.652357 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.247 seconds
[0m17:00:08.662489 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:00:08.663505 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_sellers"} */
alter table "dev"."public_staging"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m17:00:08.812766 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.148 seconds
[0m17:00:08.818021 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: COMMIT
[0m17:00:08.819080 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:00:08.819817 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: COMMIT
[0m17:00:08.949392 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.128 seconds
[0m17:00:08.951767 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:00:08.953000 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: BEGIN
[0m17:00:09.050812 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.097 seconds
[0m17:00:09.057777 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_sellers__dbt_backup"
[0m17:00:09.059773 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:00:09.060385 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_sellers"} */
drop view if exists "dev"."public_staging"."stg_sellers__dbt_backup" cascade
[0m17:00:09.161553 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.100 seconds
[0m17:00:09.165432 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: COMMIT
[0m17:00:09.166843 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:00:09.167574 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: COMMIT
[0m17:00:09.246025 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.077 seconds
[0m17:00:09.248134 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:00:09.249218 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: BEGIN
[0m17:00:09.298250 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.048 seconds
[0m17:00:09.301174 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: ROLLBACK
[0m17:00:09.399909 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: Close
[0m17:00:09.402513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45d7d40d-4b63-47b3-bad2-e31aeacb35e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112863170>]}
[0m17:00:09.404392 [info ] [Thread-1 (]: 9 of 9 OK created sql view model public_staging.stg_sellers .................... [[32mSUCCESS[0m in 1.54s]
[0m17:00:09.405723 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_sellers
[0m17:00:09.408375 [debug] [MainThread]: Using redshift connection "master"
[0m17:00:09.409154 [debug] [MainThread]: On master: BEGIN
[0m17:00:09.409702 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:00:09.410537 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:00:09.411124 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:00:09.955626 [debug] [MainThread]: SQL status: SUCCESS in 0.546 seconds
[0m17:00:09.957123 [debug] [MainThread]: On master: COMMIT
[0m17:00:09.958480 [debug] [MainThread]: Using redshift connection "master"
[0m17:00:09.959334 [debug] [MainThread]: On master: COMMIT
[0m17:00:10.055536 [debug] [MainThread]: SQL status: SUCCESS in 0.095 seconds
[0m17:00:10.057677 [debug] [MainThread]: On master: Close
[0m17:00:10.059732 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:00:10.060545 [debug] [MainThread]: Connection 'model.olist_dbt.stg_sellers' was properly closed.
[0m17:00:10.061548 [info ] [MainThread]: 
[0m17:00:10.062223 [info ] [MainThread]: Finished running 8 view models, 1 table model in 0 hours 0 minutes and 15.97 seconds (15.97s).
[0m17:00:10.064384 [debug] [MainThread]: Command end result
[0m17:00:10.149580 [info ] [MainThread]: 
[0m17:00:10.149985 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:00:10.150233 [info ] [MainThread]: 
[0m17:00:10.150527 [error] [MainThread]:   Database Error in model stg_order_items (models/staging/olist/stg_order_items.sql)
  column "product_category_name_english" does not exist in source
  compiled Code at target/run/olist_dbt/models/staging/olist/stg_order_items.sql
[0m17:00:10.150769 [info ] [MainThread]: 
[0m17:00:10.151029 [error] [MainThread]:   Database Error in model stg_products (models/staging/olist/stg_products.sql)
  column "product_category_name_english" does not exist in source
  compiled Code at target/run/olist_dbt/models/staging/olist/stg_products.sql
[0m17:00:10.151249 [info ] [MainThread]: 
[0m17:00:10.151478 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
[0m17:00:10.153879 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 16.870155, "process_user_time": 2.983604, "process_kernel_time": 0.490679, "process_mem_max_rss": "128188416", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:00:10.154343 [debug] [MainThread]: Command `dbt run` failed at 17:00:10.154267 after 16.87 seconds
[0m17:00:10.154649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105326240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112802f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112802cc0>]}
[0m17:00:10.154922 [debug] [MainThread]: Flushing usage events
[0m17:02:22.809974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025b90a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a2c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a2c140>]}


============================== 17:02:22.814479 | 3e32f242-763b-4e10-a488-ac70ac6d57d2 ==============================
[0m17:02:22.814479 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:02:22.814996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:02:22.989047 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:02:22.989478 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:02:23.123904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e32f242-763b-4e10-a488-ac70ac6d57d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059d4c50>]}
[0m17:02:23.161291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e32f242-763b-4e10-a488-ac70ac6d57d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061a4410>]}
[0m17:02:23.162943 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m17:02:23.179947 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:02:23.298327 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:02:23.298911 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/stg_products.sql
[0m17:02:23.299249 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/stg_order_items.sql
[0m17:02:23.463297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e32f242-763b-4e10-a488-ac70ac6d57d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c21e0>]}
[0m17:02:23.526393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e32f242-763b-4e10-a488-ac70ac6d57d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fe6d20>]}
[0m17:02:23.526824 [info ] [MainThread]: Found 9 models, 10 sources, 488 macros
[0m17:02:23.527124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e32f242-763b-4e10-a488-ac70ac6d57d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a72c60>]}
[0m17:02:23.528783 [info ] [MainThread]: 
[0m17:02:23.529244 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:02:23.532248 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m17:02:23.545582 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m17:02:23.546008 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m17:02:23.546262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:23.549311 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:02:23.550023 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:02:24.126230 [debug] [ThreadPool]: SQL status: SUCCESS in 0.579 seconds
[0m17:02:24.131585 [debug] [ThreadPool]: On list_dev: Close
[0m17:02:24.135181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public_staging)
[0m17:02:24.146087 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:02:24.146566 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m17:02:24.146921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:02:24.147465 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:02:24.147837 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:02:24.789649 [debug] [ThreadPool]: SQL status: SUCCESS in 0.642 seconds
[0m17:02:24.791541 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:02:24.792628 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m17:02:24.930168 [debug] [ThreadPool]: SQL status: SUCCESS in 0.136 seconds
[0m17:02:24.934949 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m17:02:25.050787 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m17:02:25.073821 [debug] [MainThread]: Using redshift connection "master"
[0m17:02:25.074426 [debug] [MainThread]: On master: BEGIN
[0m17:02:25.074795 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:02:25.075320 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:02:25.075679 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:02:25.629444 [debug] [MainThread]: SQL status: SUCCESS in 0.554 seconds
[0m17:02:25.631165 [debug] [MainThread]: Using redshift connection "master"
[0m17:02:25.632395 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:02:25.794539 [debug] [MainThread]: SQL status: SUCCESS in 0.161 seconds
[0m17:02:25.799576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e32f242-763b-4e10-a488-ac70ac6d57d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035a1640>]}
[0m17:02:25.801034 [debug] [MainThread]: On master: ROLLBACK
[0m17:02:25.902271 [debug] [MainThread]: Using redshift connection "master"
[0m17:02:25.903477 [debug] [MainThread]: On master: BEGIN
[0m17:02:25.952256 [debug] [MainThread]: SQL status: SUCCESS in 0.048 seconds
[0m17:02:25.953503 [debug] [MainThread]: On master: COMMIT
[0m17:02:25.954648 [debug] [MainThread]: Using redshift connection "master"
[0m17:02:25.955567 [debug] [MainThread]: On master: COMMIT
[0m17:02:26.055157 [debug] [MainThread]: SQL status: SUCCESS in 0.098 seconds
[0m17:02:26.056916 [debug] [MainThread]: On master: Close
[0m17:02:26.058859 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:02:26.060035 [info ] [MainThread]: 
[0m17:02:26.067212 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_customers
[0m17:02:26.068333 [info ] [Thread-1 (]: 1 of 9 START sql view model public_staging.stg_customers ....................... [RUN]
[0m17:02:26.069276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now model.olist_dbt.stg_customers)
[0m17:02:26.069894 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_customers
[0m17:02:26.075097 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_customers"
[0m17:02:26.076762 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_customers
[0m17:02:26.114385 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_customers"
[0m17:02:26.116264 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:02:26.116594 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: BEGIN
[0m17:02:26.116863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:26.117234 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:02:26.117506 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:02:26.650824 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.533 seconds
[0m17:02:26.653099 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:02:26.654435 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_customers"} */


  create view "dev"."public_staging"."stg_customers__dbt_tmp" as (
    with source as (
    select *
    from "dev"."public"."customer"
)
select
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state
from source
  ) ;
[0m17:02:26.901093 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.245 seconds
[0m17:02:26.915567 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:02:26.916167 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_customers"} */
alter table "dev"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m17:02:27.062966 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.146 seconds
[0m17:02:27.073594 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:02:27.074078 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_customers"} */
alter table "dev"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:02:27.219521 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.145 seconds
[0m17:02:27.248957 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: COMMIT
[0m17:02:27.249531 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:02:27.249893 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: COMMIT
[0m17:02:27.380827 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.130 seconds
[0m17:02:27.382851 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:02:27.383948 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: BEGIN
[0m17:02:27.484228 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.099 seconds
[0m17:02:27.498214 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_customers__dbt_backup"
[0m17:02:27.505403 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:02:27.505916 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_customers"} */
drop view if exists "dev"."public_staging"."stg_customers__dbt_backup" cascade
[0m17:02:27.606297 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.100 seconds
[0m17:02:27.610144 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: COMMIT
[0m17:02:27.611467 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:02:27.612491 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: COMMIT
[0m17:02:27.690000 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.076 seconds
[0m17:02:27.692063 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:02:27.693161 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: BEGIN
[0m17:02:27.742101 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.048 seconds
[0m17:02:27.748041 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: ROLLBACK
[0m17:02:27.844548 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: Close
[0m17:02:27.846199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e32f242-763b-4e10-a488-ac70ac6d57d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103538920>]}
[0m17:02:27.846769 [info ] [Thread-1 (]: 1 of 9 OK created sql view model public_staging.stg_customers .................. [[32mSUCCESS[0m in 1.78s]
[0m17:02:27.847286 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_customers
[0m17:02:27.847656 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_geolocation
[0m17:02:27.848151 [info ] [Thread-1 (]: 2 of 9 START sql view model public_staging.stg_geolocation ..................... [RUN]
[0m17:02:27.848587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_customers, now model.olist_dbt.stg_geolocation)
[0m17:02:27.848916 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_geolocation
[0m17:02:27.851319 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_geolocation"
[0m17:02:27.852360 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_geolocation
[0m17:02:27.857614 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_geolocation"
[0m17:02:27.859238 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:02:27.859545 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: BEGIN
[0m17:02:27.859802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:27.860164 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:02:27.860439 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:02:28.390898 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.530 seconds
[0m17:02:28.392912 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:02:28.393906 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_geolocation"} */


  create view "dev"."public_staging"."stg_geolocation__dbt_tmp" as (
    with source as (
    select *
    from "dev"."public"."geolocation"
)
select
    geolocation_zip_code_prefix,
    geolocation_lat,
    geolocation_lng,
    geolocation_city,
    geolocation_state
from source
  ) ;
[0m17:02:28.639394 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.244 seconds
[0m17:02:28.650128 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:02:28.651068 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_geolocation"} */
alter table "dev"."public_staging"."stg_geolocation" rename to "stg_geolocation__dbt_backup"
[0m17:02:28.795364 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.143 seconds
[0m17:02:28.805608 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:02:28.806085 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_geolocation"} */
alter table "dev"."public_staging"."stg_geolocation__dbt_tmp" rename to "stg_geolocation"
[0m17:02:28.952161 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.145 seconds
[0m17:02:28.958803 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: COMMIT
[0m17:02:28.960152 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:02:28.961220 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: COMMIT
[0m17:02:29.088809 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.126 seconds
[0m17:02:29.090971 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:02:29.092266 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: BEGIN
[0m17:02:29.190578 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.097 seconds
[0m17:02:29.195654 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_geolocation__dbt_backup"
[0m17:02:29.197657 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:02:29.198202 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_geolocation"} */
drop view if exists "dev"."public_staging"."stg_geolocation__dbt_backup" cascade
[0m17:02:29.298784 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.099 seconds
[0m17:02:29.302820 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: COMMIT
[0m17:02:29.304252 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:02:29.305307 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: COMMIT
[0m17:02:29.383083 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.077 seconds
[0m17:02:29.384672 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:02:29.385764 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: BEGIN
[0m17:02:29.433931 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.047 seconds
[0m17:02:29.436575 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: ROLLBACK
[0m17:02:29.535184 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: Close
[0m17:02:29.538172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e32f242-763b-4e10-a488-ac70ac6d57d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107935c70>]}
[0m17:02:29.540253 [info ] [Thread-1 (]: 2 of 9 OK created sql view model public_staging.stg_geolocation ................ [[32mSUCCESS[0m in 1.69s]
[0m17:02:29.541650 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_geolocation
[0m17:02:29.542480 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_order_items
[0m17:02:29.543433 [info ] [Thread-1 (]: 3 of 9 START sql view model public_staging.stg_order_items ..................... [RUN]
[0m17:02:29.544108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_geolocation, now model.olist_dbt.stg_order_items)
[0m17:02:29.544681 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_order_items
[0m17:02:29.549573 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_order_items"
[0m17:02:29.551288 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_order_items
[0m17:02:29.557447 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_order_items"
[0m17:02:29.560071 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:02:29.560555 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: BEGIN
[0m17:02:29.560942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:29.561518 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:02:29.561930 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:02:30.200236 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.639 seconds
[0m17:02:30.202423 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:02:30.203647 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_items"} */


  create view "dev"."public_staging"."stg_order_items__dbt_tmp" as (
    with source as (
    select *
    from "dev"."public"."order_items"
)
select
    order_id,
    order_item_id,
    product_id,
    seller_id,
    shipping_limit_date,
    price,
    freight_value
    
from source
  ) ;
[0m17:02:30.493979 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.289 seconds
[0m17:02:30.503649 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:02:30.504302 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_items"} */
alter table "dev"."public_staging"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m17:02:30.675648 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.170 seconds
[0m17:02:30.681593 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: COMMIT
[0m17:02:30.682977 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:02:30.684015 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: COMMIT
[0m17:02:30.829516 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.144 seconds
[0m17:02:30.831923 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:02:30.833086 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: BEGIN
[0m17:02:30.948338 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.114 seconds
[0m17:02:30.955519 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_order_items__dbt_backup"
[0m17:02:30.957149 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:02:30.957667 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_items"} */
drop view if exists "dev"."public_staging"."stg_order_items__dbt_backup" cascade
[0m17:02:31.073360 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.115 seconds
[0m17:02:31.077269 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: COMMIT
[0m17:02:31.078212 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:02:31.078834 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: COMMIT
[0m17:02:31.162827 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.083 seconds
[0m17:02:31.164861 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:02:31.165994 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: BEGIN
[0m17:02:31.224072 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.057 seconds
[0m17:02:31.226736 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: ROLLBACK
[0m17:02:31.340207 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: Close
[0m17:02:31.343012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e32f242-763b-4e10-a488-ac70ac6d57d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f725a0>]}
[0m17:02:31.344816 [info ] [Thread-1 (]: 3 of 9 OK created sql view model public_staging.stg_order_items ................ [[32mSUCCESS[0m in 1.80s]
[0m17:02:31.345896 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_order_items
[0m17:02:31.346619 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_order_payments
[0m17:02:31.347380 [info ] [Thread-1 (]: 4 of 9 START sql view model public_staging.stg_order_payments .................. [RUN]
[0m17:02:31.348157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_order_items, now model.olist_dbt.stg_order_payments)
[0m17:02:31.348998 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_order_payments
[0m17:02:31.353488 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_order_payments"
[0m17:02:31.354938 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_order_payments
[0m17:02:31.360433 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_order_payments"
[0m17:02:31.362717 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:02:31.363225 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: BEGIN
[0m17:02:31.363632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:31.364228 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:02:31.364638 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:02:31.898237 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.534 seconds
[0m17:02:31.900471 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:02:31.901721 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_payments"} */


  create view "dev"."public_staging"."stg_order_payments__dbt_tmp" as (
    with source as (
    select *
    from "dev"."public"."order_payments"
)
select
    order_id,
    payment_sequential,
    payment_type,
    payment_installments,
    payment_value
from source
  ) ;
[0m17:02:32.144307 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.241 seconds
[0m17:02:32.159952 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:02:32.160641 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_payments"} */
alter table "dev"."public_staging"."stg_order_payments" rename to "stg_order_payments__dbt_backup"
[0m17:02:32.306328 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.145 seconds
[0m17:02:32.316543 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:02:32.317008 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_payments"} */
alter table "dev"."public_staging"."stg_order_payments__dbt_tmp" rename to "stg_order_payments"
[0m17:02:32.463277 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.145 seconds
[0m17:02:32.469963 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: COMMIT
[0m17:02:32.471330 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:02:32.472482 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: COMMIT
[0m17:02:32.600905 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.127 seconds
[0m17:02:32.603354 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:02:32.604450 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: BEGIN
[0m17:02:32.705633 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.100 seconds
[0m17:02:32.714490 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_order_payments__dbt_backup"
[0m17:02:32.716256 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:02:32.716673 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_payments"} */
drop view if exists "dev"."public_staging"."stg_order_payments__dbt_backup" cascade
[0m17:02:32.817148 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.100 seconds
[0m17:02:32.820242 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: COMMIT
[0m17:02:32.821263 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:02:32.822141 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: COMMIT
[0m17:02:32.898702 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.076 seconds
[0m17:02:32.900236 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:02:32.901299 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: BEGIN
[0m17:02:32.949568 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.047 seconds
[0m17:02:32.952076 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: ROLLBACK
[0m17:02:33.048724 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: Close
[0m17:02:33.051567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e32f242-763b-4e10-a488-ac70ac6d57d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc6060>]}
[0m17:02:33.053462 [info ] [Thread-1 (]: 4 of 9 OK created sql view model public_staging.stg_order_payments ............. [[32mSUCCESS[0m in 1.70s]
[0m17:02:33.054525 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_order_payments
[0m17:02:33.055349 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_order_reviews
[0m17:02:33.056159 [info ] [Thread-1 (]: 5 of 9 START sql view model public_staging.stg_order_reviews ................... [RUN]
[0m17:02:33.056890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_order_payments, now model.olist_dbt.stg_order_reviews)
[0m17:02:33.057700 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_order_reviews
[0m17:02:33.062331 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_order_reviews"
[0m17:02:33.063994 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_order_reviews
[0m17:02:33.069966 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_order_reviews"
[0m17:02:33.072674 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:02:33.073141 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: BEGIN
[0m17:02:33.073530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:33.074224 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:02:33.074726 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:02:33.712417 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.638 seconds
[0m17:02:33.714592 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:02:33.715857 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_reviews"} */


  create view "dev"."public_staging"."stg_order_reviews__dbt_tmp" as (
    with source as (
    select *
    from "dev"."public"."order_reviews"
)
select
    review_id,
    order_id,
    review_score,
    review_comment_title,
    review_comment_message,
    review_creation_date,
    review_answer_timestamp
from source
  ) ;
[0m17:02:34.006510 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.289 seconds
[0m17:02:34.018556 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:02:34.019488 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_reviews"} */
alter table "dev"."public_staging"."stg_order_reviews" rename to "stg_order_reviews__dbt_backup"
[0m17:02:34.190951 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.171 seconds
[0m17:02:34.199456 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:02:34.200189 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_reviews"} */
alter table "dev"."public_staging"."stg_order_reviews__dbt_tmp" rename to "stg_order_reviews"
[0m17:02:34.373027 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.172 seconds
[0m17:02:34.379743 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: COMMIT
[0m17:02:34.381168 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:02:34.382246 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: COMMIT
[0m17:02:34.528682 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.145 seconds
[0m17:02:34.531102 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:02:34.532228 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: BEGIN
[0m17:02:34.648682 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.115 seconds
[0m17:02:34.657325 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_order_reviews__dbt_backup"
[0m17:02:34.659590 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:02:34.660345 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_reviews"} */
drop view if exists "dev"."public_staging"."stg_order_reviews__dbt_backup" cascade
[0m17:02:34.777580 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.116 seconds
[0m17:02:34.780919 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: COMMIT
[0m17:02:34.781802 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:02:34.782451 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: COMMIT
[0m17:02:34.865182 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.082 seconds
[0m17:02:34.866626 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:02:34.867656 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: BEGIN
[0m17:02:34.925985 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.057 seconds
[0m17:02:34.928766 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: ROLLBACK
[0m17:02:35.045950 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: Close
[0m17:02:35.048727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e32f242-763b-4e10-a488-ac70ac6d57d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d9f680>]}
[0m17:02:35.050825 [info ] [Thread-1 (]: 5 of 9 OK created sql view model public_staging.stg_order_reviews .............. [[32mSUCCESS[0m in 1.99s]
[0m17:02:35.052198 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_order_reviews
[0m17:02:35.053048 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_orders
[0m17:02:35.053949 [info ] [Thread-1 (]: 6 of 9 START sql table model public_staging.stg_orders ......................... [RUN]
[0m17:02:35.054651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_order_reviews, now model.olist_dbt.stg_orders)
[0m17:02:35.055235 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_orders
[0m17:02:35.060360 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_orders"
[0m17:02:35.061935 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_orders
[0m17:02:35.095397 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_orders"
[0m17:02:35.097882 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:02:35.098221 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m17:02:35.098510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:35.098909 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:02:35.099203 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:02:35.540572 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.441 seconds
[0m17:02:35.542697 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:02:35.544004 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */

  
    

  create  table
    "dev"."public_staging"."stg_orders__dbt_tmp"
    
    
    
  as (
    


-- models/staging/olist/stg_orders.sql
with source as (
    select *
    from "dev"."public"."orders"
)
select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp::timestamp as order_purchase_timestamp,
    order_approved_at::timestamp as order_approved_at,
    order_delivered_carrier_date::timestamp as order_delivered_carrier_date,
    order_delivered_customer_date::timestamp as order_delivered_customer_date,
    order_estimated_delivery_date::timestamp as order_estimated_delivery_date
from source
  );
[0m17:02:35.932124 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.386 seconds
[0m17:02:35.946063 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:02:35.947301 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m17:02:36.185425 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.237 seconds
[0m17:02:36.194004 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:02:36.194729 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m17:02:36.315466 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.120 seconds
[0m17:02:36.327410 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m17:02:36.328247 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:02:36.328774 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m17:02:36.443697 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.114 seconds
[0m17:02:36.444416 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:02:36.444756 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m17:02:36.523607 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.078 seconds
[0m17:02:36.527160 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_orders__dbt_backup"
[0m17:02:36.531995 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:02:36.532446 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
drop table if exists "dev"."public_staging"."stg_orders__dbt_backup" cascade
[0m17:02:36.614253 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.081 seconds
[0m17:02:36.618054 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m17:02:36.619360 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:02:36.620409 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m17:02:36.689384 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.068 seconds
[0m17:02:36.691117 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:02:36.692221 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m17:02:36.732664 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.039 seconds
[0m17:02:36.735234 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: ROLLBACK
[0m17:02:36.814380 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: Close
[0m17:02:36.817069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e32f242-763b-4e10-a488-ac70ac6d57d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f4f320>]}
[0m17:02:36.818900 [info ] [Thread-1 (]: 6 of 9 OK created sql table model public_staging.stg_orders .................... [[32mSUCCESS[0m in 1.76s]
[0m17:02:36.820248 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_orders
[0m17:02:36.821185 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_product_category
[0m17:02:36.821983 [info ] [Thread-1 (]: 7 of 9 START sql view model public_staging.stg_product_category ................ [RUN]
[0m17:02:36.822686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_orders, now model.olist_dbt.stg_product_category)
[0m17:02:36.823497 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_product_category
[0m17:02:36.827964 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_product_category"
[0m17:02:36.829610 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_product_category
[0m17:02:36.835148 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_product_category"
[0m17:02:36.837253 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:02:36.837704 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: BEGIN
[0m17:02:36.838105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:36.838686 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:02:36.839092 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:02:37.389360 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.551 seconds
[0m17:02:37.391462 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:02:37.392597 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_product_category"} */


  create view "dev"."public_staging"."stg_product_category__dbt_tmp" as (
    with source as (
    select *
    from "dev"."public"."product_category"
)
select
    product_category_name_english as product_category
from source
  ) ;
[0m17:02:37.638506 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.245 seconds
[0m17:02:37.646599 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:02:37.647345 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_product_category"} */
alter table "dev"."public_staging"."stg_product_category" rename to "stg_product_category__dbt_backup"
[0m17:02:37.791448 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.143 seconds
[0m17:02:37.801939 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:02:37.802486 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_product_category"} */
alter table "dev"."public_staging"."stg_product_category__dbt_tmp" rename to "stg_product_category"
[0m17:02:37.949215 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.146 seconds
[0m17:02:37.955729 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: COMMIT
[0m17:02:37.957111 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:02:37.957824 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: COMMIT
[0m17:02:38.082475 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.124 seconds
[0m17:02:38.084714 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:02:38.085553 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: BEGIN
[0m17:02:38.184021 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.097 seconds
[0m17:02:38.192882 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_product_category__dbt_backup"
[0m17:02:38.195369 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:02:38.196079 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_product_category"} */
drop view if exists "dev"."public_staging"."stg_product_category__dbt_backup" cascade
[0m17:02:38.296926 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.100 seconds
[0m17:02:38.300855 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: COMMIT
[0m17:02:38.302195 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:02:38.303280 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: COMMIT
[0m17:02:38.378073 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.074 seconds
[0m17:02:38.379638 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:02:38.380657 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: BEGIN
[0m17:02:38.430311 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.048 seconds
[0m17:02:38.433060 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: ROLLBACK
[0m17:02:38.530641 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: Close
[0m17:02:38.533214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e32f242-763b-4e10-a488-ac70ac6d57d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106072570>]}
[0m17:02:38.534777 [info ] [Thread-1 (]: 7 of 9 OK created sql view model public_staging.stg_product_category ........... [[32mSUCCESS[0m in 1.71s]
[0m17:02:38.535960 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_product_category
[0m17:02:38.537033 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_products
[0m17:02:38.538350 [info ] [Thread-1 (]: 8 of 9 START sql view model public_staging.stg_products ........................ [RUN]
[0m17:02:38.539190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_product_category, now model.olist_dbt.stg_products)
[0m17:02:38.539748 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_products
[0m17:02:38.544337 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_products"
[0m17:02:38.545749 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_products
[0m17:02:38.550715 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_products"
[0m17:02:38.558351 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:02:38.558979 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: BEGIN
[0m17:02:38.559402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:38.559949 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:02:38.560372 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:02:39.105236 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.545 seconds
[0m17:02:39.107295 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:02:39.108617 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_products"} */


  create view "dev"."public_staging"."stg_products__dbt_tmp" as (
    with source as (
    select *
    from "dev"."public"."products"
)
select
    product_id,
    product_category_name,
    product_name_length,
    product_description_length,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
from source
  ) ;
[0m17:02:39.357560 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.247 seconds
[0m17:02:39.416367 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:02:39.416833 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_products"} */
alter table "dev"."public_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m17:02:39.562649 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.145 seconds
[0m17:02:39.566652 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: COMMIT
[0m17:02:39.567548 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:02:39.568198 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: COMMIT
[0m17:02:39.693052 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.124 seconds
[0m17:02:39.695606 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:02:39.696802 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: BEGIN
[0m17:02:39.795247 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.097 seconds
[0m17:02:39.804438 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_products__dbt_backup"
[0m17:02:39.807698 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:02:39.808538 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_products"} */
drop view if exists "dev"."public_staging"."stg_products__dbt_backup" cascade
[0m17:02:39.906950 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.097 seconds
[0m17:02:39.911205 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: COMMIT
[0m17:02:39.912709 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:02:39.913770 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: COMMIT
[0m17:02:39.987781 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.073 seconds
[0m17:02:39.989504 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:02:39.990264 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: BEGIN
[0m17:02:40.041579 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.051 seconds
[0m17:02:40.044271 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: ROLLBACK
[0m17:02:40.140745 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: Close
[0m17:02:40.143318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e32f242-763b-4e10-a488-ac70ac6d57d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a3f170>]}
[0m17:02:40.144887 [info ] [Thread-1 (]: 8 of 9 OK created sql view model public_staging.stg_products ................... [[32mSUCCESS[0m in 1.60s]
[0m17:02:40.145980 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_products
[0m17:02:40.147071 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_sellers
[0m17:02:40.148259 [info ] [Thread-1 (]: 9 of 9 START sql view model public_staging.stg_sellers ......................... [RUN]
[0m17:02:40.149247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_products, now model.olist_dbt.stg_sellers)
[0m17:02:40.149925 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_sellers
[0m17:02:40.154515 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_sellers"
[0m17:02:40.156026 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_sellers
[0m17:02:40.161687 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_sellers"
[0m17:02:40.164022 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:02:40.164478 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: BEGIN
[0m17:02:40.164861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:40.165406 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:02:40.165807 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:02:40.713507 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.548 seconds
[0m17:02:40.715626 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:02:40.716901 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_sellers"} */


  create view "dev"."public_staging"."stg_sellers__dbt_tmp" as (
    with source as (
    select *
    from "dev"."public"."sellers"
)
select
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state
from source
  ) ;
[0m17:02:40.963648 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.245 seconds
[0m17:02:40.972475 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:02:40.973207 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_sellers"} */
alter table "dev"."public_staging"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m17:02:41.121349 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.147 seconds
[0m17:02:41.130601 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:02:41.131238 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_sellers"} */
alter table "dev"."public_staging"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m17:02:41.278187 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.146 seconds
[0m17:02:41.283192 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: COMMIT
[0m17:02:41.283983 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:02:41.284509 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: COMMIT
[0m17:02:41.424332 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.139 seconds
[0m17:02:41.425068 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:02:41.425398 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: BEGIN
[0m17:02:41.522531 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.097 seconds
[0m17:02:41.526425 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_sellers__dbt_backup"
[0m17:02:41.528190 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:02:41.528786 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_sellers"} */
drop view if exists "dev"."public_staging"."stg_sellers__dbt_backup" cascade
[0m17:02:41.628459 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.099 seconds
[0m17:02:41.632349 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: COMMIT
[0m17:02:41.633266 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:02:41.633872 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: COMMIT
[0m17:02:41.711613 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.077 seconds
[0m17:02:41.713396 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:02:41.714455 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: BEGIN
[0m17:02:41.764014 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.048 seconds
[0m17:02:41.766926 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: ROLLBACK
[0m17:02:41.863669 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: Close
[0m17:02:41.866251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e32f242-763b-4e10-a488-ac70ac6d57d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f8bf80>]}
[0m17:02:41.868165 [info ] [Thread-1 (]: 9 of 9 OK created sql view model public_staging.stg_sellers .................... [[32mSUCCESS[0m in 1.72s]
[0m17:02:41.869965 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_sellers
[0m17:02:41.872953 [debug] [MainThread]: Using redshift connection "master"
[0m17:02:41.873660 [debug] [MainThread]: On master: BEGIN
[0m17:02:41.874168 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:02:41.874956 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:02:41.875869 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:02:42.424364 [debug] [MainThread]: SQL status: SUCCESS in 0.550 seconds
[0m17:02:42.426375 [debug] [MainThread]: On master: COMMIT
[0m17:02:42.427753 [debug] [MainThread]: Using redshift connection "master"
[0m17:02:42.428256 [debug] [MainThread]: On master: COMMIT
[0m17:02:42.526139 [debug] [MainThread]: SQL status: SUCCESS in 0.097 seconds
[0m17:02:42.528073 [debug] [MainThread]: On master: Close
[0m17:02:42.529916 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:02:42.530803 [debug] [MainThread]: Connection 'model.olist_dbt.stg_sellers' was properly closed.
[0m17:02:42.532028 [info ] [MainThread]: 
[0m17:02:42.532920 [info ] [MainThread]: Finished running 8 view models, 1 table model in 0 hours 0 minutes and 19.00 seconds (19.00s).
[0m17:02:42.536488 [debug] [MainThread]: Command end result
[0m17:02:42.580453 [info ] [MainThread]: 
[0m17:02:42.580931 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:02:42.581234 [info ] [MainThread]: 
[0m17:02:42.581527 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m17:02:42.585251 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.828764, "process_user_time": 3.192864, "process_kernel_time": 0.477281, "process_mem_max_rss": "127336448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:02:42.585813 [debug] [MainThread]: Command `dbt run` succeeded at 17:02:42.585728 after 19.83 seconds
[0m17:02:42.586181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058c41a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043a4f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103637d10>]}
[0m17:02:42.586517 [debug] [MainThread]: Flushing usage events
[0m17:06:10.842342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115d4a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115b3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111607fb0>]}


============================== 17:06:10.846642 | df0c00d9-7158-4092-9f86-13e240a70792 ==============================
[0m17:06:10.846642 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:06:10.847145 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/eranola/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:06:11.018926 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:06:11.019365 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:06:11.144422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df0c00d9-7158-4092-9f86-13e240a70792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cf6e70>]}
[0m17:06:11.181918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df0c00d9-7158-4092-9f86-13e240a70792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ca0410>]}
[0m17:06:11.183214 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m17:06:11.199499 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:06:11.259846 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:06:11.260327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'df0c00d9-7158-4092-9f86-13e240a70792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cc3350>]}
[0m17:06:12.180831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df0c00d9-7158-4092-9f86-13e240a70792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11321cb00>]}
[0m17:06:12.243058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df0c00d9-7158-4092-9f86-13e240a70792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132a40b0>]}
[0m17:06:12.243479 [info ] [MainThread]: Found 9 models, 10 sources, 488 macros
[0m17:06:12.243766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df0c00d9-7158-4092-9f86-13e240a70792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b57ef0>]}
[0m17:06:12.245318 [info ] [MainThread]: 
[0m17:06:12.245768 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:06:12.248790 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m17:06:12.261620 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m17:06:12.262023 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m17:06:12.262273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:12.265375 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:06:12.266267 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:06:12.848328 [debug] [ThreadPool]: SQL status: SUCCESS in 0.586 seconds
[0m17:06:12.854976 [debug] [ThreadPool]: On list_dev: Close
[0m17:06:12.858145 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public_staging)
[0m17:06:12.869696 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:06:12.870193 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m17:06:12.870554 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:06:12.871108 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:06:12.871495 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:06:13.419354 [debug] [ThreadPool]: SQL status: SUCCESS in 0.549 seconds
[0m17:06:13.420021 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:06:13.420458 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m17:06:13.536814 [debug] [ThreadPool]: SQL status: SUCCESS in 0.116 seconds
[0m17:06:13.541563 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m17:06:13.638144 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m17:06:13.656785 [debug] [MainThread]: Using redshift connection "master"
[0m17:06:13.657399 [debug] [MainThread]: On master: BEGIN
[0m17:06:13.657822 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:06:13.658432 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:06:13.658881 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:06:14.305072 [debug] [MainThread]: SQL status: SUCCESS in 0.647 seconds
[0m17:06:14.306727 [debug] [MainThread]: Using redshift connection "master"
[0m17:06:14.307966 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:06:14.485889 [debug] [MainThread]: SQL status: SUCCESS in 0.176 seconds
[0m17:06:14.490733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df0c00d9-7158-4092-9f86-13e240a70792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071a1430>]}
[0m17:06:14.491841 [debug] [MainThread]: On master: ROLLBACK
[0m17:06:14.606237 [debug] [MainThread]: Using redshift connection "master"
[0m17:06:14.606780 [debug] [MainThread]: On master: BEGIN
[0m17:06:14.663942 [debug] [MainThread]: SQL status: SUCCESS in 0.057 seconds
[0m17:06:14.664520 [debug] [MainThread]: On master: COMMIT
[0m17:06:14.664946 [debug] [MainThread]: Using redshift connection "master"
[0m17:06:14.665244 [debug] [MainThread]: On master: COMMIT
[0m17:06:14.779244 [debug] [MainThread]: SQL status: SUCCESS in 0.113 seconds
[0m17:06:14.780665 [debug] [MainThread]: On master: Close
[0m17:06:14.782678 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:06:14.783287 [info ] [MainThread]: 
[0m17:06:14.788889 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_customers
[0m17:06:14.789778 [info ] [Thread-1 (]: 1 of 9 START sql table model public_staging.stg_customers ...................... [RUN]
[0m17:06:14.790530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now model.olist_dbt.stg_customers)
[0m17:06:14.791187 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_customers
[0m17:06:14.795378 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_customers"
[0m17:06:14.797406 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_customers
[0m17:06:14.841520 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_customers"
[0m17:06:14.843573 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:06:14.843896 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: BEGIN
[0m17:06:14.844155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:14.844517 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:06:14.844786 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:06:15.466553 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.622 seconds
[0m17:06:15.467717 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:06:15.468539 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_customers"} */

  
    

  create  table
    "dev"."public_staging"."stg_customers__dbt_tmp"
    
    
    
  as (
    with source as (
    select *
    from "dev"."public"."customer"
)
select
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state
from source
  );
[0m17:06:25.563852 [debug] [Thread-1 (]: SQL status: SUCCESS in 10.094 seconds
[0m17:06:25.579177 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:06:25.579916 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_customers"} */
alter table "dev"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:06:25.924901 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.344 seconds
[0m17:06:25.950417 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: COMMIT
[0m17:06:25.950902 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:06:25.951191 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: COMMIT
[0m17:06:26.130522 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.178 seconds
[0m17:06:26.133024 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:06:26.133890 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: BEGIN
[0m17:06:26.250730 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.116 seconds
[0m17:06:26.265721 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_customers__dbt_backup"
[0m17:06:26.271460 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:06:26.271928 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_customers"} */
drop table if exists "dev"."public_staging"."stg_customers__dbt_backup" cascade
[0m17:06:26.387584 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.115 seconds
[0m17:06:26.390841 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: COMMIT
[0m17:06:26.392054 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:06:26.392721 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: COMMIT
[0m17:06:26.465359 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.072 seconds
[0m17:06:26.466247 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:06:26.466764 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: BEGIN
[0m17:06:26.524612 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.057 seconds
[0m17:06:26.529654 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: ROLLBACK
[0m17:06:26.644895 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: Close
[0m17:06:26.651377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df0c00d9-7158-4092-9f86-13e240a70792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071387d0>]}
[0m17:06:26.652870 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public_staging.stg_customers ................. [[32mSUCCESS[0m in 11.86s]
[0m17:06:26.654352 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_customers
[0m17:06:26.655223 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_geolocation
[0m17:06:26.656434 [info ] [Thread-1 (]: 2 of 9 START sql table model public_staging.stg_geolocation .................... [RUN]
[0m17:06:26.657414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_customers, now model.olist_dbt.stg_geolocation)
[0m17:06:26.657980 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_geolocation
[0m17:06:26.662588 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_geolocation"
[0m17:06:26.664435 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_geolocation
[0m17:06:26.676005 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_geolocation"
[0m17:06:26.678507 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:06:26.678959 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: BEGIN
[0m17:06:26.679314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:26.679920 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:06:26.680276 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:06:27.229259 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.549 seconds
[0m17:06:27.231379 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:06:27.232636 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_geolocation"} */

  
    

  create  table
    "dev"."public_staging"."stg_geolocation__dbt_tmp"
    
    
    
  as (
    with source as (
    select *
    from "dev"."public"."geolocation"
)
select
    geolocation_zip_code_prefix,
    geolocation_lat,
    geolocation_lng,
    geolocation_city,
    geolocation_state
from source
  );
[0m17:06:43.893826 [debug] [Thread-1 (]: SQL status: SUCCESS in 16.660 seconds
[0m17:06:43.903155 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:06:43.903977 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_geolocation"} */
alter table "dev"."public_staging"."stg_geolocation__dbt_tmp" rename to "stg_geolocation"
[0m17:06:44.192842 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.288 seconds
[0m17:06:44.198007 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: COMMIT
[0m17:06:44.199195 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:06:44.199765 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: COMMIT
[0m17:06:44.329104 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.128 seconds
[0m17:06:44.331884 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:06:44.332977 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: BEGIN
[0m17:06:44.433492 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.099 seconds
[0m17:06:44.438101 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_geolocation__dbt_backup"
[0m17:06:44.439888 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:06:44.440518 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_geolocation"} */
drop table if exists "dev"."public_staging"."stg_geolocation__dbt_backup" cascade
[0m17:06:44.538806 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.097 seconds
[0m17:06:44.543180 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: COMMIT
[0m17:06:44.544372 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:06:44.545062 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: COMMIT
[0m17:06:44.601119 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.055 seconds
[0m17:06:44.602397 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:06:44.603127 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: BEGIN
[0m17:06:44.651423 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.048 seconds
[0m17:06:44.653076 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: ROLLBACK
[0m17:06:44.750685 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: Close
[0m17:06:44.754109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df0c00d9-7158-4092-9f86-13e240a70792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137b0800>]}
[0m17:06:44.755882 [info ] [Thread-1 (]: 2 of 9 OK created sql table model public_staging.stg_geolocation ............... [[32mSUCCESS[0m in 18.10s]
[0m17:06:44.757403 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_geolocation
[0m17:06:44.758232 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_order_items
[0m17:06:44.759296 [info ] [Thread-1 (]: 3 of 9 START sql table model public_staging.stg_order_items .................... [RUN]
[0m17:06:44.760088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_geolocation, now model.olist_dbt.stg_order_items)
[0m17:06:44.760667 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_order_items
[0m17:06:44.764913 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_order_items"
[0m17:06:44.766898 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_order_items
[0m17:06:44.771947 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_order_items"
[0m17:06:44.774594 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:06:44.775085 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: BEGIN
[0m17:06:44.775477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:44.776054 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:06:44.776464 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:06:45.333640 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.557 seconds
[0m17:06:45.335617 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:06:45.336877 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_items"} */

  
    

  create  table
    "dev"."public_staging"."stg_order_items__dbt_tmp"
    
    
    
  as (
    with source as (
    select *
    from "dev"."public"."order_items"
)
select
    order_id,
    order_item_id,
    product_id,
    seller_id,
    shipping_limit_date,
    price,
    freight_value
    
from source
  );
[0m17:06:55.363199 [debug] [Thread-1 (]: SQL status: SUCCESS in 10.025 seconds
[0m17:06:55.374864 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:06:55.375618 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_items"} */
alter table "dev"."public_staging"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m17:06:55.612740 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.236 seconds
[0m17:06:55.619087 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: COMMIT
[0m17:06:55.620235 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:06:55.620931 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: COMMIT
[0m17:06:55.734620 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.113 seconds
[0m17:06:55.736745 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:06:55.737875 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: BEGIN
[0m17:06:55.818577 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.079 seconds
[0m17:06:55.826457 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_order_items__dbt_backup"
[0m17:06:55.828842 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:06:55.829581 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_items"} */
drop table if exists "dev"."public_staging"."stg_order_items__dbt_backup" cascade
[0m17:06:55.911334 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.081 seconds
[0m17:06:55.915142 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: COMMIT
[0m17:06:55.916535 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:06:55.917599 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: COMMIT
[0m17:06:55.966375 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.048 seconds
[0m17:06:55.967866 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:06:55.968800 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: BEGIN
[0m17:06:56.010427 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.041 seconds
[0m17:06:56.013517 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: ROLLBACK
[0m17:06:56.095536 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: Close
[0m17:06:56.097705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df0c00d9-7158-4092-9f86-13e240a70792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132a4ec0>]}
[0m17:06:56.099481 [info ] [Thread-1 (]: 3 of 9 OK created sql table model public_staging.stg_order_items ............... [[32mSUCCESS[0m in 11.34s]
[0m17:06:56.100844 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_order_items
[0m17:06:56.101652 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_order_payments
[0m17:06:56.102550 [info ] [Thread-1 (]: 4 of 9 START sql table model public_staging.stg_order_payments ................. [RUN]
[0m17:06:56.103368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_order_items, now model.olist_dbt.stg_order_payments)
[0m17:06:56.103975 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_order_payments
[0m17:06:56.108541 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_order_payments"
[0m17:06:56.109926 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_order_payments
[0m17:06:56.115130 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_order_payments"
[0m17:06:56.117453 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:06:56.117942 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: BEGIN
[0m17:06:56.118342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:56.118895 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:06:56.119294 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:06:56.671749 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.553 seconds
[0m17:06:56.673862 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:06:56.675045 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_payments"} */

  
    

  create  table
    "dev"."public_staging"."stg_order_payments__dbt_tmp"
    
    
    
  as (
    with source as (
    select *
    from "dev"."public"."order_payments"
)
select
    order_id,
    payment_sequential,
    payment_type,
    payment_installments,
    payment_value
from source
  );
[0m17:07:10.417350 [debug] [Thread-1 (]: SQL status: SUCCESS in 13.741 seconds
[0m17:07:10.434750 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:07:10.435465 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_payments"} */
alter table "dev"."public_staging"."stg_order_payments__dbt_tmp" rename to "stg_order_payments"
[0m17:07:10.723012 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.287 seconds
[0m17:07:10.728091 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: COMMIT
[0m17:07:10.728980 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:07:10.729950 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: COMMIT
[0m17:07:10.878133 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.147 seconds
[0m17:07:10.880375 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:07:10.881258 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: BEGIN
[0m17:07:10.978259 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.096 seconds
[0m17:07:10.985988 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_order_payments__dbt_backup"
[0m17:07:10.987731 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:07:10.988293 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_payments"} */
drop table if exists "dev"."public_staging"."stg_order_payments__dbt_backup" cascade
[0m17:07:11.084774 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.096 seconds
[0m17:07:11.088457 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: COMMIT
[0m17:07:11.089527 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:07:11.090292 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: COMMIT
[0m17:07:11.146264 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.055 seconds
[0m17:07:11.148330 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:07:11.149466 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: BEGIN
[0m17:07:11.198229 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.048 seconds
[0m17:07:11.201081 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: ROLLBACK
[0m17:07:11.300188 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: Close
[0m17:07:11.302716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df0c00d9-7158-4092-9f86-13e240a70792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137ff950>]}
[0m17:07:11.304309 [info ] [Thread-1 (]: 4 of 9 OK created sql table model public_staging.stg_order_payments ............ [[32mSUCCESS[0m in 15.20s]
[0m17:07:11.305435 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_order_payments
[0m17:07:11.306459 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_order_reviews
[0m17:07:11.307600 [info ] [Thread-1 (]: 5 of 9 START sql table model public_staging.stg_order_reviews .................. [RUN]
[0m17:07:11.308622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_order_payments, now model.olist_dbt.stg_order_reviews)
[0m17:07:11.309361 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_order_reviews
[0m17:07:11.313396 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_order_reviews"
[0m17:07:11.315067 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_order_reviews
[0m17:07:11.321286 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_order_reviews"
[0m17:07:11.323983 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:07:11.324454 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: BEGIN
[0m17:07:11.324846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:11.325387 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:07:11.325808 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:07:11.879007 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.554 seconds
[0m17:07:11.880768 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:07:11.881899 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_reviews"} */

  
    

  create  table
    "dev"."public_staging"."stg_order_reviews__dbt_tmp"
    
    
    
  as (
    with source as (
    select *
    from "dev"."public"."order_reviews"
)
select
    review_id,
    order_id,
    review_score,
    review_comment_title,
    review_comment_message,
    review_creation_date,
    review_answer_timestamp
from source
  );
[0m17:07:21.064938 [debug] [Thread-1 (]: SQL status: SUCCESS in 9.182 seconds
[0m17:07:21.074457 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:07:21.075284 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_reviews"} */
alter table "dev"."public_staging"."stg_order_reviews__dbt_tmp" rename to "stg_order_reviews"
[0m17:07:21.363104 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.287 seconds
[0m17:07:21.369334 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: COMMIT
[0m17:07:21.370230 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:07:21.370740 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: COMMIT
[0m17:07:21.498938 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.127 seconds
[0m17:07:21.501622 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:07:21.502717 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: BEGIN
[0m17:07:21.601049 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.097 seconds
[0m17:07:21.607484 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_order_reviews__dbt_backup"
[0m17:07:21.609486 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:07:21.610021 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_reviews"} */
drop table if exists "dev"."public_staging"."stg_order_reviews__dbt_backup" cascade
[0m17:07:21.708586 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.098 seconds
[0m17:07:21.712166 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: COMMIT
[0m17:07:21.712995 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:07:21.713717 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: COMMIT
[0m17:07:21.768990 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.054 seconds
[0m17:07:21.770717 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:07:21.771787 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: BEGIN
[0m17:07:21.820942 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.048 seconds
[0m17:07:21.823654 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: ROLLBACK
[0m17:07:21.921836 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: Close
[0m17:07:21.924752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df0c00d9-7158-4092-9f86-13e240a70792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137ff200>]}
[0m17:07:21.926373 [info ] [Thread-1 (]: 5 of 9 OK created sql table model public_staging.stg_order_reviews ............. [[32mSUCCESS[0m in 10.62s]
[0m17:07:21.927457 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_order_reviews
[0m17:07:21.928153 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_orders
[0m17:07:21.928977 [info ] [Thread-1 (]: 6 of 9 START sql table model public_staging.stg_orders ......................... [RUN]
[0m17:07:21.929960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_order_reviews, now model.olist_dbt.stg_orders)
[0m17:07:21.930680 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_orders
[0m17:07:21.935455 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_orders"
[0m17:07:21.937209 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_orders
[0m17:07:21.942781 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_orders"
[0m17:07:21.945983 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:07:21.946453 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m17:07:21.946865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:21.947440 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:07:21.947847 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:07:22.589454 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.642 seconds
[0m17:07:22.591652 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:07:22.592906 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */

  
    

  create  table
    "dev"."public_staging"."stg_orders__dbt_tmp"
    
    
    
  as (
    


-- models/staging/olist/stg_orders.sql
with source as (
    select *
    from "dev"."public"."orders"
)
select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp::timestamp as order_purchase_timestamp,
    order_approved_at::timestamp as order_approved_at,
    order_delivered_carrier_date::timestamp as order_delivered_carrier_date,
    order_delivered_customer_date::timestamp as order_delivered_customer_date,
    order_estimated_delivery_date::timestamp as order_estimated_delivery_date
from source
  );
[0m17:07:23.112262 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.518 seconds
[0m17:07:23.118770 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:07:23.119533 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m17:07:23.458595 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.338 seconds
[0m17:07:23.463305 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m17:07:23.464259 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:07:23.464783 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m17:07:23.634540 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.169 seconds
[0m17:07:23.636887 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:07:23.637960 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m17:07:23.753402 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.114 seconds
[0m17:07:23.770742 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_orders__dbt_backup"
[0m17:07:23.772393 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:07:23.772930 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
drop table if exists "dev"."public_staging"."stg_orders__dbt_backup" cascade
[0m17:07:23.888013 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.114 seconds
[0m17:07:23.891908 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m17:07:23.893233 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:07:23.894321 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m17:07:23.959384 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.064 seconds
[0m17:07:23.960892 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:07:23.961699 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m17:07:24.018653 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.056 seconds
[0m17:07:24.021495 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: ROLLBACK
[0m17:07:24.140207 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: Close
[0m17:07:24.143070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df0c00d9-7158-4092-9f86-13e240a70792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b18d70>]}
[0m17:07:24.144769 [info ] [Thread-1 (]: 6 of 9 OK created sql table model public_staging.stg_orders .................... [[32mSUCCESS[0m in 2.21s]
[0m17:07:24.145999 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_orders
[0m17:07:24.146866 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_product_category
[0m17:07:24.147649 [info ] [Thread-1 (]: 7 of 9 START sql table model public_staging.stg_product_category ............... [RUN]
[0m17:07:24.148299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_orders, now model.olist_dbt.stg_product_category)
[0m17:07:24.148944 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_product_category
[0m17:07:24.153547 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_product_category"
[0m17:07:24.155341 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_product_category
[0m17:07:24.160480 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_product_category"
[0m17:07:24.162948 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:07:24.163476 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: BEGIN
[0m17:07:24.163958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:24.164652 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:07:24.165075 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:07:24.799254 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.635 seconds
[0m17:07:24.801529 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:07:24.802508 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_product_category"} */

  
    

  create  table
    "dev"."public_staging"."stg_product_category__dbt_tmp"
    
    
    
  as (
    with source as (
    select *
    from "dev"."public"."product_category"
)
select
    product_category_name_english as product_category
from source
  );
[0m17:07:29.359847 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.556 seconds
[0m17:07:29.372529 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:07:29.373570 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_product_category"} */
alter table "dev"."public_staging"."stg_product_category__dbt_tmp" rename to "stg_product_category"
[0m17:07:29.716021 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.341 seconds
[0m17:07:29.719450 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: COMMIT
[0m17:07:29.720277 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:07:29.720750 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: COMMIT
[0m17:07:29.872575 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.151 seconds
[0m17:07:29.874594 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:07:29.875700 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: BEGIN
[0m17:07:29.993435 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.116 seconds
[0m17:07:30.001180 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_product_category__dbt_backup"
[0m17:07:30.003436 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:07:30.004039 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_product_category"} */
drop table if exists "dev"."public_staging"."stg_product_category__dbt_backup" cascade
[0m17:07:30.120565 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.116 seconds
[0m17:07:30.124300 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: COMMIT
[0m17:07:30.125647 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:07:30.126702 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: COMMIT
[0m17:07:30.192076 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.064 seconds
[0m17:07:30.193557 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:07:30.194198 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: BEGIN
[0m17:07:30.251972 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.057 seconds
[0m17:07:30.254999 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: ROLLBACK
[0m17:07:30.370905 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: Close
[0m17:07:30.373838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df0c00d9-7158-4092-9f86-13e240a70792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137a8890>]}
[0m17:07:30.375704 [info ] [Thread-1 (]: 7 of 9 OK created sql table model public_staging.stg_product_category .......... [[32mSUCCESS[0m in 6.23s]
[0m17:07:30.377027 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_product_category
[0m17:07:30.377952 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_products
[0m17:07:30.378879 [info ] [Thread-1 (]: 8 of 9 START sql table model public_staging.stg_products ....................... [RUN]
[0m17:07:30.379581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_product_category, now model.olist_dbt.stg_products)
[0m17:07:30.380157 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_products
[0m17:07:30.385760 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_products"
[0m17:07:30.387608 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_products
[0m17:07:30.392904 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_products"
[0m17:07:30.395996 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:07:30.396525 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: BEGIN
[0m17:07:30.396919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:30.397463 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:07:30.397891 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:07:30.856223 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.459 seconds
[0m17:07:30.858258 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:07:30.859296 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_products"} */

  
    

  create  table
    "dev"."public_staging"."stg_products__dbt_tmp"
    
    
    
  as (
    with source as (
    select *
    from "dev"."public"."products"
)
select
    product_id,
    product_category_name,
    product_name_length,
    product_description_length,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
from source
  );
[0m17:07:39.907098 [debug] [Thread-1 (]: SQL status: SUCCESS in 9.047 seconds
[0m17:07:39.917653 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:07:39.918433 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_products"} */
alter table "dev"."public_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m17:07:40.152980 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.234 seconds
[0m17:07:40.158621 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: COMMIT
[0m17:07:40.159392 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:07:40.159905 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: COMMIT
[0m17:07:40.267189 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.107 seconds
[0m17:07:40.268986 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:07:40.270057 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: BEGIN
[0m17:07:40.351448 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.080 seconds
[0m17:07:40.359964 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_products__dbt_backup"
[0m17:07:40.362751 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:07:40.363560 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_products"} */
drop table if exists "dev"."public_staging"."stg_products__dbt_backup" cascade
[0m17:07:40.445699 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.081 seconds
[0m17:07:40.449402 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: COMMIT
[0m17:07:40.450589 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:07:40.451300 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: COMMIT
[0m17:07:40.498186 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.046 seconds
[0m17:07:40.499836 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:07:40.500772 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: BEGIN
[0m17:07:40.541196 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.040 seconds
[0m17:07:40.543696 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: ROLLBACK
[0m17:07:40.623223 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: Close
[0m17:07:40.625656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df0c00d9-7158-4092-9f86-13e240a70792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b143b0>]}
[0m17:07:40.627733 [info ] [Thread-1 (]: 8 of 9 OK created sql table model public_staging.stg_products .................. [[32mSUCCESS[0m in 10.25s]
[0m17:07:40.629157 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_products
[0m17:07:40.630020 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_sellers
[0m17:07:40.631233 [info ] [Thread-1 (]: 9 of 9 START sql table model public_staging.stg_sellers ........................ [RUN]
[0m17:07:40.632333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_products, now model.olist_dbt.stg_sellers)
[0m17:07:40.633062 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_sellers
[0m17:07:40.637569 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_sellers"
[0m17:07:40.639436 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_sellers
[0m17:07:40.651054 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_sellers"
[0m17:07:40.654527 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:07:40.655432 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: BEGIN
[0m17:07:40.655908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:40.656565 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:07:40.656985 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:07:41.203860 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.547 seconds
[0m17:07:41.206070 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:07:41.207313 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_sellers"} */

  
    

  create  table
    "dev"."public_staging"."stg_sellers__dbt_tmp"
    
    
    
  as (
    with source as (
    select *
    from "dev"."public"."sellers"
)
select
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state
from source
  );
[0m17:07:50.350512 [debug] [Thread-1 (]: SQL status: SUCCESS in 9.142 seconds
[0m17:07:50.358959 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:07:50.360218 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_sellers"} */
alter table "dev"."public_staging"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m17:07:50.649483 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.288 seconds
[0m17:07:50.654861 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: COMMIT
[0m17:07:50.655903 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:07:50.656408 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: COMMIT
[0m17:07:50.792789 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.136 seconds
[0m17:07:50.794546 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:07:50.795259 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: BEGIN
[0m17:07:50.894819 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.098 seconds
[0m17:07:50.900115 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_sellers__dbt_backup"
[0m17:07:50.903157 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:07:50.904419 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_sellers"} */
drop table if exists "dev"."public_staging"."stg_sellers__dbt_backup" cascade
[0m17:07:51.002766 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.097 seconds
[0m17:07:51.005909 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: COMMIT
[0m17:07:51.006870 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:07:51.007430 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: COMMIT
[0m17:07:51.063486 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.055 seconds
[0m17:07:51.065027 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:07:51.065895 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: BEGIN
[0m17:07:51.114430 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.048 seconds
[0m17:07:51.116911 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: ROLLBACK
[0m17:07:51.214243 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: Close
[0m17:07:51.216464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df0c00d9-7158-4092-9f86-13e240a70792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b37bc0>]}
[0m17:07:51.217955 [info ] [Thread-1 (]: 9 of 9 OK created sql table model public_staging.stg_sellers ................... [[32mSUCCESS[0m in 10.58s]
[0m17:07:51.219148 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_sellers
[0m17:07:51.220829 [debug] [MainThread]: Using redshift connection "master"
[0m17:07:51.221358 [debug] [MainThread]: On master: BEGIN
[0m17:07:51.221785 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:07:51.222610 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:07:51.223554 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:07:51.861116 [debug] [MainThread]: SQL status: SUCCESS in 0.639 seconds
[0m17:07:51.862858 [debug] [MainThread]: On master: COMMIT
[0m17:07:51.864071 [debug] [MainThread]: Using redshift connection "master"
[0m17:07:51.864794 [debug] [MainThread]: On master: COMMIT
[0m17:07:51.978809 [debug] [MainThread]: SQL status: SUCCESS in 0.113 seconds
[0m17:07:51.980088 [debug] [MainThread]: On master: Close
[0m17:07:51.981253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:51.981779 [debug] [MainThread]: Connection 'model.olist_dbt.stg_sellers' was properly closed.
[0m17:07:51.982584 [info ] [MainThread]: 
[0m17:07:51.983363 [info ] [MainThread]: Finished running 9 table models in 0 hours 1 minutes and 39.74 seconds (99.74s).
[0m17:07:51.989863 [debug] [MainThread]: Command end result
[0m17:07:52.031029 [info ] [MainThread]: 
[0m17:07:52.031504 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:07:52.031814 [info ] [MainThread]: 
[0m17:07:52.032108 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m17:07:52.034731 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 101.251884, "process_user_time": 3.734714, "process_kernel_time": 0.473563, "process_mem_max_rss": "125911040", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:07:52.035282 [debug] [MainThread]: Command `dbt run` succeeded at 17:07:52.035200 after 101.25 seconds
[0m17:07:52.035672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110508f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c56210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104caacc0>]}
[0m17:07:52.035999 [debug] [MainThread]: Flushing usage events
[0m21:10:32.517759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fdc980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109807fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109807f20>]}


============================== 21:10:32.522209 | 9d1daf47-fa49-4b80-8889-2e8a0862874a ==============================
[0m21:10:32.522209 [info ] [MainThread]: Running with dbt=1.8.6
[0m21:10:32.522769 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select user_summary.sql', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:10:32.705647 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m21:10:32.706093 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m21:10:33.116796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d1daf47-fa49-4b80-8889-2e8a0862874a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b12360>]}
[0m21:10:33.154669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d1daf47-fa49-4b80-8889-2e8a0862874a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109610f80>]}
[0m21:10:33.157714 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m21:10:33.210300 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m21:10:33.272333 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:10:33.272801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9d1daf47-fa49-4b80-8889-2e8a0862874a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10934b350>]}
[0m21:10:34.203242 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.olist_dbt.marts.olist
[0m21:10:34.211756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d1daf47-fa49-4b80-8889-2e8a0862874a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3a2c90>]}
[0m21:10:34.415585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d1daf47-fa49-4b80-8889-2e8a0862874a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2fa480>]}
[0m21:10:34.417788 [info ] [MainThread]: Found 11 models, 10 sources, 488 macros
[0m21:10:34.418989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d1daf47-fa49-4b80-8889-2e8a0862874a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0d2330>]}
[0m21:10:34.422051 [info ] [MainThread]: 
[0m21:10:34.424367 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:10:34.426334 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m21:10:34.485350 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m21:10:34.487083 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m21:10:34.487829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:10:34.497069 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:10:34.499610 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:10:35.442351 [debug] [ThreadPool]: SQL status: SUCCESS in 0.954 seconds
[0m21:10:35.447138 [debug] [ThreadPool]: On list_dev: Close
[0m21:10:35.455022 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public_staging)
[0m21:10:35.466114 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m21:10:35.466805 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m21:10:35.467150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:10:35.467652 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:10:35.468020 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:10:36.376820 [debug] [ThreadPool]: SQL status: SUCCESS in 0.909 seconds
[0m21:10:36.378642 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m21:10:36.379464 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m21:10:36.574586 [debug] [ThreadPool]: SQL status: SUCCESS in 0.194 seconds
[0m21:10:36.580233 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m21:10:36.743340 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m21:10:36.746601 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_staging, now list_dev_public)
[0m21:10:36.757662 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m21:10:36.758288 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m21:10:36.758715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:10:36.759348 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:10:36.759803 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:10:37.727343 [debug] [ThreadPool]: SQL status: SUCCESS in 0.968 seconds
[0m21:10:37.729257 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m21:10:37.730353 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m21:10:38.059231 [debug] [ThreadPool]: SQL status: SUCCESS in 0.328 seconds
[0m21:10:38.065547 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m21:10:38.227265 [debug] [ThreadPool]: On list_dev_public: Close
[0m21:10:38.245889 [debug] [MainThread]: Using redshift connection "master"
[0m21:10:38.246499 [debug] [MainThread]: On master: BEGIN
[0m21:10:38.246920 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:10:38.247519 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:10:38.247949 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:10:39.585728 [debug] [MainThread]: SQL status: SUCCESS in 1.338 seconds
[0m21:10:39.587517 [debug] [MainThread]: Using redshift connection "master"
[0m21:10:39.589046 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m21:10:39.779918 [debug] [MainThread]: SQL status: SUCCESS in 0.190 seconds
[0m21:10:39.782448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d1daf47-fa49-4b80-8889-2e8a0862874a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f09e20>]}
[0m21:10:39.783154 [debug] [MainThread]: On master: ROLLBACK
[0m21:10:40.263589 [debug] [MainThread]: Using redshift connection "master"
[0m21:10:40.265041 [debug] [MainThread]: On master: BEGIN
[0m21:10:40.328913 [debug] [MainThread]: SQL status: SUCCESS in 0.063 seconds
[0m21:10:40.330547 [debug] [MainThread]: On master: COMMIT
[0m21:10:40.331938 [debug] [MainThread]: Using redshift connection "master"
[0m21:10:40.332883 [debug] [MainThread]: On master: COMMIT
[0m21:10:40.786432 [debug] [MainThread]: SQL status: SUCCESS in 0.452 seconds
[0m21:10:40.788151 [debug] [MainThread]: On master: Close
[0m21:10:40.790268 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:10:40.791343 [info ] [MainThread]: 
[0m21:10:40.798214 [debug] [Thread-1 (]: Began running node model.olist_dbt.user_summary
[0m21:10:40.799618 [info ] [Thread-1 (]: 1 of 1 START sql view model public.user_summary ................................ [RUN]
[0m21:10:40.800416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.olist_dbt.user_summary)
[0m21:10:40.800987 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.user_summary
[0m21:10:40.807773 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.user_summary"
[0m21:10:40.810022 [debug] [Thread-1 (]: Began executing node model.olist_dbt.user_summary
[0m21:10:40.847373 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.user_summary"
[0m21:10:40.850442 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.user_summary"
[0m21:10:40.850765 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: BEGIN
[0m21:10:40.851027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:10:40.851389 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:10:40.851653 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:10:41.701694 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.850 seconds
[0m21:10:41.703646 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.user_summary"
[0m21:10:41.705074 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.user_summary"} */


  create view "dev"."public"."user_summary__dbt_tmp" as (
    select
    c.customer_id,
    
    -- Count distinct orders per customer
    count(distinct o.order_id) as lifetime_order_count,
    
    -- Calculate the total sales value (price * quantity) for each customer
    sum(oi.price * oi.quantity) as lifetime_sales_value,
    
    -- Count the unique product categories purchased by the customer
    count(distinct p.product_category_name) as unique_categories_purchased

-- Join customers with orders
from "dev"."public_staging"."stg_customers" c
left join "dev"."public_staging"."stg_orders" o on c.customer_id = o.customer_id

-- Join orders with order items
left join "dev"."public_staging"."stg_order_items" oi on o.order_id = oi.order_id

-- Join order items with product categories
left join "dev"."public_staging"."stg_products" p on oi.product_id = p.product_id

-- Group by customer to get individual lifetime statistics
group by c.customer_id;
  ) ;
[0m21:10:41.771188 [debug] [Thread-1 (]: Redshift adapter: Redshift error: syntax error at or near ";" in context "c.customer_id;", at line 28, column 23
[0m21:10:41.773210 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: ROLLBACK
[0m21:10:42.326841 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: Close
[0m21:10:42.340088 [debug] [Thread-1 (]: Database Error in model user_summary (models/marts/user_summary.sql)
  syntax error at or near ";" in context "c.customer_id;", at line 28, column 23
  compiled Code at target/run/olist_dbt/models/marts/user_summary.sql
[0m21:10:42.342455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d1daf47-fa49-4b80-8889-2e8a0862874a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096137d0>]}
[0m21:10:42.343437 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.user_summary ....................... [[31mERROR[0m in 1.54s]
[0m21:10:42.344320 [debug] [Thread-1 (]: Finished running node model.olist_dbt.user_summary
[0m21:10:42.346766 [debug] [MainThread]: Using redshift connection "master"
[0m21:10:42.347345 [debug] [MainThread]: On master: BEGIN
[0m21:10:42.347813 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:10:42.348463 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:10:42.348859 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:10:43.835914 [debug] [MainThread]: SQL status: SUCCESS in 1.488 seconds
[0m21:10:43.837611 [debug] [MainThread]: On master: COMMIT
[0m21:10:43.839181 [debug] [MainThread]: Using redshift connection "master"
[0m21:10:43.840160 [debug] [MainThread]: On master: COMMIT
[0m21:10:44.769657 [debug] [MainThread]: SQL status: SUCCESS in 0.928 seconds
[0m21:10:44.770977 [debug] [MainThread]: On master: Close
[0m21:10:44.772563 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:10:44.773193 [debug] [MainThread]: Connection 'model.olist_dbt.user_summary' was properly closed.
[0m21:10:44.773850 [info ] [MainThread]: 
[0m21:10:44.774686 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.35 seconds (10.35s).
[0m21:10:44.776336 [debug] [MainThread]: Command end result
[0m21:10:44.819737 [info ] [MainThread]: 
[0m21:10:44.820210 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:10:44.820477 [info ] [MainThread]: 
[0m21:10:44.820782 [error] [MainThread]:   Database Error in model user_summary (models/marts/user_summary.sql)
  syntax error at or near ";" in context "c.customer_id;", at line 28, column 23
  compiled Code at target/run/olist_dbt/models/marts/user_summary.sql
[0m21:10:44.821015 [info ] [MainThread]: 
[0m21:10:44.821258 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:10:44.863981 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.404703, "process_user_time": 2.844224, "process_kernel_time": 0.573134, "process_mem_max_rss": "126517248", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:10:44.864648 [debug] [MainThread]: Command `dbt run` failed at 21:10:44.864562 after 12.41 seconds
[0m21:10:44.865024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108951a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa19a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa2330>]}
[0m21:10:44.865334 [debug] [MainThread]: Flushing usage events
[0m21:13:34.274691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040ab4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a7fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a7e90>]}


============================== 21:13:34.279221 | d3fe164d-7de1-44d3-877e-44244e1695dd ==============================
[0m21:13:34.279221 [info ] [MainThread]: Running with dbt=1.8.6
[0m21:13:34.279772 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select user_summary.sql', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:13:34.453468 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m21:13:34.453900 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m21:13:34.588908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3fe164d-7de1-44d3-877e-44244e1695dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c69ac0>]}
[0m21:13:34.626437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3fe164d-7de1-44d3-877e-44244e1695dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10649dc40>]}
[0m21:13:34.628218 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m21:13:34.645201 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m21:13:34.764547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:13:34.764917 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:13:34.769232 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.olist_dbt.marts.olist
[0m21:13:34.790166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3fe164d-7de1-44d3-877e-44244e1695dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ec76b0>]}
[0m21:13:34.855868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3fe164d-7de1-44d3-877e-44244e1695dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075176b0>]}
[0m21:13:34.856313 [info ] [MainThread]: Found 11 models, 10 sources, 488 macros
[0m21:13:34.856591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3fe164d-7de1-44d3-877e-44244e1695dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076b2660>]}
[0m21:13:34.858057 [info ] [MainThread]: 
[0m21:13:34.858534 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:13:34.859142 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m21:13:34.873784 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m21:13:34.874220 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m21:13:34.874473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:34.877600 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:13:34.878298 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:13:36.885721 [debug] [ThreadPool]: SQL status: SUCCESS in 2.011 seconds
[0m21:13:36.887356 [debug] [ThreadPool]: On list_dev: Close
[0m21:13:36.891532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public)
[0m21:13:36.897499 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m21:13:36.897808 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m21:13:36.898029 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:13:36.898373 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:13:36.898608 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:13:38.541541 [debug] [ThreadPool]: SQL status: SUCCESS in 1.643 seconds
[0m21:13:38.543314 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m21:13:38.544400 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m21:13:39.157827 [debug] [ThreadPool]: SQL status: SUCCESS in 0.612 seconds
[0m21:13:39.163743 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m21:13:39.377541 [debug] [ThreadPool]: On list_dev_public: Close
[0m21:13:39.380386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public, now list_dev_public_staging)
[0m21:13:39.389545 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m21:13:39.390183 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m21:13:39.390606 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:13:39.391256 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:13:39.391694 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:13:41.009370 [debug] [ThreadPool]: SQL status: SUCCESS in 1.618 seconds
[0m21:13:41.011339 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m21:13:41.012499 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m21:13:41.293687 [debug] [ThreadPool]: SQL status: SUCCESS in 0.280 seconds
[0m21:13:41.299445 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m21:13:41.818973 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m21:13:41.840018 [debug] [MainThread]: Using redshift connection "master"
[0m21:13:41.840414 [debug] [MainThread]: On master: BEGIN
[0m21:13:41.840679 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:13:41.841112 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:13:41.841394 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:13:43.081555 [debug] [MainThread]: SQL status: SUCCESS in 1.241 seconds
[0m21:13:43.082113 [debug] [MainThread]: Using redshift connection "master"
[0m21:13:43.082489 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m21:13:43.865716 [debug] [MainThread]: SQL status: SUCCESS in 0.782 seconds
[0m21:13:43.870885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3fe164d-7de1-44d3-877e-44244e1695dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ef02c0>]}
[0m21:13:43.872354 [debug] [MainThread]: On master: ROLLBACK
[0m21:13:44.196028 [debug] [MainThread]: Using redshift connection "master"
[0m21:13:44.197870 [debug] [MainThread]: On master: BEGIN
[0m21:13:45.301129 [debug] [MainThread]: SQL status: SUCCESS in 1.102 seconds
[0m21:13:45.303151 [debug] [MainThread]: On master: COMMIT
[0m21:13:45.304542 [debug] [MainThread]: Using redshift connection "master"
[0m21:13:45.305528 [debug] [MainThread]: On master: COMMIT
[0m21:13:45.563153 [debug] [MainThread]: SQL status: SUCCESS in 0.256 seconds
[0m21:13:45.565115 [debug] [MainThread]: On master: Close
[0m21:13:45.567139 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:13:45.568246 [info ] [MainThread]: 
[0m21:13:45.574933 [debug] [Thread-1 (]: Began running node model.olist_dbt.user_summary
[0m21:13:45.576089 [info ] [Thread-1 (]: 1 of 1 START sql view model public.user_summary ................................ [RUN]
[0m21:13:45.577393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now model.olist_dbt.user_summary)
[0m21:13:45.578309 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.user_summary
[0m21:13:45.585899 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.user_summary"
[0m21:13:45.587803 [debug] [Thread-1 (]: Began executing node model.olist_dbt.user_summary
[0m21:13:45.628727 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.user_summary"
[0m21:13:45.631416 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.user_summary"
[0m21:13:45.631748 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: BEGIN
[0m21:13:45.632018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:45.632400 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:13:45.632666 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:13:47.560271 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.928 seconds
[0m21:13:47.562181 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.user_summary"
[0m21:13:47.563205 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.user_summary"} */


  create view "dev"."public"."user_summary__dbt_tmp" as (
    select
    c.customer_id,
    
    -- Count distinct orders per customer
    count(distinct o.order_id) as lifetime_order_count,
    
    -- Calculate the total sales value (price * quantity) for each customer
    sum(oi.price * oi.quantity) as lifetime_sales_value,
    
    -- Count the unique product categories purchased by the customer
    count(distinct p.product_category_name) as unique_categories_purchased

-- Join customers with orders
from "dev"."public_staging"."stg_customers" c
left join "dev"."public_staging"."stg_orders" o on c.customer_id = o.customer_id

-- Join orders with order items
left join "dev"."public_staging"."stg_order_items" oi on o.order_id = oi.order_id

-- Join order items with product categories
left join "dev"."public_staging"."stg_products" p on oi.product_id = p.product_id

-- Group by customer to get individual lifetime statistics
group by c.customer_id;
  ) ;
[0m21:13:47.630090 [debug] [Thread-1 (]: Redshift adapter: Redshift error: syntax error at or near ";" in context "c.customer_id;", at line 28, column 23
[0m21:13:47.631605 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: ROLLBACK
[0m21:13:47.970861 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: Close
[0m21:13:47.982489 [debug] [Thread-1 (]: Database Error in model user_summary (models/marts/user_summary.sql)
  syntax error at or near ";" in context "c.customer_id;", at line 28, column 23
  compiled Code at target/run/olist_dbt/models/marts/user_summary.sql
[0m21:13:47.985219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3fe164d-7de1-44d3-877e-44244e1695dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cbd730>]}
[0m21:13:47.986254 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.user_summary ....................... [[31mERROR[0m in 2.41s]
[0m21:13:47.987124 [debug] [Thread-1 (]: Finished running node model.olist_dbt.user_summary
[0m21:13:47.989661 [debug] [MainThread]: Using redshift connection "master"
[0m21:13:47.990193 [debug] [MainThread]: On master: BEGIN
[0m21:13:47.990607 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:13:47.991230 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:13:47.991666 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:13:49.020359 [debug] [MainThread]: SQL status: SUCCESS in 1.030 seconds
[0m21:13:49.021610 [debug] [MainThread]: On master: COMMIT
[0m21:13:49.022202 [debug] [MainThread]: Using redshift connection "master"
[0m21:13:49.022637 [debug] [MainThread]: On master: COMMIT
[0m21:13:49.234493 [debug] [MainThread]: SQL status: SUCCESS in 0.211 seconds
[0m21:13:49.235832 [debug] [MainThread]: On master: Close
[0m21:13:49.237355 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:13:49.238229 [debug] [MainThread]: Connection 'model.olist_dbt.user_summary' was properly closed.
[0m21:13:49.238916 [info ] [MainThread]: 
[0m21:13:49.239989 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 14.38 seconds (14.38s).
[0m21:13:49.242388 [debug] [MainThread]: Command end result
[0m21:13:49.288915 [info ] [MainThread]: 
[0m21:13:49.289349 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:13:49.289610 [info ] [MainThread]: 
[0m21:13:49.289913 [error] [MainThread]:   Database Error in model user_summary (models/marts/user_summary.sql)
  syntax error at or near ";" in context "c.customer_id;", at line 28, column 23
  compiled Code at target/run/olist_dbt/models/marts/user_summary.sql
[0m21:13:49.290146 [info ] [MainThread]: 
[0m21:13:49.290381 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:13:49.292817 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 15.071803, "process_user_time": 1.859897, "process_kernel_time": 0.408567, "process_mem_max_rss": "120832000", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:13:49.293342 [debug] [MainThread]: Command `dbt run` failed at 21:13:49.293267 after 15.07 seconds
[0m21:13:49.293672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10525bf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e2b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106353620>]}
[0m21:13:49.293959 [debug] [MainThread]: Flushing usage events
[0m21:56:24.124431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086184d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10864bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10864bf20>]}


============================== 21:56:24.128966 | e6b1acc3-4852-4e6f-b555-06f4b83f23d6 ==============================
[0m21:56:24.128966 [info ] [MainThread]: Running with dbt=1.8.6
[0m21:56:24.129482 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select user_summary.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:56:24.300375 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m21:56:24.300812 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m21:56:24.437298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6b1acc3-4852-4e6f-b555-06f4b83f23d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10887d160>]}
[0m21:56:24.474543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6b1acc3-4852-4e6f-b555-06f4b83f23d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c4cc20>]}
[0m21:56:24.475608 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m21:56:24.492831 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m21:56:24.555463 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:56:24.555928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e6b1acc3-4852-4e6f-b555-06f4b83f23d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c9b320>]}
[0m21:56:25.470163 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.olist_dbt.marts.olist
[0m21:56:25.478378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6b1acc3-4852-4e6f-b555-06f4b83f23d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bdcc50>]}
[0m21:56:25.542936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6b1acc3-4852-4e6f-b555-06f4b83f23d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10983bdd0>]}
[0m21:56:25.543380 [info ] [MainThread]: Found 11 models, 10 sources, 488 macros
[0m21:56:25.543687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6b1acc3-4852-4e6f-b555-06f4b83f23d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085f3f50>]}
[0m21:56:25.545093 [info ] [MainThread]: 
[0m21:56:25.545504 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:56:25.546141 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m21:56:25.559181 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m21:56:25.559598 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m21:56:25.559855 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:56:25.563143 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:56:25.563995 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:56:27.157221 [debug] [ThreadPool]: SQL status: SUCCESS in 1.597 seconds
[0m21:56:27.163695 [debug] [ThreadPool]: On list_dev: Close
[0m21:56:27.172402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public)
[0m21:56:27.183042 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m21:56:27.183539 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m21:56:27.183902 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:56:27.184440 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:56:27.184808 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:56:27.888688 [debug] [ThreadPool]: SQL status: SUCCESS in 0.704 seconds
[0m21:56:27.890408 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m21:56:27.891499 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m21:56:28.052654 [debug] [ThreadPool]: SQL status: SUCCESS in 0.160 seconds
[0m21:56:28.058130 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m21:56:28.186385 [debug] [ThreadPool]: On list_dev_public: Close
[0m21:56:28.205297 [debug] [MainThread]: Using redshift connection "master"
[0m21:56:28.205973 [debug] [MainThread]: On master: BEGIN
[0m21:56:28.206383 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:56:28.206900 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:56:28.207265 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:56:28.900843 [debug] [MainThread]: SQL status: SUCCESS in 0.694 seconds
[0m21:56:28.902677 [debug] [MainThread]: Using redshift connection "master"
[0m21:56:28.903916 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m21:56:29.093339 [debug] [MainThread]: SQL status: SUCCESS in 0.188 seconds
[0m21:56:29.098413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6b1acc3-4852-4e6f-b555-06f4b83f23d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f759a0>]}
[0m21:56:29.099432 [debug] [MainThread]: On master: ROLLBACK
[0m21:56:29.316271 [debug] [MainThread]: Using redshift connection "master"
[0m21:56:29.318158 [debug] [MainThread]: On master: BEGIN
[0m21:56:29.390958 [debug] [MainThread]: SQL status: SUCCESS in 0.072 seconds
[0m21:56:29.392680 [debug] [MainThread]: On master: COMMIT
[0m21:56:29.394015 [debug] [MainThread]: Using redshift connection "master"
[0m21:56:29.394948 [debug] [MainThread]: On master: COMMIT
[0m21:56:29.612791 [debug] [MainThread]: SQL status: SUCCESS in 0.217 seconds
[0m21:56:29.614742 [debug] [MainThread]: On master: Close
[0m21:56:29.616713 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:56:29.617824 [info ] [MainThread]: 
[0m21:56:29.624440 [debug] [Thread-1 (]: Began running node model.olist_dbt.user_summary
[0m21:56:29.625751 [info ] [Thread-1 (]: 1 of 1 START sql view model public.user_summary ................................ [RUN]
[0m21:56:29.626572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.olist_dbt.user_summary)
[0m21:56:29.627133 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.user_summary
[0m21:56:29.633831 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.user_summary"
[0m21:56:29.635532 [debug] [Thread-1 (]: Began executing node model.olist_dbt.user_summary
[0m21:56:29.672489 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.user_summary"
[0m21:56:29.675142 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.user_summary"
[0m21:56:29.675482 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: BEGIN
[0m21:56:29.675744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:56:29.676128 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:56:29.676396 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:56:30.546922 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.870 seconds
[0m21:56:30.549058 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.user_summary"
[0m21:56:30.550406 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.user_summary"} */


  create view "dev"."public"."user_summary__dbt_tmp" as (
    select
    c.customer_id,
    
    -- Count distinct orders per customer
    count(distinct o.order_id) as lifetime_order_count,
    
    -- Calculate the total sales value (price * quantity) for each customer
    sum(oi.price * oi.quantity) as lifetime_sales_value,
    
    -- Count the unique product categories purchased by the customer
    count(distinct p.product_category_name) as unique_categories_purchased

-- Join customers with orders
from "dev"."public"."stg_customers" c
left join "dev"."public"."stg_orders" o on c.customer_id = o.customer_id

-- Join orders with order items
left join "dev"."public"."stg_order_items" oi on o.order_id = oi.order_id

-- Join order items with product categories
left join "dev"."public"."stg_products" p on oi.product_id = p.product_id

-- Group by customer to get individual lifetime statistics
group by c.customer_id
  ) ;
[0m21:56:30.617233 [debug] [Thread-1 (]: Redshift adapter: Redshift error: relation "public.stg_customers" does not exist
[0m21:56:30.618961 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: ROLLBACK
[0m21:56:30.893909 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: Close
[0m21:56:30.906609 [debug] [Thread-1 (]: Database Error in model user_summary (models/marts/user_summary.sql)
  relation "public.stg_customers" does not exist
  compiled Code at target/run/olist_dbt/models/marts/user_summary.sql
[0m21:56:30.909038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6b1acc3-4852-4e6f-b555-06f4b83f23d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098c3c50>]}
[0m21:56:30.910081 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.user_summary ....................... [[31mERROR[0m in 1.28s]
[0m21:56:30.910983 [debug] [Thread-1 (]: Finished running node model.olist_dbt.user_summary
[0m21:56:30.913394 [debug] [MainThread]: Using redshift connection "master"
[0m21:56:30.913840 [debug] [MainThread]: On master: BEGIN
[0m21:56:30.914204 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:56:30.914755 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:56:30.915137 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:56:31.864435 [debug] [MainThread]: SQL status: SUCCESS in 0.950 seconds
[0m21:56:31.866519 [debug] [MainThread]: On master: COMMIT
[0m21:56:31.867941 [debug] [MainThread]: Using redshift connection "master"
[0m21:56:31.868979 [debug] [MainThread]: On master: COMMIT
[0m21:56:32.252282 [debug] [MainThread]: SQL status: SUCCESS in 0.382 seconds
[0m21:56:32.254303 [debug] [MainThread]: On master: Close
[0m21:56:32.256093 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:56:32.256780 [debug] [MainThread]: Connection 'model.olist_dbt.user_summary' was properly closed.
[0m21:56:32.257523 [info ] [MainThread]: 
[0m21:56:32.258172 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.71 seconds (6.71s).
[0m21:56:32.259792 [debug] [MainThread]: Command end result
[0m21:56:32.303433 [info ] [MainThread]: 
[0m21:56:32.303985 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:56:32.304281 [info ] [MainThread]: 
[0m21:56:32.304619 [error] [MainThread]:   Database Error in model user_summary (models/marts/user_summary.sql)
  relation "public.stg_customers" does not exist
  compiled Code at target/run/olist_dbt/models/marts/user_summary.sql
[0m21:56:32.304886 [info ] [MainThread]: 
[0m21:56:32.305152 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:56:32.307977 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.240826, "process_user_time": 2.63639, "process_kernel_time": 0.408954, "process_mem_max_rss": "125075456", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:56:32.308540 [debug] [MainThread]: Command `dbt run` failed at 21:56:32.308452 after 8.24 seconds
[0m21:56:32.308917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105042cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098cc740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108796420>]}
[0m21:56:32.309261 [debug] [MainThread]: Flushing usage events
[0m22:19:40.303358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110908bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111207f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111207fe0>]}


============================== 22:19:40.307816 | a7e0a296-787b-4c1f-af51-9e8772d0b400 ==============================
[0m22:19:40.307816 [info ] [MainThread]: Running with dbt=1.8.6
[0m22:19:40.308319 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select user_summary.sql', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:19:40.483797 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:19:40.484245 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:19:40.622491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7e0a296-787b-4c1f-af51-9e8772d0b400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111649190>]}
[0m22:19:40.659834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7e0a296-787b-4c1f-af51-9e8772d0b400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110908bc0>]}
[0m22:19:40.660969 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m22:19:40.678784 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m22:19:40.737974 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:19:40.738427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a7e0a296-787b-4c1f-af51-9e8772d0b400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104d6450>]}
[0m22:19:41.672177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7e0a296-787b-4c1f-af51-9e8772d0b400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ed2c60>]}
[0m22:19:41.735779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7e0a296-787b-4c1f-af51-9e8772d0b400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112af4c50>]}
[0m22:19:41.736212 [info ] [MainThread]: Found 11 models, 10 sources, 488 macros
[0m22:19:41.736531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7e0a296-787b-4c1f-af51-9e8772d0b400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b11b80>]}
[0m22:19:41.737948 [info ] [MainThread]: 
[0m22:19:41.738378 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:19:41.739019 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m22:19:41.751666 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m22:19:41.752048 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m22:19:41.752294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:19:41.755343 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:19:41.756061 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:19:43.116008 [debug] [ThreadPool]: SQL status: SUCCESS in 1.363 seconds
[0m22:19:43.121855 [debug] [ThreadPool]: On list_dev: Close
[0m22:19:43.133603 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public_marts)
[0m22:19:43.145121 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m22:19:43.145623 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m22:19:43.145985 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:19:43.146544 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:19:43.146917 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:19:43.892525 [debug] [ThreadPool]: SQL status: SUCCESS in 0.746 seconds
[0m22:19:43.893959 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m22:19:43.895005 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m22:19:44.061059 [debug] [ThreadPool]: SQL status: SUCCESS in 0.165 seconds
[0m22:19:44.066141 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m22:19:44.194499 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m22:19:44.197660 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_marts, now list_dev_public_staging)
[0m22:19:44.209179 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m22:19:44.209931 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m22:19:44.210350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:19:44.211002 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:19:44.211425 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:19:45.379303 [debug] [ThreadPool]: SQL status: SUCCESS in 1.169 seconds
[0m22:19:45.381330 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m22:19:45.382524 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m22:19:45.538173 [debug] [ThreadPool]: SQL status: SUCCESS in 0.154 seconds
[0m22:19:45.544190 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m22:19:45.684314 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m22:19:45.704277 [debug] [MainThread]: Using redshift connection "master"
[0m22:19:45.705064 [debug] [MainThread]: On master: BEGIN
[0m22:19:45.705502 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:19:45.706107 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:19:45.706501 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:19:46.823455 [debug] [MainThread]: SQL status: SUCCESS in 1.118 seconds
[0m22:19:46.824490 [debug] [MainThread]: Using redshift connection "master"
[0m22:19:46.825643 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:19:47.036534 [debug] [MainThread]: SQL status: SUCCESS in 0.210 seconds
[0m22:19:47.039817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7e0a296-787b-4c1f-af51-9e8772d0b400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112eb69f0>]}
[0m22:19:47.040764 [debug] [MainThread]: On master: ROLLBACK
[0m22:19:47.273916 [debug] [MainThread]: Using redshift connection "master"
[0m22:19:47.275321 [debug] [MainThread]: On master: BEGIN
[0m22:19:47.404428 [debug] [MainThread]: SQL status: SUCCESS in 0.128 seconds
[0m22:19:47.406090 [debug] [MainThread]: On master: COMMIT
[0m22:19:47.407418 [debug] [MainThread]: Using redshift connection "master"
[0m22:19:47.408392 [debug] [MainThread]: On master: COMMIT
[0m22:19:47.564200 [debug] [MainThread]: SQL status: SUCCESS in 0.155 seconds
[0m22:19:47.566039 [debug] [MainThread]: On master: Close
[0m22:19:47.568025 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:19:47.568877 [info ] [MainThread]: 
[0m22:19:47.576212 [debug] [Thread-1 (]: Began running node model.olist_dbt.user_summary
[0m22:19:47.577553 [info ] [Thread-1 (]: 1 of 1 START sql table model public_marts.user_summary ......................... [RUN]
[0m22:19:47.578354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now model.olist_dbt.user_summary)
[0m22:19:47.578887 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.user_summary
[0m22:19:47.585401 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.user_summary"
[0m22:19:47.587197 [debug] [Thread-1 (]: Began executing node model.olist_dbt.user_summary
[0m22:19:47.632026 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.user_summary"
[0m22:19:47.634719 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.user_summary"
[0m22:19:47.635043 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: BEGIN
[0m22:19:47.635301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:19:47.635667 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:19:47.635948 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:19:48.862739 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.227 seconds
[0m22:19:48.864784 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.user_summary"
[0m22:19:48.866056 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.user_summary"} */

  
    

  create  table
    "dev"."public_marts"."user_summary__dbt_tmp"
    
    
    
  as (
    select
    c.customer_id,
    
    -- Count distinct orders per customer
    count(distinct o.order_id) as lifetime_order_count,
    
    -- Calculate the total sales value (price * quantity) for each customer
    sum(oi.price * oi.quantity) as lifetime_sales_value,
    
    -- Count the unique product categories purchased by the customer
    count(distinct p.product_category_name) as unique_categories_purchased

-- Join customers with orders
from "dev"."public_staging"."stg_customers" c
left join "dev"."public_staging"."stg_orders" o on c.customer_id = o.customer_id

-- Join orders with order items
left join "dev"."public_staging"."stg_order_items" oi on o.order_id = oi.order_id

-- Join order items with product categories
left join "dev"."public_staging"."stg_products" p on oi.product_id = p.product_id

-- Group by customer to get individual lifetime statistics
group by c.customer_id
  );
[0m22:19:48.937368 [debug] [Thread-1 (]: Redshift adapter: Redshift error: column oi.quantity does not exist
[0m22:19:48.938806 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: ROLLBACK
[0m22:19:49.547684 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: Close
[0m22:19:49.560088 [debug] [Thread-1 (]: Database Error in model user_summary (models/marts/user_summary.sql)
  column oi.quantity does not exist
  compiled Code at target/run/olist_dbt/models/marts/user_summary.sql
[0m22:19:49.562509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7e0a296-787b-4c1f-af51-9e8772d0b400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e1f5f0>]}
[0m22:19:49.563499 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_marts.user_summary ................ [[31mERROR[0m in 1.98s]
[0m22:19:49.564370 [debug] [Thread-1 (]: Finished running node model.olist_dbt.user_summary
[0m22:19:49.566809 [debug] [MainThread]: Using redshift connection "master"
[0m22:19:49.567330 [debug] [MainThread]: On master: BEGIN
[0m22:19:49.567742 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:19:49.568278 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:19:49.568647 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:19:50.385401 [debug] [MainThread]: SQL status: SUCCESS in 0.817 seconds
[0m22:19:50.387434 [debug] [MainThread]: On master: COMMIT
[0m22:19:50.388745 [debug] [MainThread]: Using redshift connection "master"
[0m22:19:50.389717 [debug] [MainThread]: On master: COMMIT
[0m22:19:50.534712 [debug] [MainThread]: SQL status: SUCCESS in 0.144 seconds
[0m22:19:50.536524 [debug] [MainThread]: On master: Close
[0m22:19:50.538141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:19:50.538812 [debug] [MainThread]: Connection 'model.olist_dbt.user_summary' was properly closed.
[0m22:19:50.539514 [info ] [MainThread]: 
[0m22:19:50.540148 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.80 seconds (8.80s).
[0m22:19:50.541529 [debug] [MainThread]: Command end result
[0m22:19:50.587465 [info ] [MainThread]: 
[0m22:19:50.587940 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:19:50.588223 [info ] [MainThread]: 
[0m22:19:50.588557 [error] [MainThread]:   Database Error in model user_summary (models/marts/user_summary.sql)
  column oi.quantity does not exist
  compiled Code at target/run/olist_dbt/models/marts/user_summary.sql
[0m22:19:50.588817 [info ] [MainThread]: 
[0m22:19:50.589081 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:19:50.591876 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.340907, "process_user_time": 2.742856, "process_kernel_time": 0.421013, "process_mem_max_rss": "125730816", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:19:50.592461 [debug] [MainThread]: Command `dbt run` failed at 22:19:50.592372 after 10.34 seconds
[0m22:19:50.592821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d573e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f4acf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c62480>]}
[0m22:19:50.593192 [debug] [MainThread]: Flushing usage events
[0m22:20:31.342324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044bf980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033c4950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033c4a40>]}


============================== 22:20:31.346157 | 1f45ffc9-7b22-422f-885d-6f31d9486dba ==============================
[0m22:20:31.346157 [info ] [MainThread]: Running with dbt=1.8.6
[0m22:20:31.346659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select user_summary.sql', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:20:31.512128 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:20:31.512543 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:20:31.636422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f45ffc9-7b22-422f-885d-6f31d9486dba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bb1490>]}
[0m22:20:31.673607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f45ffc9-7b22-422f-885d-6f31d9486dba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dd19d0>]}
[0m22:20:31.674454 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m22:20:31.689155 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m22:20:31.812513 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:20:31.813084 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/marts/user_summary.sql
[0m22:20:31.973480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f45ffc9-7b22-422f-885d-6f31d9486dba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057bbfe0>]}
[0m22:20:32.033169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f45ffc9-7b22-422f-885d-6f31d9486dba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10505bc20>]}
[0m22:20:32.033590 [info ] [MainThread]: Found 11 models, 10 sources, 488 macros
[0m22:20:32.033874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f45ffc9-7b22-422f-885d-6f31d9486dba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056b24b0>]}
[0m22:20:32.035328 [info ] [MainThread]: 
[0m22:20:32.035775 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:20:32.036431 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m22:20:32.049788 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m22:20:32.050177 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m22:20:32.050417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:20:32.053544 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:20:32.054281 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:20:32.911969 [debug] [ThreadPool]: SQL status: SUCCESS in 0.861 seconds
[0m22:20:32.916600 [debug] [ThreadPool]: On list_dev: Close
[0m22:20:32.925301 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public_marts)
[0m22:20:32.935638 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m22:20:32.936128 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m22:20:32.936490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:20:32.937017 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:20:32.937384 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:20:33.984568 [debug] [ThreadPool]: SQL status: SUCCESS in 1.048 seconds
[0m22:20:33.985700 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m22:20:33.986318 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m22:20:34.142116 [debug] [ThreadPool]: SQL status: SUCCESS in 0.155 seconds
[0m22:20:34.144946 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m22:20:34.283858 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m22:20:34.286465 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_marts, now list_dev_public_staging)
[0m22:20:34.298131 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m22:20:34.298670 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m22:20:34.299072 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:20:34.299725 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:20:34.300176 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:20:35.078959 [debug] [ThreadPool]: SQL status: SUCCESS in 0.780 seconds
[0m22:20:35.080598 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m22:20:35.081679 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m22:20:35.294173 [debug] [ThreadPool]: SQL status: SUCCESS in 0.211 seconds
[0m22:20:35.299812 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m22:20:35.861646 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m22:20:35.884455 [debug] [MainThread]: Using redshift connection "master"
[0m22:20:35.885022 [debug] [MainThread]: On master: BEGIN
[0m22:20:35.885377 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:20:35.885889 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:20:35.886251 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:20:36.741143 [debug] [MainThread]: SQL status: SUCCESS in 0.855 seconds
[0m22:20:36.742803 [debug] [MainThread]: Using redshift connection "master"
[0m22:20:36.744003 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:20:37.104419 [debug] [MainThread]: SQL status: SUCCESS in 0.359 seconds
[0m22:20:37.109624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f45ffc9-7b22-422f-885d-6f31d9486dba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105920260>]}
[0m22:20:37.111128 [debug] [MainThread]: On master: ROLLBACK
[0m22:20:37.266504 [debug] [MainThread]: Using redshift connection "master"
[0m22:20:37.268178 [debug] [MainThread]: On master: BEGIN
[0m22:20:37.341432 [debug] [MainThread]: SQL status: SUCCESS in 0.072 seconds
[0m22:20:37.342896 [debug] [MainThread]: On master: COMMIT
[0m22:20:37.344135 [debug] [MainThread]: Using redshift connection "master"
[0m22:20:37.345041 [debug] [MainThread]: On master: COMMIT
[0m22:20:37.503515 [debug] [MainThread]: SQL status: SUCCESS in 0.157 seconds
[0m22:20:37.505069 [debug] [MainThread]: On master: Close
[0m22:20:37.507047 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:20:37.507757 [info ] [MainThread]: 
[0m22:20:37.512898 [debug] [Thread-1 (]: Began running node model.olist_dbt.user_summary
[0m22:20:37.514580 [info ] [Thread-1 (]: 1 of 1 START sql table model public_marts.user_summary ......................... [RUN]
[0m22:20:37.515502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now model.olist_dbt.user_summary)
[0m22:20:37.516073 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.user_summary
[0m22:20:37.522183 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.user_summary"
[0m22:20:37.524182 [debug] [Thread-1 (]: Began executing node model.olist_dbt.user_summary
[0m22:20:37.569103 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.user_summary"
[0m22:20:37.571909 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.user_summary"
[0m22:20:37.572235 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: BEGIN
[0m22:20:37.572496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:37.572859 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:20:37.573128 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:20:38.435085 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.862 seconds
[0m22:20:38.437313 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.user_summary"
[0m22:20:38.438648 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.user_summary"} */

  
    

  create  table
    "dev"."public_marts"."user_summary__dbt_tmp"
    
    
    
  as (
    select
    c.customer_id,
    
    -- Count distinct orders per customer
    count(distinct o.order_id) as lifetime_order_count,
    
    -- Calculate the total sales value (price * quantity) for each customer
    sum(oi.price * oi.freight_value) as lifetime_sales_value,
    
    -- Count the unique product categories purchased by the customer
    count(distinct p.product_category_name) as unique_categories_purchased

-- Join customers with orders
from "dev"."public_staging"."stg_customers" c
left join "dev"."public_staging"."stg_orders" o on c.customer_id = o.customer_id

-- Join orders with order items
left join "dev"."public_staging"."stg_order_items" oi on o.order_id = oi.order_id

-- Join order items with product categories
left join "dev"."public_staging"."stg_products" p on oi.product_id = p.product_id

-- Group by customer to get individual lifetime statistics
group by c.customer_id
  );
[0m22:20:50.398586 [debug] [Thread-1 (]: SQL status: SUCCESS in 11.959 seconds
[0m22:20:50.416104 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.user_summary"
[0m22:20:50.416891 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.user_summary"} */
alter table "dev"."public_marts"."user_summary__dbt_tmp" rename to "user_summary"
[0m22:20:50.968052 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.550 seconds
[0m22:20:50.988590 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: COMMIT
[0m22:20:50.989143 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.user_summary"
[0m22:20:50.989442 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: COMMIT
[0m22:20:51.192503 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.202 seconds
[0m22:20:51.194789 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.user_summary"
[0m22:20:51.195575 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: BEGIN
[0m22:20:51.323094 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.127 seconds
[0m22:20:51.336237 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_marts"."user_summary__dbt_backup"
[0m22:20:51.341427 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.user_summary"
[0m22:20:51.341866 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.user_summary"} */
drop table if exists "dev"."public_marts"."user_summary__dbt_backup" cascade
[0m22:20:51.613091 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.271 seconds
[0m22:20:51.616107 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: COMMIT
[0m22:20:51.616766 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.user_summary"
[0m22:20:51.617258 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: COMMIT
[0m22:20:51.687641 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.070 seconds
[0m22:20:51.689248 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.user_summary"
[0m22:20:51.689997 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: BEGIN
[0m22:20:51.754101 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.063 seconds
[0m22:20:51.758431 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: ROLLBACK
[0m22:20:51.887439 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: Close
[0m22:20:51.889981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f45ffc9-7b22-422f-885d-6f31d9486dba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dd0c50>]}
[0m22:20:51.890923 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public_marts.user_summary .................... [[32mSUCCESS[0m in 14.37s]
[0m22:20:51.891890 [debug] [Thread-1 (]: Finished running node model.olist_dbt.user_summary
[0m22:20:51.893658 [debug] [MainThread]: Using redshift connection "master"
[0m22:20:51.894302 [debug] [MainThread]: On master: BEGIN
[0m22:20:51.894709 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:20:51.895355 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:20:51.895800 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:20:52.637768 [debug] [MainThread]: SQL status: SUCCESS in 0.743 seconds
[0m22:20:52.639510 [debug] [MainThread]: On master: COMMIT
[0m22:20:52.640830 [debug] [MainThread]: Using redshift connection "master"
[0m22:20:52.641799 [debug] [MainThread]: On master: COMMIT
[0m22:20:52.772010 [debug] [MainThread]: SQL status: SUCCESS in 0.129 seconds
[0m22:20:52.774030 [debug] [MainThread]: On master: Close
[0m22:20:52.775916 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:20:52.776844 [debug] [MainThread]: Connection 'model.olist_dbt.user_summary' was properly closed.
[0m22:20:52.777897 [info ] [MainThread]: 
[0m22:20:52.778751 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 20.74 seconds (20.74s).
[0m22:20:52.780425 [debug] [MainThread]: Command end result
[0m22:20:52.823036 [info ] [MainThread]: 
[0m22:20:52.823542 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:20:52.823847 [info ] [MainThread]: 
[0m22:20:52.824147 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:20:52.825907 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 21.534483, "process_user_time": 2.089831, "process_kernel_time": 0.378291, "process_mem_max_rss": "125386752", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:20:52.826401 [debug] [MainThread]: Command `dbt run` succeeded at 22:20:52.826323 after 21.54 seconds
[0m22:20:52.826728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100f0acf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f76240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f75880>]}
[0m22:20:52.827034 [debug] [MainThread]: Flushing usage events
[0m22:21:14.136971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104527ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10477f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103688c20>]}


============================== 22:21:14.140884 | 1e38fd79-07ae-442f-ae98-fba0edf1db62 ==============================
[0m22:21:14.140884 [info ] [MainThread]: Running with dbt=1.8.6
[0m22:21:14.141380 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'profiles_dir': '/Users/eranola/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select monthly_summary.sql', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:21:14.306478 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:21:14.306923 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:21:14.433188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e38fd79-07ae-442f-ae98-fba0edf1db62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103099a00>]}
[0m22:21:14.470510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e38fd79-07ae-442f-ae98-fba0edf1db62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e9c8f0>]}
[0m22:21:14.471342 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m22:21:14.487036 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m22:21:14.606128 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:21:14.606496 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:21:14.630369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e38fd79-07ae-442f-ae98-fba0edf1db62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052cbb30>]}
[0m22:21:14.693581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e38fd79-07ae-442f-ae98-fba0edf1db62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057b7410>]}
[0m22:21:14.694019 [info ] [MainThread]: Found 11 models, 10 sources, 488 macros
[0m22:21:14.694306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e38fd79-07ae-442f-ae98-fba0edf1db62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ce240>]}
[0m22:21:14.695062 [warn ] [MainThread]: The selection criterion 'monthly_summary.sql' does not match any enabled nodes
[0m22:21:14.696016 [info ] [MainThread]: 
[0m22:21:14.696284 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:21:14.697581 [debug] [MainThread]: Command end result
[0m22:21:14.721762 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.63547283, "process_user_time": 1.311296, "process_kernel_time": 0.253102, "process_mem_max_rss": "114393088", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:21:14.722340 [debug] [MainThread]: Command `dbt run` succeeded at 22:21:14.722264 after 0.64 seconds
[0m22:21:14.722678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024db560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103666e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105957110>]}
[0m22:21:14.722963 [debug] [MainThread]: Flushing usage events
[0m22:21:36.589901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104430890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104467fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104467e00>]}


============================== 22:21:36.593655 | 0db16ffb-b45d-43ce-8ba7-94ce1eb40722 ==============================
[0m22:21:36.593655 [info ] [MainThread]: Running with dbt=1.8.6
[0m22:21:36.594187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select monthly_summary.sql', 'send_anonymous_usage_stats': 'True'}
[0m22:21:36.762997 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:21:36.763424 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:21:36.887030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0db16ffb-b45d-43ce-8ba7-94ce1eb40722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10440fa70>]}
[0m22:21:36.924219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0db16ffb-b45d-43ce-8ba7-94ce1eb40722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104433dd0>]}
[0m22:21:36.925074 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m22:21:36.941056 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m22:21:37.057751 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m22:21:37.058281 [debug] [MainThread]: Partial parsing: added file: olist_dbt://models/marts/monthly_summary.sql
[0m22:21:37.058554 [debug] [MainThread]: Partial parsing: deleted file: olist_dbt://models/marts/monthy_summary.sql
[0m22:21:37.218729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0db16ffb-b45d-43ce-8ba7-94ce1eb40722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105704200>]}
[0m22:21:37.280099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0db16ffb-b45d-43ce-8ba7-94ce1eb40722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104faf860>]}
[0m22:21:37.280554 [info ] [MainThread]: Found 11 models, 10 sources, 488 macros
[0m22:21:37.280853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0db16ffb-b45d-43ce-8ba7-94ce1eb40722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10561fc80>]}
[0m22:21:37.282337 [info ] [MainThread]: 
[0m22:21:37.282770 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:21:37.283460 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m22:21:37.296717 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m22:21:37.297147 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m22:21:37.297401 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:37.300665 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:21:37.301389 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:21:37.855362 [debug] [ThreadPool]: SQL status: SUCCESS in 0.557 seconds
[0m22:21:37.861465 [debug] [ThreadPool]: On list_dev: Close
[0m22:21:37.867876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public_marts)
[0m22:21:37.876074 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m22:21:37.876476 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m22:21:37.876747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:21:37.877181 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:21:37.877462 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:21:38.325199 [debug] [ThreadPool]: SQL status: SUCCESS in 0.448 seconds
[0m22:21:38.326983 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m22:21:38.328054 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m22:21:38.425886 [debug] [ThreadPool]: SQL status: SUCCESS in 0.096 seconds
[0m22:21:38.431396 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m22:21:38.506829 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m22:21:38.509615 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_marts, now list_dev_public_staging)
[0m22:21:38.518542 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m22:21:38.519190 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m22:21:38.519627 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:21:38.520266 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:21:38.520706 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:21:38.975733 [debug] [ThreadPool]: SQL status: SUCCESS in 0.456 seconds
[0m22:21:38.977391 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m22:21:38.978482 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m22:21:39.074460 [debug] [ThreadPool]: SQL status: SUCCESS in 0.095 seconds
[0m22:21:39.078750 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m22:21:39.152850 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m22:21:39.176132 [debug] [MainThread]: Using redshift connection "master"
[0m22:21:39.176752 [debug] [MainThread]: On master: BEGIN
[0m22:21:39.177114 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:21:39.177641 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:21:39.178019 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:21:39.608052 [debug] [MainThread]: SQL status: SUCCESS in 0.430 seconds
[0m22:21:39.609995 [debug] [MainThread]: Using redshift connection "master"
[0m22:21:39.611191 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:21:39.752085 [debug] [MainThread]: SQL status: SUCCESS in 0.139 seconds
[0m22:21:39.756418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0db16ffb-b45d-43ce-8ba7-94ce1eb40722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f58380>]}
[0m22:21:39.757496 [debug] [MainThread]: On master: ROLLBACK
[0m22:21:39.832410 [debug] [MainThread]: Using redshift connection "master"
[0m22:21:39.834222 [debug] [MainThread]: On master: BEGIN
[0m22:21:39.871993 [debug] [MainThread]: SQL status: SUCCESS in 0.037 seconds
[0m22:21:39.873723 [debug] [MainThread]: On master: COMMIT
[0m22:21:39.875261 [debug] [MainThread]: Using redshift connection "master"
[0m22:21:39.876333 [debug] [MainThread]: On master: COMMIT
[0m22:21:39.949208 [debug] [MainThread]: SQL status: SUCCESS in 0.072 seconds
[0m22:21:39.950659 [debug] [MainThread]: On master: Close
[0m22:21:39.952659 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:21:39.953317 [info ] [MainThread]: 
[0m22:21:39.959875 [debug] [Thread-1 (]: Began running node model.olist_dbt.monthly_summary
[0m22:21:39.961004 [info ] [Thread-1 (]: 1 of 1 START sql table model public_marts.monthly_summary ...................... [RUN]
[0m22:21:39.961813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now model.olist_dbt.monthly_summary)
[0m22:21:39.962357 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.monthly_summary
[0m22:21:39.967607 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.monthly_summary"
[0m22:21:39.969269 [debug] [Thread-1 (]: Began executing node model.olist_dbt.monthly_summary
[0m22:21:40.014229 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.monthly_summary"
[0m22:21:40.016493 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.monthly_summary"
[0m22:21:40.016793 [debug] [Thread-1 (]: On model.olist_dbt.monthly_summary: BEGIN
[0m22:21:40.017055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:21:40.017420 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:21:40.017699 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:21:40.440910 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.423 seconds
[0m22:21:40.442967 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.monthly_summary"
[0m22:21:40.444331 [debug] [Thread-1 (]: On model.olist_dbt.monthly_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.monthly_summary"} */

  
    

  create  table
    "dev"."public_marts"."monthly_summary__dbt_tmp"
    
    
    
  as (
    -- models/marts/olist/monthly_sales.sql

select
    -- Truncate the order purchase timestamp to get the month
    date_trunc('month', o.order_purchase_timestamp) as month,
    
    -- Calculate the total sales for each month
    sum(oi.price * oi.quantity) as total_sales

-- Start from the orders table
from "dev"."public_staging"."stg_orders" o

-- Join the order_items table on order_id
join "dev"."public_staging"."stg_order_items" oi on o.order_id = oi.order_id

-- Group by the month to aggregate total sales per month
group by month;
  );
[0m22:21:40.485499 [debug] [Thread-1 (]: Redshift adapter: Redshift error: syntax error at or near ";" in context "group by month;", at line 28, column 15
[0m22:21:40.486851 [debug] [Thread-1 (]: On model.olist_dbt.monthly_summary: ROLLBACK
[0m22:21:40.563479 [debug] [Thread-1 (]: On model.olist_dbt.monthly_summary: Close
[0m22:21:40.576429 [debug] [Thread-1 (]: Database Error in model monthly_summary (models/marts/monthly_summary.sql)
  syntax error at or near ";" in context "group by month;", at line 28, column 15
  compiled Code at target/run/olist_dbt/models/marts/monthly_summary.sql
[0m22:21:40.578876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0db16ffb-b45d-43ce-8ba7-94ce1eb40722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f59dc0>]}
[0m22:21:40.579884 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_marts.monthly_summary ............. [[31mERROR[0m in 0.62s]
[0m22:21:40.580798 [debug] [Thread-1 (]: Finished running node model.olist_dbt.monthly_summary
[0m22:21:40.583332 [debug] [MainThread]: Using redshift connection "master"
[0m22:21:40.583811 [debug] [MainThread]: On master: BEGIN
[0m22:21:40.584216 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:21:40.584829 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:21:40.585262 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:21:41.019063 [debug] [MainThread]: SQL status: SUCCESS in 0.435 seconds
[0m22:21:41.019663 [debug] [MainThread]: On master: COMMIT
[0m22:21:41.020059 [debug] [MainThread]: Using redshift connection "master"
[0m22:21:41.020338 [debug] [MainThread]: On master: COMMIT
[0m22:21:41.094049 [debug] [MainThread]: SQL status: SUCCESS in 0.073 seconds
[0m22:21:41.094545 [debug] [MainThread]: On master: Close
[0m22:21:41.095356 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:21:41.095751 [debug] [MainThread]: Connection 'model.olist_dbt.monthly_summary' was properly closed.
[0m22:21:41.096222 [info ] [MainThread]: 
[0m22:21:41.096711 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.81 seconds (3.81s).
[0m22:21:41.097619 [debug] [MainThread]: Command end result
[0m22:21:41.137428 [info ] [MainThread]: 
[0m22:21:41.137893 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:21:41.138173 [info ] [MainThread]: 
[0m22:21:41.138507 [error] [MainThread]:   Database Error in model monthly_summary (models/marts/monthly_summary.sql)
  syntax error at or near ";" in context "group by month;", at line 28, column 15
  compiled Code at target/run/olist_dbt/models/marts/monthly_summary.sql
[0m22:21:41.138770 [info ] [MainThread]: 
[0m22:21:41.139042 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:21:41.141087 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.6029434, "process_user_time": 1.97563, "process_kernel_time": 0.374048, "process_mem_max_rss": "125026304", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:21:41.141577 [debug] [MainThread]: Command `dbt run` failed at 22:21:41.141503 after 4.60 seconds
[0m22:21:41.141894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f9d1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f707a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10420fb60>]}
[0m22:21:41.142188 [debug] [MainThread]: Flushing usage events
[0m22:22:17.236526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10659cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105480b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105480ad0>]}


============================== 22:22:17.240336 | 5870ae7c-c4c9-4b36-9a6f-817cd96978c1 ==============================
[0m22:22:17.240336 [info ] [MainThread]: Running with dbt=1.8.6
[0m22:22:17.240824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select monthly_summary.sql', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:22:17.402869 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:22:17.403316 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:22:17.527328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5870ae7c-c4c9-4b36-9a6f-817cd96978c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a0cec0>]}
[0m22:22:17.564844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5870ae7c-c4c9-4b36-9a6f-817cd96978c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065cfd10>]}
[0m22:22:17.565794 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m22:22:17.582120 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m22:22:17.703636 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:22:17.704213 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/marts/monthly_summary.sql
[0m22:22:17.864701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5870ae7c-c4c9-4b36-9a6f-817cd96978c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070eb770>]}
[0m22:22:17.924853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5870ae7c-c4c9-4b36-9a6f-817cd96978c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10711b920>]}
[0m22:22:17.925268 [info ] [MainThread]: Found 11 models, 10 sources, 488 macros
[0m22:22:17.925551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5870ae7c-c4c9-4b36-9a6f-817cd96978c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c88800>]}
[0m22:22:17.927020 [info ] [MainThread]: 
[0m22:22:17.927460 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:22:17.928108 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m22:22:17.940671 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m22:22:17.941061 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m22:22:17.941320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:17.945354 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:22:17.946239 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:22:18.512575 [debug] [ThreadPool]: SQL status: SUCCESS in 0.571 seconds
[0m22:22:18.517773 [debug] [ThreadPool]: On list_dev: Close
[0m22:22:18.525913 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public_staging)
[0m22:22:18.536166 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m22:22:18.536652 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m22:22:18.537006 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:22:18.537554 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:22:18.537939 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:22:18.992015 [debug] [ThreadPool]: SQL status: SUCCESS in 0.455 seconds
[0m22:22:18.994013 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m22:22:18.995109 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m22:22:19.094406 [debug] [ThreadPool]: SQL status: SUCCESS in 0.098 seconds
[0m22:22:19.099715 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m22:22:19.177524 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m22:22:19.180647 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_staging, now list_dev_public_marts)
[0m22:22:19.189473 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m22:22:19.190002 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m22:22:19.190437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:22:19.191082 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:22:19.191516 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:22:19.651439 [debug] [ThreadPool]: SQL status: SUCCESS in 0.461 seconds
[0m22:22:19.652818 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m22:22:19.653638 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m22:22:19.754498 [debug] [ThreadPool]: SQL status: SUCCESS in 0.100 seconds
[0m22:22:19.759597 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m22:22:19.838562 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m22:22:19.860717 [debug] [MainThread]: Using redshift connection "master"
[0m22:22:19.861290 [debug] [MainThread]: On master: BEGIN
[0m22:22:19.861661 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:22:19.862183 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:22:19.862547 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:22:20.336194 [debug] [MainThread]: SQL status: SUCCESS in 0.474 seconds
[0m22:22:20.338038 [debug] [MainThread]: Using redshift connection "master"
[0m22:22:20.339274 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:22:20.487767 [debug] [MainThread]: SQL status: SUCCESS in 0.147 seconds
[0m22:22:20.492612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5870ae7c-c4c9-4b36-9a6f-817cd96978c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd1f40>]}
[0m22:22:20.493701 [debug] [MainThread]: On master: ROLLBACK
[0m22:22:20.574516 [debug] [MainThread]: Using redshift connection "master"
[0m22:22:20.576221 [debug] [MainThread]: On master: BEGIN
[0m22:22:20.616433 [debug] [MainThread]: SQL status: SUCCESS in 0.039 seconds
[0m22:22:20.617577 [debug] [MainThread]: On master: COMMIT
[0m22:22:20.618657 [debug] [MainThread]: Using redshift connection "master"
[0m22:22:20.619531 [debug] [MainThread]: On master: COMMIT
[0m22:22:20.699386 [debug] [MainThread]: SQL status: SUCCESS in 0.079 seconds
[0m22:22:20.700846 [debug] [MainThread]: On master: Close
[0m22:22:20.702941 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:22:20.703563 [info ] [MainThread]: 
[0m22:22:20.708323 [debug] [Thread-1 (]: Began running node model.olist_dbt.monthly_summary
[0m22:22:20.709441 [info ] [Thread-1 (]: 1 of 1 START sql table model public_marts.monthly_summary ...................... [RUN]
[0m22:22:20.710245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_marts, now model.olist_dbt.monthly_summary)
[0m22:22:20.710968 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.monthly_summary
[0m22:22:20.716681 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.monthly_summary"
[0m22:22:20.718478 [debug] [Thread-1 (]: Began executing node model.olist_dbt.monthly_summary
[0m22:22:20.764469 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.monthly_summary"
[0m22:22:20.766752 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.monthly_summary"
[0m22:22:20.767077 [debug] [Thread-1 (]: On model.olist_dbt.monthly_summary: BEGIN
[0m22:22:20.767336 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:22:20.767707 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:22:20.767978 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:22:21.194959 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.427 seconds
[0m22:22:21.195537 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.monthly_summary"
[0m22:22:21.195854 [debug] [Thread-1 (]: On model.olist_dbt.monthly_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.monthly_summary"} */

  
    

  create  table
    "dev"."public_marts"."monthly_summary__dbt_tmp"
    
    
    
  as (
    -- models/marts/olist/monthly_sales.sql

select
    -- Truncate the order purchase timestamp to get the month
    date_trunc('month', o.order_purchase_timestamp) as month,
    
    -- Calculate the total sales for each month
    sum(oi.price * oi.freight_value) as total_sales

-- Start from the orders table
from "dev"."public_staging"."stg_orders" o

-- Join the order_items table on order_id
join "dev"."public_staging"."stg_order_items" oi on o.order_id = oi.order_id

-- Group by the month to aggregate total sales per month
group by 1
  );
[0m22:22:29.293638 [debug] [Thread-1 (]: SQL status: SUCCESS in 8.097 seconds
[0m22:22:29.308223 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.monthly_summary"
[0m22:22:29.308772 [debug] [Thread-1 (]: On model.olist_dbt.monthly_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.monthly_summary"} */
alter table "dev"."public_marts"."monthly_summary__dbt_tmp" rename to "monthly_summary"
[0m22:22:29.682727 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.373 seconds
[0m22:22:29.714618 [debug] [Thread-1 (]: On model.olist_dbt.monthly_summary: COMMIT
[0m22:22:29.715225 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.monthly_summary"
[0m22:22:29.715589 [debug] [Thread-1 (]: On model.olist_dbt.monthly_summary: COMMIT
[0m22:22:29.877736 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.161 seconds
[0m22:22:29.879767 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.monthly_summary"
[0m22:22:29.880829 [debug] [Thread-1 (]: On model.olist_dbt.monthly_summary: BEGIN
[0m22:22:30.007399 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.125 seconds
[0m22:22:30.023300 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_marts"."monthly_summary__dbt_backup"
[0m22:22:30.031076 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.monthly_summary"
[0m22:22:30.031651 [debug] [Thread-1 (]: On model.olist_dbt.monthly_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.monthly_summary"} */
drop table if exists "dev"."public_marts"."monthly_summary__dbt_backup" cascade
[0m22:22:30.158219 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.126 seconds
[0m22:22:30.162073 [debug] [Thread-1 (]: On model.olist_dbt.monthly_summary: COMMIT
[0m22:22:30.163417 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.monthly_summary"
[0m22:22:30.164521 [debug] [Thread-1 (]: On model.olist_dbt.monthly_summary: COMMIT
[0m22:22:30.238936 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.073 seconds
[0m22:22:30.240659 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.monthly_summary"
[0m22:22:30.241749 [debug] [Thread-1 (]: On model.olist_dbt.monthly_summary: BEGIN
[0m22:22:30.305371 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.062 seconds
[0m22:22:30.311696 [debug] [Thread-1 (]: On model.olist_dbt.monthly_summary: ROLLBACK
[0m22:22:30.437660 [debug] [Thread-1 (]: On model.olist_dbt.monthly_summary: Close
[0m22:22:30.443186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5870ae7c-c4c9-4b36-9a6f-817cd96978c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e8cb00>]}
[0m22:22:30.444570 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public_marts.monthly_summary ................. [[32mSUCCESS[0m in 9.73s]
[0m22:22:30.445567 [debug] [Thread-1 (]: Finished running node model.olist_dbt.monthly_summary
[0m22:22:30.447931 [debug] [MainThread]: Using redshift connection "master"
[0m22:22:30.448600 [debug] [MainThread]: On master: BEGIN
[0m22:22:30.449018 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:22:30.449667 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:22:30.450121 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:22:31.141818 [debug] [MainThread]: SQL status: SUCCESS in 0.692 seconds
[0m22:22:31.143704 [debug] [MainThread]: On master: COMMIT
[0m22:22:31.145073 [debug] [MainThread]: Using redshift connection "master"
[0m22:22:31.146141 [debug] [MainThread]: On master: COMMIT
[0m22:22:31.354004 [debug] [MainThread]: SQL status: SUCCESS in 0.207 seconds
[0m22:22:31.355686 [debug] [MainThread]: On master: Close
[0m22:22:31.357528 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:22:31.358448 [debug] [MainThread]: Connection 'model.olist_dbt.monthly_summary' was properly closed.
[0m22:22:31.359493 [info ] [MainThread]: 
[0m22:22:31.360503 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 13.43 seconds (13.43s).
[0m22:22:31.361889 [debug] [MainThread]: Command end result
[0m22:22:31.407781 [info ] [MainThread]: 
[0m22:22:31.408318 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:22:31.408607 [info ] [MainThread]: 
[0m22:22:31.408890 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:22:31.410754 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.224703, "process_user_time": 2.093812, "process_kernel_time": 0.362061, "process_mem_max_rss": "125763584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:22:31.411219 [debug] [MainThread]: Command `dbt run` succeeded at 22:22:31.411153 after 14.23 seconds
[0m22:22:31.411515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f2a0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f2aae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ad61b0>]}
[0m22:22:31.411796 [debug] [MainThread]: Flushing usage events
[0m14:14:04.044988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068475c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059e4b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059e4c50>]}


============================== 14:14:04.053227 | 33af9643-fd1b-468c-8f36-d4aeac3890b2 ==============================
[0m14:14:04.053227 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:14:04.054156 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'profiles_dir': '/Users/eranola/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select stg_customers.sql', 'send_anonymous_usage_stats': 'True'}
[0m14:14:04.250992 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:14:04.251415 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:14:04.669552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33af9643-fd1b-468c-8f36-d4aeac3890b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107182510>]}
[0m14:14:04.707289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33af9643-fd1b-468c-8f36-d4aeac3890b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c6ae0>]}
[0m14:14:04.709074 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:14:04.769269 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:14:04.894583 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:14:04.895141 [debug] [MainThread]: Partial parsing: added file: olist_dbt://models/staging/olist/stg_olist.yml
[0m14:14:04.935456 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:14:04.935907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '33af9643-fd1b-468c-8f36-d4aeac3890b2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b02750>]}
[0m14:14:05.081769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33af9643-fd1b-468c-8f36-d4aeac3890b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d68a10>]}
[0m14:14:05.168834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33af9643-fd1b-468c-8f36-d4aeac3890b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e57fe0>]}
[0m14:14:05.169284 [info ] [MainThread]: Found 11 models, 2 data tests, 10 sources, 488 macros
[0m14:14:05.169573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33af9643-fd1b-468c-8f36-d4aeac3890b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc3680>]}
[0m14:14:05.171097 [info ] [MainThread]: 
[0m14:14:05.171533 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:14:05.174677 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_marts'
[0m14:14:05.188228 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m14:14:05.188648 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m14:14:05.188881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:05.191947 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:14:05.192650 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:14:06.141498 [debug] [ThreadPool]: SQL status: SUCCESS in 0.952 seconds
[0m14:14:06.143503 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m14:14:06.144559 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m14:14:06.291469 [debug] [ThreadPool]: SQL status: SUCCESS in 0.146 seconds
[0m14:14:06.296659 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m14:14:06.503603 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m14:14:06.506836 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_marts, now list_dev_public_staging)
[0m14:14:06.516350 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m14:14:06.516888 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m14:14:06.517246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:14:06.517949 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:14:06.518321 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:14:07.215099 [debug] [ThreadPool]: SQL status: SUCCESS in 0.697 seconds
[0m14:14:07.216895 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m14:14:07.217930 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m14:14:07.365548 [debug] [ThreadPool]: SQL status: SUCCESS in 0.146 seconds
[0m14:14:07.371047 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m14:14:07.497354 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m14:14:07.516460 [debug] [MainThread]: Using redshift connection "master"
[0m14:14:07.517104 [debug] [MainThread]: On master: BEGIN
[0m14:14:07.517546 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:14:07.518152 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:14:07.518583 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:14:08.216269 [debug] [MainThread]: SQL status: SUCCESS in 0.699 seconds
[0m14:14:08.216737 [debug] [MainThread]: Using redshift connection "master"
[0m14:14:08.217040 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:14:08.404500 [debug] [MainThread]: SQL status: SUCCESS in 0.187 seconds
[0m14:14:08.409638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33af9643-fd1b-468c-8f36-d4aeac3890b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076535f0>]}
[0m14:14:08.411180 [debug] [MainThread]: On master: ROLLBACK
[0m14:14:08.535902 [debug] [MainThread]: Using redshift connection "master"
[0m14:14:08.537321 [debug] [MainThread]: On master: BEGIN
[0m14:14:08.605902 [debug] [MainThread]: SQL status: SUCCESS in 0.067 seconds
[0m14:14:08.607324 [debug] [MainThread]: On master: COMMIT
[0m14:14:08.608577 [debug] [MainThread]: Using redshift connection "master"
[0m14:14:08.609475 [debug] [MainThread]: On master: COMMIT
[0m14:14:08.738140 [debug] [MainThread]: SQL status: SUCCESS in 0.128 seconds
[0m14:14:08.739836 [debug] [MainThread]: On master: Close
[0m14:14:08.741889 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:14:08.742566 [info ] [MainThread]: 
[0m14:14:08.748486 [debug] [Thread-1 (]: Began running node test.olist_dbt.not_null_stg_customers_id.6bd2c50f02
[0m14:14:08.749151 [info ] [Thread-1 (]: 1 of 2 START test not_null_stg_customers_id .................................... [RUN]
[0m14:14:08.749901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now test.olist_dbt.not_null_stg_customers_id.6bd2c50f02)
[0m14:14:08.750412 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.not_null_stg_customers_id.6bd2c50f02
[0m14:14:08.773070 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.not_null_stg_customers_id.6bd2c50f02"
[0m14:14:08.775014 [debug] [Thread-1 (]: Began executing node test.olist_dbt.not_null_stg_customers_id.6bd2c50f02
[0m14:14:08.788956 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.not_null_stg_customers_id.6bd2c50f02"
[0m14:14:08.791021 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.not_null_stg_customers_id.6bd2c50f02"
[0m14:14:08.791345 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_customers_id.6bd2c50f02: BEGIN
[0m14:14:08.791613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:08.791996 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:14:08.792262 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:14:10.503062 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.711 seconds
[0m14:14:10.505223 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.not_null_stg_customers_id.6bd2c50f02"
[0m14:14:10.506487 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_customers_id.6bd2c50f02: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.not_null_stg_customers_id.6bd2c50f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public_staging"."stg_customers"
where id is null



      
    ) dbt_internal_test
[0m14:14:10.573902 [debug] [Thread-1 (]: Redshift adapter: Redshift error: column "id" does not exist in stg_customers
[0m14:14:10.575518 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_customers_id.6bd2c50f02: ROLLBACK
[0m14:14:10.707043 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_customers_id.6bd2c50f02: Close
[0m14:14:10.719580 [debug] [Thread-1 (]: Database Error in test not_null_stg_customers_id (models/staging/olist/stg_olist.yml)
  column "id" does not exist in stg_customers
  compiled Code at target/run/olist_dbt/models/staging/olist/stg_olist.yml/not_null_stg_customers_id.sql
[0m14:14:10.720476 [error] [Thread-1 (]: 1 of 2 ERROR not_null_stg_customers_id ......................................... [[31mERROR[0m in 1.97s]
[0m14:14:10.721350 [debug] [Thread-1 (]: Finished running node test.olist_dbt.not_null_stg_customers_id.6bd2c50f02
[0m14:14:10.721962 [debug] [Thread-1 (]: Began running node test.olist_dbt.unique_stg_customers_id.a6a76acf47
[0m14:14:10.723451 [info ] [Thread-1 (]: 2 of 2 START test unique_stg_customers_id ...................................... [RUN]
[0m14:14:10.724227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.not_null_stg_customers_id.6bd2c50f02, now test.olist_dbt.unique_stg_customers_id.a6a76acf47)
[0m14:14:10.724807 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.unique_stg_customers_id.a6a76acf47
[0m14:14:10.733164 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.unique_stg_customers_id.a6a76acf47"
[0m14:14:10.734693 [debug] [Thread-1 (]: Began executing node test.olist_dbt.unique_stg_customers_id.a6a76acf47
[0m14:14:10.737669 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.unique_stg_customers_id.a6a76acf47"
[0m14:14:10.740285 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.unique_stg_customers_id.a6a76acf47"
[0m14:14:10.740661 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_customers_id.a6a76acf47: BEGIN
[0m14:14:10.740987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:10.741455 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:14:10.741791 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:14:11.537790 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.796 seconds
[0m14:14:11.539822 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.unique_stg_customers_id.a6a76acf47"
[0m14:14:11.541008 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_customers_id.a6a76acf47: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.unique_stg_customers_id.a6a76acf47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public_staging"."stg_customers"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:14:11.608407 [debug] [Thread-1 (]: Redshift adapter: Redshift error: column "id" does not exist in stg_customers
[0m14:14:11.610362 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_customers_id.a6a76acf47: ROLLBACK
[0m14:14:11.746737 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_customers_id.a6a76acf47: Close
[0m14:14:11.757157 [debug] [Thread-1 (]: Database Error in test unique_stg_customers_id (models/staging/olist/stg_olist.yml)
  column "id" does not exist in stg_customers
  compiled Code at target/run/olist_dbt/models/staging/olist/stg_olist.yml/unique_stg_customers_id.sql
[0m14:14:11.758155 [error] [Thread-1 (]: 2 of 2 ERROR unique_stg_customers_id ........................................... [[31mERROR[0m in 1.03s]
[0m14:14:11.758997 [debug] [Thread-1 (]: Finished running node test.olist_dbt.unique_stg_customers_id.a6a76acf47
[0m14:14:11.760857 [debug] [MainThread]: Using redshift connection "master"
[0m14:14:11.761319 [debug] [MainThread]: On master: BEGIN
[0m14:14:11.761712 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:14:11.762362 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:14:11.762827 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:14:12.479365 [debug] [MainThread]: SQL status: SUCCESS in 0.717 seconds
[0m14:14:12.481447 [debug] [MainThread]: On master: COMMIT
[0m14:14:12.482883 [debug] [MainThread]: Using redshift connection "master"
[0m14:14:12.483818 [debug] [MainThread]: On master: COMMIT
[0m14:14:12.617070 [debug] [MainThread]: SQL status: SUCCESS in 0.132 seconds
[0m14:14:12.618044 [debug] [MainThread]: On master: Close
[0m14:14:12.619051 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:14:12.619613 [debug] [MainThread]: Connection 'test.olist_dbt.unique_stg_customers_id.a6a76acf47' was properly closed.
[0m14:14:12.620363 [info ] [MainThread]: 
[0m14:14:12.621102 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 7.45 seconds (7.45s).
[0m14:14:12.622621 [debug] [MainThread]: Command end result
[0m14:14:12.667844 [info ] [MainThread]: 
[0m14:14:12.668352 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:14:12.668656 [info ] [MainThread]: 
[0m14:14:12.669010 [error] [MainThread]:   Database Error in test not_null_stg_customers_id (models/staging/olist/stg_olist.yml)
  column "id" does not exist in stg_customers
  compiled Code at target/run/olist_dbt/models/staging/olist/stg_olist.yml/not_null_stg_customers_id.sql
[0m14:14:12.669271 [info ] [MainThread]: 
[0m14:14:12.669567 [error] [MainThread]:   Database Error in test unique_stg_customers_id (models/staging/olist/stg_olist.yml)
  column "id" does not exist in stg_customers
  compiled Code at target/run/olist_dbt/models/staging/olist/stg_olist.yml/unique_stg_customers_id.sql
[0m14:14:12.669812 [info ] [MainThread]: 
[0m14:14:12.670077 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m14:14:12.717808 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 9.01817, "process_user_time": 2.103409, "process_kernel_time": 0.403253, "process_mem_max_rss": "127647744", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:14:12.718482 [debug] [MainThread]: Command `dbt test` failed at 14:14:12.718395 after 9.02 seconds
[0m14:14:12.718842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b01a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076314f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c4f20>]}
[0m14:14:12.719172 [debug] [MainThread]: Flushing usage events
[0m14:22:48.250730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065576b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106843b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067eb9b0>]}


============================== 14:22:48.254722 | 9c93aceb-40ff-424c-ad68-7cf6d59a86df ==============================
[0m14:22:48.254722 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:22:48.255225 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select stg_customers.sql', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:22:48.422481 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:22:48.422917 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:22:48.548682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c93aceb-40ff-424c-ad68-7cf6d59a86df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064be000>]}
[0m14:22:48.586305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c93aceb-40ff-424c-ad68-7cf6d59a86df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e403b0>]}
[0m14:22:48.587161 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:22:48.603534 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:22:48.739198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:22:48.739866 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/stg_olist.yml
[0m14:22:48.893281 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:22:48.893768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9c93aceb-40ff-424c-ad68-7cf6d59a86df', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079d2e70>]}
[0m14:22:48.968784 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/staging/olist/stg_olist.yml:
  	test definition dictionary must have exactly one key, got [('accepted_values', None), ('values', ['delivered', 'canceled', 'invoiced', 'processing', 'created', 'shipped', 'unavailable', 'approved'])] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m14:22:48.971071 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.77143574, "process_user_time": 1.439616, "process_kernel_time": 0.269311, "process_mem_max_rss": "116736000", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:22:48.971565 [debug] [MainThread]: Command `dbt test` failed at 14:22:48.971483 after 0.77 seconds
[0m14:22:48.971891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c01a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a420f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a40800>]}
[0m14:22:48.972166 [debug] [MainThread]: Flushing usage events
[0m14:23:32.891557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083500e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107234bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107234b30>]}


============================== 14:23:32.895276 | 7f31e410-4477-4928-94ee-9a0e154c46ce ==============================
[0m14:23:32.895276 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:23:32.895769 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --select stg_customers', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:23:33.061806 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:23:33.062229 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:23:33.186878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f31e410-4477-4928-94ee-9a0e154c46ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107949220>]}
[0m14:23:33.223904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f31e410-4477-4928-94ee-9a0e154c46ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108479a30>]}
[0m14:23:33.224737 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:23:33.240174 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:23:33.375208 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:23:33.375871 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/stg_olist.yml
[0m14:23:33.526467 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:23:33.527002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7f31e410-4477-4928-94ee-9a0e154c46ce', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108914c50>]}
[0m14:23:33.602126 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/staging/olist/stg_olist.yml:
  	test definition dictionary must have exactly one key, got [('accepted_values', None), ('values', ['delivered', 'canceled', 'invoiced', 'processing', 'created', 'shipped', 'unavailable', 'approved'])] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m14:23:33.604401 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.763253, "process_user_time": 1.433049, "process_kernel_time": 0.255148, "process_mem_max_rss": "117276672", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:23:33.604931 [debug] [MainThread]: Command `dbt test` failed at 14:23:33.604851 after 0.76 seconds
[0m14:23:33.605285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094fc350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095c9040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109545e50>]}
[0m14:23:33.605575 [debug] [MainThread]: Flushing usage events
[0m14:25:56.370892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037faf60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103088b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103088aa0>]}


============================== 14:25:56.374832 | efc42a47-faec-4da6-a740-6c6bd958b06a ==============================
[0m14:25:56.374832 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:25:56.375314 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select stg_customers.sql', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:25:56.542252 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:25:56.542666 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:25:56.663089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efc42a47-faec-4da6-a740-6c6bd958b06a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041fe480>]}
[0m14:25:56.702022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efc42a47-faec-4da6-a740-6c6bd958b06a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f25fa0>]}
[0m14:25:56.703099 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:25:56.719246 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:25:56.856820 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:25:56.857516 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/stg_olist.yml
[0m14:25:57.008046 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:25:57.008570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'efc42a47-faec-4da6-a740-6c6bd958b06a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10535b1a0>]}
[0m14:25:57.083589 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/staging/olist/stg_olist.yml:
  	test definition dictionary must have exactly one key, got [('accepted_values', None), ('values', ['delivered', 'canceled', 'invoiced', 'processing', 'created', 'shipped', 'unavailable', 'approved'])] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m14:25:57.085830 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.76481456, "process_user_time": 1.437454, "process_kernel_time": 0.266787, "process_mem_max_rss": "116850688", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:25:57.086324 [debug] [MainThread]: Command `dbt test` failed at 14:25:57.086243 after 0.77 seconds
[0m14:25:57.086644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037faf60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105344290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10551c770>]}
[0m14:25:57.086917 [debug] [MainThread]: Flushing usage events
[0m14:26:23.193758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104abb3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c58b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c58ad0>]}


============================== 14:26:23.197867 | 8f620a54-c33b-421d-8804-f6af4205a335 ==============================
[0m14:26:23.197867 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:26:23.198372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'profiles_dir': '/Users/eranola/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select stg_customers.sql', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:26:23.364196 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:26:23.364612 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:26:23.488773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f620a54-c33b-421d-8804-f6af4205a335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052e3bc0>]}
[0m14:26:23.527799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f620a54-c33b-421d-8804-f6af4205a335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053f7260>]}
[0m14:26:23.528918 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:26:23.544977 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:26:23.683390 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:26:23.684338 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/stg_olist.yml
[0m14:26:23.912481 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/staging/olist/stg_olist.yml:
  	test definition dictionary must have exactly one key, got [('accepted_values', None), ('values', ['delivered', 'canceled', 'invoiced', 'processing', 'created', 'shipped', 'unavailable', 'approved'])] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m14:26:23.914794 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.77144736, "process_user_time": 1.442629, "process_kernel_time": 0.260761, "process_mem_max_rss": "116047872", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:26:23.915341 [debug] [MainThread]: Command `dbt test` failed at 14:26:23.915254 after 0.77 seconds
[0m14:26:23.915700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fb4f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f6b680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e7410>]}
[0m14:26:23.916019 [debug] [MainThread]: Flushing usage events
[0m14:27:26.752826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062481a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10512cc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10512cc50>]}


============================== 14:27:26.757000 | 204e6447-05a8-4071-8af1-2bbf33586024 ==============================
[0m14:27:26.757000 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:27:26.757508 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/eranola/.dbt', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select stg_customers.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:27:26.922233 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:27:26.922656 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:27:27.048508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '204e6447-05a8-4071-8af1-2bbf33586024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c6ff0>]}
[0m14:27:27.085969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '204e6447-05a8-4071-8af1-2bbf33586024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106878c80>]}
[0m14:27:27.086875 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:27:27.102988 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:27:27.235775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:27:27.236445 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/stg_olist.yml
[0m14:27:27.457452 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/staging/olist/stg_olist.yml:
  	test definition dictionary must have exactly one key, got [('accepted_values', None), ('values', ['delivered', 'canceled', 'invoiced', 'processing', 'created', 'shipped', 'unavailable', 'approved'])] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m14:27:27.459737 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.75685865, "process_user_time": 1.438104, "process_kernel_time": 0.255964, "process_mem_max_rss": "118013952", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:27:27.460259 [debug] [MainThread]: Command `dbt test` failed at 14:27:27.460176 after 0.76 seconds
[0m14:27:27.460594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fcbec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d85730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10743fe00>]}
[0m14:27:27.460889 [debug] [MainThread]: Flushing usage events
[0m14:28:23.973637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc7b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d28bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d28b00>]}


============================== 14:28:23.977540 | 13869906-a96d-4e03-b69f-0b8a2a55b74b ==============================
[0m14:28:23.977540 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:28:23.978045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select stg_customers.sql', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:28:24.147353 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:28:24.147767 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:28:24.271700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13869906-a96d-4e03-b69f-0b8a2a55b74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d393a0>]}
[0m14:28:24.308475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13869906-a96d-4e03-b69f-0b8a2a55b74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110287f20>]}
[0m14:28:24.309429 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:28:24.324121 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:28:24.463064 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:28:24.463754 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/stg_olist.yml
[0m14:28:24.748358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13869906-a96d-4e03-b69f-0b8a2a55b74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112850950>]}
[0m14:28:24.830081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13869906-a96d-4e03-b69f-0b8a2a55b74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c002c0>]}
[0m14:28:24.830518 [info ] [MainThread]: Found 11 models, 5 data tests, 10 sources, 488 macros
[0m14:28:24.830979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13869906-a96d-4e03-b69f-0b8a2a55b74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e4cd70>]}
[0m14:28:24.832779 [info ] [MainThread]: 
[0m14:28:24.833308 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:28:24.836507 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_marts'
[0m14:28:24.849872 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m14:28:24.850283 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m14:28:24.850537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:24.853671 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:28:24.854394 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:28:25.649820 [debug] [ThreadPool]: SQL status: SUCCESS in 0.799 seconds
[0m14:28:25.651629 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m14:28:25.652840 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m14:28:25.811591 [debug] [ThreadPool]: SQL status: SUCCESS in 0.158 seconds
[0m14:28:25.816845 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m14:28:26.326708 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m14:28:26.329549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_marts, now list_dev_public_staging)
[0m14:28:26.338472 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m14:28:26.339042 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m14:28:26.339454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:26.340115 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:28:26.340576 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:28:27.138222 [debug] [ThreadPool]: SQL status: SUCCESS in 0.798 seconds
[0m14:28:27.140021 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m14:28:27.141171 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m14:28:27.291586 [debug] [ThreadPool]: SQL status: SUCCESS in 0.149 seconds
[0m14:28:27.296759 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m14:28:27.422046 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m14:28:27.440803 [debug] [MainThread]: Using redshift connection "master"
[0m14:28:27.441451 [debug] [MainThread]: On master: BEGIN
[0m14:28:27.441886 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:28:27.442486 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:28:27.442848 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:28:28.417545 [debug] [MainThread]: SQL status: SUCCESS in 0.976 seconds
[0m14:28:28.418325 [debug] [MainThread]: Using redshift connection "master"
[0m14:28:28.418898 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:28:28.610374 [debug] [MainThread]: SQL status: SUCCESS in 0.191 seconds
[0m14:28:28.614822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13869906-a96d-4e03-b69f-0b8a2a55b74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128280e0>]}
[0m14:28:28.616028 [debug] [MainThread]: On master: ROLLBACK
[0m14:28:28.742160 [debug] [MainThread]: Using redshift connection "master"
[0m14:28:28.743475 [debug] [MainThread]: On master: BEGIN
[0m14:28:28.806344 [debug] [MainThread]: SQL status: SUCCESS in 0.062 seconds
[0m14:28:28.807518 [debug] [MainThread]: On master: COMMIT
[0m14:28:28.808635 [debug] [MainThread]: Using redshift connection "master"
[0m14:28:28.809500 [debug] [MainThread]: On master: COMMIT
[0m14:28:29.191085 [debug] [MainThread]: SQL status: SUCCESS in 0.380 seconds
[0m14:28:29.192739 [debug] [MainThread]: On master: Close
[0m14:28:29.194757 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:28:29.195852 [info ] [MainThread]: 
[0m14:28:29.201887 [debug] [Thread-1 (]: Began running node test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:28:29.202902 [info ] [Thread-1 (]: 1 of 2 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m14:28:29.203851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m14:28:29.204465 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:28:29.225569 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:28:29.227112 [debug] [Thread-1 (]: Began executing node test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:28:29.242500 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:28:29.244667 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:28:29.245019 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m14:28:29.245308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:29.245727 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:28:29.246030 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:28:29.919933 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.674 seconds
[0m14:28:29.922074 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:28:29.923329 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dev"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m14:28:30.258748 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.334 seconds
[0m14:28:30.270419 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m14:28:30.397514 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m14:28:30.398637 [info ] [Thread-1 (]: 1 of 2 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 1.19s]
[0m14:28:30.399366 [debug] [Thread-1 (]: Finished running node test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:28:30.399887 [debug] [Thread-1 (]: Began running node test.olist_dbt.unique_stg_customers_customer_id.c7614daada
[0m14:28:30.400467 [info ] [Thread-1 (]: 2 of 2 START test unique_stg_customers_customer_id ............................. [RUN]
[0m14:28:30.401070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.olist_dbt.unique_stg_customers_customer_id.c7614daada)
[0m14:28:30.401528 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.unique_stg_customers_customer_id.c7614daada
[0m14:28:30.409082 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.unique_stg_customers_customer_id.c7614daada"
[0m14:28:30.410452 [debug] [Thread-1 (]: Began executing node test.olist_dbt.unique_stg_customers_customer_id.c7614daada
[0m14:28:30.412682 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.unique_stg_customers_customer_id.c7614daada"
[0m14:28:30.414888 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.unique_stg_customers_customer_id.c7614daada"
[0m14:28:30.415256 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m14:28:30.415570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:30.416024 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:28:30.416414 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:28:31.111414 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.695 seconds
[0m14:28:31.113606 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.unique_stg_customers_customer_id.c7614daada"
[0m14:28:31.114630 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dev"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:28:31.386939 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.271 seconds
[0m14:28:31.392938 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m14:28:31.520265 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_customers_customer_id.c7614daada: Close
[0m14:28:31.523149 [info ] [Thread-1 (]: 2 of 2 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 1.12s]
[0m14:28:31.524785 [debug] [Thread-1 (]: Finished running node test.olist_dbt.unique_stg_customers_customer_id.c7614daada
[0m14:28:31.527638 [debug] [MainThread]: Using redshift connection "master"
[0m14:28:31.528176 [debug] [MainThread]: On master: BEGIN
[0m14:28:31.528629 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:28:31.529365 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:28:31.530106 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:28:32.308498 [debug] [MainThread]: SQL status: SUCCESS in 0.779 seconds
[0m14:28:32.310540 [debug] [MainThread]: On master: COMMIT
[0m14:28:32.311750 [debug] [MainThread]: Using redshift connection "master"
[0m14:28:32.312474 [debug] [MainThread]: On master: COMMIT
[0m14:28:32.437690 [debug] [MainThread]: SQL status: SUCCESS in 0.124 seconds
[0m14:28:32.439600 [debug] [MainThread]: On master: Close
[0m14:28:32.441457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:32.442388 [debug] [MainThread]: Connection 'test.olist_dbt.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m14:28:32.443275 [info ] [MainThread]: 
[0m14:28:32.444113 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 7.61 seconds (7.61s).
[0m14:28:32.445795 [debug] [MainThread]: Command end result
[0m14:28:32.491164 [info ] [MainThread]: 
[0m14:28:32.491712 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:28:32.492012 [info ] [MainThread]: 
[0m14:28:32.492317 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:28:32.494379 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 8.571412, "process_user_time": 2.173703, "process_kernel_time": 0.379177, "process_mem_max_rss": "130564096", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:28:32.494903 [debug] [MainThread]: Command `dbt test` succeeded at 14:28:32.494824 after 8.57 seconds
[0m14:28:32.495268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110623470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ded0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036a2cf0>]}
[0m14:28:32.495598 [debug] [MainThread]: Flushing usage events
[0m14:28:48.923047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10407f4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10390cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10390ca70>]}


============================== 14:28:48.926927 | efc5aac3-95e7-4e1f-a332-31c8712dafdc ==============================
[0m14:28:48.926927 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:28:48.927442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select stg_orders', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:28:49.092567 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:28:49.092993 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:28:49.218121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efc5aac3-95e7-4e1f-a332-31c8712dafdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10547ac00>]}
[0m14:28:49.255578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efc5aac3-95e7-4e1f-a332-31c8712dafdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c0c9b0>]}
[0m14:28:49.256446 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:28:49.272342 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:28:49.407501 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:28:49.407890 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:28:49.440299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efc5aac3-95e7-4e1f-a332-31c8712dafdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10592b260>]}
[0m14:28:49.522975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efc5aac3-95e7-4e1f-a332-31c8712dafdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106252840>]}
[0m14:28:49.523425 [info ] [MainThread]: Found 11 models, 5 data tests, 10 sources, 488 macros
[0m14:28:49.523718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efc5aac3-95e7-4e1f-a332-31c8712dafdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10592af90>]}
[0m14:28:49.525098 [info ] [MainThread]: 
[0m14:28:49.525559 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:28:49.528733 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_marts'
[0m14:28:49.543101 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m14:28:49.543508 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m14:28:49.543741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:49.546875 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:28:49.547769 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:28:50.807373 [debug] [ThreadPool]: SQL status: SUCCESS in 1.263 seconds
[0m14:28:50.809443 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m14:28:50.810549 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m14:28:51.408394 [debug] [ThreadPool]: SQL status: SUCCESS in 0.596 seconds
[0m14:28:51.413527 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m14:28:51.551548 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m14:28:51.555095 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_marts, now list_dev_public_staging)
[0m14:28:51.564520 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m14:28:51.565142 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m14:28:51.565580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:51.566230 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:28:51.566683 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:28:52.345245 [debug] [ThreadPool]: SQL status: SUCCESS in 0.779 seconds
[0m14:28:52.346877 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m14:28:52.347662 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m14:28:52.496581 [debug] [ThreadPool]: SQL status: SUCCESS in 0.148 seconds
[0m14:28:52.502333 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m14:28:52.630996 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m14:28:52.650115 [debug] [MainThread]: Using redshift connection "master"
[0m14:28:52.650735 [debug] [MainThread]: On master: BEGIN
[0m14:28:52.651148 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:28:52.656168 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:28:52.656551 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:28:53.373207 [debug] [MainThread]: SQL status: SUCCESS in 0.722 seconds
[0m14:28:53.373773 [debug] [MainThread]: Using redshift connection "master"
[0m14:28:53.374151 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:28:53.566966 [debug] [MainThread]: SQL status: SUCCESS in 0.192 seconds
[0m14:28:53.570492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efc5aac3-95e7-4e1f-a332-31c8712dafdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e4ac90>]}
[0m14:28:53.571282 [debug] [MainThread]: On master: ROLLBACK
[0m14:28:53.700932 [debug] [MainThread]: Using redshift connection "master"
[0m14:28:53.702223 [debug] [MainThread]: On master: BEGIN
[0m14:28:53.771368 [debug] [MainThread]: SQL status: SUCCESS in 0.068 seconds
[0m14:28:53.772735 [debug] [MainThread]: On master: COMMIT
[0m14:28:53.773987 [debug] [MainThread]: Using redshift connection "master"
[0m14:28:53.774909 [debug] [MainThread]: On master: COMMIT
[0m14:28:53.903360 [debug] [MainThread]: SQL status: SUCCESS in 0.128 seconds
[0m14:28:53.904120 [debug] [MainThread]: On master: Close
[0m14:28:53.904955 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:28:53.905550 [info ] [MainThread]: 
[0m14:28:53.908577 [debug] [Thread-1 (]: Began running node test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d
[0m14:28:53.909347 [info ] [Thread-1 (]: 1 of 3 START test accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved  [RUN]
[0m14:28:53.910020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d)
[0m14:28:53.910717 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d
[0m14:28:53.924902 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d"
[0m14:28:53.926196 [debug] [Thread-1 (]: Began executing node test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d
[0m14:28:53.940486 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d"
[0m14:28:53.942720 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d"
[0m14:28:53.943066 [debug] [Thread-1 (]: On test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d: BEGIN
[0m14:28:53.943335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:53.943712 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:28:53.943995 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:28:54.623325 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.679 seconds
[0m14:28:54.625156 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d"
[0m14:28:54.626492 [debug] [Thread-1 (]: On test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "dev"."public_staging"."stg_orders"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','canceled','invoiced','processing','created','shipped','unavailable','approved'
)



      
    ) dbt_internal_test
[0m14:28:59.403179 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.775 seconds
[0m14:28:59.415584 [debug] [Thread-1 (]: On test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d: ROLLBACK
[0m14:28:59.542005 [debug] [Thread-1 (]: On test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d: Close
[0m14:28:59.545149 [info ] [Thread-1 (]: 1 of 3 PASS accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved  [[32mPASS[0m in 5.63s]
[0m14:28:59.547183 [debug] [Thread-1 (]: Finished running node test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d
[0m14:28:59.548435 [debug] [Thread-1 (]: Began running node test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m14:28:59.549577 [info ] [Thread-1 (]: 2 of 3 START test not_null_stg_orders_order_id ................................. [RUN]
[0m14:28:59.550542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d, now test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64)
[0m14:28:59.551254 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m14:28:59.562746 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:28:59.564619 [debug] [Thread-1 (]: Began executing node test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m14:28:59.567575 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:28:59.569843 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:28:59.570296 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m14:28:59.570678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:59.571229 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:28:59.571639 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:29:00.258531 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.687 seconds
[0m14:29:00.260201 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:29:00.261218 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "dev"."public_staging"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m14:29:00.540416 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.278 seconds
[0m14:29:00.545309 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m14:29:00.674144 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m14:29:00.676519 [info ] [Thread-1 (]: 2 of 3 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 1.13s]
[0m14:29:00.678192 [debug] [Thread-1 (]: Finished running node test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m14:29:00.679170 [debug] [Thread-1 (]: Began running node test.olist_dbt.unique_stg_orders_order_id.e3b841c71a
[0m14:29:00.680034 [info ] [Thread-1 (]: 3 of 3 START test unique_stg_orders_order_id ................................... [RUN]
[0m14:29:00.680939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64, now test.olist_dbt.unique_stg_orders_order_id.e3b841c71a)
[0m14:29:00.681503 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.unique_stg_orders_order_id.e3b841c71a
[0m14:29:00.693458 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m14:29:00.695133 [debug] [Thread-1 (]: Began executing node test.olist_dbt.unique_stg_orders_order_id.e3b841c71a
[0m14:29:00.698311 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m14:29:00.701055 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m14:29:00.701513 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m14:29:00.701906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:29:00.702468 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:29:00.702863 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:29:01.696005 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.994 seconds
[0m14:29:01.697640 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m14:29:01.698825 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."public_staging"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:29:02.044487 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.344 seconds
[0m14:29:02.049193 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m14:29:02.175393 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_orders_order_id.e3b841c71a: Close
[0m14:29:02.178774 [info ] [Thread-1 (]: 3 of 3 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 1.50s]
[0m14:29:02.180183 [debug] [Thread-1 (]: Finished running node test.olist_dbt.unique_stg_orders_order_id.e3b841c71a
[0m14:29:02.182648 [debug] [MainThread]: Using redshift connection "master"
[0m14:29:02.183200 [debug] [MainThread]: On master: BEGIN
[0m14:29:02.184118 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:29:02.185108 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:29:02.185647 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:29:02.882871 [debug] [MainThread]: SQL status: SUCCESS in 0.698 seconds
[0m14:29:02.884880 [debug] [MainThread]: On master: COMMIT
[0m14:29:02.886147 [debug] [MainThread]: Using redshift connection "master"
[0m14:29:02.886710 [debug] [MainThread]: On master: COMMIT
[0m14:29:03.010295 [debug] [MainThread]: SQL status: SUCCESS in 0.123 seconds
[0m14:29:03.011968 [debug] [MainThread]: On master: Close
[0m14:29:03.013832 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:29:03.014483 [debug] [MainThread]: Connection 'test.olist_dbt.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m14:29:03.015206 [info ] [MainThread]: 
[0m14:29:03.015887 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 13.49 seconds (13.49s).
[0m14:29:03.017552 [debug] [MainThread]: Command end result
[0m14:29:03.065759 [info ] [MainThread]: 
[0m14:29:03.066211 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:29:03.066498 [info ] [MainThread]: 
[0m14:29:03.066789 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:29:03.068750 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 14.196257, "process_user_time": 2.011585, "process_kernel_time": 0.372358, "process_mem_max_rss": "124354560", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:29:03.069215 [debug] [MainThread]: Command `dbt test` succeeded at 14:29:03.069148 after 14.20 seconds
[0m14:29:03.069513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101452cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105013e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e07fe0>]}
[0m14:29:03.069784 [debug] [MainThread]: Flushing usage events
[0m14:44:24.610955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110005610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100289b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100289e0>]}


============================== 14:44:24.615478 | 747e6ff3-0086-4099-bf2b-dfeabda8a05b ==============================
[0m14:44:24.615478 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:44:24.616005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/eranola/.dbt', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select stg_order_items', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:44:24.795468 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:44:24.795899 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:44:24.934485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '747e6ff3-0086-4099-bf2b-dfeabda8a05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111511190>]}
[0m14:44:24.971848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '747e6ff3-0086-4099-bf2b-dfeabda8a05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109765d0>]}
[0m14:44:24.972926 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:44:24.989910 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:44:25.129166 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:44:25.129552 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:44:25.162071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '747e6ff3-0086-4099-bf2b-dfeabda8a05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cc2990>]}
[0m14:44:25.247955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '747e6ff3-0086-4099-bf2b-dfeabda8a05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b56600>]}
[0m14:44:25.248402 [info ] [MainThread]: Found 11 models, 5 data tests, 10 sources, 488 macros
[0m14:44:25.248695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '747e6ff3-0086-4099-bf2b-dfeabda8a05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a1a570>]}
[0m14:44:25.249911 [info ] [MainThread]: 
[0m14:44:25.250204 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:44:25.251561 [debug] [MainThread]: Command end result
[0m14:44:25.277767 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.7201359, "process_user_time": 1.349824, "process_kernel_time": 0.298368, "process_mem_max_rss": "114606080", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:44:25.278364 [debug] [MainThread]: Command `dbt test` succeeded at 14:44:25.278290 after 0.72 seconds
[0m14:44:25.278695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10538acf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a1b440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11146a120>]}
[0m14:44:25.278980 [debug] [MainThread]: Flushing usage events
[0m14:58:45.499731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103464a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030cc440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103edff50>]}


============================== 14:58:45.504228 | e6bf208e-c1af-40ec-8de1-ea7ca9a0b782 ==============================
[0m14:58:45.504228 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:58:45.504730 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'profiles_dir': '/Users/eranola/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select stg_order_items', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:58:45.675592 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:58:45.675997 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:58:46.125241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6bf208e-c1af-40ec-8de1-ea7ca9a0b782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044df1d0>]}
[0m14:58:46.162224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6bf208e-c1af-40ec-8de1-ea7ca9a0b782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10340ade0>]}
[0m14:58:46.165955 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:58:46.192149 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:58:46.331090 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:58:46.331728 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/stg_olist.yml
[0m14:58:46.372530 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:58:46.373016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e6bf208e-c1af-40ec-8de1-ea7ca9a0b782', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10504a030>]}
[0m14:58:46.510323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6bf208e-c1af-40ec-8de1-ea7ca9a0b782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10520f830>]}
[0m14:58:46.597367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6bf208e-c1af-40ec-8de1-ea7ca9a0b782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105368d10>]}
[0m14:58:46.597813 [info ] [MainThread]: Found 11 models, 6 data tests, 10 sources, 488 macros
[0m14:58:46.598099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6bf208e-c1af-40ec-8de1-ea7ca9a0b782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049d09e0>]}
[0m14:58:46.599375 [info ] [MainThread]: 
[0m14:58:46.599824 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:58:46.603009 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_staging'
[0m14:58:46.616552 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m14:58:46.616969 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m14:58:46.617222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:46.620332 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:58:46.621082 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:58:47.493104 [debug] [ThreadPool]: SQL status: SUCCESS in 0.875 seconds
[0m14:58:47.494525 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m14:58:47.495411 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m14:58:47.646132 [debug] [ThreadPool]: SQL status: SUCCESS in 0.150 seconds
[0m14:58:47.651950 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m14:58:47.791813 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m14:58:47.795333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_staging, now list_dev_public_marts)
[0m14:58:47.804792 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m14:58:47.805468 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m14:58:47.805911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:47.806584 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:58:47.807033 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:58:48.497234 [debug] [ThreadPool]: SQL status: SUCCESS in 0.691 seconds
[0m14:58:48.499163 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m14:58:48.500324 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m14:58:48.645233 [debug] [ThreadPool]: SQL status: SUCCESS in 0.144 seconds
[0m14:58:48.647446 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m14:58:48.771255 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m14:58:48.783385 [debug] [MainThread]: Using redshift connection "master"
[0m14:58:48.783885 [debug] [MainThread]: On master: BEGIN
[0m14:58:48.784251 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:58:48.784820 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:58:48.785211 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:58:49.487293 [debug] [MainThread]: SQL status: SUCCESS in 0.703 seconds
[0m14:58:49.489015 [debug] [MainThread]: Using redshift connection "master"
[0m14:58:49.490264 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:58:49.684454 [debug] [MainThread]: SQL status: SUCCESS in 0.193 seconds
[0m14:58:49.689503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6bf208e-c1af-40ec-8de1-ea7ca9a0b782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044ddfd0>]}
[0m14:58:49.691020 [debug] [MainThread]: On master: ROLLBACK
[0m14:58:49.811811 [debug] [MainThread]: Using redshift connection "master"
[0m14:58:49.813353 [debug] [MainThread]: On master: BEGIN
[0m14:58:49.875143 [debug] [MainThread]: SQL status: SUCCESS in 0.061 seconds
[0m14:58:49.876325 [debug] [MainThread]: On master: COMMIT
[0m14:58:49.877440 [debug] [MainThread]: Using redshift connection "master"
[0m14:58:49.878334 [debug] [MainThread]: On master: COMMIT
[0m14:58:50.005384 [debug] [MainThread]: SQL status: SUCCESS in 0.126 seconds
[0m14:58:50.006885 [debug] [MainThread]: On master: Close
[0m14:58:50.008923 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:58:50.009605 [info ] [MainThread]: 
[0m14:58:50.014759 [debug] [Thread-1 (]: Began running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m14:58:50.015587 [info ] [Thread-1 (]: 1 of 1 START test assert_stg_order_items_values_positive_stg_order_items_ ...... [RUN]
[0m14:58:50.016475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_marts, now test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd)
[0m14:58:50.017364 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m14:58:50.035900 [debug] [Thread-1 (]: Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:58:50.036639 [error] [Thread-1 (]: 1 of 1 ERROR assert_stg_order_items_values_positive_stg_order_items_ ........... [[31mERROR[0m in 0.02s]
[0m14:58:50.037229 [debug] [Thread-1 (]: Finished running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m14:58:50.039383 [debug] [MainThread]: Using redshift connection "master"
[0m14:58:50.039857 [debug] [MainThread]: On master: BEGIN
[0m14:58:50.040163 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:58:50.040617 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:58:50.041031 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:58:50.713244 [debug] [MainThread]: SQL status: SUCCESS in 0.673 seconds
[0m14:58:50.715036 [debug] [MainThread]: On master: COMMIT
[0m14:58:50.716409 [debug] [MainThread]: Using redshift connection "master"
[0m14:58:50.717332 [debug] [MainThread]: On master: COMMIT
[0m14:58:50.843019 [debug] [MainThread]: SQL status: SUCCESS in 0.124 seconds
[0m14:58:50.844771 [debug] [MainThread]: On master: Close
[0m14:58:50.846443 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:50.847139 [debug] [MainThread]: Connection 'test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd' was properly closed.
[0m14:58:50.847896 [info ] [MainThread]: 
[0m14:58:50.848594 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 4.25 seconds (4.25s).
[0m14:58:50.849841 [debug] [MainThread]: Command end result
[0m14:58:50.892114 [info ] [MainThread]: 
[0m14:58:50.892656 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:58:50.892951 [info ] [MainThread]: 
[0m14:58:50.893312 [error] [MainThread]:   Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:58:50.893597 [info ] [MainThread]: 
[0m14:58:50.893871 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:58:50.911406 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 5.4645147, "process_user_time": 1.925347, "process_kernel_time": 0.409631, "process_mem_max_rss": "124583936", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:58:50.912118 [debug] [MainThread]: Command `dbt test` failed at 14:58:50.912026 after 5.47 seconds
[0m14:58:50.912489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1008d6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103afe9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103edff20>]}
[0m14:58:50.912817 [debug] [MainThread]: Flushing usage events
[0m14:59:33.352805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106722ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c28bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c28bc0>]}


============================== 14:59:33.357290 | c45c7b77-a255-4d63-976c-a9b0d72442d8 ==============================
[0m14:59:33.357290 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:59:33.357802 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --select stg_order_items', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:59:33.527761 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:59:33.528175 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:59:33.662684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c45c7b77-a255-4d63-976c-a9b0d72442d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ebe360>]}
[0m14:59:33.700039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c45c7b77-a255-4d63-976c-a9b0d72442d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062eef90>]}
[0m14:59:33.701841 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:59:33.719393 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:59:33.855335 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:59:33.856021 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/stg_olist.yml
[0m14:59:34.129208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c45c7b77-a255-4d63-976c-a9b0d72442d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d9d00>]}
[0m14:59:34.215236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c45c7b77-a255-4d63-976c-a9b0d72442d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108133fe0>]}
[0m14:59:34.215698 [info ] [MainThread]: Found 11 models, 6 data tests, 10 sources, 488 macros
[0m14:59:34.215993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c45c7b77-a255-4d63-976c-a9b0d72442d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d8dd0>]}
[0m14:59:34.217305 [info ] [MainThread]: 
[0m14:59:34.217749 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:59:34.220947 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_marts'
[0m14:59:34.234656 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m14:59:34.235041 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m14:59:34.235284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:34.238474 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:59:34.239205 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:59:35.031959 [debug] [ThreadPool]: SQL status: SUCCESS in 0.796 seconds
[0m14:59:35.033852 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m14:59:35.035002 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m14:59:35.177856 [debug] [ThreadPool]: SQL status: SUCCESS in 0.141 seconds
[0m14:59:35.183532 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m14:59:35.303602 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m14:59:35.306283 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_marts, now list_dev_public_staging)
[0m14:59:35.314954 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m14:59:35.315540 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m14:59:35.315985 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:59:35.316629 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:59:35.317068 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:59:35.996372 [debug] [ThreadPool]: SQL status: SUCCESS in 0.680 seconds
[0m14:59:35.998194 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m14:59:35.999304 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m14:59:36.147660 [debug] [ThreadPool]: SQL status: SUCCESS in 0.147 seconds
[0m14:59:36.153150 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m14:59:36.277635 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m14:59:36.296417 [debug] [MainThread]: Using redshift connection "master"
[0m14:59:36.297033 [debug] [MainThread]: On master: BEGIN
[0m14:59:36.297467 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:59:36.298076 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:59:36.298436 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:59:36.971278 [debug] [MainThread]: SQL status: SUCCESS in 0.673 seconds
[0m14:59:36.973126 [debug] [MainThread]: Using redshift connection "master"
[0m14:59:36.974362 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:59:37.168233 [debug] [MainThread]: SQL status: SUCCESS in 0.192 seconds
[0m14:59:37.173779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c45c7b77-a255-4d63-976c-a9b0d72442d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10746b530>]}
[0m14:59:37.175155 [debug] [MainThread]: On master: ROLLBACK
[0m14:59:37.307772 [debug] [MainThread]: Using redshift connection "master"
[0m14:59:37.309290 [debug] [MainThread]: On master: BEGIN
[0m14:59:37.371154 [debug] [MainThread]: SQL status: SUCCESS in 0.061 seconds
[0m14:59:37.372181 [debug] [MainThread]: On master: COMMIT
[0m14:59:37.372948 [debug] [MainThread]: Using redshift connection "master"
[0m14:59:37.373424 [debug] [MainThread]: On master: COMMIT
[0m14:59:37.495498 [debug] [MainThread]: SQL status: SUCCESS in 0.122 seconds
[0m14:59:37.496151 [debug] [MainThread]: On master: Close
[0m14:59:37.496892 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:59:37.497314 [info ] [MainThread]: 
[0m14:59:37.501129 [debug] [Thread-1 (]: Began running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m14:59:37.501733 [info ] [Thread-1 (]: 1 of 1 START test assert_stg_order_items_values_positive_stg_order_items_ ...... [RUN]
[0m14:59:37.502323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd)
[0m14:59:37.502957 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m14:59:37.513118 [debug] [Thread-1 (]: Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:59:37.513748 [error] [Thread-1 (]: 1 of 1 ERROR assert_stg_order_items_values_positive_stg_order_items_ ........... [[31mERROR[0m in 0.01s]
[0m14:59:37.514303 [debug] [Thread-1 (]: Finished running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m14:59:37.520203 [debug] [MainThread]: Using redshift connection "master"
[0m14:59:37.520553 [debug] [MainThread]: On master: BEGIN
[0m14:59:37.520914 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:59:37.521326 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:59:37.521611 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:59:38.182252 [debug] [MainThread]: SQL status: SUCCESS in 0.661 seconds
[0m14:59:38.184137 [debug] [MainThread]: On master: COMMIT
[0m14:59:38.185515 [debug] [MainThread]: Using redshift connection "master"
[0m14:59:38.186454 [debug] [MainThread]: On master: COMMIT
[0m14:59:38.305107 [debug] [MainThread]: SQL status: SUCCESS in 0.118 seconds
[0m14:59:38.306551 [debug] [MainThread]: On master: Close
[0m14:59:38.308369 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:59:38.309243 [debug] [MainThread]: Connection 'test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd' was properly closed.
[0m14:59:38.310284 [info ] [MainThread]: 
[0m14:59:38.311270 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 4.09 seconds (4.09s).
[0m14:59:38.312577 [debug] [MainThread]: Command end result
[0m14:59:38.355146 [info ] [MainThread]: 
[0m14:59:38.355699 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:59:38.355992 [info ] [MainThread]: 
[0m14:59:38.356344 [error] [MainThread]:   Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:59:38.356624 [info ] [MainThread]: 
[0m14:59:38.356912 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:59:38.359851 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 5.0591516, "process_user_time": 1.949206, "process_kernel_time": 0.385244, "process_mem_max_rss": "127795200", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:59:38.360465 [debug] [MainThread]: Command `dbt test` failed at 14:59:38.360377 after 5.06 seconds
[0m14:59:38.360886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10376ecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10688cbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d77fb0>]}
[0m14:59:38.361256 [debug] [MainThread]: Flushing usage events
[0m16:08:31.904123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d1eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f93fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f93ef0>]}


============================== 16:08:31.908593 | 2438204a-5384-456e-89cd-3d4088de8ab1 ==============================
[0m16:08:31.908593 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:08:31.909149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select assert_stg_order_items_values_positive', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:08:32.086717 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:08:32.087136 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:08:32.228065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2438204a-5384-456e-89cd-3d4088de8ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f3b800>]}
[0m16:08:32.265414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2438204a-5384-456e-89cd-3d4088de8ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106855a60>]}
[0m16:08:32.266479 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:08:32.283372 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:08:32.422723 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:08:32.423126 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:08:32.455628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2438204a-5384-456e-89cd-3d4088de8ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108684890>]}
[0m16:08:32.542848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2438204a-5384-456e-89cd-3d4088de8ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108630980>]}
[0m16:08:32.543298 [info ] [MainThread]: Found 11 models, 6 data tests, 10 sources, 488 macros
[0m16:08:32.543585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2438204a-5384-456e-89cd-3d4088de8ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab2540>]}
[0m16:08:32.544142 [warn ] [MainThread]: The selection criterion 'assert_stg_order_items_values_positive' does not match any enabled nodes
[0m16:08:32.545103 [info ] [MainThread]: 
[0m16:08:32.545380 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:08:32.546736 [debug] [MainThread]: Command end result
[0m16:08:32.573593 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.72763604, "process_user_time": 1.339682, "process_kernel_time": 0.305918, "process_mem_max_rss": "116047872", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:08:32.574127 [debug] [MainThread]: Command `dbt test` succeeded at 16:08:32.574052 after 0.73 seconds
[0m16:08:32.574445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108adc770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f93ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f93a40>]}
[0m16:08:32.574721 [debug] [MainThread]: Flushing usage events
[0m16:15:22.787479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a20bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a57bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a57fe0>]}


============================== 16:15:22.791916 | 033d8146-49fd-4135-8d02-a508634fbf4c ==============================
[0m16:15:22.791916 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:15:22.792411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select stg_order_items', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:15:22.964358 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:15:22.964800 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:15:23.098379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '033d8146-49fd-4135-8d02-a508634fbf4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a20f50>]}
[0m16:15:23.135857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '033d8146-49fd-4135-8d02-a508634fbf4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b8470>]}
[0m16:15:23.137756 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:15:23.154081 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:15:23.237070 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading olist_dbt: staging/olist/stg_olist.yml - Runtime Error
    Syntax error near line 26
    ------------------------------
    23 |               values: ['delivered', 'canceled', 'invoiced', 'processing', 'created', 'shipped', 'unavailable', 'approved']
    24 |   
    25 |   - name: stg_order_items
    26 |       data_tests:
    27 |         - assert_stg_order_items_values_positive
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 26, column 17
[0m16:15:23.239599 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.5035858, "process_user_time": 1.198968, "process_kernel_time": 0.262676, "process_mem_max_rss": "111509504", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:15:23.240124 [debug] [MainThread]: Command `dbt test` failed at 16:15:23.240042 after 0.50 seconds
[0m16:15:23.240483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d41a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105576840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba21e0>]}
[0m16:15:23.240779 [debug] [MainThread]: Flushing usage events
[0m16:15:38.693333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d6c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104128920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041288f0>]}


============================== 16:15:38.697249 | 4b43b656-5b40-4a91-917d-cd882c983295 ==============================
[0m16:15:38.697249 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:15:38.697757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select assert_stg_order_items_values_positive', 'send_anonymous_usage_stats': 'True'}
[0m16:15:38.860501 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:15:38.860936 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:15:38.985542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b43b656-5b40-4a91-917d-cd882c983295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10654f020>]}
[0m16:15:39.022907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b43b656-5b40-4a91-917d-cd882c983295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044dbfb0>]}
[0m16:15:39.023805 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:15:39.040083 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:15:39.121993 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading olist_dbt: staging/olist/stg_olist.yml - Runtime Error
    Syntax error near line 26
    ------------------------------
    23 |               values: ['delivered', 'canceled', 'invoiced', 'processing', 'created', 'shipped', 'unavailable', 'approved']
    24 |   
    25 |   - name: stg_order_items
    26 |       data_tests:
    27 |         - assert_stg_order_items_values_positive
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 26, column 17
[0m16:15:39.123972 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.48150876, "process_user_time": 1.244239, "process_kernel_time": 0.243504, "process_mem_max_rss": "114065408", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:15:39.124467 [debug] [MainThread]: Command `dbt test` failed at 16:15:39.124386 after 0.48 seconds
[0m16:15:39.124804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d56cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071f0c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071f08c0>]}
[0m16:15:39.125094 [debug] [MainThread]: Flushing usage events
[0m16:16:21.869690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103485af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ef3fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ef3e90>]}


============================== 16:16:21.873601 | 449fac60-0c94-4609-8ec7-42d15b2d2930 ==============================
[0m16:16:21.873601 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:16:21.874110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select assert_stg_order_items_values_positive', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:16:22.040987 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:16:22.041428 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:16:22.167922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '449fac60-0c94-4609-8ec7-42d15b2d2930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f1a3f0>]}
[0m16:16:22.205373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '449fac60-0c94-4609-8ec7-42d15b2d2930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041248c0>]}
[0m16:16:22.206207 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:16:22.222073 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:16:22.303254 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading olist_dbt: staging/olist/stg_olist.yml - Runtime Error
    Syntax error near line 26
    ------------------------------
    23 |               values: ['delivered', 'canceled', 'invoiced', 'processing', 'created', 'shipped', 'unavailable', 'approved']
    24 |   
    25 |   - name: stg_order_items
    26 |       data_tests:
    27 |         - assert_stg_order_items_values_positive
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 26, column 17
[0m16:16:22.305125 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.48594704, "process_user_time": 1.202144, "process_kernel_time": 0.242595, "process_mem_max_rss": "111640576", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:16:22.305624 [debug] [MainThread]: Command `dbt test` failed at 16:16:22.305542 after 0.49 seconds
[0m16:16:22.305961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f91af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f91700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f72d50>]}
[0m16:16:22.306257 [debug] [MainThread]: Flushing usage events
[0m16:16:26.311255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071eede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dffa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dfff20>]}


============================== 16:16:26.315117 | 16cc0633-305d-4260-94c0-315e8f7940f0 ==============================
[0m16:16:26.315117 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:16:26.315615 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select stg_order_items', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:16:26.480232 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:16:26.480661 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:16:26.606329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16cc0633-305d-4260-94c0-315e8f7940f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef66f0>]}
[0m16:16:26.643741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16cc0633-305d-4260-94c0-315e8f7940f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10844e6c0>]}
[0m16:16:26.644574 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:16:26.660515 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:16:26.741291 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading olist_dbt: staging/olist/stg_olist.yml - Runtime Error
    Syntax error near line 26
    ------------------------------
    23 |               values: ['delivered', 'canceled', 'invoiced', 'processing', 'created', 'shipped', 'unavailable', 'approved']
    24 |   
    25 |   - name: stg_order_items
    26 |       data_tests:
    27 |         - assert_stg_order_items_values_positive
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 26, column 17
[0m16:16:26.743211 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.48219842, "process_user_time": 1.204222, "process_kernel_time": 0.233815, "process_mem_max_rss": "111804416", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:16:26.743712 [debug] [MainThread]: Command `dbt test` failed at 16:16:26.743630 after 0.48 seconds
[0m16:16:26.744056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f6cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ea18e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ea1550>]}
[0m16:16:26.744352 [debug] [MainThread]: Flushing usage events
[0m16:17:28.477746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea0e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d88aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d88b60>]}


============================== 16:17:28.481784 | e5551d00-51ca-4f9c-95ec-f7e2f15065d6 ==============================
[0m16:17:28.481784 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:17:28.482283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'profiles_dir': '/Users/eranola/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select stg_order_items', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:17:28.646053 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:17:28.646479 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:17:28.771724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5551d00-51ca-4f9c-95ec-f7e2f15065d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d6510>]}
[0m16:17:28.808989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5551d00-51ca-4f9c-95ec-f7e2f15065d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea3860>]}
[0m16:17:28.809913 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:17:28.825922 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:17:28.956486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:17:28.956866 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:17:28.989291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5551d00-51ca-4f9c-95ec-f7e2f15065d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f7aa0>]}
[0m16:17:29.075659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5551d00-51ca-4f9c-95ec-f7e2f15065d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071dec60>]}
[0m16:17:29.076113 [info ] [MainThread]: Found 11 models, 6 data tests, 10 sources, 488 macros
[0m16:17:29.076410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5551d00-51ca-4f9c-95ec-f7e2f15065d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f78f0>]}
[0m16:17:29.077699 [info ] [MainThread]: 
[0m16:17:29.078132 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m16:17:29.081289 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_staging'
[0m16:17:29.096038 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m16:17:29.096476 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m16:17:29.096730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:29.099818 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:17:29.100542 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:17:30.023679 [debug] [ThreadPool]: SQL status: SUCCESS in 0.926 seconds
[0m16:17:30.025592 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m16:17:30.026883 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m16:17:30.177078 [debug] [ThreadPool]: SQL status: SUCCESS in 0.149 seconds
[0m16:17:30.183734 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m16:17:30.315110 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m16:17:30.318261 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_staging, now list_dev_public_marts)
[0m16:17:30.328878 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m16:17:30.329582 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m16:17:30.330024 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:17:30.330645 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:17:30.331095 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:17:31.049339 [debug] [ThreadPool]: SQL status: SUCCESS in 0.719 seconds
[0m16:17:31.051431 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m16:17:31.052603 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m16:17:31.209782 [debug] [ThreadPool]: SQL status: SUCCESS in 0.156 seconds
[0m16:17:31.215253 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m16:17:31.348499 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m16:17:31.365809 [debug] [MainThread]: Using redshift connection "master"
[0m16:17:31.366514 [debug] [MainThread]: On master: BEGIN
[0m16:17:31.366943 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:17:31.367561 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:17:31.367935 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:17:32.097383 [debug] [MainThread]: SQL status: SUCCESS in 0.730 seconds
[0m16:17:32.099221 [debug] [MainThread]: Using redshift connection "master"
[0m16:17:32.100388 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m16:17:32.294190 [debug] [MainThread]: SQL status: SUCCESS in 0.192 seconds
[0m16:17:32.299050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5551d00-51ca-4f9c-95ec-f7e2f15065d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d5e20>]}
[0m16:17:32.300399 [debug] [MainThread]: On master: ROLLBACK
[0m16:17:32.432304 [debug] [MainThread]: Using redshift connection "master"
[0m16:17:32.433736 [debug] [MainThread]: On master: BEGIN
[0m16:17:32.498243 [debug] [MainThread]: SQL status: SUCCESS in 0.063 seconds
[0m16:17:32.500131 [debug] [MainThread]: On master: COMMIT
[0m16:17:32.501393 [debug] [MainThread]: Using redshift connection "master"
[0m16:17:32.502198 [debug] [MainThread]: On master: COMMIT
[0m16:17:32.632229 [debug] [MainThread]: SQL status: SUCCESS in 0.129 seconds
[0m16:17:32.633968 [debug] [MainThread]: On master: Close
[0m16:17:32.635511 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:17:32.636438 [info ] [MainThread]: 
[0m16:17:32.642517 [debug] [Thread-1 (]: Began running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m16:17:32.643330 [info ] [Thread-1 (]: 1 of 1 START test assert_stg_order_items_values_positive_stg_order_items_ ...... [RUN]
[0m16:17:32.644042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_marts, now test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd)
[0m16:17:32.644569 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m16:17:32.662792 [debug] [Thread-1 (]: Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:17:32.663675 [error] [Thread-1 (]: 1 of 1 ERROR assert_stg_order_items_values_positive_stg_order_items_ ........... [[31mERROR[0m in 0.02s]
[0m16:17:32.664361 [debug] [Thread-1 (]: Finished running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m16:17:32.666248 [debug] [MainThread]: Using redshift connection "master"
[0m16:17:32.666663 [debug] [MainThread]: On master: BEGIN
[0m16:17:32.667041 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:17:32.667566 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:17:32.667899 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:17:33.334811 [debug] [MainThread]: SQL status: SUCCESS in 0.667 seconds
[0m16:17:33.336939 [debug] [MainThread]: On master: COMMIT
[0m16:17:33.338441 [debug] [MainThread]: Using redshift connection "master"
[0m16:17:33.339257 [debug] [MainThread]: On master: COMMIT
[0m16:17:33.466591 [debug] [MainThread]: SQL status: SUCCESS in 0.126 seconds
[0m16:17:33.468443 [debug] [MainThread]: On master: Close
[0m16:17:33.470241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:17:33.470932 [debug] [MainThread]: Connection 'test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd' was properly closed.
[0m16:17:33.471781 [info ] [MainThread]: 
[0m16:17:33.472490 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 4.39 seconds (4.39s).
[0m16:17:33.473957 [debug] [MainThread]: Command end result
[0m16:17:33.517406 [info ] [MainThread]: 
[0m16:17:33.517961 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:17:33.518262 [info ] [MainThread]: 
[0m16:17:33.518623 [error] [MainThread]:   Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:17:33.518895 [info ] [MainThread]: 
[0m16:17:33.519171 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:17:33.521501 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 5.0959363, "process_user_time": 1.770532, "process_kernel_time": 0.359287, "process_mem_max_rss": "120307712", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:17:33.522003 [debug] [MainThread]: Command `dbt test` failed at 16:17:33.521928 after 5.10 seconds
[0m16:17:33.522379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea0e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d5e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106590c20>]}
[0m16:17:33.522702 [debug] [MainThread]: Flushing usage events
[0m16:29:01.899940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd5400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cfca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cfc9b0>]}


============================== 16:29:01.904552 | be7fa36e-a8a8-44f0-8153-21de0e6cef5f ==============================
[0m16:29:01.904552 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:29:01.905092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select stg_order_items', 'send_anonymous_usage_stats': 'True'}
[0m16:29:02.082719 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:29:02.083145 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:29:02.224294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be7fa36e-a8a8-44f0-8153-21de0e6cef5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f65160>]}
[0m16:29:02.261598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be7fa36e-a8a8-44f0-8153-21de0e6cef5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10853a030>]}
[0m16:29:02.262739 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:29:02.279822 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:29:02.419350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:29:02.419765 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:29:02.452511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be7fa36e-a8a8-44f0-8153-21de0e6cef5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108990110>]}
[0m16:29:02.542934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be7fa36e-a8a8-44f0-8153-21de0e6cef5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109006e10>]}
[0m16:29:02.543376 [info ] [MainThread]: Found 11 models, 6 data tests, 10 sources, 488 macros
[0m16:29:02.543666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be7fa36e-a8a8-44f0-8153-21de0e6cef5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b1b50>]}
[0m16:29:02.545012 [info ] [MainThread]: 
[0m16:29:02.545437 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m16:29:02.548562 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_marts'
[0m16:29:02.562971 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m16:29:02.563382 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m16:29:02.563623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:02.566834 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:29:02.567667 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:29:03.672777 [debug] [ThreadPool]: SQL status: SUCCESS in 1.109 seconds
[0m16:29:03.674657 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m16:29:03.675984 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m16:29:03.823816 [debug] [ThreadPool]: SQL status: SUCCESS in 0.147 seconds
[0m16:29:03.827552 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m16:29:03.956444 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m16:29:03.960636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_marts, now list_dev_public_staging)
[0m16:29:03.969336 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m16:29:03.969967 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m16:29:03.970404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:29:03.971034 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:29:03.971486 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:29:04.685494 [debug] [ThreadPool]: SQL status: SUCCESS in 0.715 seconds
[0m16:29:04.687447 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m16:29:04.688565 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m16:29:04.835902 [debug] [ThreadPool]: SQL status: SUCCESS in 0.146 seconds
[0m16:29:04.840288 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m16:29:04.970521 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m16:29:04.989638 [debug] [MainThread]: Using redshift connection "master"
[0m16:29:04.990241 [debug] [MainThread]: On master: BEGIN
[0m16:29:04.990670 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:29:04.991297 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:29:04.991740 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:29:05.703810 [debug] [MainThread]: SQL status: SUCCESS in 0.713 seconds
[0m16:29:05.705509 [debug] [MainThread]: Using redshift connection "master"
[0m16:29:05.706393 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m16:29:05.897468 [debug] [MainThread]: SQL status: SUCCESS in 0.190 seconds
[0m16:29:05.902202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be7fa36e-a8a8-44f0-8153-21de0e6cef5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094df590>]}
[0m16:29:05.903426 [debug] [MainThread]: On master: ROLLBACK
[0m16:29:06.035012 [debug] [MainThread]: Using redshift connection "master"
[0m16:29:06.036631 [debug] [MainThread]: On master: BEGIN
[0m16:29:06.103060 [debug] [MainThread]: SQL status: SUCCESS in 0.065 seconds
[0m16:29:06.104807 [debug] [MainThread]: On master: COMMIT
[0m16:29:06.106110 [debug] [MainThread]: Using redshift connection "master"
[0m16:29:06.106850 [debug] [MainThread]: On master: COMMIT
[0m16:29:06.237241 [debug] [MainThread]: SQL status: SUCCESS in 0.129 seconds
[0m16:29:06.239283 [debug] [MainThread]: On master: Close
[0m16:29:06.241462 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:29:06.242812 [info ] [MainThread]: 
[0m16:29:06.249134 [debug] [Thread-1 (]: Began running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m16:29:06.250072 [info ] [Thread-1 (]: 1 of 1 START test assert_stg_order_items_values_positive_stg_order_items_ ...... [RUN]
[0m16:29:06.250931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd)
[0m16:29:06.251483 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m16:29:06.268940 [debug] [Thread-1 (]: Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:29:06.269701 [error] [Thread-1 (]: 1 of 1 ERROR assert_stg_order_items_values_positive_stg_order_items_ ........... [[31mERROR[0m in 0.02s]
[0m16:29:06.270288 [debug] [Thread-1 (]: Finished running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m16:29:06.272447 [debug] [MainThread]: Using redshift connection "master"
[0m16:29:06.272841 [debug] [MainThread]: On master: BEGIN
[0m16:29:06.273132 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:06.273541 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:29:06.273840 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:29:06.957419 [debug] [MainThread]: SQL status: SUCCESS in 0.684 seconds
[0m16:29:06.959213 [debug] [MainThread]: On master: COMMIT
[0m16:29:06.960737 [debug] [MainThread]: Using redshift connection "master"
[0m16:29:06.961473 [debug] [MainThread]: On master: COMMIT
[0m16:29:07.089983 [debug] [MainThread]: SQL status: SUCCESS in 0.128 seconds
[0m16:29:07.090551 [debug] [MainThread]: On master: Close
[0m16:29:07.091202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:29:07.091513 [debug] [MainThread]: Connection 'test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd' was properly closed.
[0m16:29:07.091854 [info ] [MainThread]: 
[0m16:29:07.092232 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 4.55 seconds (4.55s).
[0m16:29:07.092834 [debug] [MainThread]: Command end result
[0m16:29:07.125000 [info ] [MainThread]: 
[0m16:29:07.125416 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:29:07.125692 [info ] [MainThread]: 
[0m16:29:07.126001 [error] [MainThread]:   Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:29:07.126246 [info ] [MainThread]: 
[0m16:29:07.126486 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:29:07.129269 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 5.288282, "process_user_time": 1.735382, "process_kernel_time": 0.40811, "process_mem_max_rss": "121683968", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:29:07.129770 [debug] [MainThread]: Command `dbt test` failed at 16:29:07.129694 after 5.29 seconds
[0m16:29:07.130097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074af6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fef170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e0b30>]}
[0m16:29:07.130382 [debug] [MainThread]: Flushing usage events
[0m16:34:47.517313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba6540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105268590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105268140>]}


============================== 16:34:47.521425 | 9dc8cae7-a7a9-4a4d-9a4c-e4dee9c00a77 ==============================
[0m16:34:47.521425 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:34:47.521932 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/eranola/.dbt', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --select stg_order_items', 'send_anonymous_usage_stats': 'True'}
[0m16:34:47.686906 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:34:47.687321 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:34:47.813564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9dc8cae7-a7a9-4a4d-9a4c-e4dee9c00a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac30e0>]}
[0m16:34:47.849861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9dc8cae7-a7a9-4a4d-9a4c-e4dee9c00a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036284a0>]}
[0m16:34:47.850644 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:34:47.867216 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:34:48.003009 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:34:48.003685 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/stg_olist.yml
[0m16:34:48.153944 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m16:34:48.154444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9dc8cae7-a7a9-4a4d-9a4c-e4dee9c00a77', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103656f00>]}
[0m16:34:48.278988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9dc8cae7-a7a9-4a4d-9a4c-e4dee9c00a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069960f0>]}
[0m16:34:48.364048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9dc8cae7-a7a9-4a4d-9a4c-e4dee9c00a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10692fd70>]}
[0m16:34:48.364490 [info ] [MainThread]: Found 11 models, 6 data tests, 10 sources, 488 macros
[0m16:34:48.364776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dc8cae7-a7a9-4a4d-9a4c-e4dee9c00a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067494f0>]}
[0m16:34:48.366033 [info ] [MainThread]: 
[0m16:34:48.366470 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m16:34:48.369582 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_marts'
[0m16:34:48.382866 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m16:34:48.383302 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m16:34:48.383554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:48.386619 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:34:48.387587 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:34:49.289800 [debug] [ThreadPool]: SQL status: SUCCESS in 0.906 seconds
[0m16:34:49.291870 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m16:34:49.293060 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m16:34:49.446006 [debug] [ThreadPool]: SQL status: SUCCESS in 0.151 seconds
[0m16:34:49.452299 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m16:34:49.585607 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m16:34:49.588641 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_marts, now list_dev_public_staging)
[0m16:34:49.597725 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m16:34:49.598289 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m16:34:49.598707 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:49.599372 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:34:49.599811 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:34:50.319940 [debug] [ThreadPool]: SQL status: SUCCESS in 0.721 seconds
[0m16:34:50.321627 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m16:34:50.322696 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m16:34:50.474107 [debug] [ThreadPool]: SQL status: SUCCESS in 0.150 seconds
[0m16:34:50.478559 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m16:34:50.608548 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m16:34:50.627482 [debug] [MainThread]: Using redshift connection "master"
[0m16:34:50.628203 [debug] [MainThread]: On master: BEGIN
[0m16:34:50.628634 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:34:50.629261 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:34:50.629703 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:34:51.340970 [debug] [MainThread]: SQL status: SUCCESS in 0.712 seconds
[0m16:34:51.342913 [debug] [MainThread]: Using redshift connection "master"
[0m16:34:51.344075 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m16:34:51.539486 [debug] [MainThread]: SQL status: SUCCESS in 0.194 seconds
[0m16:34:51.544824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dc8cae7-a7a9-4a4d-9a4c-e4dee9c00a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10658fa40>]}
[0m16:34:51.546381 [debug] [MainThread]: On master: ROLLBACK
[0m16:34:51.677854 [debug] [MainThread]: Using redshift connection "master"
[0m16:34:51.679110 [debug] [MainThread]: On master: BEGIN
[0m16:34:51.743525 [debug] [MainThread]: SQL status: SUCCESS in 0.063 seconds
[0m16:34:51.745341 [debug] [MainThread]: On master: COMMIT
[0m16:34:51.746721 [debug] [MainThread]: Using redshift connection "master"
[0m16:34:51.747678 [debug] [MainThread]: On master: COMMIT
[0m16:34:51.875560 [debug] [MainThread]: SQL status: SUCCESS in 0.127 seconds
[0m16:34:51.877331 [debug] [MainThread]: On master: Close
[0m16:34:51.879480 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:34:51.880178 [info ] [MainThread]: 
[0m16:34:51.885383 [debug] [Thread-1 (]: Began running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m16:34:51.886412 [info ] [Thread-1 (]: 1 of 1 START test assert_stg_order_items_values_positive_stg_order_items_ ...... [RUN]
[0m16:34:51.887263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd)
[0m16:34:51.887947 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m16:34:51.901233 [debug] [Thread-1 (]: Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:34:51.902044 [error] [Thread-1 (]: 1 of 1 ERROR assert_stg_order_items_values_positive_stg_order_items_ ........... [[31mERROR[0m in 0.01s]
[0m16:34:51.902720 [debug] [Thread-1 (]: Finished running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m16:34:51.910946 [debug] [MainThread]: Using redshift connection "master"
[0m16:34:51.911426 [debug] [MainThread]: On master: BEGIN
[0m16:34:51.911735 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:34:51.912162 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:34:51.912471 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:34:52.623865 [debug] [MainThread]: SQL status: SUCCESS in 0.712 seconds
[0m16:34:52.625924 [debug] [MainThread]: On master: COMMIT
[0m16:34:52.627289 [debug] [MainThread]: Using redshift connection "master"
[0m16:34:52.628288 [debug] [MainThread]: On master: COMMIT
[0m16:34:53.200123 [debug] [MainThread]: SQL status: SUCCESS in 0.571 seconds
[0m16:34:53.202082 [debug] [MainThread]: On master: Close
[0m16:34:53.203945 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:34:53.204846 [debug] [MainThread]: Connection 'test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd' was properly closed.
[0m16:34:53.205881 [info ] [MainThread]: 
[0m16:34:53.206891 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 4.84 seconds (4.84s).
[0m16:34:53.208451 [debug] [MainThread]: Command end result
[0m16:34:53.251660 [info ] [MainThread]: 
[0m16:34:53.252232 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:34:53.252528 [info ] [MainThread]: 
[0m16:34:53.252875 [error] [MainThread]:   Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:34:53.253163 [info ] [MainThread]: 
[0m16:34:53.253461 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:34:53.256090 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 5.7910113, "process_user_time": 1.984338, "process_kernel_time": 0.358041, "process_mem_max_rss": "128155648", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:34:53.256711 [debug] [MainThread]: Command `dbt test` failed at 16:34:53.256620 after 5.79 seconds
[0m16:34:53.257115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc01a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063361e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105268590>]}
[0m16:34:53.257444 [debug] [MainThread]: Flushing usage events
[0m16:35:31.489896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101f41af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dd8ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dd8aa0>]}


============================== 16:35:31.494583 | 45ef7535-b488-454e-a66a-106d44e659f5 ==============================
[0m16:35:31.494583 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:35:31.495105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select stg_order_items', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:35:31.668452 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:35:31.668874 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:35:31.802516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45ef7535-b488-454e-a66a-106d44e659f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10415d280>]}
[0m16:35:31.839819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45ef7535-b488-454e-a66a-106d44e659f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104526f90>]}
[0m16:35:31.841079 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:35:31.859974 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:35:31.992444 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:35:31.993198 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/stg_olist.yml
[0m16:35:32.265980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45ef7535-b488-454e-a66a-106d44e659f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10536deb0>]}
[0m16:35:32.350766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45ef7535-b488-454e-a66a-106d44e659f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105307dd0>]}
[0m16:35:32.351235 [info ] [MainThread]: Found 11 models, 6 data tests, 10 sources, 488 macros
[0m16:35:32.351534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45ef7535-b488-454e-a66a-106d44e659f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10531b830>]}
[0m16:35:32.353280 [info ] [MainThread]: 
[0m16:35:32.353827 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m16:35:32.357129 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_marts'
[0m16:35:32.370199 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m16:35:32.370586 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m16:35:32.370825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:32.374459 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:35:32.375327 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:35:33.630392 [debug] [ThreadPool]: SQL status: SUCCESS in 1.259 seconds
[0m16:35:33.632528 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m16:35:33.633718 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m16:35:33.785687 [debug] [ThreadPool]: SQL status: SUCCESS in 0.151 seconds
[0m16:35:33.790393 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m16:35:33.921205 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m16:35:33.924248 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_marts, now list_dev_public_staging)
[0m16:35:33.933822 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m16:35:33.934607 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m16:35:33.935057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:33.935730 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:35:33.936222 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:35:34.658328 [debug] [ThreadPool]: SQL status: SUCCESS in 0.723 seconds
[0m16:35:34.660102 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m16:35:34.661169 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m16:35:34.820693 [debug] [ThreadPool]: SQL status: SUCCESS in 0.158 seconds
[0m16:35:34.826160 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m16:35:34.953908 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m16:35:34.973140 [debug] [MainThread]: Using redshift connection "master"
[0m16:35:34.973816 [debug] [MainThread]: On master: BEGIN
[0m16:35:34.974240 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:35:34.974866 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:35:34.975302 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:35:36.195192 [debug] [MainThread]: SQL status: SUCCESS in 1.221 seconds
[0m16:35:36.196989 [debug] [MainThread]: Using redshift connection "master"
[0m16:35:36.198250 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m16:35:36.680335 [debug] [MainThread]: SQL status: SUCCESS in 0.481 seconds
[0m16:35:36.685760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45ef7535-b488-454e-a66a-106d44e659f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050b3b00>]}
[0m16:35:36.687226 [debug] [MainThread]: On master: ROLLBACK
[0m16:35:37.008606 [debug] [MainThread]: Using redshift connection "master"
[0m16:35:37.009989 [debug] [MainThread]: On master: BEGIN
[0m16:35:37.502558 [debug] [MainThread]: SQL status: SUCCESS in 0.491 seconds
[0m16:35:37.503829 [debug] [MainThread]: On master: COMMIT
[0m16:35:37.504428 [debug] [MainThread]: Using redshift connection "master"
[0m16:35:37.504884 [debug] [MainThread]: On master: COMMIT
[0m16:35:37.830731 [debug] [MainThread]: SQL status: SUCCESS in 0.325 seconds
[0m16:35:37.832661 [debug] [MainThread]: On master: Close
[0m16:35:37.834701 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:35:37.835516 [info ] [MainThread]: 
[0m16:35:37.841792 [debug] [Thread-1 (]: Began running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m16:35:37.842974 [info ] [Thread-1 (]: 1 of 1 START test assert_stg_order_items_values_positive_stg_order_items_ ...... [RUN]
[0m16:35:37.844069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd)
[0m16:35:37.844682 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m16:35:37.857382 [debug] [Thread-1 (]: Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:35:37.858163 [error] [Thread-1 (]: 1 of 1 ERROR assert_stg_order_items_values_positive_stg_order_items_ ........... [[31mERROR[0m in 0.01s]
[0m16:35:37.859341 [debug] [Thread-1 (]: Finished running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m16:35:37.866890 [debug] [MainThread]: Using redshift connection "master"
[0m16:35:37.867410 [debug] [MainThread]: On master: BEGIN
[0m16:35:37.867717 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:35:37.868157 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:35:37.868469 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:35:38.681156 [debug] [MainThread]: SQL status: SUCCESS in 0.813 seconds
[0m16:35:38.683146 [debug] [MainThread]: On master: COMMIT
[0m16:35:38.684530 [debug] [MainThread]: Using redshift connection "master"
[0m16:35:38.685488 [debug] [MainThread]: On master: COMMIT
[0m16:35:38.818030 [debug] [MainThread]: SQL status: SUCCESS in 0.131 seconds
[0m16:35:38.820015 [debug] [MainThread]: On master: Close
[0m16:35:38.821871 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:38.822786 [debug] [MainThread]: Connection 'test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd' was properly closed.
[0m16:35:38.823824 [info ] [MainThread]: 
[0m16:35:38.824811 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 6.47 seconds (6.47s).
[0m16:35:38.826277 [debug] [MainThread]: Command end result
[0m16:35:38.869706 [info ] [MainThread]: 
[0m16:35:38.870198 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:35:38.870576 [info ] [MainThread]: 
[0m16:35:38.871008 [error] [MainThread]:   Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:35:38.871303 [info ] [MainThread]: 
[0m16:35:38.871605 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:35:38.874402 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 7.4365606, "process_user_time": 2.015166, "process_kernel_time": 0.399438, "process_mem_max_rss": "128761856", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:35:38.874971 [debug] [MainThread]: Command `dbt test` failed at 16:35:38.874889 after 7.44 seconds
[0m16:35:38.875337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031b4f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041321e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f27b00>]}
[0m16:35:38.875651 [debug] [MainThread]: Flushing usage events
[0m16:38:43.902692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034409b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e579b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eaff20>]}


============================== 16:38:43.907330 | 27f56500-98aa-457e-87f9-84d2ca843f70 ==============================
[0m16:38:43.907330 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:38:43.907861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'profiles_dir': '/Users/eranola/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select stg_order_items', 'send_anonymous_usage_stats': 'True'}
[0m16:38:44.084689 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:38:44.085113 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:38:44.227686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27f56500-98aa-457e-87f9-84d2ca843f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045a1ac0>]}
[0m16:38:44.264934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27f56500-98aa-457e-87f9-84d2ca843f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10451f8f0>]}
[0m16:38:44.265982 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:38:44.283259 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:38:44.424906 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:38:44.425297 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:38:44.457836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27f56500-98aa-457e-87f9-84d2ca843f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bffe60>]}
[0m16:38:44.544561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27f56500-98aa-457e-87f9-84d2ca843f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051b2ed0>]}
[0m16:38:44.544995 [info ] [MainThread]: Found 11 models, 6 data tests, 10 sources, 488 macros
[0m16:38:44.545345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27f56500-98aa-457e-87f9-84d2ca843f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d160c0>]}
[0m16:38:44.546674 [info ] [MainThread]: 
[0m16:38:44.547120 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m16:38:44.550298 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_staging'
[0m16:38:44.565073 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m16:38:44.565477 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m16:38:44.565716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:44.568832 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:38:44.569570 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:38:45.578511 [debug] [ThreadPool]: SQL status: SUCCESS in 1.012 seconds
[0m16:38:45.580422 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m16:38:45.581548 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m16:38:45.736554 [debug] [ThreadPool]: SQL status: SUCCESS in 0.154 seconds
[0m16:38:45.741567 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m16:38:45.958625 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m16:38:45.962645 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_staging, now list_dev_public_marts)
[0m16:38:45.971951 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m16:38:45.972481 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m16:38:45.972889 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:45.973530 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:38:45.973966 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:38:47.020294 [debug] [ThreadPool]: SQL status: SUCCESS in 1.047 seconds
[0m16:38:47.022136 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m16:38:47.023203 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m16:38:47.263088 [debug] [ThreadPool]: SQL status: SUCCESS in 0.239 seconds
[0m16:38:47.268834 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m16:38:47.410824 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m16:38:47.428072 [debug] [MainThread]: Using redshift connection "master"
[0m16:38:47.428698 [debug] [MainThread]: On master: BEGIN
[0m16:38:47.429123 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:38:47.429741 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:38:47.430158 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:38:48.823138 [debug] [MainThread]: SQL status: SUCCESS in 1.394 seconds
[0m16:38:48.825013 [debug] [MainThread]: Using redshift connection "master"
[0m16:38:48.826221 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m16:38:49.024029 [debug] [MainThread]: SQL status: SUCCESS in 0.196 seconds
[0m16:38:49.029728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27f56500-98aa-457e-87f9-84d2ca843f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bc35f0>]}
[0m16:38:49.031321 [debug] [MainThread]: On master: ROLLBACK
[0m16:38:49.174095 [debug] [MainThread]: Using redshift connection "master"
[0m16:38:49.175512 [debug] [MainThread]: On master: BEGIN
[0m16:38:49.250183 [debug] [MainThread]: SQL status: SUCCESS in 0.074 seconds
[0m16:38:49.251437 [debug] [MainThread]: On master: COMMIT
[0m16:38:49.252618 [debug] [MainThread]: Using redshift connection "master"
[0m16:38:49.253523 [debug] [MainThread]: On master: COMMIT
[0m16:38:49.454427 [debug] [MainThread]: SQL status: SUCCESS in 0.200 seconds
[0m16:38:49.456184 [debug] [MainThread]: On master: Close
[0m16:38:49.457816 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:38:49.458492 [info ] [MainThread]: 
[0m16:38:49.464285 [debug] [Thread-1 (]: Began running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m16:38:49.465095 [info ] [Thread-1 (]: 1 of 1 START test assert_stg_order_items_values_positive_stg_order_items_ ...... [RUN]
[0m16:38:49.465917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_marts, now test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd)
[0m16:38:49.466667 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m16:38:49.485381 [debug] [Thread-1 (]: Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:38:49.486004 [error] [Thread-1 (]: 1 of 1 ERROR assert_stg_order_items_values_positive_stg_order_items_ ........... [[31mERROR[0m in 0.02s]
[0m16:38:49.486568 [debug] [Thread-1 (]: Finished running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m16:38:49.488191 [debug] [MainThread]: Using redshift connection "master"
[0m16:38:49.488522 [debug] [MainThread]: On master: BEGIN
[0m16:38:49.488795 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:38:49.489297 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:38:49.489788 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:38:50.226419 [debug] [MainThread]: SQL status: SUCCESS in 0.737 seconds
[0m16:38:50.228440 [debug] [MainThread]: On master: COMMIT
[0m16:38:50.229859 [debug] [MainThread]: Using redshift connection "master"
[0m16:38:50.230776 [debug] [MainThread]: On master: COMMIT
[0m16:38:50.378098 [debug] [MainThread]: SQL status: SUCCESS in 0.146 seconds
[0m16:38:50.379999 [debug] [MainThread]: On master: Close
[0m16:38:50.381846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:50.382571 [debug] [MainThread]: Connection 'test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd' was properly closed.
[0m16:38:50.383419 [info ] [MainThread]: 
[0m16:38:50.384268 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 5.84 seconds (5.84s).
[0m16:38:50.385521 [debug] [MainThread]: Command end result
[0m16:38:50.428316 [info ] [MainThread]: 
[0m16:38:50.428854 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:38:50.429137 [info ] [MainThread]: 
[0m16:38:50.429490 [error] [MainThread]:   Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:38:50.429759 [info ] [MainThread]: 
[0m16:38:50.430025 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:38:50.433010 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 6.588629, "process_user_time": 1.767404, "process_kernel_time": 0.415376, "process_mem_max_rss": "120897536", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:38:50.433591 [debug] [MainThread]: Command `dbt test` failed at 16:38:50.433507 after 6.59 seconds
[0m16:38:50.434014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ed4440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042f1130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bc35f0>]}
[0m16:38:50.434481 [debug] [MainThread]: Flushing usage events
[0m16:39:01.693263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10597b230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10599ca70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10599c980>]}


============================== 16:39:01.697259 | 6d63fbbd-5669-435d-87ee-c059c292f6c1 ==============================
[0m16:39:01.697259 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:39:01.697746 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:39:01.815403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d63fbbd-5669-435d-87ee-c059c292f6c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053a99a0>]}
[0m16:39:01.830550 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:39:01.831353 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:39:01.832769 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.19000554, "process_user_time": 1.000792, "process_kernel_time": 0.172814, "process_mem_max_rss": "95010816", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:39:01.833192 [debug] [MainThread]: Command `dbt deps` succeeded at 16:39:01.833119 after 0.19 seconds
[0m16:39:01.833474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034e2cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106893a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b97bf0>]}
[0m16:39:01.833768 [debug] [MainThread]: Flushing usage events
[0m16:39:41.824028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ae4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c8b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c8b00>]}


============================== 16:39:41.828131 | f58360e2-04b6-4f73-a10b-8f3d0089e7cf ==============================
[0m16:39:41.828131 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:39:41.828631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select stg_order_items', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:39:41.994568 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:39:41.994987 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:39:42.120456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f58360e2-04b6-4f73-a10b-8f3d0089e7cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d5d00>]}
[0m16:39:42.158085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f58360e2-04b6-4f73-a10b-8f3d0089e7cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10809bbf0>]}
[0m16:39:42.159001 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:39:42.174552 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:39:42.312514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:39:42.312907 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:39:42.345324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f58360e2-04b6-4f73-a10b-8f3d0089e7cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109613770>]}
[0m16:39:42.427524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f58360e2-04b6-4f73-a10b-8f3d0089e7cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cd6e10>]}
[0m16:39:42.427973 [info ] [MainThread]: Found 11 models, 6 data tests, 10 sources, 488 macros
[0m16:39:42.428265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f58360e2-04b6-4f73-a10b-8f3d0089e7cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109637c80>]}
[0m16:39:42.429570 [info ] [MainThread]: 
[0m16:39:42.430003 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m16:39:42.433150 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_marts'
[0m16:39:42.447899 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m16:39:42.448302 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m16:39:42.448545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:42.451649 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:39:42.452403 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:39:43.256004 [debug] [ThreadPool]: SQL status: SUCCESS in 0.807 seconds
[0m16:39:43.258105 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m16:39:43.259268 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m16:39:43.408519 [debug] [ThreadPool]: SQL status: SUCCESS in 0.148 seconds
[0m16:39:43.413999 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m16:39:43.541364 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m16:39:43.544580 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_marts, now list_dev_public_staging)
[0m16:39:43.554386 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m16:39:43.555098 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m16:39:43.555540 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:43.556196 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:39:43.556678 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:39:44.293478 [debug] [ThreadPool]: SQL status: SUCCESS in 0.737 seconds
[0m16:39:44.295713 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m16:39:44.296834 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m16:39:44.455128 [debug] [ThreadPool]: SQL status: SUCCESS in 0.157 seconds
[0m16:39:44.460246 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m16:39:44.592869 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m16:39:44.612806 [debug] [MainThread]: Using redshift connection "master"
[0m16:39:44.613491 [debug] [MainThread]: On master: BEGIN
[0m16:39:44.613936 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:39:44.614555 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:39:44.614986 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:39:45.336109 [debug] [MainThread]: SQL status: SUCCESS in 0.722 seconds
[0m16:39:45.337226 [debug] [MainThread]: Using redshift connection "master"
[0m16:39:45.337792 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m16:39:45.531846 [debug] [MainThread]: SQL status: SUCCESS in 0.193 seconds
[0m16:39:45.537332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f58360e2-04b6-4f73-a10b-8f3d0089e7cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fab500>]}
[0m16:39:45.538894 [debug] [MainThread]: On master: ROLLBACK
[0m16:39:45.670779 [debug] [MainThread]: Using redshift connection "master"
[0m16:39:45.672495 [debug] [MainThread]: On master: BEGIN
[0m16:39:45.737651 [debug] [MainThread]: SQL status: SUCCESS in 0.064 seconds
[0m16:39:45.738730 [debug] [MainThread]: On master: COMMIT
[0m16:39:45.739810 [debug] [MainThread]: Using redshift connection "master"
[0m16:39:45.740697 [debug] [MainThread]: On master: COMMIT
[0m16:39:45.872453 [debug] [MainThread]: SQL status: SUCCESS in 0.131 seconds
[0m16:39:45.874072 [debug] [MainThread]: On master: Close
[0m16:39:45.876085 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:39:45.876765 [info ] [MainThread]: 
[0m16:39:45.881710 [debug] [Thread-1 (]: Began running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m16:39:45.882694 [info ] [Thread-1 (]: 1 of 1 START test assert_stg_order_items_values_positive_stg_order_items_ ...... [RUN]
[0m16:39:45.883656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd)
[0m16:39:45.884288 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m16:39:45.900822 [debug] [Thread-1 (]: Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:39:45.901580 [error] [Thread-1 (]: 1 of 1 ERROR assert_stg_order_items_values_positive_stg_order_items_ ........... [[31mERROR[0m in 0.02s]
[0m16:39:45.902252 [debug] [Thread-1 (]: Finished running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m16:39:45.904245 [debug] [MainThread]: Using redshift connection "master"
[0m16:39:45.904697 [debug] [MainThread]: On master: BEGIN
[0m16:39:45.905054 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:39:45.905573 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:39:45.905923 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:39:46.604329 [debug] [MainThread]: SQL status: SUCCESS in 0.699 seconds
[0m16:39:46.606424 [debug] [MainThread]: On master: COMMIT
[0m16:39:46.607937 [debug] [MainThread]: Using redshift connection "master"
[0m16:39:46.608911 [debug] [MainThread]: On master: COMMIT
[0m16:39:46.739244 [debug] [MainThread]: SQL status: SUCCESS in 0.129 seconds
[0m16:39:46.741416 [debug] [MainThread]: On master: Close
[0m16:39:46.743078 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:39:46.743656 [debug] [MainThread]: Connection 'test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd' was properly closed.
[0m16:39:46.744519 [info ] [MainThread]: 
[0m16:39:46.745567 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 4.31 seconds (4.31s).
[0m16:39:46.746663 [debug] [MainThread]: Command end result
[0m16:39:46.788084 [info ] [MainThread]: 
[0m16:39:46.788577 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:39:46.788868 [info ] [MainThread]: 
[0m16:39:46.789220 [error] [MainThread]:   Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:39:46.789502 [info ] [MainThread]: 
[0m16:39:46.789780 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:39:46.791671 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 5.0187354, "process_user_time": 1.75541, "process_kernel_time": 0.365566, "process_mem_max_rss": "121241600", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:39:46.792149 [debug] [MainThread]: Command `dbt test` failed at 16:39:46.792075 after 5.02 seconds
[0m16:39:46.792486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10550ecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108867e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109183b30>]}
[0m16:39:46.792786 [debug] [MainThread]: Flushing usage events
[0m16:41:50.441531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109557680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a07f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a2c0b0>]}


============================== 16:41:50.446760 | e6960790-b8c0-4ea8-958a-47b5f87ccdfe ==============================
[0m16:41:50.446760 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:41:50.447336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select stg_order_items', 'send_anonymous_usage_stats': 'True'}
[0m16:41:50.618272 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:41:50.618690 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:41:50.750909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6960790-b8c0-4ea8-958a-47b5f87ccdfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109afe360>]}
[0m16:41:50.788401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6960790-b8c0-4ea8-958a-47b5f87ccdfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099afbf0>]}
[0m16:41:50.790358 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:41:50.807245 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:41:50.939055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:41:50.939735 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/stg_olist.yml
[0m16:41:51.211323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6960790-b8c0-4ea8-958a-47b5f87ccdfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af92360>]}
[0m16:41:51.296959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6960790-b8c0-4ea8-958a-47b5f87ccdfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af2be60>]}
[0m16:41:51.297514 [info ] [MainThread]: Found 11 models, 6 data tests, 10 sources, 488 macros
[0m16:41:51.297828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6960790-b8c0-4ea8-958a-47b5f87ccdfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acf2f90>]}
[0m16:41:51.299166 [info ] [MainThread]: 
[0m16:41:51.299622 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m16:41:51.302846 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_staging'
[0m16:41:51.316629 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m16:41:51.317034 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m16:41:51.317274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:51.320364 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:41:51.321084 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:41:52.129393 [debug] [ThreadPool]: SQL status: SUCCESS in 0.812 seconds
[0m16:41:52.130838 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m16:41:52.131841 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m16:41:52.282771 [debug] [ThreadPool]: SQL status: SUCCESS in 0.150 seconds
[0m16:41:52.287763 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m16:41:52.770323 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m16:41:52.773752 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_staging, now list_dev_public_marts)
[0m16:41:52.783395 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m16:41:52.784110 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m16:41:52.784773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:52.785412 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:41:52.785868 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:41:53.497501 [debug] [ThreadPool]: SQL status: SUCCESS in 0.712 seconds
[0m16:41:53.499447 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m16:41:53.500546 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m16:41:53.651556 [debug] [ThreadPool]: SQL status: SUCCESS in 0.150 seconds
[0m16:41:53.657530 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m16:41:53.787696 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m16:41:53.804148 [debug] [MainThread]: Using redshift connection "master"
[0m16:41:53.804933 [debug] [MainThread]: On master: BEGIN
[0m16:41:53.805362 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:41:53.805967 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:41:53.806434 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:41:54.854166 [debug] [MainThread]: SQL status: SUCCESS in 1.049 seconds
[0m16:41:54.855508 [debug] [MainThread]: Using redshift connection "master"
[0m16:41:54.856650 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m16:41:55.061919 [debug] [MainThread]: SQL status: SUCCESS in 0.204 seconds
[0m16:41:55.066660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6960790-b8c0-4ea8-958a-47b5f87ccdfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae28d10>]}
[0m16:41:55.067725 [debug] [MainThread]: On master: ROLLBACK
[0m16:41:55.197916 [debug] [MainThread]: Using redshift connection "master"
[0m16:41:55.199042 [debug] [MainThread]: On master: BEGIN
[0m16:41:55.264428 [debug] [MainThread]: SQL status: SUCCESS in 0.065 seconds
[0m16:41:55.265593 [debug] [MainThread]: On master: COMMIT
[0m16:41:55.266458 [debug] [MainThread]: Using redshift connection "master"
[0m16:41:55.266965 [debug] [MainThread]: On master: COMMIT
[0m16:41:55.396722 [debug] [MainThread]: SQL status: SUCCESS in 0.129 seconds
[0m16:41:55.398293 [debug] [MainThread]: On master: Close
[0m16:41:55.400065 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:41:55.401182 [info ] [MainThread]: 
[0m16:41:55.407605 [debug] [Thread-1 (]: Began running node test.olist_dbt.test_assert_stg_order_items_values_positive_stg_order_items_.005a48556f
[0m16:41:55.408555 [info ] [Thread-1 (]: 1 of 1 START test test_assert_stg_order_items_values_positive_stg_order_items_ . [RUN]
[0m16:41:55.409430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_marts, now test.olist_dbt.test_assert_stg_order_items_values_positive_stg_order_items_.005a48556f)
[0m16:41:55.410027 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.test_assert_stg_order_items_values_positive_stg_order_items_.005a48556f
[0m16:41:55.425041 [debug] [Thread-1 (]: Compilation Error in test test_assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:41:55.426195 [error] [Thread-1 (]: 1 of 1 ERROR test_assert_stg_order_items_values_positive_stg_order_items_ ...... [[31mERROR[0m in 0.02s]
[0m16:41:55.427134 [debug] [Thread-1 (]: Finished running node test.olist_dbt.test_assert_stg_order_items_values_positive_stg_order_items_.005a48556f
[0m16:41:55.434995 [debug] [MainThread]: Using redshift connection "master"
[0m16:41:55.435425 [debug] [MainThread]: On master: BEGIN
[0m16:41:55.435713 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:41:55.436129 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:41:55.436432 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:41:56.487608 [debug] [MainThread]: SQL status: SUCCESS in 1.051 seconds
[0m16:41:56.489362 [debug] [MainThread]: On master: COMMIT
[0m16:41:56.490390 [debug] [MainThread]: Using redshift connection "master"
[0m16:41:56.491034 [debug] [MainThread]: On master: COMMIT
[0m16:41:56.617816 [debug] [MainThread]: SQL status: SUCCESS in 0.126 seconds
[0m16:41:56.619427 [debug] [MainThread]: On master: Close
[0m16:41:56.620796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:56.621343 [debug] [MainThread]: Connection 'test.olist_dbt.test_assert_stg_order_items_values_positive_stg_order_items_.005a48556f' was properly closed.
[0m16:41:56.622005 [info ] [MainThread]: 
[0m16:41:56.622600 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 5.32 seconds (5.32s).
[0m16:41:56.623659 [debug] [MainThread]: Command end result
[0m16:41:56.664251 [info ] [MainThread]: 
[0m16:41:56.664747 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:41:56.665047 [info ] [MainThread]: 
[0m16:41:56.665408 [error] [MainThread]:   Compilation Error in test test_assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:41:56.665684 [info ] [MainThread]: 
[0m16:41:56.665968 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:41:56.668378 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 6.278066, "process_user_time": 1.988267, "process_kernel_time": 0.384662, "process_mem_max_rss": "129286144", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:41:56.668859 [debug] [MainThread]: Command `dbt test` failed at 16:41:56.668785 after 6.28 seconds
[0m16:41:56.669199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a07ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108da43b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103676cf0>]}
[0m16:41:56.669504 [debug] [MainThread]: Flushing usage events
[0m16:42:05.088720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066707a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a3fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a3dd0>]}


============================== 16:42:05.092842 | be3cd9ea-75f9-4f48-a140-e902583c45d6 ==============================
[0m16:42:05.092842 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:42:05.093348 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select test_assert_stg_order_items_values_positive', 'send_anonymous_usage_stats': 'True'}
[0m16:42:05.251925 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:42:05.252363 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:42:05.377141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be3cd9ea-75f9-4f48-a140-e902583c45d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068d5160>]}
[0m16:42:05.414566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be3cd9ea-75f9-4f48-a140-e902583c45d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ca8d0>]}
[0m16:42:05.415402 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:42:05.431715 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:42:05.564614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:42:05.564998 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:42:05.597875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be3cd9ea-75f9-4f48-a140-e902583c45d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d8d910>]}
[0m16:42:05.680911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be3cd9ea-75f9-4f48-a140-e902583c45d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107862b70>]}
[0m16:42:05.681353 [info ] [MainThread]: Found 11 models, 6 data tests, 10 sources, 488 macros
[0m16:42:05.681652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be3cd9ea-75f9-4f48-a140-e902583c45d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ca1dc0>]}
[0m16:42:05.682204 [warn ] [MainThread]: The selection criterion 'test_assert_stg_order_items_values_positive' does not match any enabled nodes
[0m16:42:05.683142 [info ] [MainThread]: 
[0m16:42:05.683444 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:42:05.684814 [debug] [MainThread]: Command end result
[0m16:42:05.710635 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6709226, "process_user_time": 1.35201, "process_kernel_time": 0.254016, "process_mem_max_rss": "113983488", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:42:05.711181 [debug] [MainThread]: Command `dbt test` succeeded at 16:42:05.711105 after 0.67 seconds
[0m16:42:05.711517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f3f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d8c440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a3ec0>]}
[0m16:42:05.711805 [debug] [MainThread]: Flushing usage events
[0m16:43:22.556293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105449be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d13410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e74980>]}


============================== 16:43:22.560811 | 456ced89-902e-4b59-8698-fb598b4d5343 ==============================
[0m16:43:22.560811 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:43:22.561306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select stg_order_items', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:43:22.732147 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:43:22.732559 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:43:22.856826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '456ced89-902e-4b59-8698-fb598b4d5343', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e1190>]}
[0m16:43:22.893999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '456ced89-902e-4b59-8698-fb598b4d5343', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c68530>]}
[0m16:43:22.895238 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:43:22.912369 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:43:23.045987 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:43:23.046671 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/stg_olist.yml
[0m16:43:23.314922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '456ced89-902e-4b59-8698-fb598b4d5343', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090ae210>]}
[0m16:43:23.400743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '456ced89-902e-4b59-8698-fb598b4d5343', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093a7f80>]}
[0m16:43:23.401190 [info ] [MainThread]: Found 11 models, 6 data tests, 10 sources, 488 macros
[0m16:43:23.401482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '456ced89-902e-4b59-8698-fb598b4d5343', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093275f0>]}
[0m16:43:23.402797 [info ] [MainThread]: 
[0m16:43:23.403238 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m16:43:23.406432 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_marts'
[0m16:43:23.419610 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m16:43:23.420018 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m16:43:23.420254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:23.423359 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:43:23.424074 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:43:24.330730 [debug] [ThreadPool]: SQL status: SUCCESS in 0.910 seconds
[0m16:43:24.332636 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m16:43:24.333707 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m16:43:24.485841 [debug] [ThreadPool]: SQL status: SUCCESS in 0.151 seconds
[0m16:43:24.491710 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m16:43:24.618174 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m16:43:24.620323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_marts, now list_dev_public_staging)
[0m16:43:24.628540 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m16:43:24.629262 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m16:43:24.629717 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:43:24.630402 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:43:24.630855 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:43:25.333090 [debug] [ThreadPool]: SQL status: SUCCESS in 0.703 seconds
[0m16:43:25.334722 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m16:43:25.335836 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m16:43:25.862676 [debug] [ThreadPool]: SQL status: SUCCESS in 0.526 seconds
[0m16:43:25.867931 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m16:43:26.080825 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m16:43:26.100170 [debug] [MainThread]: Using redshift connection "master"
[0m16:43:26.100810 [debug] [MainThread]: On master: BEGIN
[0m16:43:26.101242 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:43:26.101860 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:43:26.102295 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:43:26.839043 [debug] [MainThread]: SQL status: SUCCESS in 0.737 seconds
[0m16:43:26.840960 [debug] [MainThread]: Using redshift connection "master"
[0m16:43:26.842174 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m16:43:27.054124 [debug] [MainThread]: SQL status: SUCCESS in 0.210 seconds
[0m16:43:27.059201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '456ced89-902e-4b59-8698-fb598b4d5343', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109326db0>]}
[0m16:43:27.060359 [debug] [MainThread]: On master: ROLLBACK
[0m16:43:27.189168 [debug] [MainThread]: Using redshift connection "master"
[0m16:43:27.191034 [debug] [MainThread]: On master: BEGIN
[0m16:43:27.255574 [debug] [MainThread]: SQL status: SUCCESS in 0.063 seconds
[0m16:43:27.256860 [debug] [MainThread]: On master: COMMIT
[0m16:43:27.258036 [debug] [MainThread]: Using redshift connection "master"
[0m16:43:27.258998 [debug] [MainThread]: On master: COMMIT
[0m16:43:27.386827 [debug] [MainThread]: SQL status: SUCCESS in 0.127 seconds
[0m16:43:27.388201 [debug] [MainThread]: On master: Close
[0m16:43:27.390041 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:43:27.390917 [info ] [MainThread]: 
[0m16:43:27.396959 [debug] [Thread-1 (]: Began running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m16:43:27.397941 [info ] [Thread-1 (]: 1 of 1 START test assert_stg_order_items_values_positive_stg_order_items_ ...... [RUN]
[0m16:43:27.398701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd)
[0m16:43:27.399249 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m16:43:27.413060 [debug] [Thread-1 (]: Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:43:27.413884 [error] [Thread-1 (]: 1 of 1 ERROR assert_stg_order_items_values_positive_stg_order_items_ ........... [[31mERROR[0m in 0.02s]
[0m16:43:27.414882 [debug] [Thread-1 (]: Finished running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m16:43:27.422297 [debug] [MainThread]: Using redshift connection "master"
[0m16:43:27.422773 [debug] [MainThread]: On master: BEGIN
[0m16:43:27.423071 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:43:27.423495 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:43:27.423797 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:43:28.132908 [debug] [MainThread]: SQL status: SUCCESS in 0.709 seconds
[0m16:43:28.134898 [debug] [MainThread]: On master: COMMIT
[0m16:43:28.136201 [debug] [MainThread]: Using redshift connection "master"
[0m16:43:28.137127 [debug] [MainThread]: On master: COMMIT
[0m16:43:28.265540 [debug] [MainThread]: SQL status: SUCCESS in 0.127 seconds
[0m16:43:28.267254 [debug] [MainThread]: On master: Close
[0m16:43:28.269159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:28.269889 [debug] [MainThread]: Connection 'test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd' was properly closed.
[0m16:43:28.270824 [info ] [MainThread]: 
[0m16:43:28.271618 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 4.87 seconds (4.87s).
[0m16:43:28.273005 [debug] [MainThread]: Command end result
[0m16:43:28.316478 [info ] [MainThread]: 
[0m16:43:28.317052 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:43:28.317352 [info ] [MainThread]: 
[0m16:43:28.317713 [error] [MainThread]:   Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:43:28.317983 [info ] [MainThread]: 
[0m16:43:28.318256 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:43:28.320628 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 5.8163843, "process_user_time": 1.960697, "process_kernel_time": 0.377195, "process_mem_max_rss": "127418368", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:43:28.321133 [debug] [MainThread]: Command `dbt test` failed at 16:43:28.321055 after 5.82 seconds
[0m16:43:28.321503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a01760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049bacf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095aa1b0>]}
[0m16:43:28.321857 [debug] [MainThread]: Flushing usage events
[0m16:43:47.111588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106607740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080eb9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec0380>]}


============================== 16:43:47.115510 | b62ba35a-35a4-4bf3-902d-41d409df07e8 ==============================
[0m16:43:47.115510 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:43:47.116013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select assert_stg_order_items_values_positive', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:43:47.279442 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:43:47.279869 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:43:47.405430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b62ba35a-35a4-4bf3-902d-41d409df07e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086a14c0>]}
[0m16:43:47.443009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b62ba35a-35a4-4bf3-902d-41d409df07e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086d5250>]}
[0m16:43:47.443885 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:43:47.459930 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:43:47.591720 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:43:47.592111 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:43:47.624731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b62ba35a-35a4-4bf3-902d-41d409df07e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c5c470>]}
[0m16:43:47.712758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b62ba35a-35a4-4bf3-902d-41d409df07e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095529f0>]}
[0m16:43:47.713233 [info ] [MainThread]: Found 11 models, 6 data tests, 10 sources, 488 macros
[0m16:43:47.713525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b62ba35a-35a4-4bf3-902d-41d409df07e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088357f0>]}
[0m16:43:47.714089 [warn ] [MainThread]: The selection criterion 'assert_stg_order_items_values_positive' does not match any enabled nodes
[0m16:43:47.715069 [info ] [MainThread]: 
[0m16:43:47.715340 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:43:47.716711 [debug] [MainThread]: Command end result
[0m16:43:47.742565 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6823383, "process_user_time": 1.348362, "process_kernel_time": 0.258065, "process_mem_max_rss": "115277824", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:43:47.743114 [debug] [MainThread]: Command `dbt test` succeeded at 16:43:47.743040 after 0.68 seconds
[0m16:43:47.743451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d279e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107022e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108143f20>]}
[0m16:43:47.743728 [debug] [MainThread]: Flushing usage events
[0m16:44:34.374749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10855c7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107934b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107934a10>]}


============================== 16:44:34.379502 | 990ef1ca-01df-4aa1-953e-66e1006ef3f3 ==============================
[0m16:44:34.379502 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:44:34.380024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select assert_stg_order_items_values_positive', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:44:34.554390 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:44:34.554800 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:44:34.688725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '990ef1ca-01df-4aa1-953e-66e1006ef3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab66f0>]}
[0m16:44:34.724955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '990ef1ca-01df-4aa1-953e-66e1006ef3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fc4080>]}
[0m16:44:34.726586 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:44:34.743796 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:44:34.873961 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:44:34.874356 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:44:34.906894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '990ef1ca-01df-4aa1-953e-66e1006ef3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109589eb0>]}
[0m16:44:34.993025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '990ef1ca-01df-4aa1-953e-66e1006ef3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c3efc0>]}
[0m16:44:34.993481 [info ] [MainThread]: Found 11 models, 6 data tests, 10 sources, 488 macros
[0m16:44:34.993783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '990ef1ca-01df-4aa1-953e-66e1006ef3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a9f410>]}
[0m16:44:34.994357 [warn ] [MainThread]: The selection criterion 'assert_stg_order_items_values_positive' does not match any enabled nodes
[0m16:44:34.995287 [info ] [MainThread]: 
[0m16:44:34.995569 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:44:34.996987 [debug] [MainThread]: Command end result
[0m16:44:35.022896 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.69988155, "process_user_time": 1.332488, "process_kernel_time": 0.297549, "process_mem_max_rss": "113999872", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:44:35.023477 [debug] [MainThread]: Command `dbt test` succeeded at 16:44:35.023389 after 0.70 seconds
[0m16:44:35.023813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a27a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e22a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e1940>]}
[0m16:44:35.024098 [debug] [MainThread]: Flushing usage events
[0m16:44:41.882319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107710170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b28a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b28aa0>]}


============================== 16:44:41.886364 | 37e53a10-b439-4432-a0a3-ff2b5a85a8eb ==============================
[0m16:44:41.886364 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:44:41.886872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/eranola/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select stg_order_items', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:44:42.053263 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:44:42.053689 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:44:42.178284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37e53a10-b439-4432-a0a3-ff2b5a85a8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107839190>]}
[0m16:44:42.214858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37e53a10-b439-4432-a0a3-ff2b5a85a8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107591df0>]}
[0m16:44:42.215683 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:44:42.232626 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:44:42.366408 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:44:42.366788 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:44:42.399146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37e53a10-b439-4432-a0a3-ff2b5a85a8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10848ba70>]}
[0m16:44:42.481912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37e53a10-b439-4432-a0a3-ff2b5a85a8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10870a900>]}
[0m16:44:42.482364 [info ] [MainThread]: Found 11 models, 6 data tests, 10 sources, 488 macros
[0m16:44:42.482657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37e53a10-b439-4432-a0a3-ff2b5a85a8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ffd7f0>]}
[0m16:44:42.483978 [info ] [MainThread]: 
[0m16:44:42.484427 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m16:44:42.487585 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_marts'
[0m16:44:42.502205 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m16:44:42.502582 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m16:44:42.502817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:42.505890 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:44:42.506621 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:44:43.316724 [debug] [ThreadPool]: SQL status: SUCCESS in 0.813 seconds
[0m16:44:43.318824 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m16:44:43.320034 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m16:44:43.470707 [debug] [ThreadPool]: SQL status: SUCCESS in 0.149 seconds
[0m16:44:43.476746 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m16:44:43.603684 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m16:44:43.606487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_marts, now list_dev_public_staging)
[0m16:44:43.616979 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m16:44:43.617572 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m16:44:43.617987 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:43.618627 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:44:43.619091 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:44:44.329774 [debug] [ThreadPool]: SQL status: SUCCESS in 0.711 seconds
[0m16:44:44.331397 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m16:44:44.332482 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m16:44:44.482159 [debug] [ThreadPool]: SQL status: SUCCESS in 0.148 seconds
[0m16:44:44.487388 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m16:44:44.615499 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m16:44:44.633236 [debug] [MainThread]: Using redshift connection "master"
[0m16:44:44.633857 [debug] [MainThread]: On master: BEGIN
[0m16:44:44.634247 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:44:44.634751 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:44:44.635138 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:44:45.703986 [debug] [MainThread]: SQL status: SUCCESS in 1.069 seconds
[0m16:44:45.705926 [debug] [MainThread]: Using redshift connection "master"
[0m16:44:45.707166 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m16:44:45.905670 [debug] [MainThread]: SQL status: SUCCESS in 0.197 seconds
[0m16:44:45.910670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37e53a10-b439-4432-a0a3-ff2b5a85a8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f79220>]}
[0m16:44:45.911698 [debug] [MainThread]: On master: ROLLBACK
[0m16:44:46.045041 [debug] [MainThread]: Using redshift connection "master"
[0m16:44:46.046163 [debug] [MainThread]: On master: BEGIN
[0m16:44:46.111854 [debug] [MainThread]: SQL status: SUCCESS in 0.065 seconds
[0m16:44:46.113327 [debug] [MainThread]: On master: COMMIT
[0m16:44:46.114682 [debug] [MainThread]: Using redshift connection "master"
[0m16:44:46.115617 [debug] [MainThread]: On master: COMMIT
[0m16:44:46.247702 [debug] [MainThread]: SQL status: SUCCESS in 0.131 seconds
[0m16:44:46.249217 [debug] [MainThread]: On master: Close
[0m16:44:46.251037 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:44:46.251888 [info ] [MainThread]: 
[0m16:44:46.257779 [debug] [Thread-1 (]: Began running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m16:44:46.258677 [info ] [Thread-1 (]: 1 of 1 START test assert_stg_order_items_values_positive_stg_order_items_ ...... [RUN]
[0m16:44:46.259379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd)
[0m16:44:46.259949 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m16:44:46.278866 [debug] [Thread-1 (]: Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:44:46.279655 [error] [Thread-1 (]: 1 of 1 ERROR assert_stg_order_items_values_positive_stg_order_items_ ........... [[31mERROR[0m in 0.02s]
[0m16:44:46.280248 [debug] [Thread-1 (]: Finished running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m16:44:46.282194 [debug] [MainThread]: Using redshift connection "master"
[0m16:44:46.282566 [debug] [MainThread]: On master: BEGIN
[0m16:44:46.282840 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:44:46.283244 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:44:46.283547 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:44:46.979314 [debug] [MainThread]: SQL status: SUCCESS in 0.696 seconds
[0m16:44:46.981309 [debug] [MainThread]: On master: COMMIT
[0m16:44:46.982749 [debug] [MainThread]: Using redshift connection "master"
[0m16:44:46.983710 [debug] [MainThread]: On master: COMMIT
[0m16:44:47.110729 [debug] [MainThread]: SQL status: SUCCESS in 0.126 seconds
[0m16:44:47.112644 [debug] [MainThread]: On master: Close
[0m16:44:47.114482 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:47.115121 [debug] [MainThread]: Connection 'test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd' was properly closed.
[0m16:44:47.115806 [info ] [MainThread]: 
[0m16:44:47.116498 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 4.63 seconds (4.63s).
[0m16:44:47.117633 [debug] [MainThread]: Command end result
[0m16:44:47.159950 [info ] [MainThread]: 
[0m16:44:47.160530 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:44:47.160827 [info ] [MainThread]: 
[0m16:44:47.161188 [error] [MainThread]:   Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:44:47.161469 [info ] [MainThread]: 
[0m16:44:47.161736 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:44:47.163628 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 5.332323, "process_user_time": 1.747851, "process_kernel_time": 0.348892, "process_mem_max_rss": "121716736", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:44:47.164124 [debug] [MainThread]: Command `dbt test` failed at 16:44:47.164050 after 5.33 seconds
[0m16:44:47.164470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c65460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107743e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107743f80>]}
[0m16:44:47.164787 [debug] [MainThread]: Flushing usage events
[0m16:45:15.606671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106018d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c69520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106018aa0>]}


============================== 16:45:15.610680 | 36b5d98a-d948-466f-a2bb-7a7dced40e62 ==============================
[0m16:45:15.610680 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:45:15.611196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:45:15.729811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36b5d98a-d948-466f-a2bb-7a7dced40e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff3620>]}
[0m16:45:15.769107 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21473087, "process_user_time": 1.01528, "process_kernel_time": 0.189854, "process_mem_max_rss": "94945280", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:45:15.769606 [debug] [MainThread]: Command `dbt clean` succeeded at 16:45:15.769528 after 0.22 seconds
[0m16:45:15.769908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c69520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106018d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106080620>]}
[0m16:45:15.770193 [debug] [MainThread]: Flushing usage events
[0m16:45:23.621255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a0dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061dbfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061dbb60>]}


============================== 16:45:23.625123 | f2772215-b54e-4ae1-a95d-998d246c9f97 ==============================
[0m16:45:23.625123 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:45:23.625637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:45:23.749601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2772215-b54e-4ae1-a95d-998d246c9f97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050be9c0>]}
[0m16:45:23.765932 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:45:23.766865 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:45:23.768652 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.20210883, "process_user_time": 1.023127, "process_kernel_time": 0.19348, "process_mem_max_rss": "95502336", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:45:23.769145 [debug] [MainThread]: Command `dbt deps` succeeded at 16:45:23.769065 after 0.20 seconds
[0m16:45:23.769449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061db950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061db7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a0dd90>]}
[0m16:45:23.769740 [debug] [MainThread]: Flushing usage events
[0m16:45:28.397898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d49970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ccb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ccb30>]}


============================== 16:45:28.401959 | 3b34de35-fbb3-493b-b479-5a369e49c738 ==============================
[0m16:45:28.401959 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:45:28.402451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:45:28.417198 [info ] [MainThread]: dbt version: 1.8.6
[0m16:45:28.417594 [info ] [MainThread]: python version: 3.12.4
[0m16:45:28.417848 [info ] [MainThread]: python path: /Users/eranola/Documents/projects/environments/venv/bin/python
[0m16:45:28.418075 [info ] [MainThread]: os info: macOS-13.3.1-arm64-arm-64bit
[0m16:45:28.586336 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:45:28.586752 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:45:28.636223 [info ] [MainThread]: Using profiles dir at /Users/eranola/.dbt
[0m16:45:28.636628 [info ] [MainThread]: Using profiles.yml file at /Users/eranola/.dbt/profiles.yml
[0m16:45:28.636885 [info ] [MainThread]: Using dbt_project.yml file at /Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/dbt_project.yml
[0m16:45:28.637591 [info ] [MainThread]: adapter type: redshift
[0m16:45:28.637897 [info ] [MainThread]: adapter version: 1.8.1
[0m16:45:28.698905 [info ] [MainThread]: Configuration:
[0m16:45:28.699362 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:45:28.699626 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:45:28.699851 [info ] [MainThread]: Required dependencies:
[0m16:45:28.700498 [debug] [MainThread]: Executing "git --help"
[0m16:45:28.722189 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:45:28.723001 [debug] [MainThread]: STDERR: "b''"
[0m16:45:28.723309 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:45:28.723580 [info ] [MainThread]: Connection:
[0m16:45:28.723857 [info ] [MainThread]:   host: redshift-cluster-1.cfbi7zij33s3.ap-southeast-1.redshift.amazonaws.com
[0m16:45:28.724073 [info ] [MainThread]:   user: awsuser
[0m16:45:28.724274 [info ] [MainThread]:   port: 5439
[0m16:45:28.724483 [info ] [MainThread]:   database: dev
[0m16:45:28.724693 [info ] [MainThread]:   method: database
[0m16:45:28.724890 [info ] [MainThread]:   cluster_id: None
[0m16:45:28.725091 [info ] [MainThread]:   iam_profile: None
[0m16:45:28.725278 [info ] [MainThread]:   schema: public
[0m16:45:28.725466 [info ] [MainThread]:   sslmode: prefer
[0m16:45:28.725677 [info ] [MainThread]:   region: None
[0m16:45:28.725876 [info ] [MainThread]:   sslmode: prefer
[0m16:45:28.726065 [info ] [MainThread]:   region: None
[0m16:45:28.726256 [info ] [MainThread]:   iam_profile: None
[0m16:45:28.726452 [info ] [MainThread]:   autocreate: False
[0m16:45:28.726642 [info ] [MainThread]:   db_groups: []
[0m16:45:28.726831 [info ] [MainThread]:   ra3_node: False
[0m16:45:28.727014 [info ] [MainThread]:   connect_timeout: None
[0m16:45:28.727197 [info ] [MainThread]:   role: None
[0m16:45:28.727385 [info ] [MainThread]:   retries: 1
[0m16:45:28.727567 [info ] [MainThread]:   autocommit: True
[0m16:45:28.728183 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:45:28.733690 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m16:45:28.738912 [debug] [MainThread]: Using redshift connection "debug"
[0m16:45:28.739222 [debug] [MainThread]: On debug: select 1 as id
[0m16:45:28.739457 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:45:28.743502 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:45:28.744226 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:45:29.653542 [debug] [MainThread]: SQL status: SUCCESS in 0.914 seconds
[0m16:45:29.657605 [debug] [MainThread]: On debug: Close
[0m16:45:29.659101 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:45:29.659991 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:45:29.664527 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.317967, "process_user_time": 1.196225, "process_kernel_time": 0.29927, "process_mem_max_rss": "110395392", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:45:29.665720 [debug] [MainThread]: Command `dbt debug` succeeded at 16:45:29.665545 after 1.32 seconds
[0m16:45:29.666553 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:45:29.667151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dd7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d8a7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087c34d0>]}
[0m16:45:29.667762 [debug] [MainThread]: Flushing usage events
[0m16:45:37.332387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b4170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052989b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105298aa0>]}


============================== 16:45:37.336426 | ba85d1b1-8481-455d-879e-f6093c6b0e0c ==============================
[0m16:45:37.336426 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:45:37.336924 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select stg_order_items', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:45:37.544620 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:45:37.545039 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:45:37.671447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba85d1b1-8481-455d-879e-f6093c6b0e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e6360>]}
[0m16:45:37.707979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba85d1b1-8481-455d-879e-f6093c6b0e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b7d10>]}
[0m16:45:37.708820 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:45:37.725734 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:45:37.726956 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:45:37.727334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ba85d1b1-8481-455d-879e-f6093c6b0e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060fb3e0>]}
[0m16:45:38.850995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba85d1b1-8481-455d-879e-f6093c6b0e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054fa3c0>]}
[0m16:45:38.939199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba85d1b1-8481-455d-879e-f6093c6b0e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10754d970>]}
[0m16:45:38.939653 [info ] [MainThread]: Found 11 models, 6 data tests, 10 sources, 488 macros
[0m16:45:38.939960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba85d1b1-8481-455d-879e-f6093c6b0e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107590bf0>]}
[0m16:45:38.941298 [info ] [MainThread]: 
[0m16:45:38.941732 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m16:45:38.944965 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_staging'
[0m16:45:38.957922 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m16:45:38.958304 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m16:45:38.958550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:38.961586 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:45:38.962381 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:45:40.028634 [debug] [ThreadPool]: SQL status: SUCCESS in 1.070 seconds
[0m16:45:40.030243 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m16:45:40.031103 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m16:45:40.183806 [debug] [ThreadPool]: SQL status: SUCCESS in 0.152 seconds
[0m16:45:40.189215 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m16:45:40.318958 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m16:45:40.321334 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_staging, now list_dev_public_marts)
[0m16:45:40.330566 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m16:45:40.331208 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m16:45:40.331636 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:45:40.332286 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:45:40.332746 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:45:41.924836 [debug] [ThreadPool]: SQL status: SUCCESS in 1.593 seconds
[0m16:45:41.926743 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m16:45:41.927849 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m16:45:42.138390 [debug] [ThreadPool]: SQL status: SUCCESS in 0.209 seconds
[0m16:45:42.144289 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m16:45:42.271470 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m16:45:42.295304 [debug] [MainThread]: Using redshift connection "master"
[0m16:45:42.296023 [debug] [MainThread]: On master: BEGIN
[0m16:45:42.296394 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:45:42.296953 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:45:42.297337 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:45:43.035395 [debug] [MainThread]: SQL status: SUCCESS in 0.739 seconds
[0m16:45:43.037353 [debug] [MainThread]: Using redshift connection "master"
[0m16:45:43.038655 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m16:45:43.235661 [debug] [MainThread]: SQL status: SUCCESS in 0.196 seconds
[0m16:45:43.241231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba85d1b1-8481-455d-879e-f6093c6b0e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10590fcb0>]}
[0m16:45:43.242762 [debug] [MainThread]: On master: ROLLBACK
[0m16:45:43.371461 [debug] [MainThread]: Using redshift connection "master"
[0m16:45:43.372859 [debug] [MainThread]: On master: BEGIN
[0m16:45:43.440117 [debug] [MainThread]: SQL status: SUCCESS in 0.066 seconds
[0m16:45:43.442049 [debug] [MainThread]: On master: COMMIT
[0m16:45:43.443444 [debug] [MainThread]: Using redshift connection "master"
[0m16:45:43.444402 [debug] [MainThread]: On master: COMMIT
[0m16:45:43.579792 [debug] [MainThread]: SQL status: SUCCESS in 0.134 seconds
[0m16:45:43.581735 [debug] [MainThread]: On master: Close
[0m16:45:43.583623 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:45:43.584994 [info ] [MainThread]: 
[0m16:45:43.591273 [debug] [Thread-1 (]: Began running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m16:45:43.592259 [info ] [Thread-1 (]: 1 of 1 START test assert_stg_order_items_values_positive_stg_order_items_ ...... [RUN]
[0m16:45:43.593064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_marts, now test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd)
[0m16:45:43.593592 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m16:45:43.607584 [debug] [Thread-1 (]: Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:45:43.608456 [error] [Thread-1 (]: 1 of 1 ERROR assert_stg_order_items_values_positive_stg_order_items_ ........... [[31mERROR[0m in 0.02s]
[0m16:45:43.609179 [debug] [Thread-1 (]: Finished running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m16:45:43.611668 [debug] [MainThread]: Using redshift connection "master"
[0m16:45:43.612282 [debug] [MainThread]: On master: BEGIN
[0m16:45:43.612660 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:45:43.613178 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:45:43.613533 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:45:44.746526 [debug] [MainThread]: SQL status: SUCCESS in 1.134 seconds
[0m16:45:44.748067 [debug] [MainThread]: On master: COMMIT
[0m16:45:44.749110 [debug] [MainThread]: Using redshift connection "master"
[0m16:45:44.749752 [debug] [MainThread]: On master: COMMIT
[0m16:45:44.882240 [debug] [MainThread]: SQL status: SUCCESS in 0.131 seconds
[0m16:45:44.884267 [debug] [MainThread]: On master: Close
[0m16:45:44.886103 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:45:44.887172 [debug] [MainThread]: Connection 'test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd' was properly closed.
[0m16:45:44.888141 [info ] [MainThread]: 
[0m16:45:44.889055 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 5.95 seconds (5.95s).
[0m16:45:44.890469 [debug] [MainThread]: Command end result
[0m16:45:44.936015 [info ] [MainThread]: 
[0m16:45:44.936628 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:45:44.936933 [info ] [MainThread]: 
[0m16:45:44.937284 [error] [MainThread]:   Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:45:44.937556 [info ] [MainThread]: 
[0m16:45:44.937825 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:45:44.939705 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 7.6587176, "process_user_time": 2.699812, "process_kernel_time": 0.371378, "process_mem_max_rss": "126648320", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:45:44.940157 [debug] [MainThread]: Command `dbt test` failed at 16:45:44.940087 after 7.66 seconds
[0m16:45:44.940481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107575d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107575b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e7fb0>]}
[0m16:45:44.940787 [debug] [MainThread]: Flushing usage events
[0m16:45:49.691413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ff3140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b2bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b2bec0>]}


============================== 16:45:49.695455 | 15ef9c6a-8ef3-4aba-8567-52daf5d6e5b4 ==============================
[0m16:45:49.695455 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:45:49.696002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/eranola/.dbt', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --select assert_stg_order_items_values_positive', 'send_anonymous_usage_stats': 'True'}
[0m16:45:49.860841 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:45:49.861276 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:45:49.985616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15ef9c6a-8ef3-4aba-8567-52daf5d6e5b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091c8740>]}
[0m16:45:50.022993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15ef9c6a-8ef3-4aba-8567-52daf5d6e5b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d36360>]}
[0m16:45:50.023829 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:45:50.040167 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:45:50.174952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:45:50.175353 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:45:50.207719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15ef9c6a-8ef3-4aba-8567-52daf5d6e5b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10921ddc0>]}
[0m16:45:50.289919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15ef9c6a-8ef3-4aba-8567-52daf5d6e5b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cfec30>]}
[0m16:45:50.290384 [info ] [MainThread]: Found 11 models, 6 data tests, 10 sources, 488 macros
[0m16:45:50.290711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15ef9c6a-8ef3-4aba-8567-52daf5d6e5b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096442c0>]}
[0m16:45:50.291319 [warn ] [MainThread]: The selection criterion 'assert_stg_order_items_values_positive' does not match any enabled nodes
[0m16:45:50.292339 [info ] [MainThread]: 
[0m16:45:50.292625 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:45:50.293992 [debug] [MainThread]: Command end result
[0m16:45:50.319951 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6792273, "process_user_time": 1.355132, "process_kernel_time": 0.253313, "process_mem_max_rss": "117227520", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:45:50.320493 [debug] [MainThread]: Command `dbt test` succeeded at 16:45:50.320419 after 0.68 seconds
[0m16:45:50.320825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10870e930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e36c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105522cf0>]}
[0m16:45:50.321104 [debug] [MainThread]: Flushing usage events
[0m16:48:38.955119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b573e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10502c560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039dda00>]}


============================== 16:48:38.959531 | 54999ef6-0fd5-45da-877d-9b9f0514d7d9 ==============================
[0m16:48:38.959531 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:48:38.960032 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt list', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:48:39.133869 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:48:39.134280 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:48:39.268869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54999ef6-0fd5-45da-877d-9b9f0514d7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103339880>]}
[0m16:48:39.305659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54999ef6-0fd5-45da-877d-9b9f0514d7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105544f50>]}
[0m16:48:39.306722 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:48:39.323480 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:48:39.461329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:48:39.461875 [debug] [MainThread]: Partial parsing: added file: olist_dbt://tests/assert_stg_order_items_values_positive.sql
[0m16:48:39.600786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54999ef6-0fd5-45da-877d-9b9f0514d7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b7b950>]}
[0m16:48:39.694428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54999ef6-0fd5-45da-877d-9b9f0514d7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106241ac0>]}
[0m16:48:39.697736 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.7942428, "process_user_time": 1.425409, "process_kernel_time": 0.2945, "process_mem_max_rss": "117473280", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:48:39.698251 [debug] [MainThread]: Command `dbt list` succeeded at 16:48:39.698167 after 0.79 seconds
[0m16:48:39.698586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ba4470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105545400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104859af0>]}
[0m16:48:39.698865 [debug] [MainThread]: Flushing usage events
[0m16:49:06.494623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106636420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aff9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b7c350>]}


============================== 16:49:06.498732 | 5dbfde4a-ef7d-45cd-bd17-422deb3c136d ==============================
[0m16:49:06.498732 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:49:06.499302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt list --resource-type test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:49:06.663559 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:49:06.663980 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:49:06.788123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dbfde4a-ef7d-45cd-bd17-422deb3c136d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105419790>]}
[0m16:49:06.825275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dbfde4a-ef7d-45cd-bd17-422deb3c136d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10734f8c0>]}
[0m16:49:06.826153 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:49:06.842878 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:49:06.980580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:49:06.980976 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:49:07.017486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dbfde4a-ef7d-45cd-bd17-422deb3c136d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a0650>]}
[0m16:49:07.109754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dbfde4a-ef7d-45cd-bd17-422deb3c136d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c1700>]}
[0m16:49:07.112249 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.6690364, "process_user_time": 1.349418, "process_kernel_time": 0.257648, "process_mem_max_rss": "114212864", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:49:07.112735 [debug] [MainThread]: Command `dbt list` succeeded at 16:49:07.112653 after 0.67 seconds
[0m16:49:07.113055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065b4b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106636420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10734de80>]}
[0m16:49:07.113324 [debug] [MainThread]: Flushing usage events
[0m16:49:49.414559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049c8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049fbfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049fbe60>]}


============================== 16:49:49.418550 | c532e64c-6303-46db-8f07-b85de533dfa1 ==============================
[0m16:49:49.418550 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:49:49.419074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'profiles_dir': '/Users/eranola/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --select olist_dbt.assert_stg_order_items_values_positive', 'send_anonymous_usage_stats': 'True'}
[0m16:49:49.585845 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:49:49.586248 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:49:49.711022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c532e64c-6303-46db-8f07-b85de533dfa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f03b0>]}
[0m16:49:49.748244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c532e64c-6303-46db-8f07-b85de533dfa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ac70e0>]}
[0m16:49:49.749091 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:49:49.766176 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:49:49.910212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:49:49.910596 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:49:49.946716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c532e64c-6303-46db-8f07-b85de533dfa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105504ad0>]}
[0m16:49:50.038208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c532e64c-6303-46db-8f07-b85de533dfa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d2ce30>]}
[0m16:49:50.038643 [info ] [MainThread]: Found 11 models, 7 data tests, 10 sources, 488 macros
[0m16:49:50.038930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c532e64c-6303-46db-8f07-b85de533dfa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10506c170>]}
[0m16:49:50.040270 [info ] [MainThread]: 
[0m16:49:50.040710 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m16:49:50.043878 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_staging'
[0m16:49:50.058813 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m16:49:50.059203 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m16:49:50.059445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:50.062521 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:49:50.063248 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:49:50.872577 [debug] [ThreadPool]: SQL status: SUCCESS in 0.813 seconds
[0m16:49:50.874386 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m16:49:50.875762 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m16:49:51.383453 [debug] [ThreadPool]: SQL status: SUCCESS in 0.506 seconds
[0m16:49:51.388279 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m16:49:51.521098 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m16:49:51.523852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_staging, now list_dev_public_marts)
[0m16:49:51.533667 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m16:49:51.534207 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m16:49:51.534615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:51.535241 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:49:51.535674 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:49:52.520293 [debug] [ThreadPool]: SQL status: SUCCESS in 0.985 seconds
[0m16:49:52.522023 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m16:49:52.523177 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m16:49:53.025660 [debug] [ThreadPool]: SQL status: SUCCESS in 0.501 seconds
[0m16:49:53.031268 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m16:49:53.161436 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m16:49:53.185371 [debug] [MainThread]: Using redshift connection "master"
[0m16:49:53.185971 [debug] [MainThread]: On master: BEGIN
[0m16:49:53.186317 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:49:53.186858 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:49:53.187229 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:49:54.325897 [debug] [MainThread]: SQL status: SUCCESS in 1.139 seconds
[0m16:49:54.327893 [debug] [MainThread]: Using redshift connection "master"
[0m16:49:54.328735 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m16:49:54.530477 [debug] [MainThread]: SQL status: SUCCESS in 0.201 seconds
[0m16:49:54.535863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c532e64c-6303-46db-8f07-b85de533dfa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103325820>]}
[0m16:49:54.537445 [debug] [MainThread]: On master: ROLLBACK
[0m16:49:54.667699 [debug] [MainThread]: Using redshift connection "master"
[0m16:49:54.669685 [debug] [MainThread]: On master: BEGIN
[0m16:49:54.733073 [debug] [MainThread]: SQL status: SUCCESS in 0.062 seconds
[0m16:49:54.733599 [debug] [MainThread]: On master: COMMIT
[0m16:49:54.733929 [debug] [MainThread]: Using redshift connection "master"
[0m16:49:54.734177 [debug] [MainThread]: On master: COMMIT
[0m16:49:54.860829 [debug] [MainThread]: SQL status: SUCCESS in 0.126 seconds
[0m16:49:54.861937 [debug] [MainThread]: On master: Close
[0m16:49:54.863623 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:49:54.864496 [info ] [MainThread]: 
[0m16:49:54.870634 [debug] [Thread-1 (]: Began running node test.olist_dbt.assert_stg_order_items_values_positive
[0m16:49:54.871288 [info ] [Thread-1 (]: 1 of 1 START test assert_stg_order_items_values_positive ....................... [RUN]
[0m16:49:54.872129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_marts, now test.olist_dbt.assert_stg_order_items_values_positive)
[0m16:49:54.872901 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.assert_stg_order_items_values_positive
[0m16:49:54.877653 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.assert_stg_order_items_values_positive"
[0m16:49:54.880715 [debug] [Thread-1 (]: Began executing node test.olist_dbt.assert_stg_order_items_values_positive
[0m16:49:54.899301 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.assert_stg_order_items_values_positive"
[0m16:49:54.903235 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.assert_stg_order_items_values_positive"
[0m16:49:54.903714 [debug] [Thread-1 (]: On test.olist_dbt.assert_stg_order_items_values_positive: BEGIN
[0m16:49:54.904007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:54.904420 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:49:54.904721 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:49:55.596967 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.692 seconds
[0m16:49:55.599054 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.assert_stg_order_items_values_positive"
[0m16:49:55.600539 [debug] [Thread-1 (]: On test.olist_dbt.assert_stg_order_items_values_positive: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.assert_stg_order_items_values_positive"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      WITH order_items AS (

    SELECT  *
    FROM "dev"."public_staging"."stg_order_items"

)

SELECT  order_id,
        SUM(price) AS total_value
FROM order_items
GROUP BY 1
HAVING total_value < 0
      
    ) dbt_internal_test
[0m16:50:00.110204 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.509 seconds
[0m16:50:00.117228 [debug] [Thread-1 (]: On test.olist_dbt.assert_stg_order_items_values_positive: ROLLBACK
[0m16:50:00.245310 [debug] [Thread-1 (]: On test.olist_dbt.assert_stg_order_items_values_positive: Close
[0m16:50:00.248184 [info ] [Thread-1 (]: 1 of 1 PASS assert_stg_order_items_values_positive ............................. [[32mPASS[0m in 5.38s]
[0m16:50:00.249893 [debug] [Thread-1 (]: Finished running node test.olist_dbt.assert_stg_order_items_values_positive
[0m16:50:00.252965 [debug] [MainThread]: Using redshift connection "master"
[0m16:50:00.253938 [debug] [MainThread]: On master: BEGIN
[0m16:50:00.254506 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:50:00.255695 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:50:00.256394 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:50:01.326089 [debug] [MainThread]: SQL status: SUCCESS in 1.071 seconds
[0m16:50:01.327481 [debug] [MainThread]: On master: COMMIT
[0m16:50:01.328420 [debug] [MainThread]: Using redshift connection "master"
[0m16:50:01.329089 [debug] [MainThread]: On master: COMMIT
[0m16:50:01.461910 [debug] [MainThread]: SQL status: SUCCESS in 0.132 seconds
[0m16:50:01.462527 [debug] [MainThread]: On master: Close
[0m16:50:01.463177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:01.463473 [debug] [MainThread]: Connection 'test.olist_dbt.assert_stg_order_items_values_positive' was properly closed.
[0m16:50:01.463791 [info ] [MainThread]: 
[0m16:50:01.464124 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 11.42 seconds (11.42s).
[0m16:50:01.465044 [debug] [MainThread]: Command end result
[0m16:50:01.498427 [info ] [MainThread]: 
[0m16:50:01.499072 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:50:01.499477 [info ] [MainThread]: 
[0m16:50:01.499752 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:50:01.501617 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 12.138008, "process_user_time": 1.850259, "process_kernel_time": 0.357862, "process_mem_max_rss": "122437632", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:50:01.502075 [debug] [MainThread]: Command `dbt test` succeeded at 16:50:01.502008 after 12.14 seconds
[0m16:50:01.502379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103860770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10445dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105baf5c0>]}
[0m16:50:01.502659 [debug] [MainThread]: Flushing usage events
[0m16:50:27.877961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108355f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a289b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a288c0>]}


============================== 16:50:27.881739 | 58d7bd31-e2e3-497b-bc41-f56a5d9ec62e ==============================
[0m16:50:27.881739 [info ] [MainThread]: Running with dbt=1.8.6
[0m16:50:27.882233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/eranola/.dbt', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --select assert_stg_order_items_values_positive', 'send_anonymous_usage_stats': 'True'}
[0m16:50:28.048909 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:50:28.049342 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:50:28.174710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58d7bd31-e2e3-497b-bc41-f56a5d9ec62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d0770>]}
[0m16:50:28.211776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58d7bd31-e2e3-497b-bc41-f56a5d9ec62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e71c40>]}
[0m16:50:28.212688 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:50:28.229097 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m16:50:28.368412 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:50:28.368780 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:50:28.405117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58d7bd31-e2e3-497b-bc41-f56a5d9ec62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10932aba0>]}
[0m16:50:28.496632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58d7bd31-e2e3-497b-bc41-f56a5d9ec62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099be300>]}
[0m16:50:28.497076 [info ] [MainThread]: Found 11 models, 7 data tests, 10 sources, 488 macros
[0m16:50:28.497375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58d7bd31-e2e3-497b-bc41-f56a5d9ec62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ffca40>]}
[0m16:50:28.498705 [info ] [MainThread]: 
[0m16:50:28.499155 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m16:50:28.502333 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_staging'
[0m16:50:28.517099 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m16:50:28.517528 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m16:50:28.517788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:28.520874 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:50:28.521595 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:50:29.350030 [debug] [ThreadPool]: SQL status: SUCCESS in 0.832 seconds
[0m16:50:29.352101 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m16:50:29.353256 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m16:50:29.503030 [debug] [ThreadPool]: SQL status: SUCCESS in 0.148 seconds
[0m16:50:29.509547 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m16:50:29.637788 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m16:50:29.640915 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_staging, now list_dev_public_marts)
[0m16:50:29.652060 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m16:50:29.652757 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m16:50:29.653200 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:29.653851 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:50:29.654307 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:50:30.363550 [debug] [ThreadPool]: SQL status: SUCCESS in 0.710 seconds
[0m16:50:30.365238 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m16:50:30.366346 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m16:50:30.517213 [debug] [ThreadPool]: SQL status: SUCCESS in 0.149 seconds
[0m16:50:30.521827 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m16:50:30.650114 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m16:50:30.672397 [debug] [MainThread]: Using redshift connection "master"
[0m16:50:30.673009 [debug] [MainThread]: On master: BEGIN
[0m16:50:30.673376 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:50:30.673886 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:50:30.674258 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:50:31.543657 [debug] [MainThread]: SQL status: SUCCESS in 0.870 seconds
[0m16:50:31.545457 [debug] [MainThread]: Using redshift connection "master"
[0m16:50:31.546692 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m16:50:31.808375 [debug] [MainThread]: SQL status: SUCCESS in 0.260 seconds
[0m16:50:31.813786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58d7bd31-e2e3-497b-bc41-f56a5d9ec62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109de1bb0>]}
[0m16:50:31.815306 [debug] [MainThread]: On master: ROLLBACK
[0m16:50:31.947851 [debug] [MainThread]: Using redshift connection "master"
[0m16:50:31.949253 [debug] [MainThread]: On master: BEGIN
[0m16:50:32.013846 [debug] [MainThread]: SQL status: SUCCESS in 0.063 seconds
[0m16:50:32.015345 [debug] [MainThread]: On master: COMMIT
[0m16:50:32.016616 [debug] [MainThread]: Using redshift connection "master"
[0m16:50:32.017612 [debug] [MainThread]: On master: COMMIT
[0m16:50:32.149906 [debug] [MainThread]: SQL status: SUCCESS in 0.131 seconds
[0m16:50:32.151588 [debug] [MainThread]: On master: Close
[0m16:50:32.153341 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:50:32.154182 [info ] [MainThread]: 
[0m16:50:32.159329 [debug] [Thread-1 (]: Began running node test.olist_dbt.assert_stg_order_items_values_positive
[0m16:50:32.160464 [info ] [Thread-1 (]: 1 of 1 START test assert_stg_order_items_values_positive ....................... [RUN]
[0m16:50:32.161464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_marts, now test.olist_dbt.assert_stg_order_items_values_positive)
[0m16:50:32.162150 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.assert_stg_order_items_values_positive
[0m16:50:32.167968 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.assert_stg_order_items_values_positive"
[0m16:50:32.169863 [debug] [Thread-1 (]: Began executing node test.olist_dbt.assert_stg_order_items_values_positive
[0m16:50:32.189404 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.assert_stg_order_items_values_positive"
[0m16:50:32.192131 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.assert_stg_order_items_values_positive"
[0m16:50:32.192559 [debug] [Thread-1 (]: On test.olist_dbt.assert_stg_order_items_values_positive: BEGIN
[0m16:50:32.192899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:32.193374 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:50:32.193726 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:50:32.974352 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.781 seconds
[0m16:50:32.976517 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.assert_stg_order_items_values_positive"
[0m16:50:32.977881 [debug] [Thread-1 (]: On test.olist_dbt.assert_stg_order_items_values_positive: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.assert_stg_order_items_values_positive"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      WITH order_items AS (

    SELECT  *
    FROM "dev"."public_staging"."stg_order_items"

)

SELECT  order_id,
        SUM(price) AS total_value
FROM order_items
GROUP BY 1
HAVING total_value < 0
      
    ) dbt_internal_test
[0m16:50:33.112974 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.134 seconds
[0m16:50:33.123560 [debug] [Thread-1 (]: On test.olist_dbt.assert_stg_order_items_values_positive: ROLLBACK
[0m16:50:33.251919 [debug] [Thread-1 (]: On test.olist_dbt.assert_stg_order_items_values_positive: Close
[0m16:50:33.254973 [info ] [Thread-1 (]: 1 of 1 PASS assert_stg_order_items_values_positive ............................. [[32mPASS[0m in 1.09s]
[0m16:50:33.256991 [debug] [Thread-1 (]: Finished running node test.olist_dbt.assert_stg_order_items_values_positive
[0m16:50:33.260221 [debug] [MainThread]: Using redshift connection "master"
[0m16:50:33.261020 [debug] [MainThread]: On master: BEGIN
[0m16:50:33.261727 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:50:33.262859 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:50:33.263838 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:50:34.584074 [debug] [MainThread]: SQL status: SUCCESS in 1.322 seconds
[0m16:50:34.586022 [debug] [MainThread]: On master: COMMIT
[0m16:50:34.587422 [debug] [MainThread]: Using redshift connection "master"
[0m16:50:34.588159 [debug] [MainThread]: On master: COMMIT
[0m16:50:34.807957 [debug] [MainThread]: SQL status: SUCCESS in 0.219 seconds
[0m16:50:34.809794 [debug] [MainThread]: On master: Close
[0m16:50:34.811684 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:34.812302 [debug] [MainThread]: Connection 'test.olist_dbt.assert_stg_order_items_values_positive' was properly closed.
[0m16:50:34.812960 [info ] [MainThread]: 
[0m16:50:34.813665 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 6.31 seconds (6.31s).
[0m16:50:34.814834 [debug] [MainThread]: Command end result
[0m16:50:34.860048 [info ] [MainThread]: 
[0m16:50:34.860593 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:50:34.860891 [info ] [MainThread]: 
[0m16:50:34.861185 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:50:34.863322 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.0359516, "process_user_time": 1.860987, "process_kernel_time": 0.367582, "process_mem_max_rss": "122519552", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:50:34.863872 [debug] [MainThread]: Command `dbt test` succeeded at 16:50:34.863792 after 7.04 seconds
[0m16:50:34.864233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b114f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d31ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108357590>]}
[0m16:50:34.864570 [debug] [MainThread]: Flushing usage events
[0m17:05:52.473203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bd6ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103768a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103768980>]}


============================== 17:05:52.477519 | f940b3b2-ba93-4d73-af60-ea4f2608569a ==============================
[0m17:05:52.477519 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:05:52.478075 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:05:52.655017 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:05:52.655440 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:05:52.792029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f940b3b2-ba93-4d73-af60-ea4f2608569a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031756a0>]}
[0m17:05:52.829839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f940b3b2-ba93-4d73-af60-ea4f2608569a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f27710>]}
[0m17:05:52.830896 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m17:05:52.847878 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:05:52.993312 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:05:52.993688 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:05:53.030212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f940b3b2-ba93-4d73-af60-ea4f2608569a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa44d0>]}
[0m17:05:53.125943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f940b3b2-ba93-4d73-af60-ea4f2608569a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a87830>]}
[0m17:05:53.126377 [info ] [MainThread]: Found 11 models, 7 data tests, 10 sources, 488 macros
[0m17:05:53.126672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f940b3b2-ba93-4d73-af60-ea4f2608569a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d3e60>]}
[0m17:05:53.128428 [info ] [MainThread]: 
[0m17:05:53.128879 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:05:53.132071 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_marts'
[0m17:05:53.146828 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m17:05:53.147259 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m17:05:53.147500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:53.150575 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:05:53.151299 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:05:54.074866 [debug] [ThreadPool]: SQL status: SUCCESS in 0.927 seconds
[0m17:05:54.076850 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m17:05:54.077729 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m17:05:54.224744 [debug] [ThreadPool]: SQL status: SUCCESS in 0.146 seconds
[0m17:05:54.229619 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m17:05:54.357386 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m17:05:54.361345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_marts, now list_dev_public_staging)
[0m17:05:54.369504 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:05:54.370166 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m17:05:54.370596 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:05:54.371261 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:05:54.371730 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:05:55.084665 [debug] [ThreadPool]: SQL status: SUCCESS in 0.714 seconds
[0m17:05:55.086728 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:05:55.087919 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m17:05:55.239396 [debug] [ThreadPool]: SQL status: SUCCESS in 0.150 seconds
[0m17:05:55.245409 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m17:05:55.373863 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m17:05:55.398643 [debug] [MainThread]: Using redshift connection "master"
[0m17:05:55.399192 [debug] [MainThread]: On master: BEGIN
[0m17:05:55.399544 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:05:55.400062 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:05:55.400440 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:05:56.484917 [debug] [MainThread]: SQL status: SUCCESS in 1.085 seconds
[0m17:05:56.486462 [debug] [MainThread]: Using redshift connection "master"
[0m17:05:56.487299 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:05:56.678740 [debug] [MainThread]: SQL status: SUCCESS in 0.190 seconds
[0m17:05:56.682515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f940b3b2-ba93-4d73-af60-ea4f2608569a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104abe1b0>]}
[0m17:05:56.683629 [debug] [MainThread]: On master: ROLLBACK
[0m17:05:57.224483 [debug] [MainThread]: Using redshift connection "master"
[0m17:05:57.226072 [debug] [MainThread]: On master: BEGIN
[0m17:05:57.670097 [debug] [MainThread]: SQL status: SUCCESS in 0.443 seconds
[0m17:05:57.670599 [debug] [MainThread]: On master: COMMIT
[0m17:05:57.670969 [debug] [MainThread]: Using redshift connection "master"
[0m17:05:57.671249 [debug] [MainThread]: On master: COMMIT
[0m17:05:57.797965 [debug] [MainThread]: SQL status: SUCCESS in 0.126 seconds
[0m17:05:57.798632 [debug] [MainThread]: On master: Close
[0m17:05:57.799399 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:05:57.799835 [info ] [MainThread]: 
[0m17:05:57.803027 [debug] [Thread-1 (]: Began running node test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d
[0m17:05:57.803546 [info ] [Thread-1 (]: 1 of 7 START test accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved  [RUN]
[0m17:05:57.804052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d)
[0m17:05:57.804474 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d
[0m17:05:57.820871 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d"
[0m17:05:57.823969 [debug] [Thread-1 (]: Began executing node test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d
[0m17:05:57.837687 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d"
[0m17:05:57.841231 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d"
[0m17:05:57.841592 [debug] [Thread-1 (]: On test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d: BEGIN
[0m17:05:57.841872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:57.842253 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:05:57.842533 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:05:58.599296 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.757 seconds
[0m17:05:58.601121 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d"
[0m17:05:58.601950 [debug] [Thread-1 (]: On test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "dev"."public_staging"."stg_orders"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','canceled','invoiced','processing','created','shipped','unavailable','approved'
)



      
    ) dbt_internal_test
[0m17:05:58.740654 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.137 seconds
[0m17:05:58.751750 [debug] [Thread-1 (]: On test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d: ROLLBACK
[0m17:05:59.065987 [debug] [Thread-1 (]: On test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d: Close
[0m17:05:59.069793 [info ] [Thread-1 (]: 1 of 7 PASS accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved  [[32mPASS[0m in 1.27s]
[0m17:05:59.071479 [debug] [Thread-1 (]: Finished running node test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d
[0m17:05:59.072421 [debug] [Thread-1 (]: Began running node test.olist_dbt.assert_stg_order_items_values_positive
[0m17:05:59.073163 [info ] [Thread-1 (]: 2 of 7 START test assert_stg_order_items_values_positive ....................... [RUN]
[0m17:05:59.074477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d, now test.olist_dbt.assert_stg_order_items_values_positive)
[0m17:05:59.075283 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.assert_stg_order_items_values_positive
[0m17:05:59.079395 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.assert_stg_order_items_values_positive"
[0m17:05:59.080951 [debug] [Thread-1 (]: Began executing node test.olist_dbt.assert_stg_order_items_values_positive
[0m17:05:59.084178 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.assert_stg_order_items_values_positive"
[0m17:05:59.087265 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.assert_stg_order_items_values_positive"
[0m17:05:59.087822 [debug] [Thread-1 (]: On test.olist_dbt.assert_stg_order_items_values_positive: BEGIN
[0m17:05:59.088297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:59.088941 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:05:59.089388 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:05:59.955859 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.867 seconds
[0m17:05:59.956560 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.assert_stg_order_items_values_positive"
[0m17:05:59.957070 [debug] [Thread-1 (]: On test.olist_dbt.assert_stg_order_items_values_positive: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.assert_stg_order_items_values_positive"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      WITH order_items AS (

    SELECT  *
    FROM "dev"."public_staging"."stg_order_items"

)

SELECT  order_id,
        SUM(price) AS total_value
FROM order_items
GROUP BY 1
HAVING total_value < 0
      
    ) dbt_internal_test
[0m17:06:00.102531 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.145 seconds
[0m17:06:00.105737 [debug] [Thread-1 (]: On test.olist_dbt.assert_stg_order_items_values_positive: ROLLBACK
[0m17:06:00.248066 [debug] [Thread-1 (]: On test.olist_dbt.assert_stg_order_items_values_positive: Close
[0m17:06:00.250434 [info ] [Thread-1 (]: 2 of 7 PASS assert_stg_order_items_values_positive ............................. [[32mPASS[0m in 1.18s]
[0m17:06:00.251868 [debug] [Thread-1 (]: Finished running node test.olist_dbt.assert_stg_order_items_values_positive
[0m17:06:00.252871 [debug] [Thread-1 (]: Began running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m17:06:00.253673 [info ] [Thread-1 (]: 3 of 7 START test assert_stg_order_items_values_positive_stg_order_items_ ...... [RUN]
[0m17:06:00.254490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.assert_stg_order_items_values_positive, now test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd)
[0m17:06:00.255053 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m17:06:00.270534 [debug] [Thread-1 (]: Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:06:00.271332 [error] [Thread-1 (]: 3 of 7 ERROR assert_stg_order_items_values_positive_stg_order_items_ ........... [[31mERROR[0m in 0.02s]
[0m17:06:00.272180 [debug] [Thread-1 (]: Finished running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m17:06:00.272855 [debug] [Thread-1 (]: Began running node test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:06:00.275030 [info ] [Thread-1 (]: 4 of 7 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m17:06:00.276476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd, now test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m17:06:00.276985 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:06:00.285034 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:06:00.286428 [debug] [Thread-1 (]: Began executing node test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:06:00.293449 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:06:00.295521 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:06:00.295878 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m17:06:00.296169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:00.296588 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:06:00.296889 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:06:01.416527 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.120 seconds
[0m17:06:01.417922 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:06:01.418567 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dev"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m17:06:01.581636 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.162 seconds
[0m17:06:01.584717 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m17:06:02.449819 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m17:06:02.459815 [info ] [Thread-1 (]: 4 of 7 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 2.18s]
[0m17:06:02.461563 [debug] [Thread-1 (]: Finished running node test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:06:02.463071 [debug] [Thread-1 (]: Began running node test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m17:06:02.464040 [info ] [Thread-1 (]: 5 of 7 START test not_null_stg_orders_order_id ................................. [RUN]
[0m17:06:02.464931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64)
[0m17:06:02.465308 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m17:06:02.469666 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:06:02.470985 [debug] [Thread-1 (]: Began executing node test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m17:06:02.473507 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:06:02.475310 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:06:02.475668 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m17:06:02.476080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:02.476520 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:06:02.476800 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:06:03.234412 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.758 seconds
[0m17:06:03.236427 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:06:03.237607 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "dev"."public_staging"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m17:06:03.851989 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.613 seconds
[0m17:06:03.856616 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m17:06:04.084154 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m17:06:04.086386 [info ] [Thread-1 (]: 5 of 7 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 1.62s]
[0m17:06:04.087708 [debug] [Thread-1 (]: Finished running node test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m17:06:04.088551 [debug] [Thread-1 (]: Began running node test.olist_dbt.unique_stg_customers_customer_id.c7614daada
[0m17:06:04.089310 [info ] [Thread-1 (]: 6 of 7 START test unique_stg_customers_customer_id ............................. [RUN]
[0m17:06:04.090158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64, now test.olist_dbt.unique_stg_customers_customer_id.c7614daada)
[0m17:06:04.090860 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.unique_stg_customers_customer_id.c7614daada
[0m17:06:04.098888 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.unique_stg_customers_customer_id.c7614daada"
[0m17:06:04.099885 [debug] [Thread-1 (]: Began executing node test.olist_dbt.unique_stg_customers_customer_id.c7614daada
[0m17:06:04.101763 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.unique_stg_customers_customer_id.c7614daada"
[0m17:06:04.103465 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.unique_stg_customers_customer_id.c7614daada"
[0m17:06:04.103759 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m17:06:04.104015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:04.104376 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:06:04.104640 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:06:07.006998 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.903 seconds
[0m17:06:07.008617 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.unique_stg_customers_customer_id.c7614daada"
[0m17:06:07.009471 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dev"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:06:07.284047 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.273 seconds
[0m17:06:07.289061 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m17:06:07.442967 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_customers_customer_id.c7614daada: Close
[0m17:06:07.445898 [info ] [Thread-1 (]: 6 of 7 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 3.36s]
[0m17:06:07.447688 [debug] [Thread-1 (]: Finished running node test.olist_dbt.unique_stg_customers_customer_id.c7614daada
[0m17:06:07.448748 [debug] [Thread-1 (]: Began running node test.olist_dbt.unique_stg_orders_order_id.e3b841c71a
[0m17:06:07.449603 [info ] [Thread-1 (]: 7 of 7 START test unique_stg_orders_order_id ................................... [RUN]
[0m17:06:07.450429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.unique_stg_customers_customer_id.c7614daada, now test.olist_dbt.unique_stg_orders_order_id.e3b841c71a)
[0m17:06:07.451767 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.unique_stg_orders_order_id.e3b841c71a
[0m17:06:07.458823 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m17:06:07.460482 [debug] [Thread-1 (]: Began executing node test.olist_dbt.unique_stg_orders_order_id.e3b841c71a
[0m17:06:07.463815 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m17:06:07.466696 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m17:06:07.467230 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m17:06:07.467657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:07.468238 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:06:07.468641 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:06:08.713288 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.245 seconds
[0m17:06:08.714839 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m17:06:08.715709 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."public_staging"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:06:09.011361 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.295 seconds
[0m17:06:09.014668 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m17:06:09.152779 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_orders_order_id.e3b841c71a: Close
[0m17:06:09.155237 [info ] [Thread-1 (]: 7 of 7 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 1.70s]
[0m17:06:09.156428 [debug] [Thread-1 (]: Finished running node test.olist_dbt.unique_stg_orders_order_id.e3b841c71a
[0m17:06:09.159012 [debug] [MainThread]: Using redshift connection "master"
[0m17:06:09.159693 [debug] [MainThread]: On master: BEGIN
[0m17:06:09.160532 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:06:09.161515 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:06:09.162107 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:06:09.931720 [debug] [MainThread]: SQL status: SUCCESS in 0.771 seconds
[0m17:06:09.932854 [debug] [MainThread]: On master: COMMIT
[0m17:06:09.933938 [debug] [MainThread]: Using redshift connection "master"
[0m17:06:09.934734 [debug] [MainThread]: On master: COMMIT
[0m17:06:10.153587 [debug] [MainThread]: SQL status: SUCCESS in 0.218 seconds
[0m17:06:10.155047 [debug] [MainThread]: On master: Close
[0m17:06:10.156080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:10.156731 [debug] [MainThread]: Connection 'test.olist_dbt.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m17:06:10.157476 [info ] [MainThread]: 
[0m17:06:10.158153 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 17.03 seconds (17.03s).
[0m17:06:10.160303 [debug] [MainThread]: Command end result
[0m17:06:10.210476 [info ] [MainThread]: 
[0m17:06:10.210940 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:06:10.211190 [info ] [MainThread]: 
[0m17:06:10.211499 [error] [MainThread]:   Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:06:10.211742 [info ] [MainThread]: 
[0m17:06:10.211978 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m17:06:10.213900 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 17.794523, "process_user_time": 2.26516, "process_kernel_time": 0.412685, "process_mem_max_rss": "126353408", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:06:10.214331 [debug] [MainThread]: Command `dbt test` failed at 17:06:10.214266 after 17.80 seconds
[0m17:06:10.214632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1012aacc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb2ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048b3b60>]}
[0m17:06:10.214933 [debug] [MainThread]: Flushing usage events
[0m17:15:08.117712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f9f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f37c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5c0e0>]}


============================== 17:15:08.122173 | e6d4a101-86b3-43b6-8327-76172bec19cf ==============================
[0m17:15:08.122173 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:15:08.122690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select source:olist', 'send_anonymous_usage_stats': 'True'}
[0m17:15:08.295732 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:15:08.296158 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:15:08.431938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6d4a101-86b3-43b6-8327-76172bec19cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108625ac0>]}
[0m17:15:08.469362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6d4a101-86b3-43b6-8327-76172bec19cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108169160>]}
[0m17:15:08.470501 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m17:15:08.488174 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:15:08.578273 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading olist_dbt: staging/olist/_olist__sources.yml - Runtime Error
    Syntax error near line 14
    ------------------------------
    11 |     # loaded_at_field: created_at
    12 |     tables:
    13 |       - name: customer
    14 |           columns:
    15 |             - name: customer_id
    16 |                 tests:
    17 |                   - unique
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 14, column 18
[0m17:15:08.580357 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.5149361, "process_user_time": 1.201547, "process_kernel_time": 0.268043, "process_mem_max_rss": "113770496", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:15:08.580877 [debug] [MainThread]: Command `dbt test` failed at 17:15:08.580793 after 0.52 seconds
[0m17:15:08.581232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e48cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108536f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fdd4c0>]}
[0m17:15:08.581534 [debug] [MainThread]: Flushing usage events
[0m17:15:38.499149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103567e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fbc5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fbc1a0>]}


============================== 17:15:38.502991 | 6068274f-9944-455a-aa54-959bd1d8c16c ==============================
[0m17:15:38.502991 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:15:38.503490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt list --resource-type test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:15:38.707592 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:15:38.708040 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:15:38.863034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6068274f-9944-455a-aa54-959bd1d8c16c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028598e0>]}
[0m17:15:38.901064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6068274f-9944-455a-aa54-959bd1d8c16c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103afbf20>]}
[0m17:15:38.902051 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m17:15:38.917454 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:15:39.005695 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading olist_dbt: staging/olist/_olist__sources.yml - Runtime Error
    Syntax error near line 14
    ------------------------------
    11 |     # loaded_at_field: created_at
    12 |     tables:
    13 |       - name: customer
    14 |           columns:
    15 |             - name: customer_id
    16 |                 tests:
    17 |                   - unique
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 14, column 18
[0m17:15:39.007734 [debug] [MainThread]: Resource report: {"command_name": "list", "command_wall_clock_time": 0.55938977, "process_user_time": 1.255349, "process_kernel_time": 0.297599, "process_mem_max_rss": "114278400", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:15:39.008257 [debug] [MainThread]: Command `dbt list` failed at 17:15:39.008180 after 0.56 seconds
[0m17:15:39.008593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fbc5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104650770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10348ce60>]}
[0m17:15:39.008889 [debug] [MainThread]: Flushing usage events
[0m17:17:13.733220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049d6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103928ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105707f80>]}


============================== 17:17:13.737105 | 0d0ec275-da80-4a1e-b0b1-2df2c5fd802a ==============================
[0m17:17:13.737105 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:17:13.737616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select source:olist', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:17:13.904081 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:17:13.904505 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:17:14.030417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d0ec275-da80-4a1e-b0b1-2df2c5fd802a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d06f30>]}
[0m17:17:14.067833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d0ec275-da80-4a1e-b0b1-2df2c5fd802a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d06f30>]}
[0m17:17:14.068695 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m17:17:14.085017 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:17:14.229421 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:17:14.230551 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/_olist__sources.yml
[0m17:17:14.591101 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:17:14.591666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0d0ec275-da80-4a1e-b0b1-2df2c5fd802a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069532f0>]}
[0m17:17:14.654964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d0ec275-da80-4a1e-b0b1-2df2c5fd802a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106953a10>]}
[0m17:17:14.749616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d0ec275-da80-4a1e-b0b1-2df2c5fd802a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10701da30>]}
[0m17:17:14.750073 [info ] [MainThread]: Found 11 models, 11 data tests, 10 sources, 488 macros
[0m17:17:14.750370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d0ec275-da80-4a1e-b0b1-2df2c5fd802a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c3410>]}
[0m17:17:14.751821 [info ] [MainThread]: 
[0m17:17:14.752277 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:17:14.755457 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_marts'
[0m17:17:14.769514 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m17:17:14.769957 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m17:17:14.770201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:14.773287 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:17:14.773996 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:17:16.355228 [debug] [ThreadPool]: SQL status: SUCCESS in 1.585 seconds
[0m17:17:16.357274 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m17:17:16.358437 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m17:17:17.241607 [debug] [ThreadPool]: SQL status: SUCCESS in 0.882 seconds
[0m17:17:17.246965 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m17:17:18.063954 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m17:17:18.065440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_marts, now list_dev_public_staging)
[0m17:17:18.071037 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:17:18.071483 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m17:17:18.071783 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:18.072260 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:17:18.072607 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:17:19.184679 [debug] [ThreadPool]: SQL status: SUCCESS in 1.113 seconds
[0m17:17:19.186414 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:17:19.187255 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m17:17:19.473516 [debug] [ThreadPool]: SQL status: SUCCESS in 0.285 seconds
[0m17:17:19.475868 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m17:17:19.601980 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m17:17:19.616351 [debug] [MainThread]: Using redshift connection "master"
[0m17:17:19.616929 [debug] [MainThread]: On master: BEGIN
[0m17:17:19.617287 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:17:19.617792 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:17:19.618151 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:17:20.648878 [debug] [MainThread]: SQL status: SUCCESS in 1.031 seconds
[0m17:17:20.650288 [debug] [MainThread]: Using redshift connection "master"
[0m17:17:20.651181 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:17:21.309938 [debug] [MainThread]: SQL status: SUCCESS in 0.658 seconds
[0m17:17:21.314883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d0ec275-da80-4a1e-b0b1-2df2c5fd802a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de7c50>]}
[0m17:17:21.316040 [debug] [MainThread]: On master: ROLLBACK
[0m17:17:21.509420 [debug] [MainThread]: Using redshift connection "master"
[0m17:17:21.511199 [debug] [MainThread]: On master: BEGIN
[0m17:17:21.576657 [debug] [MainThread]: SQL status: SUCCESS in 0.064 seconds
[0m17:17:21.578282 [debug] [MainThread]: On master: COMMIT
[0m17:17:21.579708 [debug] [MainThread]: Using redshift connection "master"
[0m17:17:21.580754 [debug] [MainThread]: On master: COMMIT
[0m17:17:21.792436 [debug] [MainThread]: SQL status: SUCCESS in 0.210 seconds
[0m17:17:21.794424 [debug] [MainThread]: On master: Close
[0m17:17:21.796502 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:17:21.797578 [info ] [MainThread]: 
[0m17:17:21.802807 [debug] [Thread-1 (]: Began running node test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608
[0m17:17:21.803607 [info ] [Thread-1 (]: 1 of 4 START test source_not_null_olist_customer_customer_id ................... [RUN]
[0m17:17:21.804515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608)
[0m17:17:21.805120 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608
[0m17:17:21.823807 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608"
[0m17:17:21.825525 [debug] [Thread-1 (]: Began executing node test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608
[0m17:17:21.881088 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608"
[0m17:17:21.883599 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608"
[0m17:17:21.883919 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608: BEGIN
[0m17:17:21.884179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:21.884557 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:17:21.884835 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:17:23.542722 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.658 seconds
[0m17:17:23.544708 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608"
[0m17:17:23.545706 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dev"."public"."customer"
where customer_id is null



      
    ) dbt_internal_test
[0m17:17:24.251877 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.705 seconds
[0m17:17:24.262922 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608: ROLLBACK
[0m17:17:24.390040 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608: Close
[0m17:17:24.392985 [info ] [Thread-1 (]: 1 of 4 PASS source_not_null_olist_customer_customer_id ......................... [[32mPASS[0m in 2.59s]
[0m17:17:24.394724 [debug] [Thread-1 (]: Finished running node test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608
[0m17:17:24.395800 [debug] [Thread-1 (]: Began running node test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b
[0m17:17:24.396751 [info ] [Thread-1 (]: 2 of 4 START test source_not_null_olist_order_order_id ......................... [RUN]
[0m17:17:24.397604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608, now test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b)
[0m17:17:24.398229 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b
[0m17:17:24.406013 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b"
[0m17:17:24.407726 [debug] [Thread-1 (]: Began executing node test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b
[0m17:17:24.411029 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b"
[0m17:17:24.413977 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b"
[0m17:17:24.414559 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b: BEGIN
[0m17:17:24.415029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:24.415687 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:17:24.416093 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:17:25.211843 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.796 seconds
[0m17:17:25.213880 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b"
[0m17:17:25.215169 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "dev"."public"."order"
where order_id is null



      
    ) dbt_internal_test
[0m17:17:25.282377 [debug] [Thread-1 (]: Redshift adapter: Redshift error: relation "public.order" does not exist
[0m17:17:25.283969 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b: ROLLBACK
[0m17:17:25.503037 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b: Close
[0m17:17:25.516060 [debug] [Thread-1 (]: Database Error in test source_not_null_olist_order_order_id (models/staging/olist/_olist__sources.yml)
  relation "public.order" does not exist
  compiled Code at target/run/olist_dbt/models/staging/olist/_olist__sources.yml/source_not_null_olist_order_order_id.sql
[0m17:17:25.517136 [error] [Thread-1 (]: 2 of 4 ERROR source_not_null_olist_order_order_id .............................. [[31mERROR[0m in 1.12s]
[0m17:17:25.518041 [debug] [Thread-1 (]: Finished running node test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b
[0m17:17:25.518651 [debug] [Thread-1 (]: Began running node test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a
[0m17:17:25.520151 [info ] [Thread-1 (]: 3 of 4 START test source_unique_olist_customer_customer_id ..................... [RUN]
[0m17:17:25.520935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b, now test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a)
[0m17:17:25.521503 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a
[0m17:17:25.532235 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a"
[0m17:17:25.533959 [debug] [Thread-1 (]: Began executing node test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a
[0m17:17:25.536567 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a"
[0m17:17:25.539005 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a"
[0m17:17:25.539378 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a: BEGIN
[0m17:17:25.539698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:25.540190 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:17:25.540532 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:17:27.382402 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.842 seconds
[0m17:17:27.384403 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a"
[0m17:17:27.385442 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dev"."public"."customer"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:17:31.962239 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.576 seconds
[0m17:17:31.966810 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a: ROLLBACK
[0m17:17:32.095426 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a: Close
[0m17:17:32.096625 [info ] [Thread-1 (]: 3 of 4 PASS source_unique_olist_customer_customer_id ........................... [[32mPASS[0m in 6.58s]
[0m17:17:32.097377 [debug] [Thread-1 (]: Finished running node test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a
[0m17:17:32.097877 [debug] [Thread-1 (]: Began running node test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34
[0m17:17:32.098448 [info ] [Thread-1 (]: 4 of 4 START test source_unique_olist_order_order_id ........................... [RUN]
[0m17:17:32.099162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a, now test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34)
[0m17:17:32.099727 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34
[0m17:17:32.104830 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34"
[0m17:17:32.106528 [debug] [Thread-1 (]: Began executing node test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34
[0m17:17:32.108872 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34"
[0m17:17:32.111157 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34"
[0m17:17:32.111539 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34: BEGIN
[0m17:17:32.111867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:32.112350 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:17:32.112701 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:17:33.472680 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.360 seconds
[0m17:17:33.474031 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34"
[0m17:17:33.474661 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."public"."order"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:17:33.540754 [debug] [Thread-1 (]: Redshift adapter: Redshift error: relation "public.order" does not exist
[0m17:17:33.542629 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34: ROLLBACK
[0m17:17:33.834957 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34: Close
[0m17:17:33.839339 [debug] [Thread-1 (]: Database Error in test source_unique_olist_order_order_id (models/staging/olist/_olist__sources.yml)
  relation "public.order" does not exist
  compiled Code at target/run/olist_dbt/models/staging/olist/_olist__sources.yml/source_unique_olist_order_order_id.sql
[0m17:17:33.839981 [error] [Thread-1 (]: 4 of 4 ERROR source_unique_olist_order_order_id ................................ [[31mERROR[0m in 1.74s]
[0m17:17:33.840648 [debug] [Thread-1 (]: Finished running node test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34
[0m17:17:33.841975 [debug] [MainThread]: Using redshift connection "master"
[0m17:17:33.842305 [debug] [MainThread]: On master: BEGIN
[0m17:17:33.842584 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:17:33.843014 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:17:33.843324 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:17:34.891166 [debug] [MainThread]: SQL status: SUCCESS in 1.048 seconds
[0m17:17:34.891934 [debug] [MainThread]: On master: COMMIT
[0m17:17:34.892540 [debug] [MainThread]: Using redshift connection "master"
[0m17:17:34.892980 [debug] [MainThread]: On master: COMMIT
[0m17:17:35.021165 [debug] [MainThread]: SQL status: SUCCESS in 0.127 seconds
[0m17:17:35.022670 [debug] [MainThread]: On master: Close
[0m17:17:35.024067 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:35.024682 [debug] [MainThread]: Connection 'test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34' was properly closed.
[0m17:17:35.025306 [info ] [MainThread]: 
[0m17:17:35.026501 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 20.27 seconds (20.27s).
[0m17:17:35.028546 [debug] [MainThread]: Command end result
[0m17:17:35.075121 [info ] [MainThread]: 
[0m17:17:35.075526 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:17:35.075779 [info ] [MainThread]: 
[0m17:17:35.076082 [error] [MainThread]:   Database Error in test source_not_null_olist_order_order_id (models/staging/olist/_olist__sources.yml)
  relation "public.order" does not exist
  compiled Code at target/run/olist_dbt/models/staging/olist/_olist__sources.yml/source_not_null_olist_order_order_id.sql
[0m17:17:35.076322 [info ] [MainThread]: 
[0m17:17:35.076584 [error] [MainThread]:   Database Error in test source_unique_olist_order_order_id (models/staging/olist/_olist__sources.yml)
  relation "public.order" does not exist
  compiled Code at target/run/olist_dbt/models/staging/olist/_olist__sources.yml/source_unique_olist_order_order_id.sql
[0m17:17:35.076807 [info ] [MainThread]: 
[0m17:17:35.077032 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m17:17:35.078881 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 21.395073, "process_user_time": 2.49717, "process_kernel_time": 0.402219, "process_mem_max_rss": "131547136", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:17:35.079280 [debug] [MainThread]: Command `dbt test` failed at 17:17:35.079213 after 21.40 seconds
[0m17:17:35.079571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d2ecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f207d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d3c890>]}
[0m17:17:35.079847 [debug] [MainThread]: Flushing usage events
[0m17:17:41.240138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104173170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a90bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a90b30>]}


============================== 17:17:41.244069 | 685ad807-6337-49c7-8d41-21f37af07e71 ==============================
[0m17:17:41.244069 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:17:41.244572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/eranola/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select source:olist', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:17:41.409384 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:17:41.409808 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:17:41.535235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '685ad807-6337-49c7-8d41-21f37af07e71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10349da00>]}
[0m17:17:41.572802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '685ad807-6337-49c7-8d41-21f37af07e71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dd3470>]}
[0m17:17:41.573675 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m17:17:41.590362 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:17:41.732398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:17:41.733583 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/_olist__sources.yml
[0m17:17:42.157134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '685ad807-6337-49c7-8d41-21f37af07e71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ab110>]}
[0m17:17:42.248818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '685ad807-6337-49c7-8d41-21f37af07e71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fd5280>]}
[0m17:17:42.249274 [info ] [MainThread]: Found 11 models, 11 data tests, 10 sources, 488 macros
[0m17:17:42.249572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '685ad807-6337-49c7-8d41-21f37af07e71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e232f0>]}
[0m17:17:42.251121 [info ] [MainThread]: 
[0m17:17:42.251567 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:17:42.254762 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_marts'
[0m17:17:42.268430 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m17:17:42.268867 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m17:17:42.269115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:42.272212 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:17:42.272940 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:17:43.770758 [debug] [ThreadPool]: SQL status: SUCCESS in 1.501 seconds
[0m17:17:43.772858 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m17:17:43.774072 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m17:17:43.929469 [debug] [ThreadPool]: SQL status: SUCCESS in 0.154 seconds
[0m17:17:43.935498 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m17:17:44.067688 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m17:17:44.070591 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_marts, now list_dev_public_staging)
[0m17:17:44.081020 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:17:44.081632 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m17:17:44.082067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:44.082775 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:17:44.083222 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:17:45.281354 [debug] [ThreadPool]: SQL status: SUCCESS in 1.199 seconds
[0m17:17:45.283189 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:17:45.284338 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m17:17:45.520500 [debug] [ThreadPool]: SQL status: SUCCESS in 0.235 seconds
[0m17:17:45.525397 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m17:17:45.715783 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m17:17:45.736557 [debug] [MainThread]: Using redshift connection "master"
[0m17:17:45.737219 [debug] [MainThread]: On master: BEGIN
[0m17:17:45.737648 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:17:45.738238 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:17:45.738616 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:17:46.450481 [debug] [MainThread]: SQL status: SUCCESS in 0.713 seconds
[0m17:17:46.452147 [debug] [MainThread]: Using redshift connection "master"
[0m17:17:46.453313 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:17:47.033911 [debug] [MainThread]: SQL status: SUCCESS in 0.579 seconds
[0m17:17:47.038958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '685ad807-6337-49c7-8d41-21f37af07e71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f739b0>]}
[0m17:17:47.040511 [debug] [MainThread]: On master: ROLLBACK
[0m17:17:47.168330 [debug] [MainThread]: Using redshift connection "master"
[0m17:17:47.170106 [debug] [MainThread]: On master: BEGIN
[0m17:17:47.233655 [debug] [MainThread]: SQL status: SUCCESS in 0.062 seconds
[0m17:17:47.234939 [debug] [MainThread]: On master: COMMIT
[0m17:17:47.236128 [debug] [MainThread]: Using redshift connection "master"
[0m17:17:47.237037 [debug] [MainThread]: On master: COMMIT
[0m17:17:47.792534 [debug] [MainThread]: SQL status: SUCCESS in 0.554 seconds
[0m17:17:47.794360 [debug] [MainThread]: On master: Close
[0m17:17:47.796376 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:17:47.797087 [info ] [MainThread]: 
[0m17:17:47.801897 [debug] [Thread-1 (]: Began running node test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608
[0m17:17:47.803011 [info ] [Thread-1 (]: 1 of 4 START test source_not_null_olist_customer_customer_id ................... [RUN]
[0m17:17:47.804294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608)
[0m17:17:47.804924 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608
[0m17:17:47.818495 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608"
[0m17:17:47.820156 [debug] [Thread-1 (]: Began executing node test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608
[0m17:17:47.840270 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608"
[0m17:17:47.842624 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608"
[0m17:17:47.842994 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608: BEGIN
[0m17:17:47.843292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:47.843707 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:17:47.844010 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:17:48.958082 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.114 seconds
[0m17:17:48.960341 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608"
[0m17:17:48.961669 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dev"."public"."customer"
where customer_id is null



      
    ) dbt_internal_test
[0m17:17:49.181994 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.219 seconds
[0m17:17:49.195228 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608: ROLLBACK
[0m17:17:49.340042 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608: Close
[0m17:17:49.343011 [info ] [Thread-1 (]: 1 of 4 PASS source_not_null_olist_customer_customer_id ......................... [[32mPASS[0m in 1.54s]
[0m17:17:49.344724 [debug] [Thread-1 (]: Finished running node test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608
[0m17:17:49.345767 [debug] [Thread-1 (]: Began running node test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b
[0m17:17:49.346693 [info ] [Thread-1 (]: 2 of 4 START test source_not_null_olist_order_order_id ......................... [RUN]
[0m17:17:49.347483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608, now test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b)
[0m17:17:49.348424 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b
[0m17:17:49.406728 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b"
[0m17:17:49.407942 [debug] [Thread-1 (]: Began executing node test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b
[0m17:17:49.409657 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b"
[0m17:17:49.411219 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b"
[0m17:17:49.411514 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b: BEGIN
[0m17:17:49.411768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:49.412124 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:17:49.412387 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:17:50.531523 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.119 seconds
[0m17:17:50.533731 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b"
[0m17:17:50.535029 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "dev"."public"."order"
where order_id is null



      
    ) dbt_internal_test
[0m17:17:50.602156 [debug] [Thread-1 (]: Redshift adapter: Redshift error: relation "public.order" does not exist
[0m17:17:50.603794 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b: ROLLBACK
[0m17:17:50.733065 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b: Close
[0m17:17:50.744916 [debug] [Thread-1 (]: Database Error in test source_not_null_olist_order_order_id (models/staging/olist/_olist__sources.yml)
  relation "public.order" does not exist
  compiled Code at target/run/olist_dbt/models/staging/olist/_olist__sources.yml/source_not_null_olist_order_order_id.sql
[0m17:17:50.746290 [error] [Thread-1 (]: 2 of 4 ERROR source_not_null_olist_order_order_id .............................. [[31mERROR[0m in 1.40s]
[0m17:17:50.747427 [debug] [Thread-1 (]: Finished running node test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b
[0m17:17:50.748067 [debug] [Thread-1 (]: Began running node test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a
[0m17:17:50.749713 [info ] [Thread-1 (]: 3 of 4 START test source_unique_olist_customer_customer_id ..................... [RUN]
[0m17:17:50.750515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b, now test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a)
[0m17:17:50.751099 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a
[0m17:17:50.762809 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a"
[0m17:17:50.764562 [debug] [Thread-1 (]: Began executing node test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a
[0m17:17:50.767574 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a"
[0m17:17:50.770416 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a"
[0m17:17:50.770880 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a: BEGIN
[0m17:17:50.771225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:50.771746 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:17:50.772116 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:17:51.900112 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.128 seconds
[0m17:17:51.902237 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a"
[0m17:17:51.903519 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dev"."public"."customer"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:17:52.183186 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.278 seconds
[0m17:17:52.189950 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a: ROLLBACK
[0m17:17:52.317799 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a: Close
[0m17:17:52.320617 [info ] [Thread-1 (]: 3 of 4 PASS source_unique_olist_customer_customer_id ........................... [[32mPASS[0m in 1.57s]
[0m17:17:52.322230 [debug] [Thread-1 (]: Finished running node test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a
[0m17:17:52.323164 [debug] [Thread-1 (]: Began running node test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34
[0m17:17:52.323987 [info ] [Thread-1 (]: 4 of 4 START test source_unique_olist_order_order_id ........................... [RUN]
[0m17:17:52.324714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a, now test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34)
[0m17:17:52.325340 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34
[0m17:17:52.332662 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34"
[0m17:17:52.334774 [debug] [Thread-1 (]: Began executing node test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34
[0m17:17:52.338267 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34"
[0m17:17:52.340967 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34"
[0m17:17:52.341422 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34: BEGIN
[0m17:17:52.341807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:52.342542 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:17:52.342959 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:17:53.671986 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.330 seconds
[0m17:17:53.673585 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34"
[0m17:17:53.674716 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."public"."order"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:17:53.741590 [debug] [Thread-1 (]: Redshift adapter: Redshift error: relation "public.order" does not exist
[0m17:17:53.742972 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34: ROLLBACK
[0m17:17:54.081065 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34: Close
[0m17:17:54.087785 [debug] [Thread-1 (]: Database Error in test source_unique_olist_order_order_id (models/staging/olist/_olist__sources.yml)
  relation "public.order" does not exist
  compiled Code at target/run/olist_dbt/models/staging/olist/_olist__sources.yml/source_unique_olist_order_order_id.sql
[0m17:17:54.090778 [error] [Thread-1 (]: 4 of 4 ERROR source_unique_olist_order_order_id ................................ [[31mERROR[0m in 1.76s]
[0m17:17:54.096161 [debug] [Thread-1 (]: Finished running node test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34
[0m17:17:54.100855 [debug] [MainThread]: Using redshift connection "master"
[0m17:17:54.102034 [debug] [MainThread]: On master: BEGIN
[0m17:17:54.104482 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:17:54.105065 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:17:54.105395 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:17:54.959099 [debug] [MainThread]: SQL status: SUCCESS in 0.854 seconds
[0m17:17:54.961133 [debug] [MainThread]: On master: COMMIT
[0m17:17:54.962533 [debug] [MainThread]: Using redshift connection "master"
[0m17:17:54.963541 [debug] [MainThread]: On master: COMMIT
[0m17:17:55.092094 [debug] [MainThread]: SQL status: SUCCESS in 0.127 seconds
[0m17:17:55.093895 [debug] [MainThread]: On master: Close
[0m17:17:55.095736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:55.096636 [debug] [MainThread]: Connection 'test.olist_dbt.source_unique_olist_order_order_id.0a1bdd8d34' was properly closed.
[0m17:17:55.097781 [info ] [MainThread]: 
[0m17:17:55.098794 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 12.85 seconds (12.85s).
[0m17:17:55.101962 [debug] [MainThread]: Command end result
[0m17:17:55.147891 [info ] [MainThread]: 
[0m17:17:55.148421 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:17:55.148760 [info ] [MainThread]: 
[0m17:17:55.149448 [error] [MainThread]:   Database Error in test source_not_null_olist_order_order_id (models/staging/olist/_olist__sources.yml)
  relation "public.order" does not exist
  compiled Code at target/run/olist_dbt/models/staging/olist/_olist__sources.yml/source_not_null_olist_order_order_id.sql
[0m17:17:55.150031 [info ] [MainThread]: 
[0m17:17:55.150383 [error] [MainThread]:   Database Error in test source_unique_olist_order_order_id (models/staging/olist/_olist__sources.yml)
  relation "public.order" does not exist
  compiled Code at target/run/olist_dbt/models/staging/olist/_olist__sources.yml/source_unique_olist_order_order_id.sql
[0m17:17:55.150706 [info ] [MainThread]: 
[0m17:17:55.151050 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m17:17:55.152758 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 13.963742, "process_user_time": 2.562241, "process_kernel_time": 0.395873, "process_mem_max_rss": "131448832", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:17:55.153184 [debug] [MainThread]: Command `dbt test` failed at 17:17:55.153115 after 13.96 seconds
[0m17:17:55.153499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10458a7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104641940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cd1730>]}
[0m17:17:55.153786 [debug] [MainThread]: Flushing usage events
[0m17:20:12.119216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106374530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10634f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a7e60>]}


============================== 17:20:12.123853 | bb86fb5b-0ac3-4443-b0a7-b4400fbd0f0d ==============================
[0m17:20:12.123853 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:20:12.124377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt list --resource-type test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:20:12.294744 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:20:12.295165 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:20:12.419630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb86fb5b-0ac3-4443-b0a7-b4400fbd0f0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c69bb0>]}
[0m17:20:12.457244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb86fb5b-0ac3-4443-b0a7-b4400fbd0f0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063cf200>]}
[0m17:20:12.458253 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m17:20:12.475157 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:20:12.617982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:20:12.618378 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:20:12.654640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb86fb5b-0ac3-4443-b0a7-b4400fbd0f0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a41d90>]}
[0m17:20:12.751096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb86fb5b-0ac3-4443-b0a7-b4400fbd0f0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ee7b0>]}
[0m17:20:12.753742 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.6862911, "process_user_time": 1.335799, "process_kernel_time": 0.259327, "process_mem_max_rss": "116195328", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:20:12.754262 [debug] [MainThread]: Command `dbt list` succeeded at 17:20:12.754177 after 0.69 seconds
[0m17:20:12.754589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f65700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064c2ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058d32f0>]}
[0m17:20:12.754865 [debug] [MainThread]: Flushing usage events
[0m17:20:37.137819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108637080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107740a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107742570>]}


============================== 17:20:37.141935 | 9123852c-f83f-4f43-8753-b02b15608970 ==============================
[0m17:20:37.141935 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:20:37.142438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --select olist_dbt.staging.olist.source_not_null_olist_order_order_id', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:20:37.307061 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:20:37.307482 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:20:37.432247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9123852c-f83f-4f43-8753-b02b15608970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f835f0>]}
[0m17:20:37.469458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9123852c-f83f-4f43-8753-b02b15608970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082558b0>]}
[0m17:20:37.470324 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m17:20:37.487286 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:20:37.632846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:20:37.633254 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:20:37.669732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9123852c-f83f-4f43-8753-b02b15608970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f83b90>]}
[0m17:20:37.761699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9123852c-f83f-4f43-8753-b02b15608970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093af890>]}
[0m17:20:37.762144 [info ] [MainThread]: Found 11 models, 11 data tests, 10 sources, 488 macros
[0m17:20:37.762439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9123852c-f83f-4f43-8753-b02b15608970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108859790>]}
[0m17:20:37.763799 [info ] [MainThread]: 
[0m17:20:37.764257 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:20:37.767433 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_staging'
[0m17:20:37.782015 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:20:37.782426 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m17:20:37.782674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:37.785961 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:20:37.786721 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:20:39.271119 [debug] [ThreadPool]: SQL status: SUCCESS in 1.488 seconds
[0m17:20:39.273183 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:20:39.274295 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m17:20:39.426663 [debug] [ThreadPool]: SQL status: SUCCESS in 0.151 seconds
[0m17:20:39.432529 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m17:20:39.559261 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m17:20:39.561957 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_staging, now list_dev_public_marts)
[0m17:20:39.573993 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m17:20:39.574593 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m17:20:39.575041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:20:39.575686 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:20:39.576136 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:20:40.533757 [debug] [ThreadPool]: SQL status: SUCCESS in 0.958 seconds
[0m17:20:40.535651 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m17:20:40.536895 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m17:20:41.228327 [debug] [ThreadPool]: SQL status: SUCCESS in 0.690 seconds
[0m17:20:41.234347 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m17:20:41.424080 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m17:20:41.440719 [debug] [MainThread]: Using redshift connection "master"
[0m17:20:41.441372 [debug] [MainThread]: On master: BEGIN
[0m17:20:41.441952 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:20:41.442500 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:20:41.442863 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:20:42.158302 [debug] [MainThread]: SQL status: SUCCESS in 0.716 seconds
[0m17:20:42.160017 [debug] [MainThread]: Using redshift connection "master"
[0m17:20:42.161268 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:20:42.760076 [debug] [MainThread]: SQL status: SUCCESS in 0.597 seconds
[0m17:20:42.765410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9123852c-f83f-4f43-8753-b02b15608970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093d8560>]}
[0m17:20:42.766902 [debug] [MainThread]: On master: ROLLBACK
[0m17:20:43.376654 [debug] [MainThread]: Using redshift connection "master"
[0m17:20:43.378402 [debug] [MainThread]: On master: BEGIN
[0m17:20:43.443399 [debug] [MainThread]: SQL status: SUCCESS in 0.064 seconds
[0m17:20:43.444626 [debug] [MainThread]: On master: COMMIT
[0m17:20:43.445767 [debug] [MainThread]: Using redshift connection "master"
[0m17:20:43.446664 [debug] [MainThread]: On master: COMMIT
[0m17:20:43.724110 [debug] [MainThread]: SQL status: SUCCESS in 0.276 seconds
[0m17:20:43.725988 [debug] [MainThread]: On master: Close
[0m17:20:43.727792 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:20:43.728465 [info ] [MainThread]: 
[0m17:20:43.733384 [debug] [Thread-1 (]: Began running node test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b
[0m17:20:43.734647 [info ] [Thread-1 (]: 1 of 1 START test source_not_null_olist_order_order_id ......................... [RUN]
[0m17:20:43.735578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_marts, now test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b)
[0m17:20:43.736148 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b
[0m17:20:43.753894 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b"
[0m17:20:43.755574 [debug] [Thread-1 (]: Began executing node test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b
[0m17:20:43.770797 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b"
[0m17:20:43.772994 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b"
[0m17:20:43.773332 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b: BEGIN
[0m17:20:43.773620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:43.774023 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:20:43.774332 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:20:44.649979 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.876 seconds
[0m17:20:44.652097 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b"
[0m17:20:44.653389 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "dev"."public"."order"
where order_id is null



      
    ) dbt_internal_test
[0m17:20:44.719435 [debug] [Thread-1 (]: Redshift adapter: Redshift error: relation "public.order" does not exist
[0m17:20:44.720713 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b: ROLLBACK
[0m17:20:44.998890 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b: Close
[0m17:20:45.010719 [debug] [Thread-1 (]: Database Error in test source_not_null_olist_order_order_id (models/staging/olist/_olist__sources.yml)
  relation "public.order" does not exist
  compiled Code at target/run/olist_dbt/models/staging/olist/_olist__sources.yml/source_not_null_olist_order_order_id.sql
[0m17:20:45.011898 [error] [Thread-1 (]: 1 of 1 ERROR source_not_null_olist_order_order_id .............................. [[31mERROR[0m in 1.28s]
[0m17:20:45.013002 [debug] [Thread-1 (]: Finished running node test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b
[0m17:20:45.015611 [debug] [MainThread]: Using redshift connection "master"
[0m17:20:45.016092 [debug] [MainThread]: On master: BEGIN
[0m17:20:45.016496 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:20:45.017091 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:20:45.017544 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:20:46.072812 [debug] [MainThread]: SQL status: SUCCESS in 1.056 seconds
[0m17:20:46.074802 [debug] [MainThread]: On master: COMMIT
[0m17:20:46.076172 [debug] [MainThread]: Using redshift connection "master"
[0m17:20:46.077166 [debug] [MainThread]: On master: COMMIT
[0m17:20:46.627850 [debug] [MainThread]: SQL status: SUCCESS in 0.549 seconds
[0m17:20:46.629772 [debug] [MainThread]: On master: Close
[0m17:20:46.631677 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:46.632420 [debug] [MainThread]: Connection 'test.olist_dbt.source_not_null_olist_order_order_id.a57640cd8b' was properly closed.
[0m17:20:46.633245 [info ] [MainThread]: 
[0m17:20:46.634056 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 8.87 seconds (8.87s).
[0m17:20:46.635359 [debug] [MainThread]: Command end result
[0m17:20:46.682899 [info ] [MainThread]: 
[0m17:20:46.683403 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:20:46.683686 [info ] [MainThread]: 
[0m17:20:46.684026 [error] [MainThread]:   Database Error in test source_not_null_olist_order_order_id (models/staging/olist/_olist__sources.yml)
  relation "public.order" does not exist
  compiled Code at target/run/olist_dbt/models/staging/olist/_olist__sources.yml/source_not_null_olist_order_order_id.sql
[0m17:20:46.684292 [info ] [MainThread]: 
[0m17:20:46.684558 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:20:46.686636 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 9.599856, "process_user_time": 1.860211, "process_kernel_time": 0.359739, "process_mem_max_rss": "123125760", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:20:46.687153 [debug] [MainThread]: Command `dbt test` failed at 17:20:46.687079 after 9.60 seconds
[0m17:20:46.687504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108637080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10888ff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10888fda0>]}
[0m17:20:46.687832 [debug] [MainThread]: Flushing usage events
[0m17:21:51.682818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085f8ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074dcad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074dcb00>]}


============================== 17:21:51.686779 | 122ceccc-8048-42a4-a08e-81fd16a5aa37 ==============================
[0m17:21:51.686779 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:21:51.687279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select source:olist', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:21:51.851830 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:21:51.852256 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:21:51.977665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '122ceccc-8048-42a4-a08e-81fd16a5aa37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10885c710>]}
[0m17:21:52.014753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '122ceccc-8048-42a4-a08e-81fd16a5aa37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b73110>]}
[0m17:21:52.015592 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m17:21:52.031964 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:21:52.177096 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:21:52.178256 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/_olist__sources.yml
[0m17:21:52.602497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '122ceccc-8048-42a4-a08e-81fd16a5aa37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109afc770>]}
[0m17:21:52.693429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '122ceccc-8048-42a4-a08e-81fd16a5aa37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109840e60>]}
[0m17:21:52.693883 [info ] [MainThread]: Found 11 models, 11 data tests, 10 sources, 488 macros
[0m17:21:52.694181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '122ceccc-8048-42a4-a08e-81fd16a5aa37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096f3da0>]}
[0m17:21:52.695687 [info ] [MainThread]: 
[0m17:21:52.696149 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:21:52.699378 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_marts'
[0m17:21:52.712895 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m17:21:52.713298 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m17:21:52.713557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:52.716660 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:21:52.717407 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:21:53.618668 [debug] [ThreadPool]: SQL status: SUCCESS in 0.905 seconds
[0m17:21:53.620723 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m17:21:53.621867 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m17:21:53.773662 [debug] [ThreadPool]: SQL status: SUCCESS in 0.151 seconds
[0m17:21:53.777676 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m17:21:53.992099 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m17:21:53.994916 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_marts, now list_dev_public_staging)
[0m17:21:54.004429 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:21:54.005158 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m17:21:54.005598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:21:54.006253 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:21:54.006714 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:21:54.882547 [debug] [ThreadPool]: SQL status: SUCCESS in 0.877 seconds
[0m17:21:54.884126 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:21:54.884915 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m17:21:55.035811 [debug] [ThreadPool]: SQL status: SUCCESS in 0.150 seconds
[0m17:21:55.041002 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m17:21:55.170247 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m17:21:55.189813 [debug] [MainThread]: Using redshift connection "master"
[0m17:21:55.190452 [debug] [MainThread]: On master: BEGIN
[0m17:21:55.190874 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:21:55.191473 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:21:55.191868 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:21:56.075586 [debug] [MainThread]: SQL status: SUCCESS in 0.884 seconds
[0m17:21:56.077612 [debug] [MainThread]: Using redshift connection "master"
[0m17:21:56.078806 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:21:56.772546 [debug] [MainThread]: SQL status: SUCCESS in 0.692 seconds
[0m17:21:56.777392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '122ceccc-8048-42a4-a08e-81fd16a5aa37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c29d90>]}
[0m17:21:56.778402 [debug] [MainThread]: On master: ROLLBACK
[0m17:21:57.055320 [debug] [MainThread]: Using redshift connection "master"
[0m17:21:57.056928 [debug] [MainThread]: On master: BEGIN
[0m17:21:57.184957 [debug] [MainThread]: SQL status: SUCCESS in 0.127 seconds
[0m17:21:57.186201 [debug] [MainThread]: On master: COMMIT
[0m17:21:57.187311 [debug] [MainThread]: Using redshift connection "master"
[0m17:21:57.188201 [debug] [MainThread]: On master: COMMIT
[0m17:21:57.378820 [debug] [MainThread]: SQL status: SUCCESS in 0.190 seconds
[0m17:21:57.380068 [debug] [MainThread]: On master: Close
[0m17:21:57.382047 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:21:57.383312 [info ] [MainThread]: 
[0m17:21:57.388870 [debug] [Thread-1 (]: Began running node test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608
[0m17:21:57.389751 [info ] [Thread-1 (]: 1 of 4 START test source_not_null_olist_customer_customer_id ................... [RUN]
[0m17:21:57.390537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608)
[0m17:21:57.391401 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608
[0m17:21:57.404900 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608"
[0m17:21:57.406565 [debug] [Thread-1 (]: Began executing node test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608
[0m17:21:57.427666 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608"
[0m17:21:57.429718 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608"
[0m17:21:57.430076 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608: BEGIN
[0m17:21:57.430371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:57.430778 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:21:57.431082 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:21:58.219770 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.789 seconds
[0m17:21:58.221873 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608"
[0m17:21:58.223219 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dev"."public"."customer"
where customer_id is null



      
    ) dbt_internal_test
[0m17:21:58.522147 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.297 seconds
[0m17:21:58.537010 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608: ROLLBACK
[0m17:21:58.974818 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608: Close
[0m17:21:58.977799 [info ] [Thread-1 (]: 1 of 4 PASS source_not_null_olist_customer_customer_id ......................... [[32mPASS[0m in 1.59s]
[0m17:21:58.979340 [debug] [Thread-1 (]: Finished running node test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608
[0m17:21:58.980258 [debug] [Thread-1 (]: Began running node test.olist_dbt.source_not_null_olist_orders_order_id.441189e023
[0m17:21:58.981220 [info ] [Thread-1 (]: 2 of 4 START test source_not_null_olist_orders_order_id ........................ [RUN]
[0m17:21:58.982550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608, now test.olist_dbt.source_not_null_olist_orders_order_id.441189e023)
[0m17:21:58.983333 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.source_not_null_olist_orders_order_id.441189e023
[0m17:21:59.040622 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.source_not_null_olist_orders_order_id.441189e023"
[0m17:21:59.041945 [debug] [Thread-1 (]: Began executing node test.olist_dbt.source_not_null_olist_orders_order_id.441189e023
[0m17:21:59.043614 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.source_not_null_olist_orders_order_id.441189e023"
[0m17:21:59.045231 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_not_null_olist_orders_order_id.441189e023"
[0m17:21:59.045527 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_orders_order_id.441189e023: BEGIN
[0m17:21:59.045783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:59.046139 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:21:59.046406 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:22:00.467071 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.421 seconds
[0m17:22:00.468788 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_not_null_olist_orders_order_id.441189e023"
[0m17:22:00.470045 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_orders_order_id.441189e023: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.source_not_null_olist_orders_order_id.441189e023"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "dev"."public"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m17:22:00.693413 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.222 seconds
[0m17:22:00.698239 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_orders_order_id.441189e023: ROLLBACK
[0m17:22:00.915578 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_orders_order_id.441189e023: Close
[0m17:22:00.916617 [info ] [Thread-1 (]: 2 of 4 PASS source_not_null_olist_orders_order_id .............................. [[32mPASS[0m in 1.93s]
[0m17:22:00.917258 [debug] [Thread-1 (]: Finished running node test.olist_dbt.source_not_null_olist_orders_order_id.441189e023
[0m17:22:00.917700 [debug] [Thread-1 (]: Began running node test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a
[0m17:22:00.918198 [info ] [Thread-1 (]: 3 of 4 START test source_unique_olist_customer_customer_id ..................... [RUN]
[0m17:22:00.918780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.source_not_null_olist_orders_order_id.441189e023, now test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a)
[0m17:22:00.919235 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a
[0m17:22:00.925896 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a"
[0m17:22:00.926949 [debug] [Thread-1 (]: Began executing node test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a
[0m17:22:00.928935 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a"
[0m17:22:00.930910 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a"
[0m17:22:00.931258 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a: BEGIN
[0m17:22:00.931539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:00.931953 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:22:00.932256 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:22:02.176131 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.244 seconds
[0m17:22:02.178213 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a"
[0m17:22:02.179514 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dev"."public"."customer"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:22:02.458396 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.277 seconds
[0m17:22:02.464792 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a: ROLLBACK
[0m17:22:02.594247 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a: Close
[0m17:22:02.597068 [info ] [Thread-1 (]: 3 of 4 PASS source_unique_olist_customer_customer_id ........................... [[32mPASS[0m in 1.68s]
[0m17:22:02.598668 [debug] [Thread-1 (]: Finished running node test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a
[0m17:22:02.599729 [debug] [Thread-1 (]: Began running node test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82
[0m17:22:02.600552 [info ] [Thread-1 (]: 4 of 4 START test source_unique_olist_orders_order_id .......................... [RUN]
[0m17:22:02.601328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a, now test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82)
[0m17:22:02.601984 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82
[0m17:22:02.609480 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82"
[0m17:22:02.611706 [debug] [Thread-1 (]: Began executing node test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82
[0m17:22:02.615264 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82"
[0m17:22:02.618167 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82"
[0m17:22:02.618621 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82: BEGIN
[0m17:22:02.619008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:02.619592 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:22:02.620004 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:22:03.320246 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.701 seconds
[0m17:22:03.322421 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82"
[0m17:22:03.323732 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."public"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:22:03.515206 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.190 seconds
[0m17:22:03.521931 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82: ROLLBACK
[0m17:22:03.652382 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82: Close
[0m17:22:03.655707 [info ] [Thread-1 (]: 4 of 4 PASS source_unique_olist_orders_order_id ................................ [[32mPASS[0m in 1.05s]
[0m17:22:03.657339 [debug] [Thread-1 (]: Finished running node test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82
[0m17:22:03.660236 [debug] [MainThread]: Using redshift connection "master"
[0m17:22:03.661303 [debug] [MainThread]: On master: BEGIN
[0m17:22:03.661884 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:22:03.662702 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:22:03.663281 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:22:04.695251 [debug] [MainThread]: SQL status: SUCCESS in 1.033 seconds
[0m17:22:04.697473 [debug] [MainThread]: On master: COMMIT
[0m17:22:04.698902 [debug] [MainThread]: Using redshift connection "master"
[0m17:22:04.699873 [debug] [MainThread]: On master: COMMIT
[0m17:22:04.829086 [debug] [MainThread]: SQL status: SUCCESS in 0.128 seconds
[0m17:22:04.830956 [debug] [MainThread]: On master: Close
[0m17:22:04.832443 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:22:04.832968 [debug] [MainThread]: Connection 'test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82' was properly closed.
[0m17:22:04.833693 [info ] [MainThread]: 
[0m17:22:04.834347 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 12.14 seconds (12.14s).
[0m17:22:04.836778 [debug] [MainThread]: Command end result
[0m17:22:04.884860 [info ] [MainThread]: 
[0m17:22:04.885330 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:22:04.885590 [info ] [MainThread]: 
[0m17:22:04.885846 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:22:04.887989 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 13.259678, "process_user_time": 2.547827, "process_kernel_time": 0.386081, "process_mem_max_rss": "132431872", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:22:04.888412 [debug] [MainThread]: Command `dbt test` succeeded at 17:22:04.888347 after 13.26 seconds
[0m17:22:04.888699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10818fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10820ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10820d760>]}
[0m17:22:04.888967 [debug] [MainThread]: Flushing usage events
[0m17:46:18.783916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fb3f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10492ca70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10492ca40>]}


============================== 17:46:18.788316 | afec0517-a748-4aec-87a1-068e6f083dbb ==============================
[0m17:46:18.788316 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:46:18.788816 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:46:18.979967 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:46:18.980414 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:46:19.125755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afec0517-a748-4aec-87a1-068e6f083dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fd6150>]}
[0m17:46:19.173161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afec0517-a748-4aec-87a1-068e6f083dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042993a0>]}
[0m17:46:19.174617 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m17:46:19.192233 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:46:19.341726 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:46:19.342138 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:46:19.380704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afec0517-a748-4aec-87a1-068e6f083dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a78110>]}
[0m17:46:19.490762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afec0517-a748-4aec-87a1-068e6f083dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072d2bd0>]}
[0m17:46:19.491352 [info ] [MainThread]: Found 11 models, 11 data tests, 10 sources, 488 macros
[0m17:46:19.496026 [info ] [MainThread]: 
[0m17:46:19.497105 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:46:19.501520 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m17:46:19.518256 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m17:46:19.518706 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m17:46:19.518956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:19.522229 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:46:19.522977 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:46:21.216285 [debug] [ThreadPool]: SQL status: SUCCESS in 1.697 seconds
[0m17:46:21.218639 [debug] [ThreadPool]: On list_dev: Close
[0m17:46:21.222760 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m17:46:21.223280 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m17:46:21.223683 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:21.224188 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:46:21.224536 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:46:23.092244 [debug] [ThreadPool]: SQL status: SUCCESS in 1.868 seconds
[0m17:46:23.093979 [debug] [ThreadPool]: On list_dev: Close
[0m17:46:23.095920 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public_marts)
[0m17:46:23.103212 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m17:46:23.103645 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m17:46:23.103946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:23.104411 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:46:23.104723 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:46:25.566265 [debug] [ThreadPool]: SQL status: SUCCESS in 2.462 seconds
[0m17:46:25.567214 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m17:46:25.567725 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m17:46:25.716621 [debug] [ThreadPool]: SQL status: SUCCESS in 0.148 seconds
[0m17:46:25.719426 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m17:46:26.552892 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m17:46:26.555033 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_marts, now list_dev_public_staging)
[0m17:46:26.562195 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:46:26.562930 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m17:46:26.563332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:26.563899 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:46:26.564280 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:46:28.302107 [debug] [ThreadPool]: SQL status: SUCCESS in 1.738 seconds
[0m17:46:28.303788 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:46:28.304921 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m17:46:29.464728 [debug] [ThreadPool]: SQL status: SUCCESS in 1.159 seconds
[0m17:46:29.467168 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m17:46:29.807629 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m17:46:29.825905 [debug] [MainThread]: Using redshift connection "master"
[0m17:46:29.826692 [debug] [MainThread]: On master: BEGIN
[0m17:46:29.827131 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:46:29.827691 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:46:29.828052 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:46:31.547319 [debug] [MainThread]: SQL status: SUCCESS in 1.720 seconds
[0m17:46:31.548310 [debug] [MainThread]: Using redshift connection "master"
[0m17:46:31.548856 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:46:31.825072 [debug] [MainThread]: SQL status: SUCCESS in 0.275 seconds
[0m17:46:31.829105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afec0517-a748-4aec-87a1-068e6f083dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a7be60>]}
[0m17:46:31.829995 [debug] [MainThread]: On master: ROLLBACK
[0m17:46:32.043405 [debug] [MainThread]: Using redshift connection "master"
[0m17:46:32.044317 [debug] [MainThread]: On master: BEGIN
[0m17:46:32.193511 [debug] [MainThread]: SQL status: SUCCESS in 0.148 seconds
[0m17:46:32.194638 [debug] [MainThread]: On master: COMMIT
[0m17:46:32.195600 [debug] [MainThread]: Using redshift connection "master"
[0m17:46:32.196243 [debug] [MainThread]: On master: COMMIT
[0m17:46:32.824591 [debug] [MainThread]: SQL status: SUCCESS in 0.627 seconds
[0m17:46:32.826059 [debug] [MainThread]: On master: Close
[0m17:46:32.828141 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:46:32.828870 [info ] [MainThread]: 
[0m17:46:32.833331 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_geolocation
[0m17:46:32.834447 [info ] [Thread-1 (]: 1 of 22 START sql table model public_staging.stg_geolocation ................... [RUN]
[0m17:46:32.835562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now model.olist_dbt.stg_geolocation)
[0m17:46:32.836332 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_geolocation
[0m17:46:32.840984 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_geolocation"
[0m17:46:32.842862 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_geolocation
[0m17:46:32.892447 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_geolocation"
[0m17:46:32.894483 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:46:32.894838 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: BEGIN
[0m17:46:32.895111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:32.895488 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:46:32.895768 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:46:34.682900 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.787 seconds
[0m17:46:34.684381 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:46:34.685759 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_geolocation"} */

  
    

  create  table
    "dev"."public_staging"."stg_geolocation__dbt_tmp"
    
    
    
  as (
    with source as (
    select *
    from "dev"."public"."geolocation"
)
select
    geolocation_zip_code_prefix,
    geolocation_lat,
    geolocation_lng,
    geolocation_city,
    geolocation_state
from source
  );
[0m17:46:35.898080 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.211 seconds
[0m17:46:35.912794 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:46:35.913785 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_geolocation"} */
alter table "dev"."public_staging"."stg_geolocation" rename to "stg_geolocation__dbt_backup"
[0m17:46:36.135365 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.221 seconds
[0m17:46:36.143027 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:46:36.144429 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_geolocation"} */
alter table "dev"."public_staging"."stg_geolocation__dbt_tmp" rename to "stg_geolocation"
[0m17:46:36.256193 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.110 seconds
[0m17:46:36.288792 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: COMMIT
[0m17:46:36.289440 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:46:36.289821 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: COMMIT
[0m17:46:36.420893 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.130 seconds
[0m17:46:36.422549 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:46:36.423301 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: BEGIN
[0m17:46:36.500121 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.076 seconds
[0m17:46:36.512466 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_geolocation__dbt_backup"
[0m17:46:36.520929 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:46:36.521672 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_geolocation"} */
drop table if exists "dev"."public_staging"."stg_geolocation__dbt_backup" cascade
[0m17:46:36.601799 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.079 seconds
[0m17:46:36.604754 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: COMMIT
[0m17:46:36.606023 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:46:36.606695 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: COMMIT
[0m17:46:36.677236 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.069 seconds
[0m17:46:36.678792 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:46:36.679412 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: BEGIN
[0m17:46:36.717009 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.037 seconds
[0m17:46:36.720970 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: ROLLBACK
[0m17:46:36.797676 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: Close
[0m17:46:36.816654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afec0517-a748-4aec-87a1-068e6f083dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042388f0>]}
[0m17:46:36.822470 [info ] [Thread-1 (]: 1 of 22 OK created sql table model public_staging.stg_geolocation .............. [[32mSUCCESS[0m in 3.97s]
[0m17:46:36.823299 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_geolocation
[0m17:46:36.823900 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_order_items
[0m17:46:36.824606 [info ] [Thread-1 (]: 2 of 22 START sql table model public_staging.stg_order_items ................... [RUN]
[0m17:46:36.825167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_geolocation, now model.olist_dbt.stg_order_items)
[0m17:46:36.825577 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_order_items
[0m17:46:36.830221 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_order_items"
[0m17:46:36.832197 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_order_items
[0m17:46:36.837339 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_order_items"
[0m17:46:36.839281 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:46:36.839640 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: BEGIN
[0m17:46:36.839896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:36.840274 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:46:36.840544 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:46:37.248347 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.408 seconds
[0m17:46:37.249152 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:46:37.249732 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_items"} */

  
    

  create  table
    "dev"."public_staging"."stg_order_items__dbt_tmp"
    
    
    
  as (
    with source as (
    select *
    from "dev"."public"."order_items"
)
select
    order_id,
    order_item_id,
    product_id,
    seller_id,
    shipping_limit_date,
    price,
    freight_value
    
from source
  );
[0m17:46:37.946507 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.696 seconds
[0m17:46:37.953488 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:46:37.954355 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_items"} */
alter table "dev"."public_staging"."stg_order_items" rename to "stg_order_items__dbt_backup"
[0m17:46:38.763253 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.808 seconds
[0m17:46:38.769392 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:46:38.770187 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_items"} */
alter table "dev"."public_staging"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m17:46:39.023611 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.253 seconds
[0m17:46:39.026913 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: COMMIT
[0m17:46:39.028149 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:46:39.028821 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: COMMIT
[0m17:46:39.191369 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.162 seconds
[0m17:46:39.193755 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:46:39.194357 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: BEGIN
[0m17:46:39.677691 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.482 seconds
[0m17:46:39.682823 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_order_items__dbt_backup"
[0m17:46:39.685001 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:46:39.685945 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_items"} */
drop table if exists "dev"."public_staging"."stg_order_items__dbt_backup" cascade
[0m17:46:39.879159 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.192 seconds
[0m17:46:39.881205 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: COMMIT
[0m17:46:39.881990 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:46:39.882616 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: COMMIT
[0m17:46:40.207434 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.324 seconds
[0m17:46:40.209267 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:46:40.210096 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: BEGIN
[0m17:46:40.812803 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.601 seconds
[0m17:46:40.814497 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: ROLLBACK
[0m17:46:41.125882 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: Close
[0m17:46:41.128774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afec0517-a748-4aec-87a1-068e6f083dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107744d10>]}
[0m17:46:41.130079 [info ] [Thread-1 (]: 2 of 22 OK created sql table model public_staging.stg_order_items .............. [[32mSUCCESS[0m in 4.30s]
[0m17:46:41.130918 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_order_items
[0m17:46:41.132244 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_order_payments
[0m17:46:41.133325 [info ] [Thread-1 (]: 3 of 22 START sql table model public_staging.stg_order_payments ................ [RUN]
[0m17:46:41.134058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_order_items, now model.olist_dbt.stg_order_payments)
[0m17:46:41.134600 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_order_payments
[0m17:46:41.138577 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_order_payments"
[0m17:46:41.140245 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_order_payments
[0m17:46:41.150881 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_order_payments"
[0m17:46:41.153661 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:46:41.154133 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: BEGIN
[0m17:46:41.154536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:41.155067 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:46:41.155469 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:46:43.123423 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.969 seconds
[0m17:46:43.125044 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:46:43.126168 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_payments"} */

  
    

  create  table
    "dev"."public_staging"."stg_order_payments__dbt_tmp"
    
    
    
  as (
    with source as (
    select *
    from "dev"."public"."order_payments"
)
select
    order_id,
    payment_sequential,
    payment_type,
    payment_installments,
    payment_value
from source
  );
[0m17:46:43.781095 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.654 seconds
[0m17:46:43.788653 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:46:43.789567 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_payments"} */
alter table "dev"."public_staging"."stg_order_payments" rename to "stg_order_payments__dbt_backup"
[0m17:46:44.464970 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.675 seconds
[0m17:46:44.472789 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:46:44.473883 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_payments"} */
alter table "dev"."public_staging"."stg_order_payments__dbt_tmp" rename to "stg_order_payments"
[0m17:46:44.795284 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.319 seconds
[0m17:46:44.798837 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: COMMIT
[0m17:46:44.799801 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:46:44.800673 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: COMMIT
[0m17:46:45.106941 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.305 seconds
[0m17:46:45.108902 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:46:45.109711 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: BEGIN
[0m17:46:45.299400 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.189 seconds
[0m17:46:45.304479 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_order_payments__dbt_backup"
[0m17:46:45.306713 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:46:45.307332 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_payments"} */
drop table if exists "dev"."public_staging"."stg_order_payments__dbt_backup" cascade
[0m17:46:45.521893 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.214 seconds
[0m17:46:45.525311 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: COMMIT
[0m17:46:45.526371 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:46:45.527085 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: COMMIT
[0m17:46:45.650181 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.122 seconds
[0m17:46:45.651617 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:46:45.652402 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: BEGIN
[0m17:46:45.839900 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.186 seconds
[0m17:46:45.842238 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: ROLLBACK
[0m17:46:46.174595 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: Close
[0m17:46:46.176887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afec0517-a748-4aec-87a1-068e6f083dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118395c70>]}
[0m17:46:46.177858 [info ] [Thread-1 (]: 3 of 22 OK created sql table model public_staging.stg_order_payments ........... [[32mSUCCESS[0m in 5.04s]
[0m17:46:46.178673 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_order_payments
[0m17:46:46.179283 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_order_reviews
[0m17:46:46.180013 [info ] [Thread-1 (]: 4 of 22 START sql table model public_staging.stg_order_reviews ................. [RUN]
[0m17:46:46.180637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_order_payments, now model.olist_dbt.stg_order_reviews)
[0m17:46:46.181165 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_order_reviews
[0m17:46:46.186021 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_order_reviews"
[0m17:46:46.187843 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_order_reviews
[0m17:46:46.193304 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_order_reviews"
[0m17:46:46.197997 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:46:46.198600 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: BEGIN
[0m17:46:46.199031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:46.199738 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:46:46.200344 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:46:47.366547 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.167 seconds
[0m17:46:47.367845 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:46:47.368517 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_reviews"} */

  
    

  create  table
    "dev"."public_staging"."stg_order_reviews__dbt_tmp"
    
    
    
  as (
    with source as (
    select *
    from "dev"."public"."order_reviews"
)
select
    review_id,
    order_id,
    review_score,
    review_comment_title,
    review_comment_message,
    review_creation_date,
    review_answer_timestamp
from source
  );
[0m17:46:48.799473 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.430 seconds
[0m17:46:48.806762 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:46:48.807573 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_reviews"} */
alter table "dev"."public_staging"."stg_order_reviews" rename to "stg_order_reviews__dbt_backup"
[0m17:46:49.701810 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.893 seconds
[0m17:46:49.710160 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:46:49.711445 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_reviews"} */
alter table "dev"."public_staging"."stg_order_reviews__dbt_tmp" rename to "stg_order_reviews"
[0m17:46:49.969749 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.257 seconds
[0m17:46:49.972897 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: COMMIT
[0m17:46:49.973592 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:46:49.974091 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: COMMIT
[0m17:46:50.874392 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.900 seconds
[0m17:46:50.875868 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:46:50.876618 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: BEGIN
[0m17:46:51.169579 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.292 seconds
[0m17:46:51.173203 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_order_reviews__dbt_backup"
[0m17:46:51.174713 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:46:51.175235 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_reviews"} */
drop table if exists "dev"."public_staging"."stg_order_reviews__dbt_backup" cascade
[0m17:46:51.628975 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.453 seconds
[0m17:46:51.631101 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: COMMIT
[0m17:46:51.631863 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:46:51.632374 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: COMMIT
[0m17:46:51.960865 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.328 seconds
[0m17:46:51.961874 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:46:51.962366 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: BEGIN
[0m17:46:52.089700 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.126 seconds
[0m17:46:52.092443 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: ROLLBACK
[0m17:46:52.633337 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: Close
[0m17:46:52.635440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afec0517-a748-4aec-87a1-068e6f083dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107750380>]}
[0m17:46:52.637049 [info ] [Thread-1 (]: 4 of 22 OK created sql table model public_staging.stg_order_reviews ............ [[32mSUCCESS[0m in 6.45s]
[0m17:46:52.638350 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_order_reviews
[0m17:46:52.639106 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_product_category
[0m17:46:52.639985 [info ] [Thread-1 (]: 5 of 22 START sql table model public_staging.stg_product_category .............. [RUN]
[0m17:46:52.640692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_order_reviews, now model.olist_dbt.stg_product_category)
[0m17:46:52.641281 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_product_category
[0m17:46:52.650466 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_product_category"
[0m17:46:52.651750 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_product_category
[0m17:46:52.655151 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_product_category"
[0m17:46:52.656863 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:46:52.657225 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: BEGIN
[0m17:46:52.657522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:52.658043 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:46:52.658354 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:46:53.704012 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.046 seconds
[0m17:46:53.705695 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:46:53.706925 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_product_category"} */

  
    

  create  table
    "dev"."public_staging"."stg_product_category__dbt_tmp"
    
    
    
  as (
    with source as (
    select *
    from "dev"."public"."product_category"
)
select
    product_category_name_english as product_category
from source
  );
[0m17:46:53.981114 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.273 seconds
[0m17:46:53.985554 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:46:53.986083 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_product_category"} */
alter table "dev"."public_staging"."stg_product_category" rename to "stg_product_category__dbt_backup"
[0m17:46:55.147569 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.161 seconds
[0m17:46:55.153003 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:46:55.153811 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_product_category"} */
alter table "dev"."public_staging"."stg_product_category__dbt_tmp" rename to "stg_product_category"
[0m17:46:55.426422 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.272 seconds
[0m17:46:55.430700 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: COMMIT
[0m17:46:55.431953 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:46:55.432734 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: COMMIT
[0m17:46:55.973501 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.540 seconds
[0m17:46:55.974583 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:46:55.975167 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: BEGIN
[0m17:46:56.249132 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.273 seconds
[0m17:46:56.252086 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_product_category__dbt_backup"
[0m17:46:56.253104 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:46:56.253444 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_product_category"} */
drop table if exists "dev"."public_staging"."stg_product_category__dbt_backup" cascade
[0m17:46:56.395315 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.141 seconds
[0m17:46:56.397498 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: COMMIT
[0m17:46:56.398213 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:46:56.398749 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: COMMIT
[0m17:46:56.493086 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.093 seconds
[0m17:46:56.494732 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:46:56.495274 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: BEGIN
[0m17:46:56.643989 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.148 seconds
[0m17:46:56.645598 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: ROLLBACK
[0m17:46:56.940767 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: Close
[0m17:46:56.944058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afec0517-a748-4aec-87a1-068e6f083dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107732c60>]}
[0m17:46:56.945269 [info ] [Thread-1 (]: 5 of 22 OK created sql table model public_staging.stg_product_category ......... [[32mSUCCESS[0m in 4.30s]
[0m17:46:56.946199 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_product_category
[0m17:46:56.946796 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_products
[0m17:46:56.947554 [info ] [Thread-1 (]: 6 of 22 START sql table model public_staging.stg_products ...................... [RUN]
[0m17:46:56.948429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_product_category, now model.olist_dbt.stg_products)
[0m17:46:56.948991 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_products
[0m17:46:56.954598 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_products"
[0m17:46:56.956498 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_products
[0m17:46:56.963775 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_products"
[0m17:46:56.967018 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:46:56.967539 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: BEGIN
[0m17:46:56.967939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:56.968494 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:46:56.968928 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:46:58.168136 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.200 seconds
[0m17:46:58.169068 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:46:58.169670 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_products"} */

  
    

  create  table
    "dev"."public_staging"."stg_products__dbt_tmp"
    
    
    
  as (
    with source as (
    select *
    from "dev"."public"."products"
)
select
    product_id,
    product_category_name,
    product_name_length,
    product_description_length,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
from source
  );
[0m17:46:58.731674 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.561 seconds
[0m17:46:58.738319 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:46:58.739256 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_products"} */
alter table "dev"."public_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m17:46:59.182060 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.441 seconds
[0m17:46:59.188495 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:46:59.189384 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_products"} */
alter table "dev"."public_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m17:46:59.467046 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.277 seconds
[0m17:46:59.470849 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: COMMIT
[0m17:46:59.471688 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:46:59.472247 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: COMMIT
[0m17:46:59.640905 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.168 seconds
[0m17:46:59.643383 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:46:59.644180 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: BEGIN
[0m17:46:59.858275 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.213 seconds
[0m17:46:59.863697 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_products__dbt_backup"
[0m17:46:59.865411 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:46:59.865984 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_products"} */
drop table if exists "dev"."public_staging"."stg_products__dbt_backup" cascade
[0m17:47:00.056930 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.190 seconds
[0m17:47:00.059470 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: COMMIT
[0m17:47:00.060458 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:47:00.061108 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: COMMIT
[0m17:47:00.156695 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.095 seconds
[0m17:47:00.159964 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:47:00.160893 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: BEGIN
[0m17:47:00.224469 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.063 seconds
[0m17:47:00.226299 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: ROLLBACK
[0m17:47:00.523867 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: Close
[0m17:47:00.525461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afec0517-a748-4aec-87a1-068e6f083dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107744170>]}
[0m17:47:00.526632 [info ] [Thread-1 (]: 6 of 22 OK created sql table model public_staging.stg_products ................. [[32mSUCCESS[0m in 3.58s]
[0m17:47:00.527611 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_products
[0m17:47:00.528251 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_sellers
[0m17:47:00.528974 [info ] [Thread-1 (]: 7 of 22 START sql table model public_staging.stg_sellers ....................... [RUN]
[0m17:47:00.529633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_products, now model.olist_dbt.stg_sellers)
[0m17:47:00.530136 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_sellers
[0m17:47:00.542839 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_sellers"
[0m17:47:00.544746 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_sellers
[0m17:47:00.549332 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_sellers"
[0m17:47:00.552043 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:47:00.552499 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: BEGIN
[0m17:47:00.552887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:00.553454 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:47:00.553868 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:47:01.591331 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.038 seconds
[0m17:47:01.592604 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:47:01.593319 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_sellers"} */

  
    

  create  table
    "dev"."public_staging"."stg_sellers__dbt_tmp"
    
    
    
  as (
    with source as (
    select *
    from "dev"."public"."sellers"
)
select
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state
from source
  );
[0m17:47:02.011395 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.417 seconds
[0m17:47:02.016761 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:47:02.017497 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_sellers"} */
alter table "dev"."public_staging"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m17:47:02.893653 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.875 seconds
[0m17:47:02.900149 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:47:02.900941 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_sellers"} */
alter table "dev"."public_staging"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m17:47:03.229251 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.328 seconds
[0m17:47:03.232895 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: COMMIT
[0m17:47:03.234037 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:47:03.234691 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: COMMIT
[0m17:47:03.852969 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.618 seconds
[0m17:47:03.854096 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:47:03.854640 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: BEGIN
[0m17:47:04.054640 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.199 seconds
[0m17:47:04.062100 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_sellers__dbt_backup"
[0m17:47:04.064833 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:47:04.065589 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_sellers"} */
drop table if exists "dev"."public_staging"."stg_sellers__dbt_backup" cascade
[0m17:47:04.281881 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.216 seconds
[0m17:47:04.285249 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: COMMIT
[0m17:47:04.286320 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:47:04.286930 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: COMMIT
[0m17:47:04.419231 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.131 seconds
[0m17:47:04.421159 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:47:04.421786 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: BEGIN
[0m17:47:04.577523 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.155 seconds
[0m17:47:04.578951 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: ROLLBACK
[0m17:47:04.776654 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: Close
[0m17:47:04.779271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afec0517-a748-4aec-87a1-068e6f083dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11835acc0>]}
[0m17:47:04.780351 [info ] [Thread-1 (]: 7 of 22 OK created sql table model public_staging.stg_sellers .................. [[32mSUCCESS[0m in 4.25s]
[0m17:47:04.781179 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_sellers
[0m17:47:04.781855 [debug] [Thread-1 (]: Began running node test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608
[0m17:47:04.782506 [info ] [Thread-1 (]: 8 of 22 START test source_not_null_olist_customer_customer_id .................. [RUN]
[0m17:47:04.783282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_sellers, now test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608)
[0m17:47:04.784314 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608
[0m17:47:04.803615 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608"
[0m17:47:04.805171 [debug] [Thread-1 (]: Began executing node test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608
[0m17:47:04.820598 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608"
[0m17:47:04.822872 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608"
[0m17:47:04.823259 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608: BEGIN
[0m17:47:04.823560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:04.824024 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:47:04.824350 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:47:07.746124 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.922 seconds
[0m17:47:07.746952 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608"
[0m17:47:07.747747 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dev"."public"."customer"
where customer_id is null



      
    ) dbt_internal_test
[0m17:47:08.022001 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.273 seconds
[0m17:47:08.030380 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608: ROLLBACK
[0m17:47:08.160903 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608: Close
[0m17:47:08.162512 [info ] [Thread-1 (]: 8 of 22 PASS source_not_null_olist_customer_customer_id ........................ [[32mPASS[0m in 3.38s]
[0m17:47:08.163455 [debug] [Thread-1 (]: Finished running node test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608
[0m17:47:08.164099 [debug] [Thread-1 (]: Began running node test.olist_dbt.source_not_null_olist_orders_order_id.441189e023
[0m17:47:08.164717 [info ] [Thread-1 (]: 9 of 22 START test source_not_null_olist_orders_order_id ....................... [RUN]
[0m17:47:08.165391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608, now test.olist_dbt.source_not_null_olist_orders_order_id.441189e023)
[0m17:47:08.165934 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.source_not_null_olist_orders_order_id.441189e023
[0m17:47:08.173316 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.source_not_null_olist_orders_order_id.441189e023"
[0m17:47:08.175039 [debug] [Thread-1 (]: Began executing node test.olist_dbt.source_not_null_olist_orders_order_id.441189e023
[0m17:47:08.179156 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.source_not_null_olist_orders_order_id.441189e023"
[0m17:47:08.182688 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_not_null_olist_orders_order_id.441189e023"
[0m17:47:08.183261 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_orders_order_id.441189e023: BEGIN
[0m17:47:08.183671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:08.184243 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:47:08.184653 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:47:08.959933 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.776 seconds
[0m17:47:08.960560 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_not_null_olist_orders_order_id.441189e023"
[0m17:47:08.960952 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_orders_order_id.441189e023: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.source_not_null_olist_orders_order_id.441189e023"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "dev"."public"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m17:47:09.179411 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.218 seconds
[0m17:47:09.182196 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_orders_order_id.441189e023: ROLLBACK
[0m17:47:09.761804 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_orders_order_id.441189e023: Close
[0m17:47:09.763182 [info ] [Thread-1 (]: 9 of 22 PASS source_not_null_olist_orders_order_id ............................. [[32mPASS[0m in 1.60s]
[0m17:47:09.764070 [debug] [Thread-1 (]: Finished running node test.olist_dbt.source_not_null_olist_orders_order_id.441189e023
[0m17:47:09.764701 [debug] [Thread-1 (]: Began running node test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a
[0m17:47:09.765549 [info ] [Thread-1 (]: 10 of 22 START test source_unique_olist_customer_customer_id ................... [RUN]
[0m17:47:09.766700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.source_not_null_olist_orders_order_id.441189e023, now test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a)
[0m17:47:09.767331 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a
[0m17:47:09.785400 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a"
[0m17:47:09.787168 [debug] [Thread-1 (]: Began executing node test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a
[0m17:47:09.834425 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a"
[0m17:47:09.836540 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a"
[0m17:47:09.836880 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a: BEGIN
[0m17:47:09.837152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:09.837525 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:47:09.837804 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:47:11.794865 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.957 seconds
[0m17:47:11.795773 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a"
[0m17:47:11.796325 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dev"."public"."customer"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:47:11.931820 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.135 seconds
[0m17:47:11.935392 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a: ROLLBACK
[0m17:47:12.065743 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a: Close
[0m17:47:12.068292 [info ] [Thread-1 (]: 10 of 22 PASS source_unique_olist_customer_customer_id ......................... [[32mPASS[0m in 2.30s]
[0m17:47:12.069754 [debug] [Thread-1 (]: Finished running node test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a
[0m17:47:12.070695 [debug] [Thread-1 (]: Began running node test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82
[0m17:47:12.071723 [info ] [Thread-1 (]: 11 of 22 START test source_unique_olist_orders_order_id ........................ [RUN]
[0m17:47:12.072509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a, now test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82)
[0m17:47:12.073165 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82
[0m17:47:12.082885 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82"
[0m17:47:12.084620 [debug] [Thread-1 (]: Began executing node test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82
[0m17:47:12.087968 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82"
[0m17:47:12.090707 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82"
[0m17:47:12.091209 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82: BEGIN
[0m17:47:12.091618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:12.092162 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:47:12.092588 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:47:13.889971 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.798 seconds
[0m17:47:13.890788 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82"
[0m17:47:13.891312 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."public"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:47:14.142728 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.251 seconds
[0m17:47:14.146213 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82: ROLLBACK
[0m17:47:14.614824 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82: Close
[0m17:47:14.617546 [info ] [Thread-1 (]: 11 of 22 PASS source_unique_olist_orders_order_id .............................. [[32mPASS[0m in 2.54s]
[0m17:47:14.619157 [debug] [Thread-1 (]: Finished running node test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82
[0m17:47:14.620170 [debug] [Thread-1 (]: Began running node test.olist_dbt.assert_stg_order_items_values_positive
[0m17:47:14.621140 [info ] [Thread-1 (]: 12 of 22 START test assert_stg_order_items_values_positive ..................... [RUN]
[0m17:47:14.621940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82, now test.olist_dbt.assert_stg_order_items_values_positive)
[0m17:47:14.622516 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.assert_stg_order_items_values_positive
[0m17:47:14.628943 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.assert_stg_order_items_values_positive"
[0m17:47:14.631133 [debug] [Thread-1 (]: Began executing node test.olist_dbt.assert_stg_order_items_values_positive
[0m17:47:14.635771 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.assert_stg_order_items_values_positive"
[0m17:47:14.638915 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.assert_stg_order_items_values_positive"
[0m17:47:14.639410 [debug] [Thread-1 (]: On test.olist_dbt.assert_stg_order_items_values_positive: BEGIN
[0m17:47:14.639822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:14.640431 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:47:14.640957 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:47:15.906314 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.266 seconds
[0m17:47:15.908275 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.assert_stg_order_items_values_positive"
[0m17:47:15.909308 [debug] [Thread-1 (]: On test.olist_dbt.assert_stg_order_items_values_positive: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.assert_stg_order_items_values_positive"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      WITH order_items AS (

    SELECT  *
    FROM "dev"."public_staging"."stg_order_items"

)

SELECT  order_id,
        SUM(price) AS total_value
FROM order_items
GROUP BY 1
HAVING total_value < 0
      
    ) dbt_internal_test
[0m17:47:16.195311 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.285 seconds
[0m17:47:16.197944 [debug] [Thread-1 (]: On test.olist_dbt.assert_stg_order_items_values_positive: ROLLBACK
[0m17:47:16.754955 [debug] [Thread-1 (]: On test.olist_dbt.assert_stg_order_items_values_positive: Close
[0m17:47:16.756446 [info ] [Thread-1 (]: 12 of 22 PASS assert_stg_order_items_values_positive ........................... [[32mPASS[0m in 2.13s]
[0m17:47:16.757349 [debug] [Thread-1 (]: Finished running node test.olist_dbt.assert_stg_order_items_values_positive
[0m17:47:16.757978 [debug] [Thread-1 (]: Began running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m17:47:16.758714 [info ] [Thread-1 (]: 13 of 22 START test assert_stg_order_items_values_positive_stg_order_items_ .... [RUN]
[0m17:47:16.759468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.assert_stg_order_items_values_positive, now test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd)
[0m17:47:16.760087 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m17:47:16.774966 [debug] [Thread-1 (]: Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:47:16.775757 [error] [Thread-1 (]: 13 of 22 ERROR assert_stg_order_items_values_positive_stg_order_items_ ......... [[31mERROR[0m in 0.02s]
[0m17:47:16.776409 [debug] [Thread-1 (]: Finished running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m17:47:16.777819 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_customers
[0m17:47:16.779790 [info ] [Thread-1 (]: 14 of 22 START sql table model public_staging.stg_customers .................... [RUN]
[0m17:47:16.780561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd, now model.olist_dbt.stg_customers)
[0m17:47:16.781081 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_customers
[0m17:47:16.784359 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_customers"
[0m17:47:16.785646 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_customers
[0m17:47:16.789533 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_customers"
[0m17:47:16.791549 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:47:16.791943 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: BEGIN
[0m17:47:16.792282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:16.792759 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:47:16.793082 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:47:18.076363 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.284 seconds
[0m17:47:18.077778 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:47:18.078362 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_customers"} */

  
    

  create  table
    "dev"."public_staging"."stg_customers__dbt_tmp"
    
    
    
  as (
    with source as (
    select *
    from "dev"."public"."customer"
)
select
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state
from source
  );
[0m17:47:18.599437 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.520 seconds
[0m17:47:18.609003 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:47:18.609940 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_customers"} */
alter table "dev"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m17:47:19.520215 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.909 seconds
[0m17:47:19.538659 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:47:19.539534 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_customers"} */
alter table "dev"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:47:19.794170 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.254 seconds
[0m17:47:19.797584 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: COMMIT
[0m17:47:19.798337 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:47:19.798825 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: COMMIT
[0m17:47:20.442028 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.642 seconds
[0m17:47:20.444308 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:47:20.445263 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: BEGIN
[0m17:47:20.574743 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.128 seconds
[0m17:47:20.580610 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_customers__dbt_backup"
[0m17:47:20.582471 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:47:20.583074 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_customers"} */
drop table if exists "dev"."public_staging"."stg_customers__dbt_backup" cascade
[0m17:47:20.715013 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.131 seconds
[0m17:47:20.717175 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: COMMIT
[0m17:47:20.717962 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:47:20.718625 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: COMMIT
[0m17:47:20.818325 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.099 seconds
[0m17:47:20.820112 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:47:20.821126 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: BEGIN
[0m17:47:20.969825 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.147 seconds
[0m17:47:20.972767 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: ROLLBACK
[0m17:47:21.248306 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: Close
[0m17:47:21.250953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afec0517-a748-4aec-87a1-068e6f083dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10775b560>]}
[0m17:47:21.252398 [info ] [Thread-1 (]: 14 of 22 OK created sql table model public_staging.stg_customers ............... [[32mSUCCESS[0m in 4.47s]
[0m17:47:21.253448 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_customers
[0m17:47:21.254146 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_orders
[0m17:47:21.255030 [info ] [Thread-1 (]: 15 of 22 START sql table model public_staging.stg_orders ....................... [RUN]
[0m17:47:21.255717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_customers, now model.olist_dbt.stg_orders)
[0m17:47:21.256219 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_orders
[0m17:47:21.261768 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_orders"
[0m17:47:21.264154 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_orders
[0m17:47:21.269771 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_orders"
[0m17:47:21.272837 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:47:21.273281 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m17:47:21.273667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:21.274225 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:47:21.274632 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:47:23.207071 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.933 seconds
[0m17:47:23.208902 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:47:23.209654 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */

  
    

  create  table
    "dev"."public_staging"."stg_orders__dbt_tmp"
    
    
    
  as (
    


-- models/staging/olist/stg_orders.sql
with source as (
    select *
    from "dev"."public"."orders"
)
select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp::timestamp as order_purchase_timestamp,
    order_approved_at::timestamp as order_approved_at,
    order_delivered_carrier_date::timestamp as order_delivered_carrier_date,
    order_delivered_customer_date::timestamp as order_delivered_customer_date,
    order_estimated_delivery_date::timestamp as order_estimated_delivery_date
from source
  );
[0m17:47:23.586850 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.376 seconds
[0m17:47:23.596293 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:47:23.597459 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m17:47:24.782043 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.184 seconds
[0m17:47:24.790624 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:47:24.791666 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m17:47:25.463896 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.671 seconds
[0m17:47:25.469570 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m17:47:25.470641 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:47:25.471199 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m17:47:25.695404 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.224 seconds
[0m17:47:25.696451 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:47:25.696944 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m17:47:25.912524 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.215 seconds
[0m17:47:25.916618 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_orders__dbt_backup"
[0m17:47:25.918621 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:47:25.919574 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
drop table if exists "dev"."public_staging"."stg_orders__dbt_backup" cascade
[0m17:47:26.106612 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.186 seconds
[0m17:47:26.109828 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m17:47:26.110889 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:47:26.111677 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m17:47:26.585023 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.472 seconds
[0m17:47:26.587164 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:47:26.588150 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m17:47:26.651549 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.062 seconds
[0m17:47:26.653505 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: ROLLBACK
[0m17:47:26.925041 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: Close
[0m17:47:26.927775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afec0517-a748-4aec-87a1-068e6f083dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107744950>]}
[0m17:47:26.928696 [info ] [Thread-1 (]: 15 of 22 OK created sql table model public_staging.stg_orders .................. [[32mSUCCESS[0m in 5.67s]
[0m17:47:26.929500 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_orders
[0m17:47:26.930109 [debug] [Thread-1 (]: Began running node test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:47:26.930905 [info ] [Thread-1 (]: 16 of 22 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m17:47:26.931594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_orders, now test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m17:47:26.932157 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:47:26.939394 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:47:26.941660 [debug] [Thread-1 (]: Began executing node test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:47:26.946127 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:47:26.949735 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:47:26.950390 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m17:47:26.950824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:26.951403 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:47:26.951872 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:47:28.153614 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.202 seconds
[0m17:47:28.155530 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:47:28.156488 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dev"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m17:47:28.327702 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.170 seconds
[0m17:47:28.330208 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m17:47:28.457535 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m17:47:28.460562 [info ] [Thread-1 (]: 16 of 22 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 1.53s]
[0m17:47:28.461583 [debug] [Thread-1 (]: Finished running node test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:47:28.462226 [debug] [Thread-1 (]: Began running node test.olist_dbt.unique_stg_customers_customer_id.c7614daada
[0m17:47:28.462928 [info ] [Thread-1 (]: 17 of 22 START test unique_stg_customers_customer_id ........................... [RUN]
[0m17:47:28.463589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.olist_dbt.unique_stg_customers_customer_id.c7614daada)
[0m17:47:28.464104 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.unique_stg_customers_customer_id.c7614daada
[0m17:47:28.471187 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.unique_stg_customers_customer_id.c7614daada"
[0m17:47:28.473247 [debug] [Thread-1 (]: Began executing node test.olist_dbt.unique_stg_customers_customer_id.c7614daada
[0m17:47:28.482838 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.unique_stg_customers_customer_id.c7614daada"
[0m17:47:28.485892 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.unique_stg_customers_customer_id.c7614daada"
[0m17:47:28.486440 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m17:47:28.486850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:28.487406 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:47:28.487820 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:47:29.533839 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.047 seconds
[0m17:47:29.535664 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.unique_stg_customers_customer_id.c7614daada"
[0m17:47:29.536553 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dev"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:47:30.068924 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.531 seconds
[0m17:47:30.073978 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m17:47:30.344068 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_customers_customer_id.c7614daada: Close
[0m17:47:30.345511 [info ] [Thread-1 (]: 17 of 22 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 1.88s]
[0m17:47:30.346404 [debug] [Thread-1 (]: Finished running node test.olist_dbt.unique_stg_customers_customer_id.c7614daada
[0m17:47:30.347098 [debug] [Thread-1 (]: Began running node test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d
[0m17:47:30.348103 [info ] [Thread-1 (]: 18 of 22 START test accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved  [RUN]
[0m17:47:30.349043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.unique_stg_customers_customer_id.c7614daada, now test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d)
[0m17:47:30.349714 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d
[0m17:47:30.369694 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d"
[0m17:47:30.371446 [debug] [Thread-1 (]: Began executing node test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d
[0m17:47:30.374200 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d"
[0m17:47:30.378345 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d"
[0m17:47:30.378952 [debug] [Thread-1 (]: On test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d: BEGIN
[0m17:47:30.379398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:30.380093 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:47:30.380663 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:47:31.501039 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.121 seconds
[0m17:47:31.501940 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d"
[0m17:47:31.502597 [debug] [Thread-1 (]: On test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "dev"."public_staging"."stg_orders"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','canceled','invoiced','processing','created','shipped','unavailable','approved'
)



      
    ) dbt_internal_test
[0m17:47:31.779511 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.276 seconds
[0m17:47:31.783651 [debug] [Thread-1 (]: On test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d: ROLLBACK
[0m17:47:31.909604 [debug] [Thread-1 (]: On test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d: Close
[0m17:47:31.912056 [info ] [Thread-1 (]: 18 of 22 PASS accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved  [[32mPASS[0m in 1.56s]
[0m17:47:31.913015 [debug] [Thread-1 (]: Finished running node test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d
[0m17:47:31.913649 [debug] [Thread-1 (]: Began running node test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m17:47:31.914306 [info ] [Thread-1 (]: 19 of 22 START test not_null_stg_orders_order_id ............................... [RUN]
[0m17:47:31.914961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d, now test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64)
[0m17:47:31.915498 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m17:47:31.923101 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:47:31.925261 [debug] [Thread-1 (]: Began executing node test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m17:47:31.929091 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:47:31.931759 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:47:31.932438 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m17:47:31.932906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:31.933499 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:47:31.933929 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:47:34.127782 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.195 seconds
[0m17:47:34.128760 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:47:34.129468 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "dev"."public_staging"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m17:47:34.294078 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.164 seconds
[0m17:47:34.296805 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m17:47:35.187068 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m17:47:35.189880 [info ] [Thread-1 (]: 19 of 22 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 3.27s]
[0m17:47:35.191286 [debug] [Thread-1 (]: Finished running node test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m17:47:35.192141 [debug] [Thread-1 (]: Began running node test.olist_dbt.unique_stg_orders_order_id.e3b841c71a
[0m17:47:35.192921 [info ] [Thread-1 (]: 20 of 22 START test unique_stg_orders_order_id ................................. [RUN]
[0m17:47:35.193638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64, now test.olist_dbt.unique_stg_orders_order_id.e3b841c71a)
[0m17:47:35.194485 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.unique_stg_orders_order_id.e3b841c71a
[0m17:47:35.203886 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m17:47:35.205865 [debug] [Thread-1 (]: Began executing node test.olist_dbt.unique_stg_orders_order_id.e3b841c71a
[0m17:47:35.208793 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m17:47:35.212062 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m17:47:35.212604 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m17:47:35.213009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:35.213586 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:47:35.213992 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:47:37.208576 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.996 seconds
[0m17:47:37.209084 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m17:47:37.209441 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."public_staging"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:47:37.472941 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.263 seconds
[0m17:47:37.478029 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m17:47:38.099721 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_orders_order_id.e3b841c71a: Close
[0m17:47:38.101171 [info ] [Thread-1 (]: 20 of 22 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 2.91s]
[0m17:47:38.102502 [debug] [Thread-1 (]: Finished running node test.olist_dbt.unique_stg_orders_order_id.e3b841c71a
[0m17:47:38.104105 [debug] [Thread-1 (]: Began running node model.olist_dbt.monthly_summary
[0m17:47:38.105163 [info ] [Thread-1 (]: 21 of 22 SKIP relation public_marts.monthly_summary ............................ [[33mSKIP[0m]
[0m17:47:38.105882 [debug] [Thread-1 (]: Finished running node model.olist_dbt.monthly_summary
[0m17:47:38.106469 [debug] [Thread-1 (]: Began running node model.olist_dbt.user_summary
[0m17:47:38.107434 [info ] [Thread-1 (]: 22 of 22 SKIP relation public_marts.user_summary ............................... [[33mSKIP[0m]
[0m17:47:38.108998 [debug] [Thread-1 (]: Finished running node model.olist_dbt.user_summary
[0m17:47:38.112104 [debug] [MainThread]: Using redshift connection "master"
[0m17:47:38.112791 [debug] [MainThread]: On master: BEGIN
[0m17:47:38.113428 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:47:38.115393 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:47:38.116718 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:47:38.903393 [debug] [MainThread]: SQL status: SUCCESS in 0.790 seconds
[0m17:47:38.903946 [debug] [MainThread]: On master: COMMIT
[0m17:47:38.904492 [debug] [MainThread]: Using redshift connection "master"
[0m17:47:38.904857 [debug] [MainThread]: On master: COMMIT
[0m17:47:39.032513 [debug] [MainThread]: SQL status: SUCCESS in 0.127 seconds
[0m17:47:39.033280 [debug] [MainThread]: On master: Close
[0m17:47:39.034233 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:47:39.034705 [debug] [MainThread]: Connection 'test.olist_dbt.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m17:47:39.035259 [info ] [MainThread]: 
[0m17:47:39.035738 [info ] [MainThread]: Finished running 11 table models, 11 data tests in 0 hours 1 minutes and 19.54 seconds (79.54s).
[0m17:47:39.039352 [debug] [MainThread]: Command end result
[0m17:47:39.087058 [info ] [MainThread]: 
[0m17:47:39.087486 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:47:39.087731 [info ] [MainThread]: 
[0m17:47:39.088045 [error] [MainThread]:   Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:47:39.088285 [info ] [MainThread]: 
[0m17:47:39.088532 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=1 SKIP=2 TOTAL=22
[0m17:47:39.091011 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 80.363014, "process_user_time": 4.087757, "process_kernel_time": 0.636414, "process_mem_max_rss": "129564672", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:47:39.091510 [debug] [MainThread]: Command `dbt build` failed at 17:47:39.091428 after 80.36 seconds
[0m17:47:39.091848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101602cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057a5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107745d00>]}
[0m17:47:39.092133 [debug] [MainThread]: Flushing usage events
[0m17:48:38.066497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106acf2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10862c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10862c350>]}


============================== 17:48:38.071075 | f6c8aeb1-3b34-45b4-9938-e753bfca6412 ==============================
[0m17:48:38.071075 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:48:38.071584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt list --resource-type test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:48:38.241192 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:48:38.241633 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:48:38.374398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6c8aeb1-3b34-45b4-9938-e753bfca6412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a360c0>]}
[0m17:48:38.411419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6c8aeb1-3b34-45b4-9938-e753bfca6412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f2d3a0>]}
[0m17:48:38.413143 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m17:48:38.430951 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:48:38.568441 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:48:38.568809 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:48:38.604872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6c8aeb1-3b34-45b4-9938-e753bfca6412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cfcb90>]}
[0m17:48:38.699468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6c8aeb1-3b34-45b4-9938-e753bfca6412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108701fa0>]}
[0m17:48:38.702614 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.6868778, "process_user_time": 1.33976, "process_kernel_time": 0.269445, "process_mem_max_rss": "115785728", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:48:38.703134 [debug] [MainThread]: Command `dbt list` succeeded at 17:48:38.703048 after 0.69 seconds
[0m17:48:38.703462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105002d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b9e300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085d8470>]}
[0m17:48:38.703737 [debug] [MainThread]: Flushing usage events
[0m17:49:05.607315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aaf890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10749ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10749c950>]}


============================== 17:49:05.630290 | 04034a88-4f61-408f-bbe5-0a6cd221d735 ==============================
[0m17:49:05.630290 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:49:05.634265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select assert_stg_order_items_values_positive_stg_order_items_', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:49:05.942734 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:49:05.943746 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:49:06.229602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04034a88-4f61-408f-bbe5-0a6cd221d735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2f52b0>]}
[0m17:49:06.298187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04034a88-4f61-408f-bbe5-0a6cd221d735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6ea50>]}
[0m17:49:06.299422 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m17:49:06.324402 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:49:06.598513 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:49:06.599119 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:49:06.641564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04034a88-4f61-408f-bbe5-0a6cd221d735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092d7bc0>]}
[0m17:49:06.745211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04034a88-4f61-408f-bbe5-0a6cd221d735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c886ab0>]}
[0m17:49:06.745712 [info ] [MainThread]: Found 11 models, 11 data tests, 10 sources, 488 macros
[0m17:49:06.746029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04034a88-4f61-408f-bbe5-0a6cd221d735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10939d7f0>]}
[0m17:49:06.747501 [info ] [MainThread]: 
[0m17:49:06.747980 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:49:06.751365 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_marts'
[0m17:49:06.766840 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m17:49:06.767302 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m17:49:06.767550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:06.770658 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:49:06.771369 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:49:08.373158 [debug] [ThreadPool]: SQL status: SUCCESS in 1.605 seconds
[0m17:49:08.375302 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m17:49:08.376151 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m17:49:08.657182 [debug] [ThreadPool]: SQL status: SUCCESS in 0.280 seconds
[0m17:49:08.661499 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m17:49:09.294048 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m17:49:09.296548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_marts, now list_dev_public_staging)
[0m17:49:09.306626 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:49:09.307362 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m17:49:09.307816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:49:09.308461 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:49:09.308901 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:49:10.248513 [debug] [ThreadPool]: SQL status: SUCCESS in 0.941 seconds
[0m17:49:10.249613 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:49:10.250378 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m17:49:11.648801 [debug] [ThreadPool]: SQL status: SUCCESS in 1.398 seconds
[0m17:49:11.651768 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m17:49:11.902513 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m17:49:11.918118 [debug] [MainThread]: Using redshift connection "master"
[0m17:49:11.918790 [debug] [MainThread]: On master: BEGIN
[0m17:49:11.919226 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:49:11.919812 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:49:11.920168 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:49:13.688943 [debug] [MainThread]: SQL status: SUCCESS in 1.770 seconds
[0m17:49:13.689949 [debug] [MainThread]: Using redshift connection "master"
[0m17:49:13.691048 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:49:14.233511 [debug] [MainThread]: SQL status: SUCCESS in 0.541 seconds
[0m17:49:14.235409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04034a88-4f61-408f-bbe5-0a6cd221d735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a142c30>]}
[0m17:49:14.236016 [debug] [MainThread]: On master: ROLLBACK
[0m17:49:14.500751 [debug] [MainThread]: Using redshift connection "master"
[0m17:49:14.503367 [debug] [MainThread]: On master: BEGIN
[0m17:49:14.927416 [debug] [MainThread]: SQL status: SUCCESS in 0.420 seconds
[0m17:49:14.928483 [debug] [MainThread]: On master: COMMIT
[0m17:49:14.929414 [debug] [MainThread]: Using redshift connection "master"
[0m17:49:14.929961 [debug] [MainThread]: On master: COMMIT
[0m17:49:15.565871 [debug] [MainThread]: SQL status: SUCCESS in 0.635 seconds
[0m17:49:15.566746 [debug] [MainThread]: On master: Close
[0m17:49:15.567707 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:49:15.568244 [info ] [MainThread]: 
[0m17:49:15.574009 [debug] [Thread-1 (]: Began running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m17:49:15.575143 [info ] [Thread-1 (]: 1 of 1 START test assert_stg_order_items_values_positive_stg_order_items_ ...... [RUN]
[0m17:49:15.575911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd)
[0m17:49:15.576663 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m17:49:15.596549 [debug] [Thread-1 (]: Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:49:15.597392 [error] [Thread-1 (]: 1 of 1 ERROR assert_stg_order_items_values_positive_stg_order_items_ ........... [[31mERROR[0m in 0.02s]
[0m17:49:15.598090 [debug] [Thread-1 (]: Finished running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m17:49:15.600739 [debug] [MainThread]: Using redshift connection "master"
[0m17:49:15.601303 [debug] [MainThread]: On master: BEGIN
[0m17:49:15.601668 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:49:15.602128 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:49:15.602432 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:49:17.384819 [debug] [MainThread]: SQL status: SUCCESS in 1.783 seconds
[0m17:49:17.385669 [debug] [MainThread]: On master: COMMIT
[0m17:49:17.386384 [debug] [MainThread]: Using redshift connection "master"
[0m17:49:17.386964 [debug] [MainThread]: On master: COMMIT
[0m17:49:17.572085 [debug] [MainThread]: SQL status: SUCCESS in 0.184 seconds
[0m17:49:17.573447 [debug] [MainThread]: On master: Close
[0m17:49:17.574512 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:17.574949 [debug] [MainThread]: Connection 'test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd' was properly closed.
[0m17:49:17.575508 [info ] [MainThread]: 
[0m17:49:17.576573 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 10.83 seconds (10.83s).
[0m17:49:17.577949 [debug] [MainThread]: Command end result
[0m17:49:17.621993 [info ] [MainThread]: 
[0m17:49:17.622428 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:49:17.622693 [info ] [MainThread]: 
[0m17:49:17.623003 [error] [MainThread]:   Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:49:17.623237 [info ] [MainThread]: 
[0m17:49:17.623470 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:49:17.625780 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 12.112435, "process_user_time": 2.027349, "process_kernel_time": 0.513505, "process_mem_max_rss": "123486208", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:49:17.626302 [debug] [MainThread]: Command `dbt test` failed at 17:49:17.626226 after 12.11 seconds
[0m17:49:17.626646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ca7f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2f56d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109307fb0>]}
[0m17:49:17.626937 [debug] [MainThread]: Flushing usage events
[0m17:49:54.751668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083bbb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c8aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c8a70>]}


============================== 17:49:54.756233 | 8a80cefc-f358-4fca-8f64-00b2ef353b1f ==============================
[0m17:49:54.756233 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:49:54.756750 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select olist_dbt.staging.olist.assert_stg_order_items_values_positive_stg_order_items_', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:49:54.924786 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:49:54.925215 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:49:55.045813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a80cefc-f358-4fca-8f64-00b2ef353b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a54a70>]}
[0m17:49:55.083122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a80cefc-f358-4fca-8f64-00b2ef353b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f3d880>]}
[0m17:49:55.084046 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m17:49:55.101381 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:49:55.245194 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:49:55.245599 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:49:55.281913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a80cefc-f358-4fca-8f64-00b2ef353b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10911ea80>]}
[0m17:49:55.373561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a80cefc-f358-4fca-8f64-00b2ef353b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109949f70>]}
[0m17:49:55.374022 [info ] [MainThread]: Found 11 models, 11 data tests, 10 sources, 488 macros
[0m17:49:55.374321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a80cefc-f358-4fca-8f64-00b2ef353b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10912f170>]}
[0m17:49:55.375698 [info ] [MainThread]: 
[0m17:49:55.376148 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:49:55.379258 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_marts'
[0m17:49:55.393447 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m17:49:55.393827 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m17:49:55.394071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:55.397291 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:49:55.398310 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:49:55.922917 [debug] [ThreadPool]: SQL status: SUCCESS in 0.529 seconds
[0m17:49:55.924184 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m17:49:55.924726 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m17:49:56.019586 [debug] [ThreadPool]: SQL status: SUCCESS in 0.094 seconds
[0m17:49:56.022512 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m17:49:56.096798 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m17:49:56.098415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_marts, now list_dev_public_staging)
[0m17:49:56.108898 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:49:56.109724 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m17:49:56.110177 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:49:56.110819 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:49:56.111255 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:49:56.555221 [debug] [ThreadPool]: SQL status: SUCCESS in 0.445 seconds
[0m17:49:56.556233 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:49:56.556853 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m17:49:56.653178 [debug] [ThreadPool]: SQL status: SUCCESS in 0.096 seconds
[0m17:49:56.656239 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m17:49:56.732655 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m17:49:56.749447 [debug] [MainThread]: Using redshift connection "master"
[0m17:49:56.750205 [debug] [MainThread]: On master: BEGIN
[0m17:49:56.750648 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:49:56.751289 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:49:56.751731 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:49:57.192244 [debug] [MainThread]: SQL status: SUCCESS in 0.441 seconds
[0m17:49:57.194291 [debug] [MainThread]: Using redshift connection "master"
[0m17:49:57.195309 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:49:57.336645 [debug] [MainThread]: SQL status: SUCCESS in 0.141 seconds
[0m17:49:57.339023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a80cefc-f358-4fca-8f64-00b2ef353b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c12420>]}
[0m17:49:57.339913 [debug] [MainThread]: On master: ROLLBACK
[0m17:49:57.415971 [debug] [MainThread]: Using redshift connection "master"
[0m17:49:57.416835 [debug] [MainThread]: On master: BEGIN
[0m17:49:57.456041 [debug] [MainThread]: SQL status: SUCCESS in 0.038 seconds
[0m17:49:57.457329 [debug] [MainThread]: On master: COMMIT
[0m17:49:57.458071 [debug] [MainThread]: Using redshift connection "master"
[0m17:49:57.458559 [debug] [MainThread]: On master: COMMIT
[0m17:49:57.534497 [debug] [MainThread]: SQL status: SUCCESS in 0.075 seconds
[0m17:49:57.535250 [debug] [MainThread]: On master: Close
[0m17:49:57.536279 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:49:57.536878 [info ] [MainThread]: 
[0m17:49:57.541518 [debug] [Thread-1 (]: Began running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m17:49:57.542426 [info ] [Thread-1 (]: 1 of 1 START test assert_stg_order_items_values_positive_stg_order_items_ ...... [RUN]
[0m17:49:57.543223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd)
[0m17:49:57.544267 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m17:49:57.561899 [debug] [Thread-1 (]: Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:49:57.562706 [error] [Thread-1 (]: 1 of 1 ERROR assert_stg_order_items_values_positive_stg_order_items_ ........... [[31mERROR[0m in 0.02s]
[0m17:49:57.563543 [debug] [Thread-1 (]: Finished running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m17:49:57.565850 [debug] [MainThread]: Using redshift connection "master"
[0m17:49:57.566540 [debug] [MainThread]: On master: BEGIN
[0m17:49:57.566919 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:49:57.567423 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:49:57.567796 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:49:58.011004 [debug] [MainThread]: SQL status: SUCCESS in 0.444 seconds
[0m17:49:58.012301 [debug] [MainThread]: On master: COMMIT
[0m17:49:58.012959 [debug] [MainThread]: Using redshift connection "master"
[0m17:49:58.013400 [debug] [MainThread]: On master: COMMIT
[0m17:49:58.091887 [debug] [MainThread]: SQL status: SUCCESS in 0.078 seconds
[0m17:49:58.093109 [debug] [MainThread]: On master: Close
[0m17:49:58.094557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:58.095349 [debug] [MainThread]: Connection 'test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd' was properly closed.
[0m17:49:58.095935 [info ] [MainThread]: 
[0m17:49:58.096479 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 2.72 seconds (2.72s).
[0m17:49:58.097422 [debug] [MainThread]: Command end result
[0m17:49:58.144056 [info ] [MainThread]: 
[0m17:49:58.144582 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:49:58.144879 [info ] [MainThread]: 
[0m17:49:58.145229 [error] [MainThread]:   Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:49:58.145507 [info ] [MainThread]: 
[0m17:49:58.145777 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:49:58.147654 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 3.4455454, "process_user_time": 1.729869, "process_kernel_time": 0.343815, "process_mem_max_rss": "123191296", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:49:58.148161 [debug] [MainThread]: Command `dbt test` failed at 17:49:58.148085 after 3.45 seconds
[0m17:49:58.148494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080760c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c12060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109787e30>]}
[0m17:49:58.148776 [debug] [MainThread]: Flushing usage events
[0m17:50:42.945411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082776e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bfcbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bfcb90>]}


============================== 17:50:42.949440 | d4e76c8a-fde5-4a2f-b05f-e09ffde52fdb ==============================
[0m17:50:42.949440 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:50:42.949946 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select olist_dbt.staging.olist.assert_stg_order_items_values_positive_stg_order_items_', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:50:43.117245 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:50:43.117671 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:50:43.244440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4e76c8a-fde5-4a2f-b05f-e09ffde52fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109287b00>]}
[0m17:50:43.282055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4e76c8a-fde5-4a2f-b05f-e09ffde52fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10880daf0>]}
[0m17:50:43.282914 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m17:50:43.299854 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:50:43.446033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:50:43.446437 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:50:43.482897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4e76c8a-fde5-4a2f-b05f-e09ffde52fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10986aa50>]}
[0m17:50:43.575106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4e76c8a-fde5-4a2f-b05f-e09ffde52fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ed3c80>]}
[0m17:50:43.575552 [info ] [MainThread]: Found 11 models, 11 data tests, 10 sources, 488 macros
[0m17:50:43.575847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4e76c8a-fde5-4a2f-b05f-e09ffde52fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109843890>]}
[0m17:50:43.577223 [info ] [MainThread]: 
[0m17:50:43.577669 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:50:43.580831 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_staging'
[0m17:50:43.595914 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:50:43.596373 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m17:50:43.596614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:43.599738 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:50:43.600450 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:50:45.532824 [debug] [ThreadPool]: SQL status: SUCCESS in 1.936 seconds
[0m17:50:45.535087 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:50:45.536224 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m17:50:46.402531 [debug] [ThreadPool]: SQL status: SUCCESS in 0.865 seconds
[0m17:50:46.409155 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m17:50:46.984556 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m17:50:46.987884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_staging, now list_dev_public_marts)
[0m17:50:47.001071 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m17:50:47.001808 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m17:50:47.002264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:47.002933 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:50:47.003376 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:50:48.445239 [debug] [ThreadPool]: SQL status: SUCCESS in 1.443 seconds
[0m17:50:48.447242 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m17:50:48.448376 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m17:50:48.679779 [debug] [ThreadPool]: SQL status: SUCCESS in 0.230 seconds
[0m17:50:48.684875 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m17:50:48.872537 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m17:50:48.891282 [debug] [MainThread]: Using redshift connection "master"
[0m17:50:48.891906 [debug] [MainThread]: On master: BEGIN
[0m17:50:48.892481 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:50:48.893046 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:50:48.893412 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:50:50.243096 [debug] [MainThread]: SQL status: SUCCESS in 1.350 seconds
[0m17:50:50.244560 [debug] [MainThread]: Using redshift connection "master"
[0m17:50:50.245688 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:50:50.436641 [debug] [MainThread]: SQL status: SUCCESS in 0.189 seconds
[0m17:50:50.441258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4e76c8a-fde5-4a2f-b05f-e09ffde52fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10986a6f0>]}
[0m17:50:50.442761 [debug] [MainThread]: On master: ROLLBACK
[0m17:50:51.388435 [debug] [MainThread]: Using redshift connection "master"
[0m17:50:51.390275 [debug] [MainThread]: On master: BEGIN
[0m17:50:51.517751 [debug] [MainThread]: SQL status: SUCCESS in 0.126 seconds
[0m17:50:51.519449 [debug] [MainThread]: On master: COMMIT
[0m17:50:51.520682 [debug] [MainThread]: Using redshift connection "master"
[0m17:50:51.521616 [debug] [MainThread]: On master: COMMIT
[0m17:50:51.710332 [debug] [MainThread]: SQL status: SUCCESS in 0.188 seconds
[0m17:50:51.712319 [debug] [MainThread]: On master: Close
[0m17:50:51.714363 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:50:51.715076 [info ] [MainThread]: 
[0m17:50:51.719972 [debug] [Thread-1 (]: Began running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m17:50:51.721113 [info ] [Thread-1 (]: 1 of 1 START test assert_stg_order_items_values_positive_stg_order_items_ ...... [RUN]
[0m17:50:51.722097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_marts, now test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd)
[0m17:50:51.722697 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m17:50:51.738852 [debug] [Thread-1 (]: Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:50:51.739700 [error] [Thread-1 (]: 1 of 1 ERROR assert_stg_order_items_values_positive_stg_order_items_ ........... [[31mERROR[0m in 0.02s]
[0m17:50:51.740367 [debug] [Thread-1 (]: Finished running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m17:50:51.742343 [debug] [MainThread]: Using redshift connection "master"
[0m17:50:51.743120 [debug] [MainThread]: On master: BEGIN
[0m17:50:51.743938 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:50:51.744530 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:50:51.744861 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:50:53.026146 [debug] [MainThread]: SQL status: SUCCESS in 1.282 seconds
[0m17:50:53.028101 [debug] [MainThread]: On master: COMMIT
[0m17:50:53.029470 [debug] [MainThread]: Using redshift connection "master"
[0m17:50:53.030426 [debug] [MainThread]: On master: COMMIT
[0m17:50:53.305534 [debug] [MainThread]: SQL status: SUCCESS in 0.274 seconds
[0m17:50:53.306819 [debug] [MainThread]: On master: Close
[0m17:50:53.307974 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:53.308405 [debug] [MainThread]: Connection 'test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd' was properly closed.
[0m17:50:53.309159 [info ] [MainThread]: 
[0m17:50:53.309976 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 9.73 seconds (9.73s).
[0m17:50:53.311192 [debug] [MainThread]: Command end result
[0m17:50:53.359056 [info ] [MainThread]: 
[0m17:50:53.359528 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:50:53.359820 [info ] [MainThread]: 
[0m17:50:53.360173 [error] [MainThread]:   Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:50:53.360439 [info ] [MainThread]: 
[0m17:50:53.360712 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:50:53.362531 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 10.468466, "process_user_time": 1.785951, "process_kernel_time": 0.362254, "process_mem_max_rss": "122912768", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:50:53.363004 [debug] [MainThread]: Command `dbt test` failed at 17:50:53.362929 after 10.47 seconds
[0m17:50:53.363324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108af37a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e96270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d4bf80>]}
[0m17:50:53.363627 [debug] [MainThread]: Flushing usage events
[0m17:51:34.442513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040047a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106003e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106003a10>]}


============================== 17:51:34.446647 | 6688d4ff-8559-4c76-a9d5-4214afaf2a96 ==============================
[0m17:51:34.446647 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:51:34.447156 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m17:51:34.564936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6688d4ff-8559-4c76-a9d5-4214afaf2a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102809b50>]}
[0m17:51:34.597416 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20644005, "process_user_time": 1.01611, "process_kernel_time": 0.202513, "process_mem_max_rss": "95141888", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:51:34.597983 [debug] [MainThread]: Command `dbt clean` succeeded at 17:51:34.597904 after 0.21 seconds
[0m17:51:34.598300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060037d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106113860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061125a0>]}
[0m17:51:34.598589 [debug] [MainThread]: Flushing usage events
[0m17:51:39.140390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab3a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bc0a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bc2540>]}


============================== 17:51:39.144298 | 790879e7-83a1-4a46-ac27-7f0199181284 ==============================
[0m17:51:39.144298 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:51:39.144828 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select olist_dbt.staging.olist.assert_stg_order_items_values_positive_stg_order_items_', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:51:39.311907 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:51:39.312326 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:51:39.438077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '790879e7-83a1-4a46-ac27-7f0199181284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075cd700>]}
[0m17:51:39.475586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '790879e7-83a1-4a46-ac27-7f0199181284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f3c590>]}
[0m17:51:39.476456 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m17:51:39.492300 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:51:39.493643 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:51:39.494150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '790879e7-83a1-4a46-ac27-7f0199181284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093fb3e0>]}
[0m17:51:40.641252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '790879e7-83a1-4a46-ac27-7f0199181284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109db87a0>]}
[0m17:51:40.735189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '790879e7-83a1-4a46-ac27-7f0199181284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d75040>]}
[0m17:51:40.735630 [info ] [MainThread]: Found 11 models, 11 data tests, 10 sources, 488 macros
[0m17:51:40.735922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '790879e7-83a1-4a46-ac27-7f0199181284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109db9a30>]}
[0m17:51:40.737211 [info ] [MainThread]: 
[0m17:51:40.737640 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:51:40.740764 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_staging'
[0m17:51:40.754138 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:51:40.754543 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m17:51:40.754780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:40.757896 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:51:40.758627 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:51:42.776046 [debug] [ThreadPool]: SQL status: SUCCESS in 2.021 seconds
[0m17:51:42.778183 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:51:42.779468 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m17:51:43.065084 [debug] [ThreadPool]: SQL status: SUCCESS in 0.284 seconds
[0m17:51:43.070128 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m17:51:43.611773 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m17:51:43.614482 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_staging, now list_dev_public_marts)
[0m17:51:43.625618 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m17:51:43.626362 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m17:51:43.626797 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:43.627463 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:51:43.627916 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:51:44.420030 [debug] [ThreadPool]: SQL status: SUCCESS in 0.793 seconds
[0m17:51:44.422020 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m17:51:44.423161 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m17:51:45.661630 [debug] [ThreadPool]: SQL status: SUCCESS in 1.237 seconds
[0m17:51:45.667469 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m17:51:45.857098 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m17:51:45.881070 [debug] [MainThread]: Using redshift connection "master"
[0m17:51:45.881748 [debug] [MainThread]: On master: BEGIN
[0m17:51:45.882118 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:51:45.882636 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:51:45.882998 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:51:47.055405 [debug] [MainThread]: SQL status: SUCCESS in 1.173 seconds
[0m17:51:47.057126 [debug] [MainThread]: Using redshift connection "master"
[0m17:51:47.058336 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:51:47.252346 [debug] [MainThread]: SQL status: SUCCESS in 0.193 seconds
[0m17:51:47.257471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '790879e7-83a1-4a46-ac27-7f0199181284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a073f80>]}
[0m17:51:47.258971 [debug] [MainThread]: On master: ROLLBACK
[0m17:51:47.391757 [debug] [MainThread]: Using redshift connection "master"
[0m17:51:47.393600 [debug] [MainThread]: On master: BEGIN
[0m17:51:47.459602 [debug] [MainThread]: SQL status: SUCCESS in 0.065 seconds
[0m17:51:47.461214 [debug] [MainThread]: On master: COMMIT
[0m17:51:47.462520 [debug] [MainThread]: Using redshift connection "master"
[0m17:51:47.463465 [debug] [MainThread]: On master: COMMIT
[0m17:51:47.681649 [debug] [MainThread]: SQL status: SUCCESS in 0.217 seconds
[0m17:51:47.683715 [debug] [MainThread]: On master: Close
[0m17:51:47.685728 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:51:47.686848 [info ] [MainThread]: 
[0m17:51:47.692669 [debug] [Thread-1 (]: Began running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m17:51:47.693737 [info ] [Thread-1 (]: 1 of 1 START test assert_stg_order_items_values_positive_stg_order_items_ ...... [RUN]
[0m17:51:47.694615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_marts, now test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd)
[0m17:51:47.695584 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m17:51:47.708728 [debug] [Thread-1 (]: Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:51:47.709575 [error] [Thread-1 (]: 1 of 1 ERROR assert_stg_order_items_values_positive_stg_order_items_ ........... [[31mERROR[0m in 0.02s]
[0m17:51:47.710296 [debug] [Thread-1 (]: Finished running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m17:51:47.712391 [debug] [MainThread]: Using redshift connection "master"
[0m17:51:47.712859 [debug] [MainThread]: On master: BEGIN
[0m17:51:47.713190 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:51:47.713671 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:51:47.714023 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:51:48.796576 [debug] [MainThread]: SQL status: SUCCESS in 1.083 seconds
[0m17:51:48.797193 [debug] [MainThread]: On master: COMMIT
[0m17:51:48.797578 [debug] [MainThread]: Using redshift connection "master"
[0m17:51:48.797844 [debug] [MainThread]: On master: COMMIT
[0m17:51:49.345592 [debug] [MainThread]: SQL status: SUCCESS in 0.547 seconds
[0m17:51:49.347050 [debug] [MainThread]: On master: Close
[0m17:51:49.349017 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:49.349626 [debug] [MainThread]: Connection 'test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd' was properly closed.
[0m17:51:49.350300 [info ] [MainThread]: 
[0m17:51:49.350957 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 8.61 seconds (8.61s).
[0m17:51:49.352124 [debug] [MainThread]: Command end result
[0m17:51:49.397113 [info ] [MainThread]: 
[0m17:51:49.397603 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:51:49.397896 [info ] [MainThread]: 
[0m17:51:49.398249 [error] [MainThread]:   Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:51:49.398526 [info ] [MainThread]: 
[0m17:51:49.398823 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:51:49.400990 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 10.312464, "process_user_time": 2.74454, "process_kernel_time": 0.37748, "process_mem_max_rss": "127205376", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:51:49.401467 [debug] [MainThread]: Command `dbt test` failed at 17:51:49.401394 after 10.31 seconds
[0m17:51:49.401810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087cfe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cf9ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d321b0>]}
[0m17:51:49.402123 [debug] [MainThread]: Flushing usage events
[0m17:52:03.942514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e20c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d04b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d04aa0>]}


============================== 17:52:03.946365 | 0ba1bc95-b902-4e8b-b00c-ba95f8c87b9f ==============================
[0m17:52:03.946365 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:52:03.946882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --select olist_dbt.staging.olist.assert_stg_order_items_values_positive_stg_order_items_', 'send_anonymous_usage_stats': 'True'}
[0m17:52:04.111710 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:52:04.112139 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:52:04.237258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ba1bc95-b902-4e8b-b00c-ba95f8c87b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104715af0>]}
[0m17:52:04.275655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ba1bc95-b902-4e8b-b00c-ba95f8c87b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064be4e0>]}
[0m17:52:04.276562 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m17:52:04.292519 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:52:04.434321 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:52:04.434719 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:52:04.470783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ba1bc95-b902-4e8b-b00c-ba95f8c87b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10694f230>]}
[0m17:52:04.561810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ba1bc95-b902-4e8b-b00c-ba95f8c87b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10718ad80>]}
[0m17:52:04.562249 [info ] [MainThread]: Found 11 models, 11 data tests, 10 sources, 488 macros
[0m17:52:04.562539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ba1bc95-b902-4e8b-b00c-ba95f8c87b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106972ff0>]}
[0m17:52:04.563887 [info ] [MainThread]: 
[0m17:52:04.564342 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:52:04.567461 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_marts'
[0m17:52:04.582317 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m17:52:04.582726 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m17:52:04.582970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:04.586068 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:52:04.586773 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:52:05.133744 [debug] [ThreadPool]: SQL status: SUCCESS in 0.550 seconds
[0m17:52:05.135934 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m17:52:05.136928 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m17:52:05.233322 [debug] [ThreadPool]: SQL status: SUCCESS in 0.095 seconds
[0m17:52:05.237979 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m17:52:05.313540 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m17:52:05.316727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_marts, now list_dev_public_staging)
[0m17:52:05.328754 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:52:05.329497 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m17:52:05.329967 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:52:05.330615 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:52:05.331106 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:52:05.751975 [debug] [ThreadPool]: SQL status: SUCCESS in 0.422 seconds
[0m17:52:05.753744 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:52:05.754871 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m17:52:05.849266 [debug] [ThreadPool]: SQL status: SUCCESS in 0.093 seconds
[0m17:52:05.855089 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m17:52:05.926952 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m17:52:05.945806 [debug] [MainThread]: Using redshift connection "master"
[0m17:52:05.946474 [debug] [MainThread]: On master: BEGIN
[0m17:52:05.946858 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:52:05.947358 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:52:05.947712 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:52:06.368320 [debug] [MainThread]: SQL status: SUCCESS in 0.421 seconds
[0m17:52:06.370086 [debug] [MainThread]: Using redshift connection "master"
[0m17:52:06.371260 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:52:06.507950 [debug] [MainThread]: SQL status: SUCCESS in 0.135 seconds
[0m17:52:06.513265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ba1bc95-b902-4e8b-b00c-ba95f8c87b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065489e0>]}
[0m17:52:06.514834 [debug] [MainThread]: On master: ROLLBACK
[0m17:52:06.586139 [debug] [MainThread]: Using redshift connection "master"
[0m17:52:06.587271 [debug] [MainThread]: On master: BEGIN
[0m17:52:06.623315 [debug] [MainThread]: SQL status: SUCCESS in 0.035 seconds
[0m17:52:06.624377 [debug] [MainThread]: On master: COMMIT
[0m17:52:06.625465 [debug] [MainThread]: Using redshift connection "master"
[0m17:52:06.626348 [debug] [MainThread]: On master: COMMIT
[0m17:52:06.699663 [debug] [MainThread]: SQL status: SUCCESS in 0.072 seconds
[0m17:52:06.700891 [debug] [MainThread]: On master: Close
[0m17:52:06.702796 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:52:06.703643 [info ] [MainThread]: 
[0m17:52:06.708933 [debug] [Thread-1 (]: Began running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m17:52:06.710212 [info ] [Thread-1 (]: 1 of 1 START test assert_stg_order_items_values_positive_stg_order_items_ ...... [RUN]
[0m17:52:06.711335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd)
[0m17:52:06.712094 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m17:52:06.729406 [debug] [Thread-1 (]: Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:52:06.730209 [error] [Thread-1 (]: 1 of 1 ERROR assert_stg_order_items_values_positive_stg_order_items_ ........... [[31mERROR[0m in 0.02s]
[0m17:52:06.730873 [debug] [Thread-1 (]: Finished running node test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd
[0m17:52:06.733387 [debug] [MainThread]: Using redshift connection "master"
[0m17:52:06.733829 [debug] [MainThread]: On master: BEGIN
[0m17:52:06.734152 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:52:06.734644 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:52:06.734961 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:52:07.172623 [debug] [MainThread]: SQL status: SUCCESS in 0.438 seconds
[0m17:52:07.174533 [debug] [MainThread]: On master: COMMIT
[0m17:52:07.175939 [debug] [MainThread]: Using redshift connection "master"
[0m17:52:07.176926 [debug] [MainThread]: On master: COMMIT
[0m17:52:07.252469 [debug] [MainThread]: SQL status: SUCCESS in 0.075 seconds
[0m17:52:07.253968 [debug] [MainThread]: On master: Close
[0m17:52:07.255415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:52:07.256056 [debug] [MainThread]: Connection 'test.olist_dbt.assert_stg_order_items_values_positive_stg_order_items_.6880928cbd' was properly closed.
[0m17:52:07.256722 [info ] [MainThread]: 
[0m17:52:07.257410 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 2.69 seconds (2.69s).
[0m17:52:07.258601 [debug] [MainThread]: Command end result
[0m17:52:07.304630 [info ] [MainThread]: 
[0m17:52:07.305094 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:52:07.305383 [info ] [MainThread]: 
[0m17:52:07.305732 [error] [MainThread]:   Compilation Error in test assert_stg_order_items_values_positive_stg_order_items_ (models/staging/olist/stg_olist.yml)
  'test_assert_stg_order_items_values_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:52:07.306008 [info ] [MainThread]: 
[0m17:52:07.306292 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:52:07.308154 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 3.4163895, "process_user_time": 1.752783, "process_kernel_time": 0.350555, "process_mem_max_rss": "121995264", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:52:07.308644 [debug] [MainThread]: Command `dbt test` failed at 17:52:07.308570 after 3.42 seconds
[0m17:52:07.308970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e20c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e53f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107037950>]}
[0m17:52:07.309264 [debug] [MainThread]: Flushing usage events
[0m17:52:14.726911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031776e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104828920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048288c0>]}


============================== 17:52:14.731100 | 7d6f1022-992b-4c00-af39-8d27ffc8e4fb ==============================
[0m17:52:14.731100 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:52:14.731619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select olist_dbt.staging.olist.assert_stg_order_items_values_positive_stg_order_items', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:52:14.898413 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:52:14.898846 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:52:15.022422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d6f1022-992b-4c00-af39-8d27ffc8e4fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066042c0>]}
[0m17:52:15.092087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d6f1022-992b-4c00-af39-8d27ffc8e4fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c40fe0>]}
[0m17:52:15.093095 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m17:52:15.110168 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:52:15.278418 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:52:15.278827 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:52:15.315031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d6f1022-992b-4c00-af39-8d27ffc8e4fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a37d0>]}
[0m17:52:15.407682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d6f1022-992b-4c00-af39-8d27ffc8e4fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a99a90>]}
[0m17:52:15.408133 [info ] [MainThread]: Found 11 models, 11 data tests, 10 sources, 488 macros
[0m17:52:15.408425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d6f1022-992b-4c00-af39-8d27ffc8e4fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10662e600>]}
[0m17:52:15.409029 [warn ] [MainThread]: The selection criterion 'olist_dbt.staging.olist.assert_stg_order_items_values_positive_stg_order_items' does not match any enabled nodes
[0m17:52:15.409992 [info ] [MainThread]: 
[0m17:52:15.410261 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:52:15.411603 [debug] [MainThread]: Command end result
[0m17:52:15.437448 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.7615941, "process_user_time": 1.428447, "process_kernel_time": 0.341576, "process_mem_max_rss": "116883456", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:52:15.437993 [debug] [MainThread]: Command `dbt test` succeeded at 17:52:15.437918 after 0.76 seconds
[0m17:52:15.438332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100bb6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d062d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106607fb0>]}
[0m17:52:15.438612 [debug] [MainThread]: Flushing usage events
[0m17:52:59.430743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fb32c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a2f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aac2f0>]}


============================== 17:52:59.434583 | 54456292-c01d-499d-9a8b-118f01eb37be ==============================
[0m17:52:59.434583 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:52:59.435070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'profiles_dir': '/Users/eranola/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt list --resource-type test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:52:59.601457 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:52:59.601871 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:52:59.726041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54456292-c01d-499d-9a8b-118f01eb37be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c8a4e0>]}
[0m17:52:59.763754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54456292-c01d-499d-9a8b-118f01eb37be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046447a0>]}
[0m17:52:59.764599 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m17:52:59.781311 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:52:59.924846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:52:59.925228 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:52:59.961422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54456292-c01d-499d-9a8b-118f01eb37be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055a8380>]}
[0m17:53:00.052373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54456292-c01d-499d-9a8b-118f01eb37be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c95df0>]}
[0m17:53:00.054887 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.67489433, "process_user_time": 1.343764, "process_kernel_time": 0.258897, "process_mem_max_rss": "114688000", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:53:00.055400 [debug] [MainThread]: Command `dbt list` succeeded at 17:53:00.055313 after 0.68 seconds
[0m17:53:00.055733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050ce360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b79970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105546b10>]}
[0m17:53:00.056011 [debug] [MainThread]: Flushing usage events
[0m17:53:40.756766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046c5640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051dc980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051dc890>]}


============================== 17:53:40.760742 | dda695d0-78b5-4aaf-8c47-7ebfd33c0096 ==============================
[0m17:53:40.760742 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:53:40.761235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select olist_dbt.assert_stg_order_items_values_positive', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:53:40.927639 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:53:40.928047 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:53:41.053360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dda695d0-78b5-4aaf-8c47-7ebfd33c0096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e7c20>]}
[0m17:53:41.090658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dda695d0-78b5-4aaf-8c47-7ebfd33c0096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10539d010>]}
[0m17:53:41.091533 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m17:53:41.107536 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:53:41.253133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:53:41.253544 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:53:41.289953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dda695d0-78b5-4aaf-8c47-7ebfd33c0096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e479b0>]}
[0m17:53:41.381770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dda695d0-78b5-4aaf-8c47-7ebfd33c0096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10766a8d0>]}
[0m17:53:41.382208 [info ] [MainThread]: Found 11 models, 11 data tests, 10 sources, 488 macros
[0m17:53:41.382500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dda695d0-78b5-4aaf-8c47-7ebfd33c0096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10603f3e0>]}
[0m17:53:41.383850 [info ] [MainThread]: 
[0m17:53:41.384289 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:53:41.387441 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_staging'
[0m17:53:41.402595 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:53:41.403000 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m17:53:41.403236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:41.406284 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:53:41.407023 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:53:43.626369 [debug] [ThreadPool]: SQL status: SUCCESS in 2.223 seconds
[0m17:53:43.628369 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:53:43.629546 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m17:53:43.832637 [debug] [ThreadPool]: SQL status: SUCCESS in 0.202 seconds
[0m17:53:43.838596 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m17:53:43.973871 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m17:53:43.976884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_staging, now list_dev_public_marts)
[0m17:53:43.990214 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m17:53:43.990957 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m17:53:43.991424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:53:43.992101 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:53:43.992559 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:53:45.781949 [debug] [ThreadPool]: SQL status: SUCCESS in 1.790 seconds
[0m17:53:45.783751 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m17:53:45.784922 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m17:53:46.424472 [debug] [ThreadPool]: SQL status: SUCCESS in 0.638 seconds
[0m17:53:46.428912 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m17:53:46.987830 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m17:53:47.004308 [debug] [MainThread]: Using redshift connection "master"
[0m17:53:47.005070 [debug] [MainThread]: On master: BEGIN
[0m17:53:47.005763 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:53:47.006383 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:53:47.006746 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:53:49.498728 [debug] [MainThread]: SQL status: SUCCESS in 2.493 seconds
[0m17:53:49.500662 [debug] [MainThread]: Using redshift connection "master"
[0m17:53:49.501940 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:53:49.766875 [debug] [MainThread]: SQL status: SUCCESS in 0.263 seconds
[0m17:53:49.771842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dda695d0-78b5-4aaf-8c47-7ebfd33c0096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dec830>]}
[0m17:53:49.773286 [debug] [MainThread]: On master: ROLLBACK
[0m17:53:49.902094 [debug] [MainThread]: Using redshift connection "master"
[0m17:53:49.903210 [debug] [MainThread]: On master: BEGIN
[0m17:53:50.068003 [debug] [MainThread]: SQL status: SUCCESS in 0.164 seconds
[0m17:53:50.069317 [debug] [MainThread]: On master: COMMIT
[0m17:53:50.070341 [debug] [MainThread]: Using redshift connection "master"
[0m17:53:50.070982 [debug] [MainThread]: On master: COMMIT
[0m17:53:51.102254 [debug] [MainThread]: SQL status: SUCCESS in 1.031 seconds
[0m17:53:51.103588 [debug] [MainThread]: On master: Close
[0m17:53:51.104849 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:53:51.105647 [info ] [MainThread]: 
[0m17:53:51.108767 [debug] [Thread-1 (]: Began running node test.olist_dbt.assert_stg_order_items_values_positive
[0m17:53:51.109551 [info ] [Thread-1 (]: 1 of 1 START test assert_stg_order_items_values_positive ....................... [RUN]
[0m17:53:51.110183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_marts, now test.olist_dbt.assert_stg_order_items_values_positive)
[0m17:53:51.110683 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.assert_stg_order_items_values_positive
[0m17:53:51.115059 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.assert_stg_order_items_values_positive"
[0m17:53:51.116883 [debug] [Thread-1 (]: Began executing node test.olist_dbt.assert_stg_order_items_values_positive
[0m17:53:51.131237 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.assert_stg_order_items_values_positive"
[0m17:53:51.134120 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.assert_stg_order_items_values_positive"
[0m17:53:51.134490 [debug] [Thread-1 (]: On test.olist_dbt.assert_stg_order_items_values_positive: BEGIN
[0m17:53:51.134758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:51.135141 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:53:51.135414 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:53:53.891125 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.756 seconds
[0m17:53:53.893519 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.assert_stg_order_items_values_positive"
[0m17:53:53.894826 [debug] [Thread-1 (]: On test.olist_dbt.assert_stg_order_items_values_positive: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.assert_stg_order_items_values_positive"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      WITH order_items AS (

    SELECT  *
    FROM "dev"."public_staging"."stg_order_items"

)

SELECT  order_id,
        SUM(price) AS total_value
FROM order_items
GROUP BY 1
HAVING total_value < 0
      
    ) dbt_internal_test
[0m17:53:54.094382 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.198 seconds
[0m17:53:54.107278 [debug] [Thread-1 (]: On test.olist_dbt.assert_stg_order_items_values_positive: ROLLBACK
[0m17:53:54.235942 [debug] [Thread-1 (]: On test.olist_dbt.assert_stg_order_items_values_positive: Close
[0m17:53:54.238789 [info ] [Thread-1 (]: 1 of 1 PASS assert_stg_order_items_values_positive ............................. [[32mPASS[0m in 3.13s]
[0m17:53:54.240010 [debug] [Thread-1 (]: Finished running node test.olist_dbt.assert_stg_order_items_values_positive
[0m17:53:54.242437 [debug] [MainThread]: Using redshift connection "master"
[0m17:53:54.243279 [debug] [MainThread]: On master: BEGIN
[0m17:53:54.243832 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:53:54.244611 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:53:54.245090 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:53:55.262067 [debug] [MainThread]: SQL status: SUCCESS in 1.018 seconds
[0m17:53:55.263056 [debug] [MainThread]: On master: COMMIT
[0m17:53:55.263795 [debug] [MainThread]: Using redshift connection "master"
[0m17:53:55.264355 [debug] [MainThread]: On master: COMMIT
[0m17:53:55.475452 [debug] [MainThread]: SQL status: SUCCESS in 0.210 seconds
[0m17:53:55.476867 [debug] [MainThread]: On master: Close
[0m17:53:55.478924 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:53:55.479707 [debug] [MainThread]: Connection 'test.olist_dbt.assert_stg_order_items_values_positive' was properly closed.
[0m17:53:55.480547 [info ] [MainThread]: 
[0m17:53:55.481348 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 14.10 seconds (14.10s).
[0m17:53:55.482736 [debug] [MainThread]: Command end result
[0m17:53:55.530729 [info ] [MainThread]: 
[0m17:53:55.531276 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:53:55.531570 [info ] [MainThread]: 
[0m17:53:55.531861 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:53:55.534009 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 14.828322, "process_user_time": 1.864231, "process_kernel_time": 0.362515, "process_mem_max_rss": "124567552", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:53:55.534516 [debug] [MainThread]: Command `dbt test` succeeded at 17:53:55.534445 after 14.83 seconds
[0m17:53:55.534837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046c5640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d22cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10632bb60>]}
[0m17:53:55.535135 [debug] [MainThread]: Flushing usage events
[0m17:54:19.633567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b10230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b68500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b680b0>]}


============================== 17:54:19.637412 | 1bde8149-898f-4e5f-8323-eeffe3d86e1a ==============================
[0m17:54:19.637412 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:54:19.637908 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/eranola/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt list --resource-type test', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:54:19.804994 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:54:19.805434 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:54:19.932715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bde8149-898f-4e5f-8323-eeffe3d86e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f12630>]}
[0m17:54:19.969806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1bde8149-898f-4e5f-8323-eeffe3d86e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083077d0>]}
[0m17:54:19.970824 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m17:54:19.987212 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:54:20.134206 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:54:20.134943 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/stg_olist.yml
[0m17:54:20.333675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bde8149-898f-4e5f-8323-eeffe3d86e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0f0d10>]}
[0m17:54:20.424213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bde8149-898f-4e5f-8323-eeffe3d86e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083a0a70>]}
[0m17:54:20.426729 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.8439587, "process_user_time": 1.491049, "process_kernel_time": 0.273124, "process_mem_max_rss": "119799808", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:54:20.427235 [debug] [MainThread]: Command `dbt list` succeeded at 17:54:20.427153 after 0.84 seconds
[0m17:54:20.427554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dae7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0f0470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c9f8f0>]}
[0m17:54:20.427825 [debug] [MainThread]: Flushing usage events
[0m17:54:36.650520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053414f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105364830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105364800>]}


============================== 17:54:36.654497 | 9b86537e-890d-484d-94b5-9949ac09175d ==============================
[0m17:54:36.654497 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:54:36.655012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select olist_dbt.assert_stg_order_items_values_positive', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:54:36.822878 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:54:36.823302 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:54:36.947469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b86537e-890d-484d-94b5-9949ac09175d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d719d0>]}
[0m17:54:36.984236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b86537e-890d-484d-94b5-9949ac09175d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064b3cb0>]}
[0m17:54:36.985043 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m17:54:37.001426 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:54:37.143075 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:54:37.143473 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:54:37.179873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b86537e-890d-484d-94b5-9949ac09175d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f721e0>]}
[0m17:54:37.272037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b86537e-890d-484d-94b5-9949ac09175d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077f1670>]}
[0m17:54:37.272480 [info ] [MainThread]: Found 11 models, 10 data tests, 10 sources, 488 macros
[0m17:54:37.272772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b86537e-890d-484d-94b5-9949ac09175d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f72690>]}
[0m17:54:37.274120 [info ] [MainThread]: 
[0m17:54:37.274571 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:54:37.277753 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_staging'
[0m17:54:37.292585 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:54:37.293008 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m17:54:37.293249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:37.296785 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:54:37.297590 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:54:39.340353 [debug] [ThreadPool]: SQL status: SUCCESS in 2.047 seconds
[0m17:54:39.342444 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:54:39.343530 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m17:54:39.641062 [debug] [ThreadPool]: SQL status: SUCCESS in 0.296 seconds
[0m17:54:39.646700 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m17:54:39.943470 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m17:54:39.946150 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_staging, now list_dev_public_marts)
[0m17:54:39.960270 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m17:54:39.960905 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m17:54:39.961369 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:39.962019 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:54:39.962477 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:54:41.555823 [debug] [ThreadPool]: SQL status: SUCCESS in 1.594 seconds
[0m17:54:41.557554 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m17:54:41.558652 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m17:54:41.775006 [debug] [ThreadPool]: SQL status: SUCCESS in 0.215 seconds
[0m17:54:41.780692 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m17:54:42.366571 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m17:54:42.373855 [debug] [MainThread]: Using redshift connection "master"
[0m17:54:42.374173 [debug] [MainThread]: On master: BEGIN
[0m17:54:42.374530 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:54:42.374865 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:54:42.375096 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:54:43.148703 [debug] [MainThread]: SQL status: SUCCESS in 0.774 seconds
[0m17:54:43.150477 [debug] [MainThread]: Using redshift connection "master"
[0m17:54:43.151694 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:54:43.737000 [debug] [MainThread]: SQL status: SUCCESS in 0.584 seconds
[0m17:54:43.738859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b86537e-890d-484d-94b5-9949ac09175d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ddd880>]}
[0m17:54:43.739465 [debug] [MainThread]: On master: ROLLBACK
[0m17:54:43.962350 [debug] [MainThread]: Using redshift connection "master"
[0m17:54:43.963542 [debug] [MainThread]: On master: BEGIN
[0m17:54:44.451679 [debug] [MainThread]: SQL status: SUCCESS in 0.487 seconds
[0m17:54:44.453314 [debug] [MainThread]: On master: COMMIT
[0m17:54:44.454214 [debug] [MainThread]: Using redshift connection "master"
[0m17:54:44.454791 [debug] [MainThread]: On master: COMMIT
[0m17:54:44.708817 [debug] [MainThread]: SQL status: SUCCESS in 0.253 seconds
[0m17:54:44.710561 [debug] [MainThread]: On master: Close
[0m17:54:44.711999 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:54:44.712590 [info ] [MainThread]: 
[0m17:54:44.717433 [debug] [Thread-1 (]: Began running node test.olist_dbt.assert_stg_order_items_values_positive
[0m17:54:44.719385 [info ] [Thread-1 (]: 1 of 1 START test assert_stg_order_items_values_positive ....................... [RUN]
[0m17:54:44.720645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_marts, now test.olist_dbt.assert_stg_order_items_values_positive)
[0m17:54:44.721456 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.assert_stg_order_items_values_positive
[0m17:54:44.726114 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.assert_stg_order_items_values_positive"
[0m17:54:44.728052 [debug] [Thread-1 (]: Began executing node test.olist_dbt.assert_stg_order_items_values_positive
[0m17:54:44.748462 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.assert_stg_order_items_values_positive"
[0m17:54:44.751314 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.assert_stg_order_items_values_positive"
[0m17:54:44.751755 [debug] [Thread-1 (]: On test.olist_dbt.assert_stg_order_items_values_positive: BEGIN
[0m17:54:44.752101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:44.752580 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:54:44.752933 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:54:46.603358 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.851 seconds
[0m17:54:46.605350 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.assert_stg_order_items_values_positive"
[0m17:54:46.606791 [debug] [Thread-1 (]: On test.olist_dbt.assert_stg_order_items_values_positive: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.assert_stg_order_items_values_positive"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      WITH order_items AS (

    SELECT  *
    FROM "dev"."public_staging"."stg_order_items"

)

SELECT  order_id,
        SUM(price) AS total_value
FROM order_items
GROUP BY 1
HAVING total_value < 0
      
    ) dbt_internal_test
[0m17:54:46.933038 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.325 seconds
[0m17:54:46.944032 [debug] [Thread-1 (]: On test.olist_dbt.assert_stg_order_items_values_positive: ROLLBACK
[0m17:54:47.800917 [debug] [Thread-1 (]: On test.olist_dbt.assert_stg_order_items_values_positive: Close
[0m17:54:47.804141 [info ] [Thread-1 (]: 1 of 1 PASS assert_stg_order_items_values_positive ............................. [[32mPASS[0m in 3.08s]
[0m17:54:47.806132 [debug] [Thread-1 (]: Finished running node test.olist_dbt.assert_stg_order_items_values_positive
[0m17:54:47.808341 [debug] [MainThread]: Using redshift connection "master"
[0m17:54:47.808998 [debug] [MainThread]: On master: BEGIN
[0m17:54:47.810050 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:54:47.810938 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:54:47.811528 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:54:50.503498 [debug] [MainThread]: SQL status: SUCCESS in 2.693 seconds
[0m17:54:50.504289 [debug] [MainThread]: On master: COMMIT
[0m17:54:50.504897 [debug] [MainThread]: Using redshift connection "master"
[0m17:54:50.505328 [debug] [MainThread]: On master: COMMIT
[0m17:54:50.757104 [debug] [MainThread]: SQL status: SUCCESS in 0.251 seconds
[0m17:54:50.758454 [debug] [MainThread]: On master: Close
[0m17:54:50.760233 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:50.760847 [debug] [MainThread]: Connection 'test.olist_dbt.assert_stg_order_items_values_positive' was properly closed.
[0m17:54:50.761318 [info ] [MainThread]: 
[0m17:54:50.761917 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 13.49 seconds (13.49s).
[0m17:54:50.762989 [debug] [MainThread]: Command end result
[0m17:54:50.813109 [info ] [MainThread]: 
[0m17:54:50.813614 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:54:50.813919 [info ] [MainThread]: 
[0m17:54:50.814218 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:54:50.815999 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 14.216388, "process_user_time": 1.848598, "process_kernel_time": 0.360056, "process_mem_max_rss": "123633664", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:54:50.816509 [debug] [MainThread]: Command `dbt test` succeeded at 17:54:50.816433 after 14.22 seconds
[0m17:54:50.816834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc8170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064b3710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064b3fe0>]}
[0m17:54:50.817129 [debug] [MainThread]: Flushing usage events
[0m17:55:03.783310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e22a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106288f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106288c0>]}


============================== 17:55:03.787075 | fd27f9b7-f12a-48b1-88c0-31832b6ab1a7 ==============================
[0m17:55:03.787075 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:55:03.787590 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'profiles_dir': '/Users/eranola/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:55:03.952896 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:55:03.953361 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:55:04.078436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd27f9b7-f12a-48b1-88c0-31832b6ab1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f398b0>]}
[0m17:55:04.116275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd27f9b7-f12a-48b1-88c0-31832b6ab1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d33770>]}
[0m17:55:04.117201 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m17:55:04.133714 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m17:55:04.275210 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:55:04.275589 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:55:04.311754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd27f9b7-f12a-48b1-88c0-31832b6ab1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113588650>]}
[0m17:55:04.406059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd27f9b7-f12a-48b1-88c0-31832b6ab1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140d2c30>]}
[0m17:55:04.406506 [info ] [MainThread]: Found 11 models, 10 data tests, 10 sources, 488 macros
[0m17:55:04.409098 [info ] [MainThread]: 
[0m17:55:04.409561 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:55:04.412934 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m17:55:04.427626 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m17:55:04.428124 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m17:55:04.428384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:04.431545 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:55:04.432272 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:55:05.861894 [debug] [ThreadPool]: SQL status: SUCCESS in 1.433 seconds
[0m17:55:05.867985 [debug] [ThreadPool]: On list_dev: Close
[0m17:55:05.876031 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m17:55:05.877183 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m17:55:05.877693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:05.878418 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:55:05.878885 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:55:07.140267 [debug] [ThreadPool]: SQL status: SUCCESS in 1.262 seconds
[0m17:55:07.144586 [debug] [ThreadPool]: On list_dev: Close
[0m17:55:07.148019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public_staging)
[0m17:55:07.159130 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:55:07.159603 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m17:55:07.159955 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:07.160470 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:55:07.160821 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:55:08.644594 [debug] [ThreadPool]: SQL status: SUCCESS in 1.484 seconds
[0m17:55:08.646697 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m17:55:08.647889 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m17:55:08.931575 [debug] [ThreadPool]: SQL status: SUCCESS in 0.282 seconds
[0m17:55:08.938211 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m17:55:09.152087 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m17:55:09.155379 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_staging, now list_dev_public_marts)
[0m17:55:09.166224 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m17:55:09.166940 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m17:55:09.167383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:09.168007 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:55:09.168470 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:55:10.806363 [debug] [ThreadPool]: SQL status: SUCCESS in 1.639 seconds
[0m17:55:10.808028 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m17:55:10.809177 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m17:55:11.385970 [debug] [ThreadPool]: SQL status: SUCCESS in 0.575 seconds
[0m17:55:11.391512 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m17:55:12.099921 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m17:55:12.117828 [debug] [MainThread]: Using redshift connection "master"
[0m17:55:12.118538 [debug] [MainThread]: On master: BEGIN
[0m17:55:12.118979 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:55:12.119633 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:55:12.120081 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:55:12.906624 [debug] [MainThread]: SQL status: SUCCESS in 0.787 seconds
[0m17:55:12.908508 [debug] [MainThread]: Using redshift connection "master"
[0m17:55:12.909722 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:55:13.186597 [debug] [MainThread]: SQL status: SUCCESS in 0.275 seconds
[0m17:55:13.191560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd27f9b7-f12a-48b1-88c0-31832b6ab1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa1730>]}
[0m17:55:13.192609 [debug] [MainThread]: On master: ROLLBACK
[0m17:55:13.322753 [debug] [MainThread]: Using redshift connection "master"
[0m17:55:13.324214 [debug] [MainThread]: On master: BEGIN
[0m17:55:13.476809 [debug] [MainThread]: SQL status: SUCCESS in 0.151 seconds
[0m17:55:13.478403 [debug] [MainThread]: On master: COMMIT
[0m17:55:13.479728 [debug] [MainThread]: Using redshift connection "master"
[0m17:55:13.480727 [debug] [MainThread]: On master: COMMIT
[0m17:55:13.734856 [debug] [MainThread]: SQL status: SUCCESS in 0.253 seconds
[0m17:55:13.736652 [debug] [MainThread]: On master: Close
[0m17:55:13.738411 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:55:13.739082 [info ] [MainThread]: 
[0m17:55:13.744760 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_geolocation
[0m17:55:13.745854 [info ] [Thread-1 (]: 1 of 21 START sql table model public_staging.stg_geolocation ................... [RUN]
[0m17:55:13.746747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_marts, now model.olist_dbt.stg_geolocation)
[0m17:55:13.747360 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_geolocation
[0m17:55:13.751858 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_geolocation"
[0m17:55:13.755350 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_geolocation
[0m17:55:13.801001 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_geolocation"
[0m17:55:13.803495 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:55:13.803836 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: BEGIN
[0m17:55:13.804106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:13.804486 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:55:13.804772 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:55:15.376974 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.572 seconds
[0m17:55:15.379338 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:55:15.380609 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_geolocation"} */

  
    

  create  table
    "dev"."public_staging"."stg_geolocation__dbt_tmp"
    
    
    
  as (
    with source as (
    select *
    from "dev"."public"."geolocation"
)
select
    geolocation_zip_code_prefix,
    geolocation_lat,
    geolocation_lng,
    geolocation_city,
    geolocation_state
from source
  );
[0m17:55:16.299982 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.918 seconds
[0m17:55:16.320577 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:55:16.321259 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_geolocation"} */
alter table "dev"."public_staging"."stg_geolocation" rename to "stg_geolocation__dbt_backup"
[0m17:55:17.530565 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.208 seconds
[0m17:55:17.542853 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:55:17.544055 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_geolocation"} */
alter table "dev"."public_staging"."stg_geolocation__dbt_tmp" rename to "stg_geolocation"
[0m17:55:17.886441 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.341 seconds
[0m17:55:17.915519 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: COMMIT
[0m17:55:17.916127 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:55:17.916458 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: COMMIT
[0m17:55:18.190802 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.274 seconds
[0m17:55:18.192910 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:55:18.193619 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: BEGIN
[0m17:55:18.323473 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.129 seconds
[0m17:55:18.338524 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_geolocation__dbt_backup"
[0m17:55:18.346197 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:55:18.346704 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_geolocation"} */
drop table if exists "dev"."public_staging"."stg_geolocation__dbt_backup" cascade
[0m17:55:18.479332 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.132 seconds
[0m17:55:18.482269 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: COMMIT
[0m17:55:18.483183 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:55:18.483709 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: COMMIT
[0m17:55:18.580643 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.096 seconds
[0m17:55:18.582629 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_geolocation"
[0m17:55:18.583697 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: BEGIN
[0m17:55:18.735473 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.150 seconds
[0m17:55:18.741938 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: ROLLBACK
[0m17:55:19.018747 [debug] [Thread-1 (]: On model.olist_dbt.stg_geolocation: Close
[0m17:55:19.024329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd27f9b7-f12a-48b1-88c0-31832b6ab1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f389b0>]}
[0m17:55:19.026005 [info ] [Thread-1 (]: 1 of 21 OK created sql table model public_staging.stg_geolocation .............. [[32mSUCCESS[0m in 5.27s]
[0m17:55:19.027169 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_geolocation
[0m17:55:19.028070 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_order_items
[0m17:55:19.028922 [info ] [Thread-1 (]: 2 of 21 START sql table model public_staging.stg_order_items ................... [RUN]
[0m17:55:19.029600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_geolocation, now model.olist_dbt.stg_order_items)
[0m17:55:19.030401 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_order_items
[0m17:55:19.035227 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_order_items"
[0m17:55:19.037026 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_order_items
[0m17:55:19.042901 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_order_items"
[0m17:55:19.045945 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:55:19.046623 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: BEGIN
[0m17:55:19.047054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:19.047644 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:55:19.048098 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:55:20.912759 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.865 seconds
[0m17:55:20.914596 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:55:20.915674 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_items"} */

  
    

  create  table
    "dev"."public_staging"."stg_order_items__dbt_tmp"
    
    
    
  as (
    with source as (
    select *
    from "dev"."public"."order_items"
)
select
    order_id,
    order_item_id,
    product_id,
    seller_id,
    shipping_limit_date,
    price,
    freight_value
    
from source
  );
[0m17:55:22.545860 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.629 seconds
[0m17:55:22.556042 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:55:22.556876 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_items"} */
alter table "dev"."public_staging"."stg_order_items" rename to "stg_order_items__dbt_backup"
[0m17:55:23.178390 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.621 seconds
[0m17:55:23.186870 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:55:23.187550 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_items"} */
alter table "dev"."public_staging"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m17:55:23.959188 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.771 seconds
[0m17:55:23.965494 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: COMMIT
[0m17:55:23.966423 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:55:23.967028 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: COMMIT
[0m17:55:24.221516 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.254 seconds
[0m17:55:24.223704 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:55:24.224618 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: BEGIN
[0m17:55:24.727526 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.502 seconds
[0m17:55:24.735662 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_order_items__dbt_backup"
[0m17:55:24.737757 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:55:24.738353 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_items"} */
drop table if exists "dev"."public_staging"."stg_order_items__dbt_backup" cascade
[0m17:55:25.355032 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.616 seconds
[0m17:55:25.360115 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: COMMIT
[0m17:55:25.361243 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:55:25.361811 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: COMMIT
[0m17:55:25.987076 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.624 seconds
[0m17:55:25.988940 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_items"
[0m17:55:25.990083 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: BEGIN
[0m17:55:26.519596 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.528 seconds
[0m17:55:26.523084 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: ROLLBACK
[0m17:55:26.777407 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_items: Close
[0m17:55:26.780513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd27f9b7-f12a-48b1-88c0-31832b6ab1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114423b90>]}
[0m17:55:26.782205 [info ] [Thread-1 (]: 2 of 21 OK created sql table model public_staging.stg_order_items .............. [[32mSUCCESS[0m in 7.75s]
[0m17:55:26.783314 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_order_items
[0m17:55:26.784154 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_order_payments
[0m17:55:26.785271 [info ] [Thread-1 (]: 3 of 21 START sql table model public_staging.stg_order_payments ................ [RUN]
[0m17:55:26.786017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_order_items, now model.olist_dbt.stg_order_payments)
[0m17:55:26.786979 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_order_payments
[0m17:55:26.791396 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_order_payments"
[0m17:55:26.793088 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_order_payments
[0m17:55:26.803646 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_order_payments"
[0m17:55:26.806283 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:55:26.806757 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: BEGIN
[0m17:55:26.807139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:26.807723 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:55:26.808128 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:55:28.735576 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.928 seconds
[0m17:55:28.737521 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:55:28.738624 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_payments"} */

  
    

  create  table
    "dev"."public_staging"."stg_order_payments__dbt_tmp"
    
    
    
  as (
    with source as (
    select *
    from "dev"."public"."order_payments"
)
select
    order_id,
    payment_sequential,
    payment_type,
    payment_installments,
    payment_value
from source
  );
[0m17:55:29.182237 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.442 seconds
[0m17:55:29.192686 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:55:29.193588 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_payments"} */
alter table "dev"."public_staging"."stg_order_payments" rename to "stg_order_payments__dbt_backup"
[0m17:55:29.648387 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.454 seconds
[0m17:55:29.655796 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:55:29.656410 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_payments"} */
alter table "dev"."public_staging"."stg_order_payments__dbt_tmp" rename to "stg_order_payments"
[0m17:55:30.043572 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.386 seconds
[0m17:55:30.047341 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: COMMIT
[0m17:55:30.048062 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:55:30.048875 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: COMMIT
[0m17:55:30.351585 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.302 seconds
[0m17:55:30.353402 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:55:30.354355 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: BEGIN
[0m17:55:30.548480 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.193 seconds
[0m17:55:30.555174 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_order_payments__dbt_backup"
[0m17:55:30.557695 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:55:30.558736 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_payments"} */
drop table if exists "dev"."public_staging"."stg_order_payments__dbt_backup" cascade
[0m17:55:31.115109 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.555 seconds
[0m17:55:31.118705 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: COMMIT
[0m17:55:31.119835 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:55:31.120637 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: COMMIT
[0m17:55:31.761825 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.640 seconds
[0m17:55:31.766793 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_payments"
[0m17:55:31.768872 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: BEGIN
[0m17:55:31.900373 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.129 seconds
[0m17:55:31.902482 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: ROLLBACK
[0m17:55:32.096941 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_payments: Close
[0m17:55:32.100012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd27f9b7-f12a-48b1-88c0-31832b6ab1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11636c140>]}
[0m17:55:32.101755 [info ] [Thread-1 (]: 3 of 21 OK created sql table model public_staging.stg_order_payments ........... [[32mSUCCESS[0m in 5.31s]
[0m17:55:32.103113 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_order_payments
[0m17:55:32.103928 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_order_reviews
[0m17:55:32.105093 [info ] [Thread-1 (]: 4 of 21 START sql table model public_staging.stg_order_reviews ................. [RUN]
[0m17:55:32.106416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_order_payments, now model.olist_dbt.stg_order_reviews)
[0m17:55:32.107192 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_order_reviews
[0m17:55:32.111864 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_order_reviews"
[0m17:55:32.113543 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_order_reviews
[0m17:55:32.119319 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_order_reviews"
[0m17:55:32.121995 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:55:32.122444 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: BEGIN
[0m17:55:32.122827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:32.123384 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:55:32.123786 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:55:33.529114 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.406 seconds
[0m17:55:33.531176 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:55:33.532387 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_reviews"} */

  
    

  create  table
    "dev"."public_staging"."stg_order_reviews__dbt_tmp"
    
    
    
  as (
    with source as (
    select *
    from "dev"."public"."order_reviews"
)
select
    review_id,
    order_id,
    review_score,
    review_comment_title,
    review_comment_message,
    review_creation_date,
    review_answer_timestamp
from source
  );
[0m17:55:33.987683 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.454 seconds
[0m17:55:33.994459 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:55:33.995181 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_reviews"} */
alter table "dev"."public_staging"."stg_order_reviews" rename to "stg_order_reviews__dbt_backup"
[0m17:55:34.644481 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.648 seconds
[0m17:55:34.653717 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:55:34.654422 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_reviews"} */
alter table "dev"."public_staging"."stg_order_reviews__dbt_tmp" rename to "stg_order_reviews"
[0m17:55:34.950401 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.295 seconds
[0m17:55:34.955151 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: COMMIT
[0m17:55:34.956038 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:55:34.956564 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: COMMIT
[0m17:55:35.128771 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.171 seconds
[0m17:55:35.131394 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:55:35.132568 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: BEGIN
[0m17:55:35.428068 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.294 seconds
[0m17:55:35.436642 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_order_reviews__dbt_backup"
[0m17:55:35.439372 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:55:35.440228 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_order_reviews"} */
drop table if exists "dev"."public_staging"."stg_order_reviews__dbt_backup" cascade
[0m17:55:35.574427 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.133 seconds
[0m17:55:35.577431 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: COMMIT
[0m17:55:35.578379 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:55:35.579134 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: COMMIT
[0m17:55:35.780983 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.201 seconds
[0m17:55:35.783294 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_order_reviews"
[0m17:55:35.784418 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: BEGIN
[0m17:55:38.213541 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.428 seconds
[0m17:55:38.217064 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: ROLLBACK
[0m17:55:38.448973 [debug] [Thread-1 (]: On model.olist_dbt.stg_order_reviews: Close
[0m17:55:38.452014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd27f9b7-f12a-48b1-88c0-31832b6ab1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144e1e80>]}
[0m17:55:38.453831 [info ] [Thread-1 (]: 4 of 21 OK created sql table model public_staging.stg_order_reviews ............ [[32mSUCCESS[0m in 6.35s]
[0m17:55:38.455114 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_order_reviews
[0m17:55:38.456094 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_product_category
[0m17:55:38.457617 [info ] [Thread-1 (]: 5 of 21 START sql table model public_staging.stg_product_category .............. [RUN]
[0m17:55:38.458607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_order_reviews, now model.olist_dbt.stg_product_category)
[0m17:55:38.459312 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_product_category
[0m17:55:38.470855 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_product_category"
[0m17:55:38.472364 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_product_category
[0m17:55:38.476858 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_product_category"
[0m17:55:38.479254 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:55:38.479752 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: BEGIN
[0m17:55:38.480098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:38.480716 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:55:38.481070 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:55:40.466048 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.985 seconds
[0m17:55:40.468176 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:55:40.469419 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_product_category"} */

  
    

  create  table
    "dev"."public_staging"."stg_product_category__dbt_tmp"
    
    
    
  as (
    with source as (
    select *
    from "dev"."public"."product_category"
)
select
    product_category_name_english as product_category
from source
  );
[0m17:55:40.730550 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.260 seconds
[0m17:55:40.741827 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:55:40.742800 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_product_category"} */
alter table "dev"."public_staging"."stg_product_category" rename to "stg_product_category__dbt_backup"
[0m17:55:41.599490 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.856 seconds
[0m17:55:41.608575 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:55:41.609501 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_product_category"} */
alter table "dev"."public_staging"."stg_product_category__dbt_tmp" rename to "stg_product_category"
[0m17:55:42.774757 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.164 seconds
[0m17:55:42.781256 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: COMMIT
[0m17:55:42.782214 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:55:42.783044 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: COMMIT
[0m17:55:43.039245 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.255 seconds
[0m17:55:43.041321 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:55:43.042449 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: BEGIN
[0m17:55:43.742876 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.699 seconds
[0m17:55:43.752028 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_product_category__dbt_backup"
[0m17:55:43.755022 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:55:43.755882 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_product_category"} */
drop table if exists "dev"."public_staging"."stg_product_category__dbt_backup" cascade
[0m17:55:44.016594 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.260 seconds
[0m17:55:44.020527 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: COMMIT
[0m17:55:44.021983 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:55:44.023099 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: COMMIT
[0m17:55:44.120622 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.096 seconds
[0m17:55:44.122104 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_product_category"
[0m17:55:44.123142 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: BEGIN
[0m17:55:44.190062 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.066 seconds
[0m17:55:44.192758 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: ROLLBACK
[0m17:55:44.816620 [debug] [Thread-1 (]: On model.olist_dbt.stg_product_category: Close
[0m17:55:44.819340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd27f9b7-f12a-48b1-88c0-31832b6ab1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144237a0>]}
[0m17:55:44.821354 [info ] [Thread-1 (]: 5 of 21 OK created sql table model public_staging.stg_product_category ......... [[32mSUCCESS[0m in 6.36s]
[0m17:55:44.822764 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_product_category
[0m17:55:44.823612 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_products
[0m17:55:44.824634 [info ] [Thread-1 (]: 6 of 21 START sql table model public_staging.stg_products ...................... [RUN]
[0m17:55:44.825719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_product_category, now model.olist_dbt.stg_products)
[0m17:55:44.826436 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_products
[0m17:55:44.830986 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_products"
[0m17:55:44.832686 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_products
[0m17:55:44.838324 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_products"
[0m17:55:44.841354 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:55:44.841821 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: BEGIN
[0m17:55:44.842214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:44.842812 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:55:44.843231 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:55:46.540550 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.698 seconds
[0m17:55:46.542776 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:55:46.544027 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_products"} */

  
    

  create  table
    "dev"."public_staging"."stg_products__dbt_tmp"
    
    
    
  as (
    with source as (
    select *
    from "dev"."public"."products"
)
select
    product_id,
    product_category_name,
    product_name_length,
    product_description_length,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
from source
  );
[0m17:55:46.895684 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.350 seconds
[0m17:55:46.909054 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:55:46.909902 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_products"} */
alter table "dev"."public_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m17:55:47.858469 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.947 seconds
[0m17:55:47.869454 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:55:47.870010 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_products"} */
alter table "dev"."public_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m17:55:48.275248 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.404 seconds
[0m17:55:48.281405 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: COMMIT
[0m17:55:48.282242 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:55:48.282770 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: COMMIT
[0m17:55:48.640723 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.357 seconds
[0m17:55:48.642748 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:55:48.643804 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: BEGIN
[0m17:55:49.112002 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.467 seconds
[0m17:55:49.119438 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_products__dbt_backup"
[0m17:55:49.121879 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:55:49.122532 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_products"} */
drop table if exists "dev"."public_staging"."stg_products__dbt_backup" cascade
[0m17:55:49.786488 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.663 seconds
[0m17:55:49.790408 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: COMMIT
[0m17:55:49.791778 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:55:49.792832 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: COMMIT
[0m17:55:50.296478 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.502 seconds
[0m17:55:50.298371 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_products"
[0m17:55:50.299454 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: BEGIN
[0m17:55:50.425911 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.125 seconds
[0m17:55:50.429023 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: ROLLBACK
[0m17:55:50.615616 [debug] [Thread-1 (]: On model.olist_dbt.stg_products: Close
[0m17:55:50.618444 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd27f9b7-f12a-48b1-88c0-31832b6ab1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114422a50>]}
[0m17:55:50.620412 [info ] [Thread-1 (]: 6 of 21 OK created sql table model public_staging.stg_products ................. [[32mSUCCESS[0m in 5.79s]
[0m17:55:50.621753 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_products
[0m17:55:50.622622 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_sellers
[0m17:55:50.623667 [info ] [Thread-1 (]: 7 of 21 START sql table model public_staging.stg_sellers ....................... [RUN]
[0m17:55:50.624656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_products, now model.olist_dbt.stg_sellers)
[0m17:55:50.625355 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_sellers
[0m17:55:50.637100 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_sellers"
[0m17:55:50.638654 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_sellers
[0m17:55:50.643083 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_sellers"
[0m17:55:50.645897 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:55:50.646409 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: BEGIN
[0m17:55:50.646788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:50.647401 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:55:50.647813 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:55:51.339600 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.692 seconds
[0m17:55:51.341855 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:55:51.343160 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_sellers"} */

  
    

  create  table
    "dev"."public_staging"."stg_sellers__dbt_tmp"
    
    
    
  as (
    with source as (
    select *
    from "dev"."public"."sellers"
)
select
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state
from source
  );
[0m17:55:52.076690 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.732 seconds
[0m17:55:52.086944 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:55:52.087737 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_sellers"} */
alter table "dev"."public_staging"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m17:55:53.266095 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.177 seconds
[0m17:55:53.277993 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:55:53.278921 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_sellers"} */
alter table "dev"."public_staging"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m17:55:53.469365 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.189 seconds
[0m17:55:53.477183 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: COMMIT
[0m17:55:53.478511 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:55:53.479054 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: COMMIT
[0m17:55:53.751717 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.272 seconds
[0m17:55:53.753828 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:55:53.754914 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: BEGIN
[0m17:55:54.034862 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.279 seconds
[0m17:55:54.043866 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_sellers__dbt_backup"
[0m17:55:54.045870 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:55:54.046362 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_sellers"} */
drop table if exists "dev"."public_staging"."stg_sellers__dbt_backup" cascade
[0m17:55:54.176587 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.129 seconds
[0m17:55:54.180482 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: COMMIT
[0m17:55:54.181872 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:55:54.182933 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: COMMIT
[0m17:55:54.279933 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.096 seconds
[0m17:55:54.281514 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_sellers"
[0m17:55:54.282552 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: BEGIN
[0m17:55:54.699786 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.416 seconds
[0m17:55:54.703063 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: ROLLBACK
[0m17:55:55.040706 [debug] [Thread-1 (]: On model.olist_dbt.stg_sellers: Close
[0m17:55:55.043541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd27f9b7-f12a-48b1-88c0-31832b6ab1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11635fd70>]}
[0m17:55:55.045208 [info ] [Thread-1 (]: 7 of 21 OK created sql table model public_staging.stg_sellers .................. [[32mSUCCESS[0m in 4.42s]
[0m17:55:55.046218 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_sellers
[0m17:55:55.046975 [debug] [Thread-1 (]: Began running node test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608
[0m17:55:55.047982 [info ] [Thread-1 (]: 8 of 21 START test source_not_null_olist_customer_customer_id .................. [RUN]
[0m17:55:55.048919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_sellers, now test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608)
[0m17:55:55.049520 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608
[0m17:55:55.066544 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608"
[0m17:55:55.068942 [debug] [Thread-1 (]: Began executing node test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608
[0m17:55:55.083980 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608"
[0m17:55:55.086440 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608"
[0m17:55:55.086796 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608: BEGIN
[0m17:55:55.087092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:55.087507 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:55:55.087802 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:55:55.960038 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.873 seconds
[0m17:55:55.960660 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608"
[0m17:55:55.961049 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dev"."public"."customer"
where customer_id is null



      
    ) dbt_internal_test
[0m17:55:56.175526 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.214 seconds
[0m17:55:56.183960 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608: ROLLBACK
[0m17:55:57.175646 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608: Close
[0m17:55:57.178890 [info ] [Thread-1 (]: 8 of 21 PASS source_not_null_olist_customer_customer_id ........................ [[32mPASS[0m in 2.13s]
[0m17:55:57.180016 [debug] [Thread-1 (]: Finished running node test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608
[0m17:55:57.180887 [debug] [Thread-1 (]: Began running node test.olist_dbt.source_not_null_olist_orders_order_id.441189e023
[0m17:55:57.181679 [info ] [Thread-1 (]: 9 of 21 START test source_not_null_olist_orders_order_id ....................... [RUN]
[0m17:55:57.182405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608, now test.olist_dbt.source_not_null_olist_orders_order_id.441189e023)
[0m17:55:57.183595 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.source_not_null_olist_orders_order_id.441189e023
[0m17:55:57.191095 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.source_not_null_olist_orders_order_id.441189e023"
[0m17:55:57.192881 [debug] [Thread-1 (]: Began executing node test.olist_dbt.source_not_null_olist_orders_order_id.441189e023
[0m17:55:57.196480 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.source_not_null_olist_orders_order_id.441189e023"
[0m17:55:57.199058 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_not_null_olist_orders_order_id.441189e023"
[0m17:55:57.199504 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_orders_order_id.441189e023: BEGIN
[0m17:55:57.199890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:57.200469 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:55:57.200886 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:55:58.797497 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.597 seconds
[0m17:55:58.799584 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_not_null_olist_orders_order_id.441189e023"
[0m17:55:58.800763 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_orders_order_id.441189e023: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.source_not_null_olist_orders_order_id.441189e023"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "dev"."public"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m17:55:59.165762 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.363 seconds
[0m17:55:59.172067 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_orders_order_id.441189e023: ROLLBACK
[0m17:56:00.012443 [debug] [Thread-1 (]: On test.olist_dbt.source_not_null_olist_orders_order_id.441189e023: Close
[0m17:56:00.014275 [info ] [Thread-1 (]: 9 of 21 PASS source_not_null_olist_orders_order_id ............................. [[32mPASS[0m in 2.83s]
[0m17:56:00.015671 [debug] [Thread-1 (]: Finished running node test.olist_dbt.source_not_null_olist_orders_order_id.441189e023
[0m17:56:00.016888 [debug] [Thread-1 (]: Began running node test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a
[0m17:56:00.017856 [info ] [Thread-1 (]: 10 of 21 START test source_unique_olist_customer_customer_id ................... [RUN]
[0m17:56:00.019146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.source_not_null_olist_orders_order_id.441189e023, now test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a)
[0m17:56:00.019949 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a
[0m17:56:00.035763 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a"
[0m17:56:00.037449 [debug] [Thread-1 (]: Began executing node test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a
[0m17:56:00.085724 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a"
[0m17:56:00.087542 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a"
[0m17:56:00.087893 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a: BEGIN
[0m17:56:00.088172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:00.088546 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:56:00.088815 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:56:01.367688 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.279 seconds
[0m17:56:01.369650 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a"
[0m17:56:01.370850 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dev"."public"."customer"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:56:02.055828 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.684 seconds
[0m17:56:02.058293 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a: ROLLBACK
[0m17:56:02.693426 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a: Close
[0m17:56:02.694760 [info ] [Thread-1 (]: 10 of 21 PASS source_unique_olist_customer_customer_id ......................... [[32mPASS[0m in 2.68s]
[0m17:56:02.695776 [debug] [Thread-1 (]: Finished running node test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a
[0m17:56:02.696671 [debug] [Thread-1 (]: Began running node test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82
[0m17:56:02.697603 [info ] [Thread-1 (]: 11 of 21 START test source_unique_olist_orders_order_id ........................ [RUN]
[0m17:56:02.698336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a, now test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82)
[0m17:56:02.698962 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82
[0m17:56:02.704260 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82"
[0m17:56:02.706150 [debug] [Thread-1 (]: Began executing node test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82
[0m17:56:02.708247 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82"
[0m17:56:02.710160 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82"
[0m17:56:02.710510 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82: BEGIN
[0m17:56:02.710782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:02.711154 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:56:02.711427 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:56:03.844765 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.134 seconds
[0m17:56:03.846216 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82"
[0m17:56:03.847049 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."public"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:56:04.391765 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.543 seconds
[0m17:56:04.397506 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82: ROLLBACK
[0m17:56:04.530202 [debug] [Thread-1 (]: On test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82: Close
[0m17:56:04.533051 [info ] [Thread-1 (]: 11 of 21 PASS source_unique_olist_orders_order_id .............................. [[32mPASS[0m in 1.83s]
[0m17:56:04.534323 [debug] [Thread-1 (]: Finished running node test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82
[0m17:56:04.535266 [debug] [Thread-1 (]: Began running node test.olist_dbt.assert_stg_order_items_values_positive
[0m17:56:04.536258 [info ] [Thread-1 (]: 12 of 21 START test assert_stg_order_items_values_positive ..................... [RUN]
[0m17:56:04.536889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82, now test.olist_dbt.assert_stg_order_items_values_positive)
[0m17:56:04.537467 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.assert_stg_order_items_values_positive
[0m17:56:04.542845 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.assert_stg_order_items_values_positive"
[0m17:56:04.544765 [debug] [Thread-1 (]: Began executing node test.olist_dbt.assert_stg_order_items_values_positive
[0m17:56:04.548323 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.assert_stg_order_items_values_positive"
[0m17:56:04.551388 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.assert_stg_order_items_values_positive"
[0m17:56:04.551914 [debug] [Thread-1 (]: On test.olist_dbt.assert_stg_order_items_values_positive: BEGIN
[0m17:56:04.552331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:04.552942 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:56:04.553377 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:56:06.018333 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.466 seconds
[0m17:56:06.019274 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.assert_stg_order_items_values_positive"
[0m17:56:06.019868 [debug] [Thread-1 (]: On test.olist_dbt.assert_stg_order_items_values_positive: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.assert_stg_order_items_values_positive"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      WITH order_items AS (

    SELECT  *
    FROM "dev"."public_staging"."stg_order_items"

)

SELECT  order_id,
        SUM(price) AS total_value
FROM order_items
GROUP BY 1
HAVING total_value < 0
      
    ) dbt_internal_test
[0m17:56:06.681347 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.661 seconds
[0m17:56:06.687228 [debug] [Thread-1 (]: On test.olist_dbt.assert_stg_order_items_values_positive: ROLLBACK
[0m17:56:07.387191 [debug] [Thread-1 (]: On test.olist_dbt.assert_stg_order_items_values_positive: Close
[0m17:56:07.390842 [info ] [Thread-1 (]: 12 of 21 PASS assert_stg_order_items_values_positive ........................... [[32mPASS[0m in 2.85s]
[0m17:56:07.392460 [debug] [Thread-1 (]: Finished running node test.olist_dbt.assert_stg_order_items_values_positive
[0m17:56:07.393429 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_customers
[0m17:56:07.394639 [info ] [Thread-1 (]: 13 of 21 START sql table model public_staging.stg_customers .................... [RUN]
[0m17:56:07.395797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.assert_stg_order_items_values_positive, now model.olist_dbt.stg_customers)
[0m17:56:07.396678 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_customers
[0m17:56:07.400946 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_customers"
[0m17:56:07.402669 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_customers
[0m17:56:07.407962 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_customers"
[0m17:56:07.410841 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:56:07.411371 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: BEGIN
[0m17:56:07.411821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:07.412500 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:56:07.413311 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:56:08.206202 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.794 seconds
[0m17:56:08.208293 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:56:08.209538 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_customers"} */

  
    

  create  table
    "dev"."public_staging"."stg_customers__dbt_tmp"
    
    
    
  as (
    with source as (
    select *
    from "dev"."public"."customer"
)
select
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state
from source
  );
[0m17:56:08.704469 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.493 seconds
[0m17:56:08.715633 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:56:08.716608 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_customers"} */
alter table "dev"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m17:56:09.561457 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.844 seconds
[0m17:56:09.572549 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:56:09.573251 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_customers"} */
alter table "dev"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:56:09.909936 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.336 seconds
[0m17:56:09.915933 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: COMMIT
[0m17:56:09.916793 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:56:09.917578 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: COMMIT
[0m17:56:10.165685 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.247 seconds
[0m17:56:10.168240 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:56:10.169347 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: BEGIN
[0m17:56:10.799016 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.628 seconds
[0m17:56:10.816338 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_customers__dbt_backup"
[0m17:56:10.817799 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:56:10.818269 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_customers"} */
drop table if exists "dev"."public_staging"."stg_customers__dbt_backup" cascade
[0m17:56:11.415622 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.596 seconds
[0m17:56:11.419741 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: COMMIT
[0m17:56:11.421023 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:56:11.421880 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: COMMIT
[0m17:56:11.581305 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.158 seconds
[0m17:56:11.582799 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_customers"
[0m17:56:11.583697 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: BEGIN
[0m17:56:11.711701 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.127 seconds
[0m17:56:11.714534 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: ROLLBACK
[0m17:56:12.519251 [debug] [Thread-1 (]: On model.olist_dbt.stg_customers: Close
[0m17:56:12.522447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd27f9b7-f12a-48b1-88c0-31832b6ab1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114413950>]}
[0m17:56:12.524074 [info ] [Thread-1 (]: 13 of 21 OK created sql table model public_staging.stg_customers ............... [[32mSUCCESS[0m in 5.13s]
[0m17:56:12.525292 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_customers
[0m17:56:12.526113 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_orders
[0m17:56:12.527979 [info ] [Thread-1 (]: 14 of 21 START sql table model public_staging.stg_orders ....................... [RUN]
[0m17:56:12.528901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_customers, now model.olist_dbt.stg_orders)
[0m17:56:12.529470 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_orders
[0m17:56:12.534177 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_orders"
[0m17:56:12.535911 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_orders
[0m17:56:12.541443 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.stg_orders"
[0m17:56:12.544928 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:56:12.545464 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m17:56:12.545860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:12.546436 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:56:12.546884 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:56:13.657389 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.111 seconds
[0m17:56:13.659550 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:56:13.660904 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */

  
    

  create  table
    "dev"."public_staging"."stg_orders__dbt_tmp"
    
    
    
  as (
    


-- models/staging/olist/stg_orders.sql
with source as (
    select *
    from "dev"."public"."orders"
)
select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp::timestamp as order_purchase_timestamp,
    order_approved_at::timestamp as order_approved_at,
    order_delivered_carrier_date::timestamp as order_delivered_carrier_date,
    order_delivered_customer_date::timestamp as order_delivered_customer_date,
    order_estimated_delivery_date::timestamp as order_estimated_delivery_date
from source
  );
[0m17:56:14.071697 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.409 seconds
[0m17:56:14.081865 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:56:14.082669 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m17:56:14.805429 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.722 seconds
[0m17:56:14.814454 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:56:14.815036 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
alter table "dev"."public_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m17:56:15.174938 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.359 seconds
[0m17:56:15.181270 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m17:56:15.182304 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:56:15.182933 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m17:56:16.024587 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.841 seconds
[0m17:56:16.025783 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:56:16.026328 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m17:56:16.307989 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.281 seconds
[0m17:56:16.316160 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_staging"."stg_orders__dbt_backup"
[0m17:56:16.318200 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:56:16.318735 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.stg_orders"} */
drop table if exists "dev"."public_staging"."stg_orders__dbt_backup" cascade
[0m17:56:16.518365 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.199 seconds
[0m17:56:16.521968 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m17:56:16.523145 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:56:16.523735 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: COMMIT
[0m17:56:16.703644 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.179 seconds
[0m17:56:16.705174 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.stg_orders"
[0m17:56:16.706204 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: BEGIN
[0m17:56:17.125752 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.419 seconds
[0m17:56:17.126658 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: ROLLBACK
[0m17:56:17.656628 [debug] [Thread-1 (]: On model.olist_dbt.stg_orders: Close
[0m17:56:17.658958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd27f9b7-f12a-48b1-88c0-31832b6ab1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114411580>]}
[0m17:56:17.660695 [info ] [Thread-1 (]: 14 of 21 OK created sql table model public_staging.stg_orders .................. [[32mSUCCESS[0m in 5.13s]
[0m17:56:17.662157 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_orders
[0m17:56:17.662935 [debug] [Thread-1 (]: Began running node test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:56:17.663875 [info ] [Thread-1 (]: 15 of 21 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m17:56:17.665131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_orders, now test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m17:56:17.666092 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:56:17.672926 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:56:17.675330 [debug] [Thread-1 (]: Began executing node test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:56:17.678652 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:56:17.682074 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:56:17.682601 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m17:56:17.683000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:17.683556 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:56:17.683967 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:56:18.396084 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.713 seconds
[0m17:56:18.397675 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:56:18.398447 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dev"."public_staging"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m17:56:18.970753 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.571 seconds
[0m17:56:18.974846 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m17:56:19.280713 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m17:56:19.288268 [info ] [Thread-1 (]: 15 of 21 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 1.62s]
[0m17:56:19.290070 [debug] [Thread-1 (]: Finished running node test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:56:19.290791 [debug] [Thread-1 (]: Began running node test.olist_dbt.unique_stg_customers_customer_id.c7614daada
[0m17:56:19.291505 [info ] [Thread-1 (]: 16 of 21 START test unique_stg_customers_customer_id ........................... [RUN]
[0m17:56:19.292584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.olist_dbt.unique_stg_customers_customer_id.c7614daada)
[0m17:56:19.293498 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.unique_stg_customers_customer_id.c7614daada
[0m17:56:19.299722 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.unique_stg_customers_customer_id.c7614daada"
[0m17:56:19.301552 [debug] [Thread-1 (]: Began executing node test.olist_dbt.unique_stg_customers_customer_id.c7614daada
[0m17:56:19.304652 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.unique_stg_customers_customer_id.c7614daada"
[0m17:56:19.307394 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.unique_stg_customers_customer_id.c7614daada"
[0m17:56:19.307832 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m17:56:19.308219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:19.308779 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:56:19.309195 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:56:20.578776 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.270 seconds
[0m17:56:20.580816 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.unique_stg_customers_customer_id.c7614daada"
[0m17:56:20.581674 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dev"."public_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:56:21.051794 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.469 seconds
[0m17:56:21.055874 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m17:56:21.386757 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_customers_customer_id.c7614daada: Close
[0m17:56:21.390199 [info ] [Thread-1 (]: 16 of 21 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 2.10s]
[0m17:56:21.391346 [debug] [Thread-1 (]: Finished running node test.olist_dbt.unique_stg_customers_customer_id.c7614daada
[0m17:56:21.392240 [debug] [Thread-1 (]: Began running node test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d
[0m17:56:21.393281 [info ] [Thread-1 (]: 17 of 21 START test accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved  [RUN]
[0m17:56:21.394607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.unique_stg_customers_customer_id.c7614daada, now test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d)
[0m17:56:21.395684 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d
[0m17:56:21.419997 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d"
[0m17:56:21.421680 [debug] [Thread-1 (]: Began executing node test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d
[0m17:56:21.424020 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d"
[0m17:56:21.426781 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d"
[0m17:56:21.427255 [debug] [Thread-1 (]: On test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d: BEGIN
[0m17:56:21.427627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:21.428129 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:56:21.428511 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:56:23.087371 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.659 seconds
[0m17:56:23.089553 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d"
[0m17:56:23.090993 [debug] [Thread-1 (]: On test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "dev"."public_staging"."stg_orders"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','canceled','invoiced','processing','created','shipped','unavailable','approved'
)



      
    ) dbt_internal_test
[0m17:56:23.352875 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.260 seconds
[0m17:56:23.359030 [debug] [Thread-1 (]: On test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d: ROLLBACK
[0m17:56:23.485563 [debug] [Thread-1 (]: On test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d: Close
[0m17:56:23.487922 [info ] [Thread-1 (]: 17 of 21 PASS accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved  [[32mPASS[0m in 2.09s]
[0m17:56:23.489214 [debug] [Thread-1 (]: Finished running node test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d
[0m17:56:23.490035 [debug] [Thread-1 (]: Began running node test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m17:56:23.490877 [info ] [Thread-1 (]: 18 of 21 START test not_null_stg_orders_order_id ............................... [RUN]
[0m17:56:23.491624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d, now test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64)
[0m17:56:23.492197 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m17:56:23.499606 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:56:23.501600 [debug] [Thread-1 (]: Began executing node test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m17:56:23.504991 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:56:23.507401 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:56:23.508078 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m17:56:23.508518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:23.509156 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:56:23.509597 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:56:25.492317 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.983 seconds
[0m17:56:25.494611 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:56:25.495915 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "dev"."public_staging"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m17:56:25.721705 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.224 seconds
[0m17:56:25.728094 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m17:56:25.921729 [debug] [Thread-1 (]: On test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m17:56:25.922706 [info ] [Thread-1 (]: 18 of 21 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 2.43s]
[0m17:56:25.923239 [debug] [Thread-1 (]: Finished running node test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m17:56:25.923615 [debug] [Thread-1 (]: Began running node test.olist_dbt.unique_stg_orders_order_id.e3b841c71a
[0m17:56:25.924025 [info ] [Thread-1 (]: 19 of 21 START test unique_stg_orders_order_id ................................. [RUN]
[0m17:56:25.924453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64, now test.olist_dbt.unique_stg_orders_order_id.e3b841c71a)
[0m17:56:25.924785 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.unique_stg_orders_order_id.e3b841c71a
[0m17:56:25.928564 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m17:56:25.929713 [debug] [Thread-1 (]: Began executing node test.olist_dbt.unique_stg_orders_order_id.e3b841c71a
[0m17:56:25.932062 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m17:56:25.934201 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m17:56:25.934562 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m17:56:25.934821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:25.935199 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:56:25.935464 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:56:27.577624 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.642 seconds
[0m17:56:27.579793 [debug] [Thread-1 (]: Using redshift connection "test.olist_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m17:56:27.580852 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "test.olist_dbt.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."public_staging"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:56:27.845072 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.263 seconds
[0m17:56:27.851412 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m17:56:28.063873 [debug] [Thread-1 (]: On test.olist_dbt.unique_stg_orders_order_id.e3b841c71a: Close
[0m17:56:28.065881 [info ] [Thread-1 (]: 19 of 21 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 2.14s]
[0m17:56:28.066967 [debug] [Thread-1 (]: Finished running node test.olist_dbt.unique_stg_orders_order_id.e3b841c71a
[0m17:56:28.068439 [debug] [Thread-1 (]: Began running node model.olist_dbt.monthly_summary
[0m17:56:28.069481 [info ] [Thread-1 (]: 20 of 21 START sql table model public_marts.monthly_summary .................... [RUN]
[0m17:56:28.070254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.unique_stg_orders_order_id.e3b841c71a, now model.olist_dbt.monthly_summary)
[0m17:56:28.070833 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.monthly_summary
[0m17:56:28.076144 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.monthly_summary"
[0m17:56:28.078218 [debug] [Thread-1 (]: Began executing node model.olist_dbt.monthly_summary
[0m17:56:28.083832 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.monthly_summary"
[0m17:56:28.087072 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.monthly_summary"
[0m17:56:28.087548 [debug] [Thread-1 (]: On model.olist_dbt.monthly_summary: BEGIN
[0m17:56:28.087968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:28.088502 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:56:28.088904 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:56:29.215732 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.128 seconds
[0m17:56:29.216750 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.monthly_summary"
[0m17:56:29.217335 [debug] [Thread-1 (]: On model.olist_dbt.monthly_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.monthly_summary"} */

  
    

  create  table
    "dev"."public_marts"."monthly_summary__dbt_tmp"
    
    
    
  as (
    -- models/marts/olist/monthly_sales.sql

select
    -- Truncate the order purchase timestamp to get the month
    date_trunc('month', o.order_purchase_timestamp) as month,
    
    -- Calculate the total sales for each month
    sum(oi.price * oi.freight_value) as total_sales

-- Start from the orders table
from "dev"."public_staging"."stg_orders" o

-- Join the order_items table on order_id
join "dev"."public_staging"."stg_order_items" oi on o.order_id = oi.order_id

-- Group by the month to aggregate total sales per month
group by 1
  );
[0m17:56:29.618101 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.400 seconds
[0m17:56:29.627300 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.monthly_summary"
[0m17:56:29.628058 [debug] [Thread-1 (]: On model.olist_dbt.monthly_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.monthly_summary"} */
alter table "dev"."public_marts"."monthly_summary" rename to "monthly_summary__dbt_backup"
[0m17:56:30.131799 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.503 seconds
[0m17:56:30.141319 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.monthly_summary"
[0m17:56:30.141804 [debug] [Thread-1 (]: On model.olist_dbt.monthly_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.monthly_summary"} */
alter table "dev"."public_marts"."monthly_summary__dbt_tmp" rename to "monthly_summary"
[0m17:56:30.332437 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.190 seconds
[0m17:56:30.335705 [debug] [Thread-1 (]: On model.olist_dbt.monthly_summary: COMMIT
[0m17:56:30.336316 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.monthly_summary"
[0m17:56:30.336740 [debug] [Thread-1 (]: On model.olist_dbt.monthly_summary: COMMIT
[0m17:56:30.510066 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.172 seconds
[0m17:56:30.512583 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.monthly_summary"
[0m17:56:30.513707 [debug] [Thread-1 (]: On model.olist_dbt.monthly_summary: BEGIN
[0m17:56:30.648763 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.133 seconds
[0m17:56:30.656769 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_marts"."monthly_summary__dbt_backup"
[0m17:56:30.659176 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.monthly_summary"
[0m17:56:30.659838 [debug] [Thread-1 (]: On model.olist_dbt.monthly_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.monthly_summary"} */
drop table if exists "dev"."public_marts"."monthly_summary__dbt_backup" cascade
[0m17:56:30.880008 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.219 seconds
[0m17:56:30.881963 [debug] [Thread-1 (]: On model.olist_dbt.monthly_summary: COMMIT
[0m17:56:30.882676 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.monthly_summary"
[0m17:56:30.883190 [debug] [Thread-1 (]: On model.olist_dbt.monthly_summary: COMMIT
[0m17:56:31.076528 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.192 seconds
[0m17:56:31.078239 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.monthly_summary"
[0m17:56:31.078944 [debug] [Thread-1 (]: On model.olist_dbt.monthly_summary: BEGIN
[0m17:56:31.564423 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.484 seconds
[0m17:56:31.567786 [debug] [Thread-1 (]: On model.olist_dbt.monthly_summary: ROLLBACK
[0m17:56:31.896085 [debug] [Thread-1 (]: On model.olist_dbt.monthly_summary: Close
[0m17:56:31.898439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd27f9b7-f12a-48b1-88c0-31832b6ab1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cc12e0>]}
[0m17:56:31.899755 [info ] [Thread-1 (]: 20 of 21 OK created sql table model public_marts.monthly_summary ............... [[32mSUCCESS[0m in 3.83s]
[0m17:56:31.900576 [debug] [Thread-1 (]: Finished running node model.olist_dbt.monthly_summary
[0m17:56:31.901158 [debug] [Thread-1 (]: Began running node model.olist_dbt.user_summary
[0m17:56:31.901843 [info ] [Thread-1 (]: 21 of 21 START sql table model public_marts.user_summary ....................... [RUN]
[0m17:56:31.902522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.monthly_summary, now model.olist_dbt.user_summary)
[0m17:56:31.903048 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.user_summary
[0m17:56:31.907675 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.user_summary"
[0m17:56:31.909113 [debug] [Thread-1 (]: Began executing node model.olist_dbt.user_summary
[0m17:56:31.916138 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dbt.user_summary"
[0m17:56:31.919890 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.user_summary"
[0m17:56:31.920372 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: BEGIN
[0m17:56:31.920768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:31.921330 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:56:31.921751 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:56:32.988767 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.067 seconds
[0m17:56:32.990929 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.user_summary"
[0m17:56:32.992347 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.user_summary"} */

  
    

  create  table
    "dev"."public_marts"."user_summary__dbt_tmp"
    
    
    
  as (
    select
    c.customer_id,
    
    -- Count distinct orders per customer
    count(distinct o.order_id) as lifetime_order_count,
    
    -- Calculate the total sales value (price * quantity) for each customer
    sum(oi.price * oi.freight_value) as lifetime_sales_value,
    
    -- Count the unique product categories purchased by the customer
    count(distinct p.product_category_name) as unique_categories_purchased

-- Join customers with orders
from "dev"."public_staging"."stg_customers" c
left join "dev"."public_staging"."stg_orders" o on c.customer_id = o.customer_id

-- Join orders with order items
left join "dev"."public_staging"."stg_order_items" oi on o.order_id = oi.order_id

-- Join order items with product categories
left join "dev"."public_staging"."stg_products" p on oi.product_id = p.product_id

-- Group by customer to get individual lifetime statistics
group by c.customer_id
  );
[0m17:56:34.143200 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.149 seconds
[0m17:56:34.156165 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.user_summary"
[0m17:56:34.157451 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.user_summary"} */
alter table "dev"."public_marts"."user_summary" rename to "user_summary__dbt_backup"
[0m17:56:34.656816 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.498 seconds
[0m17:56:34.666978 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.user_summary"
[0m17:56:34.667820 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.user_summary"} */
alter table "dev"."public_marts"."user_summary__dbt_tmp" rename to "user_summary"
[0m17:56:34.934693 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.266 seconds
[0m17:56:34.941716 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: COMMIT
[0m17:56:34.942934 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.user_summary"
[0m17:56:34.943663 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: COMMIT
[0m17:56:35.122924 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.179 seconds
[0m17:56:35.123861 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.user_summary"
[0m17:56:35.124252 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: BEGIN
[0m17:56:35.259821 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.135 seconds
[0m17:56:35.268563 [debug] [Thread-1 (]: Applying DROP to: "dev"."public_marts"."user_summary__dbt_backup"
[0m17:56:35.270332 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.user_summary"
[0m17:56:35.270815 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "node_id": "model.olist_dbt.user_summary"} */
drop table if exists "dev"."public_marts"."user_summary__dbt_backup" cascade
[0m17:56:35.497746 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.226 seconds
[0m17:56:35.501044 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: COMMIT
[0m17:56:35.501948 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.user_summary"
[0m17:56:35.502612 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: COMMIT
[0m17:56:35.572368 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.069 seconds
[0m17:56:35.574427 [debug] [Thread-1 (]: Using redshift connection "model.olist_dbt.user_summary"
[0m17:56:35.575564 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: BEGIN
[0m17:56:35.614939 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.038 seconds
[0m17:56:35.618101 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: ROLLBACK
[0m17:56:35.698632 [debug] [Thread-1 (]: On model.olist_dbt.user_summary: Close
[0m17:56:35.701100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd27f9b7-f12a-48b1-88c0-31832b6ab1a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1163b2e70>]}
[0m17:56:35.702416 [info ] [Thread-1 (]: 21 of 21 OK created sql table model public_marts.user_summary .................. [[32mSUCCESS[0m in 3.80s]
[0m17:56:35.703516 [debug] [Thread-1 (]: Finished running node model.olist_dbt.user_summary
[0m17:56:35.706233 [debug] [MainThread]: Using redshift connection "master"
[0m17:56:35.707125 [debug] [MainThread]: On master: BEGIN
[0m17:56:35.707600 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:56:35.708294 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:56:35.708950 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:56:36.133862 [debug] [MainThread]: SQL status: SUCCESS in 0.426 seconds
[0m17:56:36.135823 [debug] [MainThread]: On master: COMMIT
[0m17:56:36.137131 [debug] [MainThread]: Using redshift connection "master"
[0m17:56:36.137841 [debug] [MainThread]: On master: COMMIT
[0m17:56:36.214481 [debug] [MainThread]: SQL status: SUCCESS in 0.076 seconds
[0m17:56:36.216133 [debug] [MainThread]: On master: Close
[0m17:56:36.218143 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:56:36.219039 [debug] [MainThread]: Connection 'model.olist_dbt.user_summary' was properly closed.
[0m17:56:36.220091 [info ] [MainThread]: 
[0m17:56:36.220828 [info ] [MainThread]: Finished running 11 table models, 10 data tests in 0 hours 1 minutes and 31.81 seconds (91.81s).
[0m17:56:36.228854 [debug] [MainThread]: Command end result
[0m17:56:36.274001 [info ] [MainThread]: 
[0m17:56:36.274436 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:56:36.274703 [info ] [MainThread]: 
[0m17:56:36.274969 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=0 SKIP=0 TOTAL=21
[0m17:56:36.276835 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 92.54815, "process_user_time": 4.602574, "process_kernel_time": 0.58246, "process_mem_max_rss": "129613824", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:56:36.277482 [debug] [MainThread]: Command `dbt build` succeeded at 17:56:36.277376 after 92.55 seconds
[0m17:56:36.277841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050becc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11359fc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113570080>]}
[0m17:56:36.278151 [debug] [MainThread]: Flushing usage events
[0m11:04:43.032593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107207560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120843f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120843fe0>]}


============================== 11:04:43.040227 | 75e51518-0ab2-4818-b267-163b7a90de70 ==============================
[0m11:04:43.040227 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:04:43.040995 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:04:43.235018 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m11:04:43.235428 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m11:04:43.945447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75e51518-0ab2-4818-b267-163b7a90de70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a39610>]}
[0m11:04:43.984277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75e51518-0ab2-4818-b267-163b7a90de70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120840980>]}
[0m11:04:43.985561 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m11:04:44.039156 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:04:44.187044 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m11:04:44.187635 [debug] [MainThread]: Partial parsing: added file: olist_dbt://models/staging/olist/_olist_docs.md
[0m11:04:44.188555 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/_olist__sources.yml
[0m11:04:44.188912 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/stg_olist.yml
[0m11:04:44.573033 [error] [MainThread]: Encountered an error:
Compilation Error
  Documentation for 'model.olist_dbt.stg_orders' depends on doc 'order_status'  which was not found
[0m11:04:44.624930 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 1.8309598, "process_user_time": 1.658611, "process_kernel_time": 0.375901, "process_mem_max_rss": "120078336", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:04:44.625637 [debug] [MainThread]: Command `dbt docs generate` failed at 11:04:44.625545 after 1.83 seconds
[0m11:04:44.625996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120843fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c0b3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121dddc70>]}
[0m11:04:44.626306 [debug] [MainThread]: Flushing usage events
[0m11:08:20.400872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c58cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c07f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c28aa0>]}


============================== 11:08:20.404847 | 1dd523b1-34dc-4e12-9787-6497868ffc6e ==============================
[0m11:08:20.404847 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:08:20.405363 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m11:08:20.568578 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m11:08:20.569032 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m11:08:20.694177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dd523b1-34dc-4e12-9787-6497868ffc6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11426a150>]}
[0m11:08:20.731042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1dd523b1-34dc-4e12-9787-6497868ffc6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114212750>]}
[0m11:08:20.731940 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m11:08:20.749340 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:08:20.897119 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m11:08:20.897795 [debug] [MainThread]: Partial parsing: added file: olist_dbt://models/staging/olist/_olist_docs.md
[0m11:08:20.898369 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/stg_olist.yml
[0m11:08:20.899138 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/_olist__sources.yml
[0m11:08:21.383166 [error] [MainThread]: Encountered an error:
Compilation Error
  Documentation for 'model.olist_dbt.stg_orders' depends on doc 'order_status'  which was not found
[0m11:08:21.385123 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 1.0372382, "process_user_time": 1.650985, "process_kernel_time": 0.289522, "process_mem_max_rss": "120078336", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:08:21.385699 [debug] [MainThread]: Command `dbt docs generate` failed at 11:08:21.385619 after 1.04 seconds
[0m11:08:21.386067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114243f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1169652b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b491f0>]}
[0m11:08:21.386364 [debug] [MainThread]: Flushing usage events
[0m11:10:01.081387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10860fa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10888c5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10888c0b0>]}


============================== 11:10:01.085380 | ae5dbb1c-f889-49f7-bfb0-51fbf90c366b ==============================
[0m11:10:01.085380 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:10:01.085876 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:10:01.253739 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m11:10:01.254184 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m11:10:01.376069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae5dbb1c-f889-49f7-bfb0-51fbf90c366b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a71eb0>]}
[0m11:10:01.413700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae5dbb1c-f889-49f7-bfb0-51fbf90c366b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108da0aa0>]}
[0m11:10:01.414782 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m11:10:01.431932 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:10:01.575070 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m11:10:01.575682 [debug] [MainThread]: Partial parsing: added file: olist_dbt://models/staging/olist/order_status.md
[0m11:10:01.576191 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/stg_olist.yml
[0m11:10:01.577163 [debug] [MainThread]: Partial parsing: updated file: olist_dbt://models/staging/olist/_olist__sources.yml
[0m11:10:01.983592 [error] [MainThread]: Encountered an error:
Compilation Error
  Documentation for 'model.olist_dbt.stg_orders' depends on doc 'order_status'  which was not found
[0m11:10:01.985499 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 0.95504725, "process_user_time": 1.642671, "process_kernel_time": 0.265831, "process_mem_max_rss": "121028608", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:10:01.986053 [debug] [MainThread]: Command `dbt docs generate` failed at 11:10:01.985974 after 0.96 seconds
[0m11:10:01.986389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10888c0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aaec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b5a480>]}
[0m11:10:01.986683 [debug] [MainThread]: Flushing usage events
[0m11:12:57.415281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062cb1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105468950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105468980>]}


============================== 11:12:57.419090 | 295c3a70-978a-4cf8-9064-f277d7ee824b ==============================
[0m11:12:57.419090 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:12:57.419590 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:12:57.536799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '295c3a70-978a-4cf8-9064-f277d7ee824b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066477d0>]}
[0m11:12:57.568954 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20424, "process_user_time": 1.002225, "process_kernel_time": 0.186871, "process_mem_max_rss": "94928896", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:12:57.569434 [debug] [MainThread]: Command `dbt clean` succeeded at 11:12:57.569360 after 0.20 seconds
[0m11:12:57.569733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065b3ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106335b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065de3c0>]}
[0m11:12:57.570014 [debug] [MainThread]: Flushing usage events
[0m11:13:02.491593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108020bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f0cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f0caa0>]}


============================== 11:13:02.495505 | d80b87c2-9eef-401b-9161-898af12ed197 ==============================
[0m11:13:02.495505 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:13:02.496000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/eranola/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:13:02.660659 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m11:13:02.661102 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m11:13:02.787044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd80b87c2-9eef-401b-9161-898af12ed197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108288860>]}
[0m11:13:02.823826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd80b87c2-9eef-401b-9161-898af12ed197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108057e90>]}
[0m11:13:02.824662 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m11:13:02.840056 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:13:02.841297 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:13:02.841618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd80b87c2-9eef-401b-9161-898af12ed197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b15340>]}
[0m11:13:03.907636 [error] [MainThread]: Encountered an error:
Compilation Error
  Documentation for 'model.olist_dbt.stg_orders' depends on doc 'order_status'  which was not found
[0m11:13:03.909692 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 1.4688232, "process_user_time": 2.145852, "process_kernel_time": 0.267139, "process_mem_max_rss": "119521280", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:13:03.910217 [debug] [MainThread]: Command `dbt docs generate` failed at 11:13:03.910141 after 1.47 seconds
[0m11:13:03.910518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd4170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109320170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109304770>]}
[0m11:13:03.910802 [debug] [MainThread]: Flushing usage events
[0m11:14:29.862736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108565e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108817e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108567ef0>]}


============================== 11:14:29.866666 | 3fadda34-98ab-4834-8570-ae87a128a9c7 ==============================
[0m11:14:29.866666 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:14:29.867159 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/eranola/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:14:30.033524 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m11:14:30.033960 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m11:14:30.159353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fadda34-98ab-4834-8570-ae87a128a9c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f08770>]}
[0m11:14:30.196739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fadda34-98ab-4834-8570-ae87a128a9c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cf3020>]}
[0m11:14:30.197700 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m11:14:30.213376 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:14:30.214709 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:14:30.215081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3fadda34-98ab-4834-8570-ae87a128a9c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109320200>]}
[0m11:14:31.343546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fadda34-98ab-4834-8570-ae87a128a9c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a7c500>]}
[0m11:14:31.355098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fadda34-98ab-4834-8570-ae87a128a9c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10986c920>]}
[0m11:14:31.355479 [info ] [MainThread]: Found 11 models, 10 data tests, 10 sources, 488 macros
[0m11:14:31.355770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fadda34-98ab-4834-8570-ae87a128a9c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109808d10>]}
[0m11:14:31.357684 [info ] [MainThread]: 
[0m11:14:31.358112 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m11:14:31.361328 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public_marts'
[0m11:14:31.374850 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m11:14:31.375253 [debug] [ThreadPool]: On list_dev_public_marts: BEGIN
[0m11:14:31.375499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:31.378595 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:14:31.379414 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:14:32.441044 [debug] [ThreadPool]: SQL status: SUCCESS in 1.065 seconds
[0m11:14:32.442136 [debug] [ThreadPool]: Using redshift connection "list_dev_public_marts"
[0m11:14:32.444459 [debug] [ThreadPool]: On list_dev_public_marts: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_marts"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_marts'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_marts'
[0m11:14:32.606875 [debug] [ThreadPool]: SQL status: SUCCESS in 0.161 seconds
[0m11:14:32.614756 [debug] [ThreadPool]: On list_dev_public_marts: ROLLBACK
[0m11:14:32.756975 [debug] [ThreadPool]: On list_dev_public_marts: Close
[0m11:14:32.759862 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_public_marts, now list_dev_public_staging)
[0m11:14:32.769425 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m11:14:32.770014 [debug] [ThreadPool]: On list_dev_public_staging: BEGIN
[0m11:14:32.770436 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:14:32.771058 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:14:32.771496 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:14:33.545843 [debug] [ThreadPool]: SQL status: SUCCESS in 0.775 seconds
[0m11:14:33.547768 [debug] [ThreadPool]: Using redshift connection "list_dev_public_staging"
[0m11:14:33.548928 [debug] [ThreadPool]: On list_dev_public_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "list_dev_public_staging"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public_staging'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public_staging'
[0m11:14:33.709588 [debug] [ThreadPool]: SQL status: SUCCESS in 0.159 seconds
[0m11:14:33.714574 [debug] [ThreadPool]: On list_dev_public_staging: ROLLBACK
[0m11:14:33.855550 [debug] [ThreadPool]: On list_dev_public_staging: Close
[0m11:14:33.874689 [debug] [MainThread]: Using redshift connection "master"
[0m11:14:33.875276 [debug] [MainThread]: On master: BEGIN
[0m11:14:33.875710 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:14:33.876306 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:14:33.876753 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:14:34.618790 [debug] [MainThread]: SQL status: SUCCESS in 0.743 seconds
[0m11:14:34.620647 [debug] [MainThread]: Using redshift connection "master"
[0m11:14:34.621898 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m11:14:34.826212 [debug] [MainThread]: SQL status: SUCCESS in 0.203 seconds
[0m11:14:34.830454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fadda34-98ab-4834-8570-ae87a128a9c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109808d10>]}
[0m11:14:34.831393 [debug] [MainThread]: On master: ROLLBACK
[0m11:14:34.976826 [debug] [MainThread]: On master: Close
[0m11:14:34.979602 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:14:34.980723 [info ] [MainThread]: 
[0m11:14:34.988447 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_customers
[0m11:14:34.989643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public_staging, now model.olist_dbt.stg_customers)
[0m11:14:34.990309 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_customers
[0m11:14:34.994936 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_customers"
[0m11:14:34.997970 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_customers
[0m11:14:34.999039 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_customers
[0m11:14:34.999671 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_geolocation
[0m11:14:35.000414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_customers, now model.olist_dbt.stg_geolocation)
[0m11:14:35.000901 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_geolocation
[0m11:14:35.009888 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_geolocation"
[0m11:14:35.011098 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_geolocation
[0m11:14:35.011893 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_geolocation
[0m11:14:35.012303 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_order_items
[0m11:14:35.012787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_geolocation, now model.olist_dbt.stg_order_items)
[0m11:14:35.013385 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_order_items
[0m11:14:35.016204 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_order_items"
[0m11:14:35.017387 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_order_items
[0m11:14:35.018044 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_order_items
[0m11:14:35.018437 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_order_payments
[0m11:14:35.018935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_order_items, now model.olist_dbt.stg_order_payments)
[0m11:14:35.019322 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_order_payments
[0m11:14:35.021763 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_order_payments"
[0m11:14:35.022660 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_order_payments
[0m11:14:35.023226 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_order_payments
[0m11:14:35.023624 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_order_reviews
[0m11:14:35.024004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_order_payments, now model.olist_dbt.stg_order_reviews)
[0m11:14:35.024348 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_order_reviews
[0m11:14:35.026865 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_order_reviews"
[0m11:14:35.027721 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_order_reviews
[0m11:14:35.028323 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_order_reviews
[0m11:14:35.028725 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_orders
[0m11:14:35.029102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_order_reviews, now model.olist_dbt.stg_orders)
[0m11:14:35.029422 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_orders
[0m11:14:35.031796 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_orders"
[0m11:14:35.032583 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_orders
[0m11:14:35.033093 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_orders
[0m11:14:35.033420 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_product_category
[0m11:14:35.033826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_orders, now model.olist_dbt.stg_product_category)
[0m11:14:35.034110 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_product_category
[0m11:14:35.036179 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_product_category"
[0m11:14:35.036935 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_product_category
[0m11:14:35.037423 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_product_category
[0m11:14:35.037738 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_products
[0m11:14:35.038088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_product_category, now model.olist_dbt.stg_products)
[0m11:14:35.038373 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_products
[0m11:14:35.040471 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_products"
[0m11:14:35.041203 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_products
[0m11:14:35.041678 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_products
[0m11:14:35.041990 [debug] [Thread-1 (]: Began running node model.olist_dbt.stg_sellers
[0m11:14:35.042335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_products, now model.olist_dbt.stg_sellers)
[0m11:14:35.042612 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.stg_sellers
[0m11:14:35.044626 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.stg_sellers"
[0m11:14:35.045330 [debug] [Thread-1 (]: Began executing node model.olist_dbt.stg_sellers
[0m11:14:35.045801 [debug] [Thread-1 (]: Finished running node model.olist_dbt.stg_sellers
[0m11:14:35.046127 [debug] [Thread-1 (]: Began running node test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608
[0m11:14:35.046453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.stg_sellers, now test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608)
[0m11:14:35.046727 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608
[0m11:14:35.053141 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608"
[0m11:14:35.054177 [debug] [Thread-1 (]: Began executing node test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608
[0m11:14:35.054641 [debug] [Thread-1 (]: Finished running node test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608
[0m11:14:35.054934 [debug] [Thread-1 (]: Began running node test.olist_dbt.source_not_null_olist_orders_order_id.441189e023
[0m11:14:35.055219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608, now test.olist_dbt.source_not_null_olist_orders_order_id.441189e023)
[0m11:14:35.055470 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.source_not_null_olist_orders_order_id.441189e023
[0m11:14:35.058402 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.source_not_null_olist_orders_order_id.441189e023"
[0m11:14:35.059117 [debug] [Thread-1 (]: Began executing node test.olist_dbt.source_not_null_olist_orders_order_id.441189e023
[0m11:14:35.059571 [debug] [Thread-1 (]: Finished running node test.olist_dbt.source_not_null_olist_orders_order_id.441189e023
[0m11:14:35.059870 [debug] [Thread-1 (]: Began running node test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a
[0m11:14:35.060155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.source_not_null_olist_orders_order_id.441189e023, now test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a)
[0m11:14:35.060406 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a
[0m11:14:35.065085 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a"
[0m11:14:35.065804 [debug] [Thread-1 (]: Began executing node test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a
[0m11:14:35.066268 [debug] [Thread-1 (]: Finished running node test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a
[0m11:14:35.066581 [debug] [Thread-1 (]: Began running node test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82
[0m11:14:35.066879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a, now test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82)
[0m11:14:35.067139 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82
[0m11:14:35.071392 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82"
[0m11:14:35.072120 [debug] [Thread-1 (]: Began executing node test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82
[0m11:14:35.072575 [debug] [Thread-1 (]: Finished running node test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82
[0m11:14:35.072866 [debug] [Thread-1 (]: Began running node test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:14:35.073148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82, now test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m11:14:35.073412 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:14:35.076257 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m11:14:35.077235 [debug] [Thread-1 (]: Began executing node test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:14:35.077687 [debug] [Thread-1 (]: Finished running node test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:14:35.077973 [debug] [Thread-1 (]: Began running node test.olist_dbt.unique_stg_customers_customer_id.c7614daada
[0m11:14:35.078263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.olist_dbt.unique_stg_customers_customer_id.c7614daada)
[0m11:14:35.078522 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.unique_stg_customers_customer_id.c7614daada
[0m11:14:35.081328 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.unique_stg_customers_customer_id.c7614daada"
[0m11:14:35.082091 [debug] [Thread-1 (]: Began executing node test.olist_dbt.unique_stg_customers_customer_id.c7614daada
[0m11:14:35.082554 [debug] [Thread-1 (]: Finished running node test.olist_dbt.unique_stg_customers_customer_id.c7614daada
[0m11:14:35.082852 [debug] [Thread-1 (]: Began running node test.olist_dbt.assert_stg_order_items_values_positive
[0m11:14:35.083146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.unique_stg_customers_customer_id.c7614daada, now test.olist_dbt.assert_stg_order_items_values_positive)
[0m11:14:35.083403 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.assert_stg_order_items_values_positive
[0m11:14:35.085174 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.assert_stg_order_items_values_positive"
[0m11:14:35.086108 [debug] [Thread-1 (]: Began executing node test.olist_dbt.assert_stg_order_items_values_positive
[0m11:14:35.086542 [debug] [Thread-1 (]: Finished running node test.olist_dbt.assert_stg_order_items_values_positive
[0m11:14:35.086840 [debug] [Thread-1 (]: Began running node model.olist_dbt.monthly_summary
[0m11:14:35.087115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.assert_stg_order_items_values_positive, now model.olist_dbt.monthly_summary)
[0m11:14:35.087365 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.monthly_summary
[0m11:14:35.089376 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.monthly_summary"
[0m11:14:35.090258 [debug] [Thread-1 (]: Began executing node model.olist_dbt.monthly_summary
[0m11:14:35.090782 [debug] [Thread-1 (]: Finished running node model.olist_dbt.monthly_summary
[0m11:14:35.091112 [debug] [Thread-1 (]: Began running node test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d
[0m11:14:35.091433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dbt.monthly_summary, now test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d)
[0m11:14:35.091708 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d
[0m11:14:35.094909 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d"
[0m11:14:35.095707 [debug] [Thread-1 (]: Began executing node test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d
[0m11:14:35.096182 [debug] [Thread-1 (]: Finished running node test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d
[0m11:14:35.096470 [debug] [Thread-1 (]: Began running node test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m11:14:35.096762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d, now test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64)
[0m11:14:35.097013 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m11:14:35.099907 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:14:35.100668 [debug] [Thread-1 (]: Began executing node test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m11:14:35.101129 [debug] [Thread-1 (]: Finished running node test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m11:14:35.101417 [debug] [Thread-1 (]: Began running node test.olist_dbt.unique_stg_orders_order_id.e3b841c71a
[0m11:14:35.101707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64, now test.olist_dbt.unique_stg_orders_order_id.e3b841c71a)
[0m11:14:35.101960 [debug] [Thread-1 (]: Began compiling node test.olist_dbt.unique_stg_orders_order_id.e3b841c71a
[0m11:14:35.104751 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m11:14:35.105715 [debug] [Thread-1 (]: Began executing node test.olist_dbt.unique_stg_orders_order_id.e3b841c71a
[0m11:14:35.106158 [debug] [Thread-1 (]: Finished running node test.olist_dbt.unique_stg_orders_order_id.e3b841c71a
[0m11:14:35.106440 [debug] [Thread-1 (]: Began running node model.olist_dbt.user_summary
[0m11:14:35.106718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dbt.unique_stg_orders_order_id.e3b841c71a, now model.olist_dbt.user_summary)
[0m11:14:35.106964 [debug] [Thread-1 (]: Began compiling node model.olist_dbt.user_summary
[0m11:14:35.109311 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dbt.user_summary"
[0m11:14:35.109986 [debug] [Thread-1 (]: Began executing node model.olist_dbt.user_summary
[0m11:14:35.110430 [debug] [Thread-1 (]: Finished running node model.olist_dbt.user_summary
[0m11:14:35.111103 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:14:35.111358 [debug] [MainThread]: Connection 'model.olist_dbt.user_summary' was properly closed.
[0m11:14:35.113251 [debug] [MainThread]: Command end result
[0m11:14:35.195491 [debug] [MainThread]: Acquiring new redshift connection 'generate_catalog'
[0m11:14:35.195830 [info ] [MainThread]: Building catalog
[0m11:14:35.203756 [debug] [ThreadPool]: Acquiring new redshift connection 'dev.information_schema'
[0m11:14:35.237536 [debug] [ThreadPool]: Using redshift connection "dev.information_schema"
[0m11:14:35.237919 [debug] [ThreadPool]: On dev.information_schema: BEGIN
[0m11:14:35.238151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:35.238485 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:14:35.238726 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:14:35.945493 [debug] [ThreadPool]: SQL status: SUCCESS in 0.707 seconds
[0m11:14:35.947448 [debug] [ThreadPool]: Using redshift connection "dev.information_schema"
[0m11:14:35.949686 [debug] [ThreadPool]: On dev.information_schema: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "dev.information_schema"} */
with
            late_binding as (
    
    select
        table_schema,
        table_name,
        'LATE BINDING VIEW'::varchar as table_type,
        null::text as table_comment,
        column_name,
        column_index,
        column_type,
        null::text as column_comment
    from pg_get_late_binding_view_cols()
        cols(
            table_schema name,
            table_name name,
            column_name name,
            column_type varchar,
            column_index int
        )

    where ((
                upper(table_schema) = upper('public')
            and upper(table_name) = upper('product_category')
            ) or (
                upper(table_schema) = upper('public')
            and upper(table_name) = upper('orders')
            ) or (
                upper(table_schema) = upper('public')
            and upper(table_name) = upper('products')
            ) or (
                upper(table_schema) = upper('public')
            and upper(table_name) = upper('geolocation')
            ) or (
                upper(table_schema) = upper('public')
            and upper(table_name) = upper('sellers')
            ) or (
                upper(table_schema) = upper('public_staging')
            and upper(table_name) = upper('stg_customers')
            ) or (
                upper(table_schema) = upper('public')
            and upper(table_name) = upper('order_reviews')
            ) or (
                upper(table_schema) = upper('public_staging')
            and upper(table_name) = upper('stg_sellers')
            ) or (
                upper(table_schema) = upper('public')
            and upper(table_name) = upper('order_payments')
            ) or (
                upper(table_schema) = upper('public_staging')
            and upper(table_name) = upper('stg_products')
            ) or (
                upper(table_schema) = upper('public_staging')
            and upper(table_name) = upper('stg_order_reviews')
            ) or (
                upper(table_schema) = upper('public_staging')
            and upper(table_name) = upper('stg_geolocation')
            ) or (
                upper(table_schema) = upper('public_staging')
            and upper(table_name) = upper('stg_product_category')
            ) or (
                upper(table_schema) = upper('public_marts')
            and upper(table_name) = upper('monthly_summary')
            ) or (
                upper(table_schema) = upper('public_staging')
            and upper(table_name) = upper('stg_orders')
            ) or (
                upper(table_schema) = upper('public')
            and upper(table_name) = upper('order')
            ) or (
                upper(table_schema) = upper('public')
            and upper(table_name) = upper('customer')
            ) or (
                upper(table_schema) = upper('public_staging')
            and upper(table_name) = upper('stg_order_items')
            ) or (
                upper(table_schema) = upper('public')
            and upper(table_name) = upper('order_items')
            ) or (
                upper(table_schema) = upper('public_staging')
            and upper(table_name) = upper('stg_order_payments')
            ) or (
                upper(table_schema) = upper('public_marts')
            and upper(table_name) = upper('user_summary')
            ))
),
            early_binding as (
    
    select
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case
            when tbl.relkind = 'v' and mat_views.table_name is not null then 'MATERIALIZED VIEW'
            when tbl.relkind = 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment
    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl
        on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col
        on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc
        on tbl_desc.objoid = tbl.oid
        and tbl_desc.objsubid = 0
    left outer join pg_catalog.pg_description col_desc
        on col_desc.objoid = tbl.oid
        and col_desc.objsubid = col.attnum
    left outer join information_schema.views mat_views
        on mat_views.table_schema = sch.nspname
        and mat_views.table_name = tbl.relname
        and mat_views.view_definition ilike '%create materialized view%'
        and mat_views.table_catalog = 'dev'
    where tbl.relkind in ('r', 'v', 'f', 'p')
    and col.attnum > 0
    and not col.attisdropped

    and ((
                upper(sch.nspname) = upper('public')
            and upper(tbl.relname) = upper('product_category')
            ) or (
                upper(sch.nspname) = upper('public')
            and upper(tbl.relname) = upper('orders')
            ) or (
                upper(sch.nspname) = upper('public')
            and upper(tbl.relname) = upper('products')
            ) or (
                upper(sch.nspname) = upper('public')
            and upper(tbl.relname) = upper('geolocation')
            ) or (
                upper(sch.nspname) = upper('public')
            and upper(tbl.relname) = upper('sellers')
            ) or (
                upper(sch.nspname) = upper('public_staging')
            and upper(tbl.relname) = upper('stg_customers')
            ) or (
                upper(sch.nspname) = upper('public')
            and upper(tbl.relname) = upper('order_reviews')
            ) or (
                upper(sch.nspname) = upper('public_staging')
            and upper(tbl.relname) = upper('stg_sellers')
            ) or (
                upper(sch.nspname) = upper('public')
            and upper(tbl.relname) = upper('order_payments')
            ) or (
                upper(sch.nspname) = upper('public_staging')
            and upper(tbl.relname) = upper('stg_products')
            ) or (
                upper(sch.nspname) = upper('public_staging')
            and upper(tbl.relname) = upper('stg_order_reviews')
            ) or (
                upper(sch.nspname) = upper('public_staging')
            and upper(tbl.relname) = upper('stg_geolocation')
            ) or (
                upper(sch.nspname) = upper('public_staging')
            and upper(tbl.relname) = upper('stg_product_category')
            ) or (
                upper(sch.nspname) = upper('public_marts')
            and upper(tbl.relname) = upper('monthly_summary')
            ) or (
                upper(sch.nspname) = upper('public_staging')
            and upper(tbl.relname) = upper('stg_orders')
            ) or (
                upper(sch.nspname) = upper('public')
            and upper(tbl.relname) = upper('order')
            ) or (
                upper(sch.nspname) = upper('public')
            and upper(tbl.relname) = upper('customer')
            ) or (
                upper(sch.nspname) = upper('public_staging')
            and upper(tbl.relname) = upper('stg_order_items')
            ) or (
                upper(sch.nspname) = upper('public')
            and upper(tbl.relname) = upper('order_items')
            ) or (
                upper(sch.nspname) = upper('public_staging')
            and upper(tbl.relname) = upper('stg_order_payments')
            ) or (
                upper(sch.nspname) = upper('public_marts')
            and upper(tbl.relname) = upper('user_summary')
            ))
),
            unioned as (select * from early_binding union all select * from late_binding),
            table_owners as (
    select
        schemaname as table_schema,
        tablename as table_name,
        tableowner as table_owner
    from pg_tables
    union all
    select
        schemaname as table_schema,
        viewname as table_name,
        viewowner as table_owner
    from pg_views
)
        select 'dev' as table_database, *
        from unioned
        join table_owners using (table_schema, table_name)
        order by "column_index"
[0m11:14:36.320659 [debug] [ThreadPool]: SQL status: SUCCESS in 0.369 seconds
[0m11:14:36.332743 [debug] [ThreadPool]: Using redshift connection "dev.information_schema"
[0m11:14:36.333473 [debug] [ThreadPool]: On dev.information_schema: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "dev.information_schema"} */
select has_table_privilege(current_user, 'svv_table_info', 'SELECT') as can_select
[0m11:14:36.475447 [debug] [ThreadPool]: SQL status: SUCCESS in 0.141 seconds
[0m11:14:36.508823 [debug] [ThreadPool]: Using redshift connection "dev.information_schema"
[0m11:14:36.509789 [debug] [ThreadPool]: On dev.information_schema: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "olist_dbt", "target_name": "dev", "connection_name": "dev.information_schema"} */

    select
        "schema" as table_schema,
        "table" as table_name,

        'Encoded'::text as "stats:encoded:label",
        encoded as "stats:encoded:value",
        'Indicates whether any column in the table has compression encoding defined.'::text as "stats:encoded:description",
        true as "stats:encoded:include",

        'Dist Style' as "stats:diststyle:label",
        diststyle as "stats:diststyle:value",
        'Distribution style or distribution key column, if key distribution is defined.'::text as "stats:diststyle:description",
        true as "stats:diststyle:include",

        'Sort Key 1' as "stats:sortkey1:label",
        -- handle 0xFF byte in response for interleaved sort styles
        case
            when sortkey1 like 'INTERLEAVED%' then 'INTERLEAVED'::text
            else sortkey1
        end as "stats:sortkey1:value",
        'First column in the sort key.'::text as "stats:sortkey1:description",
        (sortkey1 is not null) as "stats:sortkey1:include",

        'Max Varchar' as "stats:max_varchar:label",
        max_varchar as "stats:max_varchar:value",
        'Size of the largest column that uses a VARCHAR data type.'::text as "stats:max_varchar:description",
        true as "stats:max_varchar:include",

        -- exclude this, as the data is strangely returned with null-byte characters
        'Sort Key 1 Encoding' as "stats:sortkey1_enc:label",
        sortkey1_enc as "stats:sortkey1_enc:value",
        'Compression encoding of the first column in the sort key.' as "stats:sortkey1_enc:description",
        false as "stats:sortkey1_enc:include",

        '# Sort Keys' as "stats:sortkey_num:label",
        sortkey_num as "stats:sortkey_num:value",
        'Number of columns defined as sort keys.' as "stats:sortkey_num:description",
        (sortkey_num > 0) as "stats:sortkey_num:include",

        'Approximate Size' as "stats:size:label",
        size * 1000000 as "stats:size:value",
        'Approximate size of the table, calculated from a count of 1MB blocks'::text as "stats:size:description",
        true as "stats:size:include",

        'Disk Utilization' as "stats:pct_used:label",
        pct_used / 100.0 as "stats:pct_used:value",
        'Percent of available space that is used by the table.'::text as "stats:pct_used:description",
        true as "stats:pct_used:include",

        'Unsorted %' as "stats:unsorted:label",
        unsorted / 100.0 as "stats:unsorted:value",
        'Percent of unsorted rows in the table.'::text as "stats:unsorted:description",
        (unsorted is not null) as "stats:unsorted:include",

        'Stats Off' as "stats:stats_off:label",
        stats_off as "stats:stats_off:value",
        'Number that indicates how stale the table statistics are; 0 is current, 100 is out of date.'::text as "stats:stats_off:description",
        true as "stats:stats_off:include",

        'Approximate Row Count' as "stats:rows:label",
        tbl_rows as "stats:rows:value",
        'Approximate number of rows in the table. This value includes rows marked for deletion, but not yet vacuumed.'::text as "stats:rows:description",
        true as "stats:rows:include",

        'Sort Key Skew' as "stats:skew_sortkey1:label",
        skew_sortkey1 as "stats:skew_sortkey1:value",
        'Ratio of the size of the largest non-sort key column to the size of the first column of the sort key.'::text as "stats:skew_sortkey1:description",
        (skew_sortkey1 is not null) as "stats:skew_sortkey1:include",

        'Skew Rows' as "stats:skew_rows:label",
        skew_rows as "stats:skew_rows:value",
        'Ratio of the number of rows in the slice with the most rows to the number of rows in the slice with the fewest rows.'::text as "stats:skew_rows:description",
        (skew_rows is not null) as "stats:skew_rows:include"

    from svv_table_info

        where ((
                    upper("schema") = upper('public')
                and upper("table") = upper('product_category')
                ) or (
                    upper("schema") = upper('public')
                and upper("table") = upper('orders')
                ) or (
                    upper("schema") = upper('public')
                and upper("table") = upper('products')
                ) or (
                    upper("schema") = upper('public')
                and upper("table") = upper('geolocation')
                ) or (
                    upper("schema") = upper('public')
                and upper("table") = upper('sellers')
                ) or (
                    upper("schema") = upper('public_staging')
                and upper("table") = upper('stg_customers')
                ) or (
                    upper("schema") = upper('public')
                and upper("table") = upper('order_reviews')
                ) or (
                    upper("schema") = upper('public_staging')
                and upper("table") = upper('stg_sellers')
                ) or (
                    upper("schema") = upper('public')
                and upper("table") = upper('order_payments')
                ) or (
                    upper("schema") = upper('public_staging')
                and upper("table") = upper('stg_products')
                ) or (
                    upper("schema") = upper('public_staging')
                and upper("table") = upper('stg_order_reviews')
                ) or (
                    upper("schema") = upper('public_staging')
                and upper("table") = upper('stg_geolocation')
                ) or (
                    upper("schema") = upper('public_staging')
                and upper("table") = upper('stg_product_category')
                ) or (
                    upper("schema") = upper('public_marts')
                and upper("table") = upper('monthly_summary')
                ) or (
                    upper("schema") = upper('public_staging')
                and upper("table") = upper('stg_orders')
                ) or (
                    upper("schema") = upper('public')
                and upper("table") = upper('order')
                ) or (
                    upper("schema") = upper('public')
                and upper("table") = upper('customer')
                ) or (
                    upper("schema") = upper('public_staging')
                and upper("table") = upper('stg_order_items')
                ) or (
                    upper("schema") = upper('public')
                and upper("table") = upper('order_items')
                ) or (
                    upper("schema") = upper('public_staging')
                and upper("table") = upper('stg_order_payments')
                ) or (
                    upper("schema") = upper('public_marts')
                and upper("table") = upper('user_summary')
                ))
[0m11:14:45.174414 [debug] [ThreadPool]: SQL status: SUCCESS in 8.664 seconds
[0m11:14:45.203893 [debug] [ThreadPool]: On dev.information_schema: ROLLBACK
[0m11:14:45.343513 [debug] [ThreadPool]: On dev.information_schema: Close
[0m11:14:45.475435 [info ] [MainThread]: Catalog written to /Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/target/catalog.json
[0m11:14:45.477327 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 15.667736, "process_user_time": 3.008483, "process_kernel_time": 0.382548, "process_mem_max_rss": "127369216", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:14:45.477821 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:14:45.477751 after 15.67 seconds
[0m11:14:45.478079 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:14:45.478285 [debug] [MainThread]: Connection 'dev.information_schema' was properly closed.
[0m11:14:45.478518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108565e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10520ecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081c2cf0>]}
[0m11:14:45.478779 [debug] [MainThread]: Flushing usage events
[0m11:16:12.545873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104338770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103220aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103220a70>]}


============================== 11:16:12.549957 | 47d33fa1-e506-4b02-b997-4e0df590fd89 ==============================
[0m11:16:12.549957 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:16:12.550454 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/eranola/.dbt', 'log_path': '/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:16:12.715614 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m11:16:12.716064 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m11:16:12.842568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47d33fa1-e506-4b02-b997-4e0df590fd89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104739160>]}
[0m11:16:12.880674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47d33fa1-e506-4b02-b997-4e0df590fd89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1017cc260>]}
[0m14:38:53.647296 [error] [MainThread]: Encountered an error:

[0m14:38:53.664163 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/eranola/Documents/projects/environments/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eranola/Documents/projects/environments/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eranola/Documents/projects/environments/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eranola/Documents/projects/environments/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eranola/Documents/projects/environments/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/eranola/Documents/projects/environments/venv/lib/python3.12/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/eranola/Documents/projects/environments/venv/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/opt/anaconda3/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m14:38:53.747797 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 12161.731, "process_user_time": 2.342411, "process_kernel_time": 1.106855, "process_mem_max_rss": "110723072", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:38:53.750847 [debug] [MainThread]: Command `dbt docs serve` failed at 14:38:53.750620 after 12161.74 seconds
[0m14:38:53.751833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035db2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f96e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c28770>]}
[0m14:38:53.752515 [debug] [MainThread]: Flushing usage events
