{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.6", "generated_at": "2024-09-20T03:14:35.111559Z", "invocation_id": "3fadda34-98ab-4834-8570-ae87a128a9c7", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-20T03:14:34.990681Z", "completed_at": "2024-09-20T03:14:34.997799Z"}, {"name": "execute", "started_at": "2024-09-20T03:14:34.998395Z", "completed_at": "2024-09-20T03:14:34.998415Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009271621704101562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.olist_dbt.stg_customers", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"dev\".\"public\".\"customer\"\n)\nselect\n    customer_id,\n    customer_unique_id,\n    customer_zip_code_prefix,\n    customer_city,\n    customer_state\nfrom source", "relation_name": "\"dev\".\"public_staging\".\"stg_customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-20T03:14:35.001234Z", "completed_at": "2024-09-20T03:14:35.010968Z"}, {"name": "execute", "started_at": "2024-09-20T03:14:35.011440Z", "completed_at": "2024-09-20T03:14:35.011450Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011360883712768555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.olist_dbt.stg_geolocation", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"dev\".\"public\".\"geolocation\"\n)\nselect\n    geolocation_zip_code_prefix,\n    geolocation_lat,\n    geolocation_lng,\n    geolocation_city,\n    geolocation_state\nfrom source", "relation_name": "\"dev\".\"public_staging\".\"stg_geolocation\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-20T03:14:35.013689Z", "completed_at": "2024-09-20T03:14:35.017275Z"}, {"name": "execute", "started_at": "2024-09-20T03:14:35.017674Z", "completed_at": "2024-09-20T03:14:35.017682Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0051729679107666016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.olist_dbt.stg_order_items", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"dev\".\"public\".\"order_items\"\n)\nselect\n    order_id,\n    order_item_id,\n    product_id,\n    seller_id,\n    shipping_limit_date,\n    price,\n    freight_value\n    \nfrom source", "relation_name": "\"dev\".\"public_staging\".\"stg_order_items\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-20T03:14:35.019599Z", "completed_at": "2024-09-20T03:14:35.022569Z"}, {"name": "execute", "started_at": "2024-09-20T03:14:35.022908Z", "completed_at": "2024-09-20T03:14:35.022914Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004197835922241211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.olist_dbt.stg_order_payments", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"dev\".\"public\".\"order_payments\"\n)\nselect\n    order_id,\n    payment_sequential,\n    payment_type,\n    payment_installments,\n    payment_value\nfrom source", "relation_name": "\"dev\".\"public_staging\".\"stg_order_payments\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-20T03:14:35.024607Z", "completed_at": "2024-09-20T03:14:35.027624Z"}, {"name": "execute", "started_at": "2024-09-20T03:14:35.027983Z", "completed_at": "2024-09-20T03:14:35.027989Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004182100296020508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.olist_dbt.stg_order_reviews", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"dev\".\"public\".\"order_reviews\"\n)\nselect\n    review_id,\n    order_id,\n    review_score,\n    review_comment_title,\n    review_comment_message,\n    review_creation_date,\n    review_answer_timestamp\nfrom source", "relation_name": "\"dev\".\"public_staging\".\"stg_order_reviews\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-20T03:14:35.029635Z", "completed_at": "2024-09-20T03:14:35.032504Z"}, {"name": "execute", "started_at": "2024-09-20T03:14:35.032807Z", "completed_at": "2024-09-20T03:14:35.032812Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0038979053497314453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.olist_dbt.stg_orders", "compiled": true, "compiled_code": "\n\n\n-- models/staging/olist/stg_orders.sql\nwith source as (\n    select *\n    from \"dev\".\"public\".\"orders\"\n)\nselect\n    order_id,\n    customer_id,\n    order_status,\n    order_purchase_timestamp::timestamp as order_purchase_timestamp,\n    order_approved_at::timestamp as order_approved_at,\n    order_delivered_carrier_date::timestamp as order_delivered_carrier_date,\n    order_delivered_customer_date::timestamp as order_delivered_customer_date,\n    order_estimated_delivery_date::timestamp as order_estimated_delivery_date\nfrom source", "relation_name": "\"dev\".\"public_staging\".\"stg_orders\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-20T03:14:35.034309Z", "completed_at": "2024-09-20T03:14:35.036854Z"}, {"name": "execute", "started_at": "2024-09-20T03:14:35.037139Z", "completed_at": "2024-09-20T03:14:35.037146Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003490924835205078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.olist_dbt.stg_product_category", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"dev\".\"public\".\"product_category\"\n)\nselect\n    product_category_name_english as product_category\nfrom source", "relation_name": "\"dev\".\"public_staging\".\"stg_product_category\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-20T03:14:35.038607Z", "completed_at": "2024-09-20T03:14:35.041126Z"}, {"name": "execute", "started_at": "2024-09-20T03:14:35.041403Z", "completed_at": "2024-09-20T03:14:35.041409Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0034859180450439453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.olist_dbt.stg_products", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"dev\".\"public\".\"products\"\n)\nselect\n    product_id,\n    product_category_name,\n    product_name_length,\n    product_description_length,\n    product_photos_qty,\n    product_weight_g,\n    product_length_cm,\n    product_height_cm,\n    product_width_cm\nfrom source", "relation_name": "\"dev\".\"public_staging\".\"stg_products\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-20T03:14:35.042813Z", "completed_at": "2024-09-20T03:14:35.045254Z"}, {"name": "execute", "started_at": "2024-09-20T03:14:35.045529Z", "completed_at": "2024-09-20T03:14:35.045534Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0033588409423828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.olist_dbt.stg_sellers", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"dev\".\"public\".\"sellers\"\n)\nselect\n    seller_id,\n    seller_zip_code_prefix,\n    seller_city,\n    seller_state\nfrom source", "relation_name": "\"dev\".\"public_staging\".\"stg_sellers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-20T03:14:35.046925Z", "completed_at": "2024-09-20T03:14:35.054098Z"}, {"name": "execute", "started_at": "2024-09-20T03:14:35.054381Z", "completed_at": "2024-09-20T03:14:35.054386Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008092880249023438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.olist_dbt.source_not_null_olist_customer_customer_id.6b5402b608", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"dev\".\"public\".\"customer\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-20T03:14:35.055646Z", "completed_at": "2024-09-20T03:14:35.059043Z"}, {"name": "execute", "started_at": "2024-09-20T03:14:35.059315Z", "completed_at": "2024-09-20T03:14:35.059320Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004250049591064453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.olist_dbt.source_not_null_olist_orders_order_id.441189e023", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom \"dev\".\"public\".\"orders\"\nwhere order_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-20T03:14:35.060585Z", "completed_at": "2024-09-20T03:14:35.065729Z"}, {"name": "execute", "started_at": "2024-09-20T03:14:35.066004Z", "completed_at": "2024-09-20T03:14:35.066009Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006005048751831055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.olist_dbt.source_unique_olist_customer_customer_id.73f8b9c46a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"dev\".\"public\".\"customer\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-20T03:14:35.067322Z", "completed_at": "2024-09-20T03:14:35.072047Z"}, {"name": "execute", "started_at": "2024-09-20T03:14:35.072319Z", "completed_at": "2024-09-20T03:14:35.072323Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005596160888671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.olist_dbt.source_unique_olist_orders_order_id.df3b066d82", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_id as unique_field,\n    count(*) as n_records\n\nfrom \"dev\".\"public\".\"orders\"\nwhere order_id is not null\ngroup by order_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-20T03:14:35.073593Z", "completed_at": "2024-09-20T03:14:35.077162Z"}, {"name": "execute", "started_at": "2024-09-20T03:14:35.077433Z", "completed_at": "2024-09-20T03:14:35.077438Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004434823989868164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.olist_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"dev\".\"public_staging\".\"stg_customers\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-20T03:14:35.078707Z", "completed_at": "2024-09-20T03:14:35.082015Z"}, {"name": "execute", "started_at": "2024-09-20T03:14:35.082293Z", "completed_at": "2024-09-20T03:14:35.082298Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004181861877441406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.olist_dbt.unique_stg_customers_customer_id.c7614daada", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"dev\".\"public_staging\".\"stg_customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-20T03:14:35.083581Z", "completed_at": "2024-09-20T03:14:35.086038Z"}, {"name": "execute", "started_at": "2024-09-20T03:14:35.086291Z", "completed_at": "2024-09-20T03:14:35.086295Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0032949447631835938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.olist_dbt.assert_stg_order_items_values_positive", "compiled": true, "compiled_code": "WITH order_items AS (\n\n    SELECT  *\n    FROM \"dev\".\"public_staging\".\"stg_order_items\"\n\n)\n\nSELECT  order_id,\n        SUM(price) AS total_value\nFROM order_items\nGROUP BY 1\nHAVING total_value < 0", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-20T03:14:35.087561Z", "completed_at": "2024-09-20T03:14:35.090170Z"}, {"name": "execute", "started_at": "2024-09-20T03:14:35.090492Z", "completed_at": "2024-09-20T03:14:35.090498Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0035440921783447266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.olist_dbt.monthly_summary", "compiled": true, "compiled_code": "-- models/marts/olist/monthly_sales.sql\n\nselect\n    -- Truncate the order purchase timestamp to get the month\n    date_trunc('month', o.order_purchase_timestamp) as month,\n    \n    -- Calculate the total sales for each month\n    sum(oi.price * oi.freight_value) as total_sales\n\n-- Start from the orders table\nfrom \"dev\".\"public_staging\".\"stg_orders\" o\n\n-- Join the order_items table on order_id\njoin \"dev\".\"public_staging\".\"stg_order_items\" oi on o.order_id = oi.order_id\n\n-- Group by the month to aggregate total sales per month\ngroup by 1", "relation_name": "\"dev\".\"public_marts\".\"monthly_summary\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-20T03:14:35.091899Z", "completed_at": "2024-09-20T03:14:35.095623Z"}, {"name": "execute", "started_at": "2024-09-20T03:14:35.095917Z", "completed_at": "2024-09-20T03:14:35.095922Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0046541690826416016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.olist_dbt.accepted_values_stg_orders_order_status__delivered__canceled__invoiced__processing__created__shipped__unavailable__approved.67568b689d", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        order_status as value_field,\n        count(*) as n_records\n\n    from \"dev\".\"public_staging\".\"stg_orders\"\n    group by order_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'delivered','canceled','invoiced','processing','created','shipped','unavailable','approved'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-20T03:14:35.097191Z", "completed_at": "2024-09-20T03:14:35.100592Z"}, {"name": "execute", "started_at": "2024-09-20T03:14:35.100873Z", "completed_at": "2024-09-20T03:14:35.100878Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004271030426025391, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.olist_dbt.not_null_stg_orders_order_id.81cfe2fe64", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom \"dev\".\"public_staging\".\"stg_orders\"\nwhere order_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-20T03:14:35.102138Z", "completed_at": "2024-09-20T03:14:35.105644Z"}, {"name": "execute", "started_at": "2024-09-20T03:14:35.105909Z", "completed_at": "2024-09-20T03:14:35.105915Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004354953765869141, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.olist_dbt.unique_stg_orders_order_id.e3b841c71a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_id as unique_field,\n    count(*) as n_records\n\nfrom \"dev\".\"public_staging\".\"stg_orders\"\nwhere order_id is not null\ngroup by order_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-20T03:14:35.107146Z", "completed_at": "2024-09-20T03:14:35.109918Z"}, {"name": "execute", "started_at": "2024-09-20T03:14:35.110176Z", "completed_at": "2024-09-20T03:14:35.110181Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003612041473388672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.olist_dbt.user_summary", "compiled": true, "compiled_code": "select\n    c.customer_id,\n    \n    -- Count distinct orders per customer\n    count(distinct o.order_id) as lifetime_order_count,\n    \n    -- Calculate the total sales value (price * quantity) for each customer\n    sum(oi.price * oi.freight_value) as lifetime_sales_value,\n    \n    -- Count the unique product categories purchased by the customer\n    count(distinct p.product_category_name) as unique_categories_purchased\n\n-- Join customers with orders\nfrom \"dev\".\"public_staging\".\"stg_customers\" c\nleft join \"dev\".\"public_staging\".\"stg_orders\" o on c.customer_id = o.customer_id\n\n-- Join orders with order items\nleft join \"dev\".\"public_staging\".\"stg_order_items\" oi on o.order_id = oi.order_id\n\n-- Join order items with product categories\nleft join \"dev\".\"public_staging\".\"stg_products\" p on oi.product_id = p.product_id\n\n-- Group by customer to get individual lifetime statistics\ngroup by c.customer_id", "relation_name": "\"dev\".\"public_marts\".\"user_summary\""}], "elapsed_time": 3.7535879611968994, "args": {"project_dir": "/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt", "print": true, "macro_debugging": false, "require_resource_names_without_spaces": false, "version_check": true, "show_resource_report": false, "which": "generate", "partial_parse": true, "require_explicit_package_overrides_for_builtin_materializations": true, "vars": {}, "use_colors_file": true, "static": false, "static_parser": true, "invocation_command": "dbt docs generate", "warn_error_options": {"include": [], "exclude": []}, "compile": true, "log_format_file": "debug", "partial_parse_file_diff": true, "profiles_dir": "/Users/eranola/.dbt", "log_format": "default", "introspect": true, "favor_state": false, "defer": false, "empty_catalog": false, "quiet": false, "strict_mode": false, "log_path": "/Users/eranola/Documents/projects/data-engineering-project/dbt/olist_dbt/logs", "write_json": true, "enable_legacy_logger": false, "populate_cache": true, "log_level_file": "debug", "exclude": [], "log_file_max_bytes": 10485760, "indirect_selection": "eager", "printer_width": 80, "use_colors": true, "select": [], "send_anonymous_usage_stats": true, "cache_selected_only": false, "log_level": "info", "source_freshness_run_project_hooks": false}}